!function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=68)}([function(e,t,n){"use strict";function s(e,t){return e.line<t.line?-1:e.line>t.line?1:e.character<t.character?-1:e.character>t.character?1:0}function r(){return{line:0,character:0}}Object.defineProperty(t,"__esModule",{value:!0}),function(e){function t(e,t){if(e<0)throw new Error("start must be non-negative");if(t<0)throw new Error("length must be non-negative");return{start:e,length:t}}function n(e){return e.start+e.length}e.create=t,e.fromBounds=function(e,n){if(e<0)throw new Error("start must be non-negative");if(e>n)throw new Error("end must be greater than or equal to start");return t(e,n-e)},e.getEnd=n,e.contains=function(e,t){return t>=e.start&&t<n(e)},e.extend=function e(t,s){s&&(Array.isArray(s)?s.forEach(n=>{e(t,n)}):(s.start<t.start&&(t.length+=t.start-s.start,t.start=s.start),n(s)>n(t)&&(t.length+=n(s)-n(t))))}}(t.TextRange||(t.TextRange={})),t.comparePositions=s,t.getEmptyPosition=r,t.doRangesOverlap=function(e,t){return!(s(t.start,e.end)>=0)&&!(s(e.start,t.end)>=0)},t.doesRangeContain=function(e,t){return s(e.start,t)<=0&&s(e.end,t)>=0},t.rangesAreEqual=function(e,t){return 0===s(e.start,t.start)&&0===s(e.end,t.end)},t.getEmptyRange=function(){return{start:{line:0,character:0},end:{line:0,character:0}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(36),r=n(25);function i(e,t){const n=new Error(e?`Debug Failure. ${e}`:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(n,t||i),n}function o(e,t){return null==e?i(t):e}t.assert=function e(t,n,s,r){t||(s&&(n+="\r\nVerbose Debug Information: "+("string"==typeof s?s:s())),i(n?"False expression: "+n:"False expression.",r||e))},t.fail=i,t.assertDefined=o,t.assertEachDefined=function(e,t){for(const n of e)o(n,t);return e},t.assertNever=function e(t,n="Illegal value:",s){return i(`${n} ${JSON.stringify(t)}`,s||e)},t.getFunctionName=function(e){if("function"!=typeof e)return"";if(r.hasProperty(e,"name"))return e.name;{const t=Function.prototype.toString.call(e),n=/^function\s+([\w$]+)\s*\(/.exec(t);return n?n[1]:""}},t.formatEnum=function(e=0,t,n){const i=function(e){const t=[];for(const n of Object.keys(e)){const s=e[n];"number"==typeof s&&t.push([s,n])}return s.stableSort(t,(e,t)=>r.compareValues(e[0],t[0]))}(t);if(0===e)return i.length>0&&0===i[0][0]?i[0][1]:"0";if(n){let t="",n=e;for(const[s,r]of i){if(s>e)break;0!==s&&s&e&&(t=`${t}${t?"|":""}${r}`,n&=~s)}if(0===n)return t}else for(const[t,n]of i)if(t===e)return n;return e.toString()}},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(11),r=n(34),i=n(2),o=n(10);class a{static shouldCheck(){const e=Date.now().valueOf();return e-this._lastCheckTimestamp>=5&&(this._lastCheckTimestamp=e,!0)}}a._lastCheckTimestamp=0;class c{constructor(e){this._cancellationFolderPath=e,this._isCancelled=!1}get isCancellationRequested(){return!!this._isCancelled||(a.shouldCheck()&&this._pipeExists()&&(this._isCancelled=!0),this._isCancelled)}get onCancellationRequested(){return o.Event.None}_pipeExists(){try{const e=s.readdirSync(this._cancellationFolderPath);return e&&e.length>0}catch(e){return!1}}}class l{constructor(e){this._cancellationFilePath=e,this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return!!this._isCancelled||(a.shouldCheck()&&this._pipeExists()&&this.cancel(),this._isCancelled)}get onCancellationRequested(){return this._emitter||(this._emitter=new o.Emitter),this._emitter.event}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}_pipeExists(){try{return s.statSync(this._cancellationFilePath),!0}catch(e){return!1}}}class p{constructor(e){this._cancellationFilePath=e}get token(){return this._token||(this._token=new l(this._cancellationFilePath)),this._token}cancel(){this._token?this._token.cancel():this._token=o.CancellationToken.Cancelled}dispose(){this._token?this._token instanceof l&&this._token.dispose():this._token=o.CancellationToken.None}}function u(e){return i.join(r.tmpdir(),"python-languageserver-cancellation",e)}class d{constructor(e){this.folderName=e}createCancellationTokenSource(e){return new p(function(e,t){return i.join(u(e),`cancellation-${String(t)}.tmp`)}(this.folderName,e))}}class h extends o.ResponseError{constructor(){super(o.ErrorCodes.RequestCancelled,"request cancelled")}static is(e){return e.code==o.ErrorCodes.RequestCancelled}}let f;t.OperationCanceledException=h,t.throwIfCancellationRequested=function(e){if(e.isCancellationRequested)throw new h},t.getCancellationStrategyFromArgv=function(e){let t;for(let s=0;s<e.length;s++){const r=e[s];if("--cancellationReceive"===r)t=n(e[s+1]);else{const e=r.split("=");"--cancellationReceive"===e[0]&&(t=n(e[1]))}}return t&&!f&&(f=t.folderName),t=t||o.CancellationReceiverStrategy.Message,{receiver:t,sender:o.CancellationSenderStrategy.Message};function n(e){const t=function(e){const t=e.match(/^file:(.+)$/);return t?t[1]:void 0}(e);return t?new d(t):void 0}},t.getGlobalCancellationToken=function(){return f?new c(u(f)):o.CancellationToken.None}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1);function r(e,t){if(0===t.end)return{line:0,character:0};e>=t.end&&(e=t.end-1);const n=t.getItemContaining(e);s.assert(n>=0&&n<=t.length);const r=t.getItemAt(n);return s.assert(void 0!==r),{line:n,character:e-r.start}}t.convertOffsetToPosition=r,t.convertOffsetsToRange=function(e,t,n){return{start:r(e,n),end:r(t,n)}},t.convertPositionToOffset=function(e,t){if(!(e.line>=t.count))return t.getItemAt(e.line).start+e.character}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9);class r extends s.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=r;class i extends s.RequestType{constructor(e){super(e)}}t.ProtocolRequestType=i;class o extends s.NotificationType{constructor(e){super(e)}}t.ProtocolNotificationType=o;class a extends s.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(2),r=n(48),i=n(36),o=n(25),a=n(1),c=n(19);function l(e){return e.substr(0,Math.max(p(e),e.lastIndexOf(s.sep)))}function p(e){if(e.charAt(0)===s.sep){if(e.charAt(1)!==s.sep)return 1;const t=e.indexOf(s.sep,2);if(t<0)return 2;const n=e.indexOf(s.sep,t+1);return n<0?t+1:n+1}return":"===e.charAt(1)&&e.charAt(2)===s.sep?3:0}function u(e){const t=f(e),n=p(t),r=t.substring(0,n),i=t.substring(n).split(s.sep);return i.length>0&&!i[i.length-1]&&i.pop(),d([r,...i])}function d(e){if(!i.some(e))return[];const t=[e[0]];for(let n=1;n<e.length;n++){const s=e[n];if(s&&"."!==s){if(".."===s)if(t.length>1){if(".."!==t[t.length-1]){t.pop();continue}}else if(t[0])continue;t.push(s)}}return t}function h(e){if(0===e.length)return"";return f((e[0]&&_(e[0]))+e.slice(1).join(s.sep))}function f(e){return e.replace(/[\\/]/g,s.sep)}function g(e,...t){e&&(e=f(e));for(let n of t)n&&(n=f(n),e=e&&0===p(n)?_(e)+n:n);return e}function y(e,t,n){if(t)return function(e,t,n){if("string"==typeof t)return x(e,t,n)||"";for(const s of t){const t=x(e,s,n);if(t)return t}return""}(v(e),t,n?c.equateStringsCaseInsensitive:c.equateStringsCaseSensitive);const s=m(e),r=s.lastIndexOf(".");return r>=0?s.substring(r):""}function m(e,t,n){if(p(e=f(e))===e.length)return"";const r=(e=v(e)).slice(Math.max(p(e),e.lastIndexOf(s.sep)+1)),i=void 0!==t&&void 0!==n?y(r,t,n):void 0;return i?r.slice(0,r.length-i.length):r}function _(e){return T(e)?e:e+s.sep}function T(e){if(0===e.length)return!1;const t=e.charCodeAt(e.length-1);return 47===t||92===t}function v(e){return T(e)?e.substr(0,e.length-1):e}function b(e){return f(s.normalize(e))}function E(e,t){let n=b(g(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=_(n));const s=u(n),r=k(),i=`(${r}[^${r}.][^${r}]*)*?`,o=new RegExp(`[^\\w\\s${r}]`,"g");s.length>0&&(s[0]=v(s[0]));let a="",c=!0;for(let e of s)"**"===e?a+=i:(c||(e=r+e),a+=e.replace(o,e=>"*"===e?`[^${r}]*`:"?"===e?`[^${r}]`:"\\"+e),c=!1);return a}function C(e,t){let n=b(g(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=_(n));const r=u(n);r.length>0&&(r[0]=v(r[0]));let i="",o=!0;for(let e of r){if("**"===e)break;if(e.match(/[*?]/))break;o||(e=s.sep+e),i+=e,o=!1}return i}function k(){return"/"===s.sep?"/":"\\\\"}function S(e,t,n){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;const s=e.substring(0,p(e)),r=t.substring(0,p(t)),i=c.compareStringsCaseInsensitive(s,r);if(0!==i)return i;const a=k(),l=new RegExp(`(^|${a}).{0,2}($|${a})`),d=e.substring(s.length),h=t.substring(r.length);if(!l.test(d)&&!l.test(h))return n(d,h);const f=u(e),g=u(t),y=Math.min(f.length,g.length);for(let e=1;e<y;e++){const t=n(f[e],g[e]);if(0!==t)return t}return o.compareValues(f.length,g.length)}function x(e,t,n){if(t.startsWith(".")||(t="."+t),e.length>=t.length&&46===e.charCodeAt(e.length-t.length)){const s=e.slice(e.length-t.length);if(n(s,t))return s}}function w(e,t,n){try{const s=e.statSync(t);switch(n){case 0:return s.isFile();case 1:return s.isDirectory();default:return!1}}catch(e){return!1}}t.forEachAncestorDirectory=function(e,t){for(;;){const n=t(e);if(void 0!==n)return n;const s=l(e);if(s===e)return;e=s}},t.getDirectoryPath=l,t.getRootLength=p,t.getPathComponents=u,t.reducePathComponents=d,t.combinePathComponents=h,t.getRelativePath=function(e,t){if(!e.startsWith(_(t)))return;const n=u(e);let r=".";for(let e=u(t).length;e<n.length;e++)r+=s.sep+n[e];return r},t.makeDirectories=function(e,t,n){if(!t.startsWith(n))return;const s=u(t);let r=n;for(let t=u(n).length;t<s.length;t++)r=g(r,s[t]),e.existsSync(r)||e.mkdirSync(r)},t.getFileSize=function(e,t){try{const n=e.statSync(t);if(n.isFile())return n.size}catch(e){}return 0},t.fileExists=function(e,t){return w(e,t,0)},t.directoryExists=function(e,t){return w(e,t,1)},t.normalizeSlashes=f,t.resolvePaths=function(e,...t){return b(i.some(t)?g(e,...t):f(e))},t.combinePaths=g,t.comparePaths=function(e,t,n,s){return e=b(e),t=b(t),"string"==typeof n?(e=g(n,e),t=g(n,t)):"boolean"==typeof n&&(s=n),S(e,t,c.getStringComparer(s))},t.containsPath=function(e,t,n,s){if("string"==typeof n?(e=g(n,e),t=g(n,t)):"boolean"==typeof n&&(s=n),void 0===e||void 0===t)return!1;if(e===t)return!0;const r=u(e),i=u(t);if(i.length<r.length)return!1;const o=s?c.equateStringsCaseInsensitive:c.equateStringsCaseSensitive;for(let e=0;e<r.length;e++){if(!(0===e?c.equateStringsCaseInsensitive:o)(r[e],i[e]))return!1}return!0},t.changeAnyExtension=function(e,t,n,s){const r=void 0!==n&&void 0!==s?y(e,n,s):y(e);return r?e.slice(0,e.length-r.length)+(t.startsWith(".")?t:"."+t):e},t.getAnyExtensionFromPath=y,t.getBaseFileName=m,t.getRelativePathFromDirectory=function(e,t,n){a.assert(p(e)>0==p(t)>0,"Paths must either both be absolute or both be relative");const s="function"==typeof n?n:o.identity;return h(function(e,t,n,s){const r=u(e),i=u(t);let o;for(o=0;o<r.length&&o<i.length;o++){const e=s(r[o]),t=s(i[o]);if(!(0===o?c.equateStringsCaseInsensitive:n)(e,t))break}if(0===o)return i;const a=i.slice(o),l=[];for(;o<r.length;o++)l.push("..");return["",...l,...a]}(e,t,"boolean"==typeof n&&n?c.equateStringsCaseInsensitive:c.equateStringsCaseSensitive,s))},t.comparePathsCaseSensitive=function(e,t){return S(e,t,c.compareStringsCaseSensitive)},t.comparePathsCaseInsensitive=function(e,t){return S(e,t,c.compareStringsCaseInsensitive)},t.ensureTrailingDirectorySeparator=_,t.hasTrailingDirectorySeparator=T,t.stripTrailingDirectorySeparator=v,t.getFileExtension=function(e){return s.extname(e)},t.getFileName=function(e){return s.basename(e)},t.stripFileExtension=function(e){const t=s.extname(e);return e.substr(0,e.length-t.length)},t.normalizePath=b,t.isDirectory=function(e,t){let n;try{n=e.statSync(t)}catch(e){return!1}return n.isDirectory()},t.isFile=function(e,t){let n;try{n=e.statSync(t)}catch(e){return!1}return n.isFile()},t.getFileSystemEntries=function(e,t){try{const n=e.readdirSync(t||".").sort(),s=[],r=[];for(const i of n){if("."===i||".."===i)continue;const n=g(t,i);let o;try{o=e.statSync(n)}catch(e){continue}o.isFile()?s.push(i):o.isDirectory()&&r.push(i)}return{files:s,directories:r}}catch(e){return{files:[],directories:[]}}},t.getWildcardRegexPattern=E,t.getWildcardRoot=C,t.getFileSpec=function(e,t){let n=E(e,t);n=`^(${n})($|${k()})`;const s=new RegExp(n);return{wildcardRoot:C(e,t),regExp:s}},t.getRegexEscapedSeparator=k,t.isRootedDiskPath=function(e){return p(e)>0},t.isDiskPathRoot=function(e){const t=p(e);return t>0&&t===e.length},t.convertUriToPath=function(e){let t=b(r.URI.parse(e).path);return t.match(/^\\[a-zA-Z]:\\/)&&(t=t.substr(1)),t},t.convertPathToUri=function(e){return r.URI.file(e).toString()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(37);function r(e){return e.flowNode}t.cleanNodeAnalysisInfo=function(e){const t=e;delete t.scope,delete t.declaration,delete t.flowNode,delete t.afterFlowNode,delete t.fileInfo},t.getImportInfo=function(e){return e.importInfo},t.setImportInfo=function(e,t){e.importInfo=t},t.getScope=function(e){return e.scope},t.setScope=function(e,t){e.scope=t},t.getDeclaration=function(e){return e.declaration},t.setDeclaration=function(e,t){e.declaration=t},t.getFlowNode=r,t.setFlowNode=function(e,t){e.flowNode=t},t.getAfterFlowNode=function(e){return e.afterFlowNode},t.setAfterFlowNode=function(e,t){e.afterFlowNode=t},t.getFileInfo=function(e){return e.fileInfo},t.setFileInfo=function(e,t){e.fileInfo=t},t.getCodeFlowExpressions=function(e){return e.codeFlowExpressions},t.setCodeFlowExpressions=function(e,t){e.codeFlowExpressions=t},t.isCodeUnreachable=function(e){let t=e;for(;t;){const e=r(t);if(e)return!!(e.flags&s.FlowFlags.Unreachable);t=t.parent}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1),r=n(4),i=n(0),o=n(22),a=n(54),c=n(12);function l(e,t){if(t<e.start||t>i.TextRange.getEnd(e))return;const n=(new c.ParseTreeWalker).visitNode(e);for(const e of n)if(e){const n=l(e,t);if(n)return n}return e}function p(e){const t={0:"+",1:"+=",2:"=",3:"&",4:"&=",5:"~",6:"|",7:"|=",8:"^",9:"^=",10:"/",11:"/=",12:"==",13:"//",14:"//=",15:">",16:">=",17:"<<",18:"<<=",19:"<",20:"<=",21:"@",22:"@=",23:"%",24:"%=",25:"*",26:"*=",27:"!=",28:"**",29:"**=",30:">>",31:">>=",32:"-",33:"-=",35:"and",36:"or",37:"not",38:"is",39:"is not",40:"in",41:"not in"};return t[e]?t[e]:"unknown"}function u(e){let t,n=e,r=!1;for(;n;){switch(42===n.nodeType&&t===n.name&&(r=!0),n.nodeType){case 29:if(n.parameters.some(e=>e===t)){if(r)return n}else if(t===n.suite)return n;break;case 10:if(t===n.suite)return n;break;case 33:case 37:case 31:return n}t=n,n=n.parent}s.fail("Did not find evaluation scope")}t.getNodeDepth=function(e){let t=0,n=e;for(;n;)t++,n=n.parent;return t},t.findNodeByPosition=function(e,t,n){const s=r.convertPositionToOffset(t,n);if(void 0!==s)return l(e,s)},t.findNodeByOffset=l,t.printExpression=function e(t,n=0){switch(t.nodeType){case 39:return t.value;case 36:return e(t.leftExpression,n)+"."+t.memberName.value;case 9:return e(t.leftExpression,n)+"("+t.arguments.map(t=>{let s="";return 1===t.argumentCategory?s="*":2===t.argumentCategory&&(s="**"),t.name&&(s+=t.name.value+"="),s+=e(t.valueExpression,n),s}).join(", ")+")";case 24:return e(t.baseExpression,n)+"["+t.items.items.map(t=>e(t,n)).join(", ")+"]";case 56:return p(t.operator)+" "+e(t.expression,n);case 7:return e(t.leftExpression,n)+" "+p(t.operator)+" "+e(t.rightExpression,n);case 41:{let e=t.value.toString();return t.isImaginary&&(e+="j"),e}case 49:return 1&n&&t.typeAnnotation?e(t.typeAnnotation,n):t.strings.map(t=>e(t,n)).join(" ");case 50:{let e="";return 8&t.token.flags&&(e+="r"),16&t.token.flags&&(e+="u"),32&t.token.flags&&(e+="b"),64&t.token.flags&&(e+="f"),4&t.token.flags?1&t.token.flags?e+=`'''${t.token.escapedValue}'''`:e+=`"""${t.token.escapedValue}"""`:1&t.token.flags?e+=`'${t.token.escapedValue}'`:e+=`"${t.token.escapedValue}"`,e}case 3:return e(t.leftExpression,n)+" = "+e(t.rightExpression,n);case 4:return e(t.name,n)+" := "+e(t.rightExpression,n);case 55:return e(t.valueExpression,n)+": "+e(t.typeAnnotation,n);case 5:return e(t.leftExpression,n)+" "+p(t.operator)+" "+e(t.rightExpression,n);case 6:return"await "+e(t.expression,n);case 52:return e(t.ifExpression,n)+" if "+e(t.testExpression,n)+" else "+e(t.elseExpression,n);case 32:return`[${t.entries.map(t=>e(t,n)).join(", ")}]`;case 57:return"*"+e(t.expression,n);case 53:{const s=t.expressions.map(t=>e(t,n));return 1===s.length?`(${s[0]}, )`:`(${s.join(", ")})`}case 61:return t.expression?"yield "+e(t.expression,n):"yield";case 62:return"yield from "+e(t.expression,n);case 18:return"...";case 33:{let s="<ListExpression>";if(o.isExpressionNode(t.expression))s=e(t.expression,n);else if(17===t.expression.nodeType){s=`${e(t.expression.keyExpression,n)}: ${e(t.expression.valueExpression,n)}`}return s+" "+t.comprehensions.map(t=>34===t.nodeType?`${t.isAsync?"async ":""}for `+e(t.targetExpression,n)+` in ${e(t.iterableExpression,n)}`:`if ${e(t.testExpression,n)}`).join(" ")}case 47:{let s="";return t.startValue&&(s+=e(t.startValue,n)),t.endValue&&(s+=": "+e(t.endValue,n)),t.stepValue&&(s+=": "+e(t.stepValue,n)),s}case 31:return"lambda "+t.parameters.map(t=>{let s="";return 1===t.category?s+="*":2===t.category&&(s+="**"),t.name&&(s+=t.name.value),t.defaultValue&&(s+=" = "+e(t.defaultValue,n)),s}).join(", ")+": "+e(t.expression,n);case 11:if(31===t.constType)return"True";if(14===t.constType)return"False";if(8===t.constType)return"__debug__";if(24===t.constType)return"None";break;case 15:return`{ ${t.entries.map(t=>17===t.nodeType?`${e(t.keyExpression,n)}: `+`${e(t.valueExpression,n)}`:e(t,n))} }`;case 16:return`**${e(t.expandExpression,n)}`;case 46:return t.entries.map(t=>e(t,n)).join(", ")}return"<Expression>"},t.printOperator=p,t.getEnclosingClass=function(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(37===n.nodeType)return;if(29===n.nodeType&&t)return;n=n.parent}},t.getEnclosingModule=function(e){let t=e.parent;for(;t;){if(37===t.nodeType)return t;t=t.parent}s.fail("Module node not found")},t.getEnclosingClassOrModule=function(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(37===n.nodeType)return n;if(29===n.nodeType&&t)return;n=n.parent}},t.getEnclosingFunction=function(e){let t=e.parent;for(;t;){if(29===t.nodeType)return t;if(10===t.nodeType)return;t=t.parent}},t.getEvaluationNodeForAssignmentExpression=function(e){let t=u(e);for(;void 0!==t;){switch(t.nodeType){case 29:case 31:case 37:return t;case 10:return}t=t.parent}},t.getEvaluationScopeNode=u,t.getExecutionScopeNode=function(e){let t=u(e);for(;10===t.nodeType||33===t.nodeType;)t=u(t.parent);return t},t.isNodeContainedWithin=function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parent}return!1},t.isSuiteEmpty=function(e){for(const t of e.statements){if(48!==t.nodeType)return!1;for(const e of t.statements)if(18===e.nodeType);else if(49!==e.nodeType)return!1}return!0},t.isMatchingExpression=function e(t,n){return 39===t.nodeType&&39===n.nodeType?t.value===n.value:36===t.nodeType&&36===n.nodeType&&(e(t.leftExpression,n.leftExpression)&&t.memberName.value===n.memberName.value)},t.isWithinDefaultParamInitializer=function(e){let t,n=e;for(;n;){if(42===n.nodeType&&t===n.defaultValue)return!0;if(31===n.nodeType||29===n.nodeType||10===n.nodeType||37===n.nodeType)return!1;t=n,n=n.parent}return!1},t.getDocString=function(e){if(0===e.length)return;if(48!==e[0].nodeType)return;const t=e[0];if(0===t.statements.length||49!==t.statements[0].nodeType)return;const n=t.statements[0];return 0==(64&n.strings[0].token.flags)?a.decodeDocString(n.strings[0].value):void 0},t.isAssignmentToDefaultsFollowingNamedTuple=function(e){if(9!==e.nodeType||!e.parent||3!==e.parent.nodeType||39!==e.parent.leftExpression.nodeType||!e.parent.parent||48!==e.parent.parent.nodeType)return!1;const t=e.parent.leftExpression.value,n=e.parent.parent;if(n.statements[0]!==e.parent||!n.parent||37!==n.parent.nodeType&&51!==n.parent.nodeType)return!1;const s=n.parent;let r=s.statements.findIndex(e=>e===n);if(r<0)return!1;for(r++;r<s.statements.length;){const e=s.statements[r];if(48!==e.nodeType)break;if(49!==e.statements[0].nodeType){if(3===e.statements[0].nodeType){const n=e.statements[0];if(36===n.leftExpression.nodeType&&"__defaults__"===n.leftExpression.memberName.value){const e=n.leftExpression.leftExpression;if(36===e.nodeType&&"__new__"===e.memberName.value&&39===e.leftExpression.nodeType&&e.leftExpression.value===t)return!0}}break}r++}return!1}},function(e,t,n){"use strict";function s(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const r=n(18),i=n(70);t.RequestType=i.RequestType,t.RequestType0=i.RequestType0,t.RequestType1=i.RequestType1,t.RequestType2=i.RequestType2,t.RequestType3=i.RequestType3,t.RequestType4=i.RequestType4,t.RequestType5=i.RequestType5,t.RequestType6=i.RequestType6,t.RequestType7=i.RequestType7,t.RequestType8=i.RequestType8,t.RequestType9=i.RequestType9,t.ResponseError=i.ResponseError,t.ErrorCodes=i.ErrorCodes,t.NotificationType=i.NotificationType,t.NotificationType0=i.NotificationType0,t.NotificationType1=i.NotificationType1,t.NotificationType2=i.NotificationType2,t.NotificationType3=i.NotificationType3,t.NotificationType4=i.NotificationType4,t.NotificationType5=i.NotificationType5,t.NotificationType6=i.NotificationType6,t.NotificationType7=i.NotificationType7,t.NotificationType8=i.NotificationType8,t.NotificationType9=i.NotificationType9;const o=n(32);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=n(33);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=n(24);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=n(71);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const p=n(72);var u,d,h,f,g,y,m,_,T,v,b,E;s(n(73)),s(n(75)),function(e){e.type=new i.NotificationType("$/cancelRequest")}(u||(u={})),function(e){e.type=new i.NotificationType("$/progress")}(d||(d={}));t.ProgressType=class{constructor(){}},t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(h=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!r.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(h=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(f=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new i.NotificationType("$/setTraceNotification")}(g=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new i.NotificationType("$/logTraceNotification")}(y=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(m=t.ConnectionErrors||(t.ConnectionErrors={}));class C extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,C.prototype)}}function k(e,t,n,s){let o=0,a=0,_=0;let T,v,k=void 0,S=Object.create(null),x=void 0,w=Object.create(null),I=new Map,R=new p.LinkedMap,F=Object.create(null),P=Object.create(null),A=h.Off,N=f.Text,D=E.New,O=new c.Emitter,M=new c.Emitter,L=new c.Emitter,U=new c.Emitter,$=new c.Emitter,q=s&&s.cancellationStrategy?s.cancellationStrategy:b.Message;function W(e){return"req-"+e.toString()}function V(e,t){var n;i.isRequestMessage(t)?e.set(W(t.id),t):i.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++_).toString():"res-"+n.toString(),t):e.set("not-"+(++a).toString(),t)}function B(e){}function j(){return D===E.Listening}function z(){return D===E.Closed}function H(){return D===E.Disposed}function G(){D!==E.New&&D!==E.Listening||(D=E.Closed,M.fire(void 0))}function K(){T||0===R.size||(T=setImmediate(()=>{T=void 0,function(){if(0===R.size)return;let e=R.shift();try{i.isRequestMessage(e)?function(e){if(H())return;function n(n,s,r){let o={jsonrpc:"2.0",id:e.id};n instanceof i.ResponseError?o.error=n.toJson():o.result=void 0===n?null:n,Q(o,s,r),t.write(o)}function s(n,s,r){let i={jsonrpc:"2.0",id:e.id,error:n.toJson()};Q(i,s,r),t.write(i)}!function(e){if(A===h.Off||!v)return;if(N===f.Text){let t=void 0;A===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),v.log(`Received request '${e.method} - (${e.id})'.`,t)}else X("receive-request",e)}(e);let o,a,c=S[e.method];c&&(o=c.type,a=c.handler);let l=Date.now();if(a||k){let c=String(e.id),p=q.receiver.createCancellationTokenSource(c);P[c]=p;try{let u;u=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(p.token):k(e.method,p.token):r.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,p.token):k(e.method,...e.params,p.token):a?a(e.params,p.token):k(e.method,e.params,p.token);let d=u;u?d.then?d.then(t=>{delete P[c],n(t,e.method,l)},t=>{delete P[c],t instanceof i.ResponseError?s(t,e.method,l):t&&r.string(t.message)?s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}):(delete P[c],n(u,e.method,l)):(delete P[c],function(n,s,r){void 0===n&&(n=null);let i={jsonrpc:"2.0",id:e.id,result:n};Q(i,s,r),t.write(i)}(u,e.method,l))}catch(t){delete P[c],t instanceof i.ResponseError?n(t,e.method,l):t&&r.string(t.message)?s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):s(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else s(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):i.isNotificationMessage(e)?function(e){if(H())return;let t,s=void 0;if(e.method===u.type.method)t=e=>{let t=e.id,n=P[String(t)];n&&n.cancel()};else{let n=w[e.method];n&&(t=n.handler,s=n.type)}if(t||x)try{!function(e){if(A===h.Off||!v||e.method===y.type.method)return;if(N===f.Text){let t=void 0;A===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),v.log(`Received notification '${e.method}'.`,t)}else X("receive-notification",e)}(e),void 0===e.params||void 0!==s&&0===s.numberOfParams?t?t():x(e.method):r.array(e.params)&&(void 0===s||s.numberOfParams>1)?t?t(...e.params):x(e.method,...e.params):t?t(e.params):x(e.method,e.params)}catch(t){t.message?n.error(`Notification handler '${e.method}' failed with message: ${t.message}`):n.error(`Notification handler '${e.method}' failed unexpectedly.`)}else L.fire(e)}(e):i.isResponseMessage(e)?function(e){if(H())return;if(null===e.id)e.error?n.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):n.error("Received response message without id. No further error information provided.");else{let t=String(e.id),s=F[t];if(function(e,t){if(A===h.Off||!v)return;if(N===f.Text){let n=void 0;if(A===h.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){let s=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";v.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${s}`,n)}else v.log(`Received response ${e.id} without active response promise.`,n)}else X("receive-response",e)}(e,s),s){delete F[t];try{if(e.error){let t=e.error;s.reject(new i.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");s.resolve(e.result)}}catch(e){e.message?n.error(`Response handler '${s.method}' failed with message: ${e.message}`):n.error(`Response handler '${s.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void n.error("Received empty message.");n.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(r.string(t.id)||r.number(t.id)){let e=String(t.id),n=F[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{K()}}()}))}e.onClose(G),e.onError((function(e){O.fire([e,void 0,void 0])})),t.onClose(G),t.onError((function(e){O.fire(e)}));let Y=e=>{var n;try{if(i.isNotificationMessage(e)&&e.method===u.type.method){let r=W(e.params.id),o=R.get(r);if(i.isRequestMessage(o)){const i=null===(n=s)||void 0===n?void 0:n.connectionStrategy;let a=i&&i.cancelUndispatched?i.cancelUndispatched(o,B):void 0;if(a&&(void 0!==a.error||void 0!==a.result))return R.delete(r),a.id=o.id,Q(a,e.method,Date.now()),void t.write(a)}}V(R,e)}finally{K()}};function Q(e,t,n){if(A!==h.Off&&v)if(N===f.Text){let s=void 0;A===h.Verbose&&(e.error&&e.error.data?s=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?s=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(s="No result returned.\n\n")),v.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,s)}else X("send-response",e)}function X(e,t){if(!v||A===h.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};v.log(n)}function J(){if(z())throw new C(m.Closed,"Connection is closed.");if(H())throw new C(m.Disposed,"Connection is disposed.")}function Z(e){return void 0===e?null:e}function ee(e,t){let n,s=e.numberOfParams;switch(s){case 0:n=null;break;case 1:n=Z(t[0]);break;default:n=[];for(let e=0;e<t.length&&e<s;e++)n.push(Z(t[e]));if(t.length<s)for(let e=t.length;e<s;e++)n.push(null)}return n}let te={sendNotification:(e,...n)=>{let s,i;if(J(),r.string(e))switch(s=e,n.length){case 0:i=null;break;case 1:i=n[0];break;default:i=n}else s=e.method,i=ee(e,n);let o={jsonrpc:"2.0",method:s,params:i};!function(e){if(A!==h.Off&&v)if(N===f.Text){let t=void 0;A===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),v.log(`Sending notification '${e.method}'.`,t)}else X("send-notification",e)}(o),t.write(o)},onNotification:(e,t)=>{J(),r.func(e)?x=e:t&&(r.string(e)?w[e]={type:void 0,handler:t}:w[e.method]={type:e,handler:t})},onProgress:(e,t,n)=>{if(I.has(t))throw new Error(`Progress handler for token ${t} already registered`);return I.set(t,n),{dispose:()=>{I.delete(t)}}},sendProgress:(e,t,n)=>{te.sendNotification(d.type,{token:t,value:n})},onUnhandledProgress:U.event,sendRequest:(e,...n)=>{let s,a;J(),function(){if(!j())throw new Error("Call listen() first.")}();let c=void 0;if(r.string(e))switch(s=e,n.length){case 0:a=null;break;case 1:l.CancellationToken.is(n[0])?(a=null,c=n[0]):a=Z(n[0]);break;default:const e=n.length-1;l.CancellationToken.is(n[e])?(c=n[e],a=2===n.length?Z(n[0]):n.slice(0,e).map(e=>Z(e))):a=n.map(e=>Z(e))}else{s=e.method,a=ee(e,n);let t=e.numberOfParams;c=l.CancellationToken.is(n[t])?n[t]:void 0}let p,u=o++;return c&&(p=c.onCancellationRequested(()=>{q.sender.sendCancellation(te,u)})),new Promise((e,n)=>{let r={jsonrpc:"2.0",id:u,method:s,params:a};let o={method:s,timerStart:Date.now(),resolve:t=>{var n;e(t),q.sender.cleanup(u),null===(n=p)||void 0===n||n.dispose()},reject:e=>{var t;n(e),q.sender.cleanup(u),null===(t=p)||void 0===t||t.dispose()}};!function(e){if(A!==h.Off&&v)if(N===f.Text){let t=void 0;A===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),v.log(`Sending request '${e.method} - (${e.id})'.`,t)}else X("send-request",e)}(r);try{t.write(r)}catch(e){o.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),o=null}o&&(F[String(u)]=o)})},onRequest:(e,t)=>{J(),r.func(e)?k=e:t&&(r.string(e)?S[e]={type:void 0,handler:t}:S[e.method]={type:e,handler:t})},trace:(e,t,n)=>{let s=!1,i=f.Text;void 0!==n&&(r.boolean(n)?s=n:(s=n.sendNotification||!1,i=n.traceFormat||f.Text)),A=e,N=i,v=A===h.Off?void 0:t,!s||z()||H()||te.sendNotification(g.type,{value:h.toString(e)})},onError:O.event,onClose:M.event,onUnhandledNotification:L.event,onDispose:$.event,dispose:()=>{if(H())return;D=E.Disposed,$.fire(void 0);let n=new Error("Connection got disposed.");Object.keys(F).forEach(e=>{F[e].reject(n)}),F=Object.create(null),P=Object.create(null),R=new p.LinkedMap,r.func(t.dispose)&&t.dispose(),r.func(e.dispose)&&e.dispose()},listen:()=>{J(),function(){if(j())throw new C(m.AlreadyListening,"Connection is already listening")}(),D=E.Listening,e.listen(Y)},inspect:()=>{console.log("inspect")}};return te.onNotification(y.type,e=>{A!==h.Off&&v&&v.log(e.message,A===h.Verbose?e.verbose:void 0)}),te.onNotification(d.type,e=>{const t=I.get(e.token);t?t(e.value):U.fire(e)}),te}t.ConnectionError=C,function(e){e.is=function(e){let t=e;return t&&r.func(t.cancelUndispatched)}}(_=t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new l.CancellationTokenSource}),e.is=function(e){let t=e;return t&&r.func(t.createCancellationTokenSource)}}(T=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){e.sendNotification(u.type,{id:t})},cleanup(e){}}),e.is=function(e){let t=e;return t&&r.func(t.sendCancellation)&&r.func(t.cleanup)}}(v=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:T.Message,sender:v.Message}),e.is=function(e){let t=e;return t&&T.is(t.receiver)&&v.is(t.sender)}}(b=t.CancellationStrategy||(t.CancellationStrategy={})),function(e){e.is=function(e){let t=e;return t&&(b.is(t.cancellationStrategy)||_.is(t.connectionStrategy))}}(t.ConnectionOptions||(t.ConnectionOptions={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(E||(E={})),t.createMessageConnection=function(e,n,s,r){s||(s=t.NullLogger);let i=void 0!==(c=e).listen&&void 0===c.read?e:new o.StreamMessageReader(e);var c;let l=function(e){return void 0!==e.write&&void 0===e.end}(n)?n:new a.StreamMessageWriter(n);return _.is(r)&&(r={connectionStrategy:r}),k(i,l,s,r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(13);t.Event=s.Event;const r=n(90),i=n(91),o=n(92),a=n(43),c=n(44);!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(13));const l=n(93);!function(e){e.uriToFilePath=l.uriToFilePath,e.resolveGlobalNodePath=l.resolveGlobalNodePath,e.resolveGlobalYarnPath=l.resolveGlobalYarnPath,e.resolve=l.resolve,e.resolveModulePath=l.resolveModulePath}(t.Files||(t.Files={}));let p=!1,u=void 0;function d(e){if(null!==e)return e}!function(){function e(e){try{let t=parseInt(e);isNaN(t)||(u=setInterval(()=>{try{process.kill(t,0)}catch(e){process.exit(p?0:1)}},3e3))}catch(e){}}for(let t=2;t<process.argv.length;t++){let n=process.argv[t];if("--clientProcessId"===n&&t+1<process.argv.length)return void e(process.argv[t+1]);{let t=n.split("=");"--clientProcessId"===t[0]&&e(t[1])}}}();t.TextDocuments=class{constructor(e){this._documents=Object.create(null),this._configuration=e,this._onDidChangeContent=new s.Emitter,this._onDidOpen=new s.Emitter,this._onDidClose=new s.Emitter,this._onDidSave=new s.Emitter,this._onWillSave=new s.Emitter}get onDidChangeContent(){return this._onDidChangeContent.event}get onDidOpen(){return this._onDidOpen.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._documents[e]}all(){return Object.keys(this._documents).map(e=>this._documents[e])}keys(){return Object.keys(this._documents)}listen(e){e.__textDocumentSync=s.TextDocumentSyncKind.Full,e.onDidOpenTextDocument(e=>{let t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._documents[t.uri]=n;let s=Object.freeze({document:n});this._onDidOpen.fire(s),this._onDidChangeContent.fire(s)}),e.onDidChangeTextDocument(e=>{let t=e.textDocument,n=e.contentChanges;if(0===n.length)return;let s=this._documents[t.uri];const{version:r}=t;if(null==r)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);s=this._configuration.update(s,n,r),this._documents[t.uri]=s,this._onDidChangeContent.fire(Object.freeze({document:s}))}),e.onDidCloseTextDocument(e=>{let t=this._documents[e.textDocument.uri];t&&(delete this._documents[e.textDocument.uri],this._onDidClose.fire(Object.freeze({document:t})))}),e.onWillSaveTextDocument(e=>{let t=this._documents[e.textDocument.uri];t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))}),e.onWillSaveTextDocumentWaitUntil((e,t)=>{let n=this._documents[e.textDocument.uri];return n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]}),e.onDidSaveTextDocument(e=>{let t=this._documents[e.textDocument.uri];t&&this._onDidSave.fire(Object.freeze({document:t}))})}};t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach(t=>{e.window.showErrorMessage(t)})}};class h{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(s.MessageType.Error,e)}warn(e){this.send(s.MessageType.Warning,e)}info(e){this.send(s.MessageType.Info,e)}log(e){this.send(s.MessageType.Log,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(s.LogMessageNotification.type,{type:e,message:t})}}const f=o.ProgressFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:s.MessageType.Error,message:e,actions:t};return this._connection.sendRequest(s.ShowMessageRequest.type,n).then(d)}showWarningMessage(e,...t){let n={type:s.MessageType.Warning,message:e,actions:t};return this._connection.sendRequest(s.ShowMessageRequest.type,n).then(d)}showInformationMessage(e,...t){let n={type:s.MessageType.Info,message:e,actions:t};return this._connection.sendRequest(s.ShowMessageRequest.type,n).then(d)}});!function(e){e.create=function(){return new g}}(t.BulkRegistration||(t.BulkRegistration={}));class g{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=a.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const s=c.generateUuid();this._registrations.push({id:s,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}!function(e){e.create=function(){return new y(void 0,[])}}(t.BulkUnregistration||(t.BulkUnregistration={}));class y{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach(e=>{this._unregistrations.set(e.method,e)})}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(s.UnregistrationRequest.type,t).then(void 0,e=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(e){const t=a.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let r={unregisterations:[n]};return this._connection.sendRequest(s.UnregistrationRequest.type,r).then(()=>{this._unregistrations.delete(t)},e=>{this._connection.console.info(`Unregistering request handler for ${n.id} failed.`)}),!0}}class m{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof g?this.registerMany(e):e instanceof y?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const r=a.string(t)?t:t.method,i=c.generateUuid();let o={registrations:[{id:i,method:r,registerOptions:n||{}}]};return e.isAttached||e.attach(this._connection),this._connection.sendRequest(s.RegistrationRequest.type,o).then(t=>(e.add({id:i,method:r}),e),e=>(this.connection.console.info(`Registering request handler for ${r} failed.`),Promise.reject(e)))}registerSingle2(e,t){const n=a.string(e)?e:e.method,r=c.generateUuid();let i={registrations:[{id:r,method:n,registerOptions:t||{}}]};return this._connection.sendRequest(s.RegistrationRequest.type,i).then(e=>s.Disposable.create(()=>{this.unregisterSingle(r,n)}),e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e)))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this._connection.sendRequest(s.UnregistrationRequest.type,n).then(void 0,t=>{this.connection.console.info(`Unregistering request handler for ${e} failed.`)})}registerMany(e){let t=e.asRegistrationParams();return this._connection.sendRequest(s.RegistrationRequest.type,t).then(()=>new y(this._connection,t.registrations.map(e=>({id:e.id,method:e.method}))),e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e)))}}const _=i.WorkspaceFoldersFeature(r.ConfigurationFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this._connection.sendRequest(s.ApplyWorkspaceEditRequest.type,t)}}));class T{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this._connection.sendNotification(s.TelemetryEventNotification.type,e)}}class v{constructor(){this._trace=s.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==s.Trace.Off&&this._connection.sendNotification(s.LogTraceNotification.type,{message:e,verbose:this._trace===s.Trace.Verbose?t:void 0})}}class b{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return o.attachWorkDone(this.connection,e)}attachPartialResultProgress(e,t){return o.attachPartialResult(this.connection,t)}}function E(e,t){return function(n){return t(e(n))}}function C(e,t){return function(n){return t(e(n))}}function k(e,t){return function(n){return t(e(n))}}function S(e,t){return function(n){return t(e(n))}}function x(e,t){return function(n){return t(e(n))}}function w(e,t){return function(n){return t(e(n))}}function I(e,t){return function(n){return t(e(n))}}t.LanguagesImpl=b,t.combineConsoleFeatures=E,t.combineTelemetryFeatures=C,t.combineTracerFeatures=k,t.combineClientFeatures=S,t.combineWindowFeatures=x,t.combineWorkspaceFeatures=w,t.combineLanguagesFeatures=I,t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,E),tracer:n(e.tracer,t.tracer,k),telemetry:n(e.telemetry,t.telemetry,C),client:n(e.client,t.client,S),window:n(e.window,t.window,x),workspace:n(e.workspace,t.workspace,w)}},t.createConnection=function(e,t,n,r){let i,c,l,d;return void 0!==e&&"features"===e.__brand&&(i=e,e=t,t=n,n=r),s.ConnectionStrategy.is(e)||s.ConnectionOptions.is(e)?d=e:(c=e,l=t,d=n),function(e,t,n,r){if(!e&&!t&&process.argv.length>2){let n=void 0,r=void 0,o=process.argv.slice(2);for(let a=0;a<o.length;a++){let c=o[a];if("--node-ipc"===c){e=new s.IPCMessageReader(process),t=new s.IPCMessageWriter(process);break}if("--stdio"===c){e=process.stdin,t=process.stdout;break}if("--socket"===c){n=parseInt(o[a+1]);break}if("--pipe"===c){r=o[a+1];break}var i=c.split("=");if("--socket"===i[0]){n=parseInt(i[1]);break}if("--pipe"===i[0]){r=i[1];break}}if(n){let r=s.createServerSocketTransport(n);e=r[0],t=r[1]}else if(r){let n=s.createServerPipeTransport(r);e=n[0],t=n[1]}}var c="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+c);if(!t)throw new Error("Connection output stream is not set. "+c);if(a.func(e.read)&&a.func(e.on)){let t=e;t.on("end",()=>{process.exit(p?0:1)}),t.on("close",()=>{process.exit(p?0:1)})}const l=r&&r.console?new(r.console(h)):new h,d=s.createProtocolConnection(e,t,l,n);l.rawAttach(d);const g=r&&r.tracer?new(r.tracer(v)):new v,y=r&&r.telemetry?new(r.telemetry(T)):new T,E=r&&r.client?new(r.client(m)):new m,C=r&&r.window?new(r.window(f)):new f,k=r&&r.workspace?new(r.workspace(_)):new _,S=r&&r.languages?new(r.languages(b)):new b,x=[l,g,y,E,C,k,S];function w(e){return e instanceof Promise?e:a.thenable(e)?new Promise((t,n)=>{e.then(e=>t(e),e=>n(e))}):Promise.resolve(e)}let I=void 0,R=void 0,F=void 0,P={listen:()=>d.listen(),sendRequest:(e,...t)=>d.sendRequest(a.string(e)?e:e.method,...t),onRequest:(e,t)=>d.onRequest(e,t),sendNotification:(e,t)=>{const n=a.string(e)?e:e.method;1===arguments.length?d.sendNotification(n):d.sendNotification(n,t)},onNotification:(e,t)=>d.onNotification(e,t),onProgress:d.onProgress,sendProgress:d.sendProgress,onInitialize:e=>R=e,onInitialized:e=>d.onNotification(s.InitializedNotification.type,e),onShutdown:e=>I=e,onExit:e=>F=e,get console(){return l},get telemetry(){return y},get tracer(){return g},get client(){return E},get window(){return C},get workspace(){return k},get languages(){return S},onDidChangeConfiguration:e=>d.onNotification(s.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>d.onNotification(s.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>d.onNotification(s.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>d.onNotification(s.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>d.onNotification(s.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>d.onNotification(s.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>d.onRequest(s.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>d.onNotification(s.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>d.sendNotification(s.PublishDiagnosticsNotification.type,e),onHover:e=>d.onRequest(s.HoverRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),void 0)),onCompletion:e=>d.onRequest(s.CompletionRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onCompletionResolve:e=>d.onRequest(s.CompletionResolveRequest.type,e),onSignatureHelp:e=>d.onRequest(s.SignatureHelpRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),void 0)),onDeclaration:e=>d.onRequest(s.DeclarationRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onDefinition:e=>d.onRequest(s.DefinitionRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onTypeDefinition:e=>d.onRequest(s.TypeDefinitionRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onImplementation:e=>d.onRequest(s.ImplementationRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onReferences:e=>d.onRequest(s.ReferencesRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onDocumentHighlight:e=>d.onRequest(s.DocumentHighlightRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onDocumentSymbol:e=>d.onRequest(s.DocumentSymbolRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onWorkspaceSymbol:e=>d.onRequest(s.WorkspaceSymbolRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onCodeAction:e=>d.onRequest(s.CodeActionRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onCodeLens:e=>d.onRequest(s.CodeLensRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onCodeLensResolve:e=>d.onRequest(s.CodeLensResolveRequest.type,(t,n)=>e(t,n)),onDocumentFormatting:e=>d.onRequest(s.DocumentFormattingRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),void 0)),onDocumentRangeFormatting:e=>d.onRequest(s.DocumentRangeFormattingRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),void 0)),onDocumentOnTypeFormatting:e=>d.onRequest(s.DocumentOnTypeFormattingRequest.type,(t,n)=>e(t,n)),onRenameRequest:e=>d.onRequest(s.RenameRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),void 0)),onPrepareRename:e=>d.onRequest(s.PrepareRenameRequest.type,(t,n)=>e(t,n)),onDocumentLinks:e=>d.onRequest(s.DocumentLinkRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onDocumentLinkResolve:e=>d.onRequest(s.DocumentLinkResolveRequest.type,(t,n)=>e(t,n)),onDocumentColor:e=>d.onRequest(s.DocumentColorRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onColorPresentation:e=>d.onRequest(s.ColorPresentationRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onFoldingRanges:e=>d.onRequest(s.FoldingRangeRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onSelectionRanges:e=>d.onRequest(s.SelectionRangeRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),o.attachPartialResult(d,t))),onExecuteCommand:e=>d.onRequest(s.ExecuteCommandRequest.type,(t,n)=>e(t,n,o.attachWorkDone(d,t),void 0)),dispose:()=>d.dispose()};for(let e of x)e.attach(P);return d.onRequest(s.InitializeRequest.type,e=>{const t=e.processId;a.number(t)&&void 0===u&&setInterval(()=>{try{process.kill(t,0)}catch(e){process.exit(p?0:1)}},3e3),a.string(e.trace)&&(g.trace=s.Trace.fromString(e.trace));for(let t of x)t.initialize(e.capabilities);if(R){return w(R(e,(new s.CancellationTokenSource).token,o.attachWorkDone(d,e),void 0)).then(e=>{if(e instanceof s.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=a.number(P.__textDocumentSync)?P.__textDocumentSync:s.TextDocumentSyncKind.None:a.number(n.textDocumentSync)||a.number(n.textDocumentSync.change)||(n.textDocumentSync.change=a.number(P.__textDocumentSync)?P.__textDocumentSync:s.TextDocumentSyncKind.None);for(let e of x)e.fillServerCapabilities(n);return t})}{let e={capabilities:{textDocumentSync:s.TextDocumentSyncKind.None}};for(let t of x)t.fillServerCapabilities(e.capabilities);return e}}),d.onRequest(s.ShutdownRequest.type,()=>(p=!0,I?I((new s.CancellationTokenSource).token):void 0)),d.onNotification(s.ExitNotification.type,()=>{try{F&&F()}finally{p?process.exit(0):process.exit(1)}}),d.onNotification(s.SetTraceNotification.type,e=>{g.trace=s.Trace.fromString(e.value)}),P}(c,l,d,i)};const R=n(95),F=n(96);!function(e){e.all={__brand:"features",languages:I(R.CallHierarchyFeature,F.SemanticTokensFeature)},e.SemanticTokensBuilder=F.SemanticTokensBuilder}(t.ProposedFeatures||(t.ProposedFeatures={}))},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1);t.ParseTreeWalker=class{walk(e){const t=this.visitNode(e);t.length>0&&this.walkMultiple(t)}walkMultiple(e){e.forEach(e=>{e&&this.walk(e)})}visitNode(e){switch(e.nodeType){case 1:if(this.visitArgument(e))return[e.name,e.valueExpression];break;case 2:if(this.visitAssert(e))return[e.testExpression,e.exceptionExpression];break;case 3:if(this.visitAssignment(e))return[e.leftExpression,e.rightExpression,e.typeAnnotationComment];break;case 4:if(this.visitAssignmentExpression(e))return[e.name,e.rightExpression];break;case 5:if(this.visitAugmentedAssignment(e))return[e.leftExpression,e.rightExpression];break;case 6:if(this.visitAwait(e))return[e.expression];break;case 7:if(this.visitBinaryOperation(e))return[e.leftExpression,e.rightExpression];break;case 8:if(this.visitBreak(e))return[];break;case 9:if(this.visitCall(e))return[e.leftExpression,...e.arguments];break;case 10:if(this.visitClass(e))return[...e.decorators,e.name,...e.arguments,e.suite];break;case 52:if(this.visitTernary(e))return[e.ifExpression,e.testExpression,e.elseExpression];break;case 11:if(this.visitConstant(e))return[];break;case 12:if(this.visitContinue(e))return[];break;case 13:if(this.visitDecorator(e))return[e.leftExpression,...e.arguments||[]];break;case 14:if(this.visitDel(e))return e.expressions;break;case 15:if(this.visitDictionary(e))return e.entries;break;case 17:if(this.visitDictionaryKeyEntry(e))return[e.keyExpression,e.valueExpression];break;case 16:if(this.visitDictionaryExpandEntry(e))return[e.expandExpression];break;case 0:if(this.visitError(e))return[e.child];break;case 19:if(this.visitIf(e))return[e.testExpression,e.ifSuite,e.elseSuite];break;case 20:if(this.visitImport(e))return e.list;break;case 21:if(this.visitImportAs(e))return[e.module,e.alias];break;case 22:if(this.visitImportFrom(e))return[e.module,...e.imports];break;case 23:if(this.visitImportFromAs(e))return[e.name,e.alias];break;case 24:if(this.visitIndex(e))return[e.baseExpression,e.items];break;case 25:if(this.visitIndexItems(e))return e.items;break;case 18:if(this.visitEllipsis(e))return[];break;case 26:if(this.visitExcept(e))return[e.typeExpression,e.name,e.exceptSuite];break;case 27:if(this.visitFor(e))return[e.targetExpression,e.iterableExpression,e.forSuite,e.elseSuite];break;case 28:if(this.visitFormatString(e))return e.expressions;break;case 29:if(this.visitFunction(e))return[...e.decorators,e.name,...e.parameters,e.returnTypeAnnotation,e.suite];break;case 30:if(this.visitGlobal(e))return e.nameList;break;case 31:if(this.visitLambda(e))return[...e.parameters,e.expression];break;case 32:if(this.visitList(e))return e.entries;break;case 33:if(this.visitListComprehension(e))return[e.expression,...e.comprehensions];break;case 34:if(this.visitListComprehensionFor(e))return[e.targetExpression,e.iterableExpression];break;case 35:if(this.visitListComprehensionIf(e))return[e.testExpression];break;case 36:if(this.visitMemberAccess(e))return[e.leftExpression,e.memberName];break;case 37:if(this.visitModule(e))return[...e.statements];break;case 38:if(this.visitModuleName(e))return e.nameParts;break;case 39:if(this.visitName(e))return[];break;case 40:if(this.visitNonlocal(e))return e.nameList;break;case 41:if(this.visitNumber(e))return[];break;case 42:if(this.visitParameter(e))return[e.name,e.typeAnnotation,e.defaultValue];break;case 43:if(this.visitPass(e))return[];break;case 44:if(this.visitRaise(e))return[e.typeExpression,e.valueExpression,e.tracebackExpression];break;case 45:if(this.visitReturn(e))return[e.returnExpression];break;case 46:if(this.visitSet(e))return e.entries;break;case 47:if(this.visitSlice(e))return[e.startValue,e.endValue,e.stepValue];break;case 48:if(this.visitStatementList(e))return e.statements;break;case 50:if(this.visitString(e))return[];break;case 49:if(this.visitStringList(e))return[e.typeAnnotation,...e.strings];break;case 51:if(this.visitSuite(e))return[...e.statements];break;case 53:if(this.visitTuple(e))return e.expressions;break;case 54:if(this.visitTry(e))return[e.trySuite,...e.exceptClauses,e.elseSuite,e.finallySuite];break;case 55:if(this.visitTypeAnnotation(e))return[e.valueExpression,e.typeAnnotation];break;case 56:if(this.visitUnaryOperation(e))return[e.expression];break;case 57:if(this.visitUnpack(e))return[e.expression];break;case 58:if(this.visitWhile(e))return[e.testExpression,e.whileSuite,e.elseSuite];break;case 59:if(this.visitWith(e))return[...e.withItems,e.suite];break;case 60:if(this.visitWithItem(e))return[e.expression,e.target];break;case 61:if(this.visitYield(e))return[e.expression];break;case 62:if(this.visitYieldFrom(e))return[e.expression];break;default:s.fail("Unexpected node type")}return[]}visitArgument(e){return!0}visitAssert(e){return!0}visitAssignment(e){return!0}visitAssignmentExpression(e){return!0}visitAugmentedAssignment(e){return!0}visitAwait(e){return!0}visitBinaryOperation(e){return!0}visitBreak(e){return!0}visitCall(e){return!0}visitClass(e){return!0}visitTernary(e){return!0}visitContinue(e){return!0}visitConstant(e){return!0}visitDecorator(e){return!0}visitDel(e){return!0}visitDictionary(e){return!0}visitDictionaryKeyEntry(e){return!0}visitDictionaryExpandEntry(e){return!0}visitError(e){return!0}visitEllipsis(e){return!0}visitIf(e){return!0}visitImport(e){return!0}visitImportAs(e){return!0}visitImportFrom(e){return!0}visitImportFromAs(e){return!0}visitIndex(e){return!0}visitIndexItems(e){return!0}visitExcept(e){return!0}visitFor(e){return!0}visitFormatString(e){return!0}visitFunction(e){return!0}visitGlobal(e){return!0}visitLambda(e){return!0}visitList(e){return!0}visitListComprehension(e){return!0}visitListComprehensionFor(e){return!0}visitListComprehensionIf(e){return!0}visitMemberAccess(e){return!0}visitModule(e){return!0}visitModuleName(e){return!0}visitName(e){return!0}visitNonlocal(e){return!0}visitNumber(e){return!0}visitParameter(e){return!0}visitPass(e){return!0}visitRaise(e){return!0}visitReturn(e){return!0}visitSet(e){return!0}visitSlice(e){return!0}visitStatementList(e){return!0}visitString(e){return!0}visitStringList(e){return!0}visitSuite(e){return!0}visitTuple(e){return!0}visitTry(e){return!0}visitTypeAnnotation(e){return!0}visitUnaryOperation(e){return!0}visitUnpack(e){return!0}visitWhile(e){return!0}visitWith(e){return!0}visitWithItem(e){return!0}visitYield(e){return!0}visitYieldFrom(e){return!0}}},function(e,t,n){"use strict";function s(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const r=n(9);t.ErrorCodes=r.ErrorCodes,t.ResponseError=r.ResponseError,t.CancellationToken=r.CancellationToken,t.CancellationTokenSource=r.CancellationTokenSource,t.CancellationStrategy=r.CancellationStrategy,t.CancellationReceiverStrategy=r.CancellationReceiverStrategy,t.CancellationSenderStrategy=r.CancellationSenderStrategy,t.Disposable=r.Disposable,t.Event=r.Event,t.Emitter=r.Emitter,t.Trace=r.Trace,t.TraceFormat=r.TraceFormat,t.SetTraceNotification=r.SetTraceNotification,t.LogTraceNotification=r.LogTraceNotification,t.RequestType=r.RequestType,t.RequestType0=r.RequestType0,t.NotificationType=r.NotificationType,t.NotificationType0=r.NotificationType0,t.MessageReader=r.MessageReader,t.MessageWriter=r.MessageWriter,t.ConnectionStrategy=r.ConnectionStrategy,t.ConnectionOptions=r.ConnectionOptions,t.StreamMessageReader=r.StreamMessageReader,t.StreamMessageWriter=r.StreamMessageWriter,t.IPCMessageReader=r.IPCMessageReader,t.IPCMessageWriter=r.IPCMessageWriter,t.createClientPipeTransport=r.createClientPipeTransport,t.createServerPipeTransport=r.createServerPipeTransport,t.generateRandomPipeName=r.generateRandomPipeName,t.createClientSocketTransport=r.createClientSocketTransport,t.createServerSocketTransport=r.createServerSocketTransport,t.ProgressType=r.ProgressType,s(n(76)),s(n(77));const i=n(88),o=n(89);!function(e){let t,n,s,r,a,c;!function(e){e.method=i.CallHierarchyPrepareRequest.method,e.type=i.CallHierarchyPrepareRequest.type}(t=e.CallHierarchyPrepareRequest||(e.CallHierarchyPrepareRequest={})),function(e){e.method=i.CallHierarchyIncomingCallsRequest.method,e.type=i.CallHierarchyIncomingCallsRequest.type}(n=e.CallHierarchyIncomingCallsRequest||(e.CallHierarchyIncomingCallsRequest={})),function(e){e.method=i.CallHierarchyOutgoingCallsRequest.method,e.type=i.CallHierarchyOutgoingCallsRequest.type}(s=e.CallHierarchyOutgoingCallsRequest||(e.CallHierarchyOutgoingCallsRequest={})),e.SemanticTokenTypes=o.SemanticTokenTypes,e.SemanticTokenModifiers=o.SemanticTokenModifiers,e.SemanticTokens=o.SemanticTokens,function(e){e.method=o.SemanticTokensRequest.method,e.type=o.SemanticTokensRequest.type}(r=e.SemanticTokensRequest||(e.SemanticTokensRequest={})),function(e){e.method=o.SemanticTokensEditsRequest.method,e.type=o.SemanticTokensEditsRequest.type}(a=e.SemanticTokensEditsRequest||(e.SemanticTokensEditsRequest={})),function(e){e.method=o.SemanticTokensRangeRequest.method,e.type=o.SemanticTokensRangeRequest.type}(c=e.SemanticTokensRangeRequest||(e.SemanticTokensRangeRequest={}))}(t.Proposed||(t.Proposed={})),t.createProtocolConnection=function(e,t,n,s){return r.createMessageConnection(e,t,n,s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=/^[A-Z0-9_]+$/,r=/^[_]+$/;function i(e){return e.length>2&&e.startsWith("__")&&!e.endsWith("__")}function o(e){return e.length>1&&e.startsWith("_")&&!e.startsWith("__")}t.isPrivateName=i,t.isProtectedName=o,t.isPrivateOrProtectedName=function(e){return i(e)||o(e)},t.isDunderName=function(e){return e.length>4&&e.startsWith("__")&&e.endsWith("__")},t.isConstantName=function(e){return!!e.match(s)&&!e.match(r)}},function(e,t){e.exports=require("util")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1);var r,i,o,a,c,l,p;function u(e){return 2===e.category||1===e.category||10===e.category&&void 0===e.subtypes.find(e=>!u(e))}function d(e,n,s=0){if(e.category!==n.category)return!1;if(s>t.maxTypeRecursionCount)return!0;switch(e.category){case 7:{const t=n;if(!i.isSameGenericClass(e,t,!0,s+1))return!1;const r=e.typeArguments||[],o=t.typeArguments||[],a=Math.max(r.length,o.length);for(let e=0;e<a;e++){if(!d(e<r.length?r[e]:l.create(),e<o.length?o[e]:l.create(),s+1))return!1}return!0}case 8:{const t=n;return e.literalValue===t.literalValue&&d(e.classType,t.classType,s+1)}case 5:{const t=n,r=e.details.parameters,i=t.details.parameters;if(r.length!==i.length)return!1;for(let n=0;n<r.length;n++){const o=r[n],c=i[n];if(o.category!==c.category)return!1;if(o.name!==c.name)return!1;if(!d(a.getEffectiveParameterType(e,n),a.getEffectiveParameterType(t,n),s+1))return!1}let o=e.details.declaredReturnType;e.specializedTypes&&e.specializedTypes.returnType&&(o=e.specializedTypes.returnType);let c=t.details.declaredReturnType;return t.specializedTypes&&t.specializedTypes.returnType&&(c=t.specializedTypes.returnType),!!(!o&&!c||o&&c&&d(o,c,s+1))&&e.details.declaration===t.details.declaration}case 6:{const t=n;if(e.overloads.length!==t.overloads.length)return!1;for(let n=0;n<e.overloads.length;n++)if(!d(e.overloads[n],t.overloads[n]))return!1;return!0}case 10:{const t=n,r=e.subtypes,i=t.subtypes;return r.length===i.length&&void 0===r.find(e=>!p.containsType(t,e,s+1))}case 11:{const t=n;if(e.name!==t.name)return!1;const r=e.boundType,i=t.boundType;if(r){if(!i||!d(r,i,s+1))return!1}else if(i)return!1;if(e.isContravariant!==t.isContravariant)return!1;if(e.isCovariant!==t.isCovariant)return!1;const o=e.constraints,a=t.constraints;if(o.length!==a.length)return!1;for(let e=0;e<o.length;e++)if(!d(o[e],a[e],s+1))return!1;return!0}case 9:{const t=n;return e.fields===t.fields||0===e.fields.size&&0===t.fields.size}}return!0}function h(e,t){if(10===e.category){const n=e.subtypes.filter(e=>!t(e));if(n.length<e.subtypes.length)return f(n)}return e}function f(e){if(0===(e=e.filter(e=>4!==e.category)).length)return c.create();if(1===e.length)return e[0];let t=[];for(const n of e)10===n.category?t=t.concat(n.subtypes):t.push(n);t=t.sort((e,t)=>8===e.category&&void 0!==e.literalValue?1:8===t.category&&void 0!==t.literalValue?-1:0);const n=[t[0]];if(t.forEach((e,t)=>{t>0&&function(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(d(s,t))return;if(8===s.category&&8===t.category){if(g(s,t)&&void 0===s.literalValue)return;if(i.isBuiltIn(s.classType,"bool")&&void 0!==t.literalValue&&!t.literalValue===s.literalValue)return void(e[n]=o.create(s.classType))}}e.push(t)}(n,e)}),1===n.length)return n[0];const s=p.create();return p.addTypes(s,n),s}function g(e,t){return!!d(e,t)||8===t.category&&void 0!==t.literalValue&&d(e,t=o.create(t.classType))}t.maxTypeRecursionCount=16,function(e){const t={category:0};e.create=function(){return t}}(t.UnboundType||(t.UnboundType={})),function(e){const t={category:1};e.create=function(){return t}}(r=t.UnknownType||(t.UnknownType={})),function(e){e.create=function(e){return{category:9,fields:e||new Map,loaderFields:new Map}},e.getField=function(e,t){let n=e.fields.get(t);return!n&&e.loaderFields&&(n=e.loaderFields.get(t)),n}}(t.ModuleType||(t.ModuleType={})),function(e){function n(e,t,n,s){return{category:7,details:{name:e,flags:t,typeSourceId:n,baseClasses:[],mro:[],fields:new Map,typeParameters:[],docString:s},skipAbstractClassTest:!1}}function s(e,t){return!!(1&e.details.flags)&&(void 0===t||e.details.name===t)}function i(e,n,s=!0,i=0){if(i>t.maxTypeRecursionCount)return!0;if(e.details===n.details)return!0;const o=s&&e.details.aliasClass?e.details.aliasClass.details:e.details,a=s&&n.details.aliasClass?n.details.aliasClass.details:n.details;if(o===a)return!0;if(o.name!==a.name||o.flags!==a.flags||o.typeSourceId!==a.typeSourceId||o.baseClasses.length!==a.baseClasses.length||o.typeParameters.length!==a.typeParameters.length)return!1;for(let e=0;e<o.baseClasses.length;e++)if(!d(o.baseClasses[e],a.baseClasses[e],i+1))return!1;if((o.metaClass||a.metaClass)&&(!o.metaClass||!a.metaClass||!d(o.metaClass,a.metaClass)))return!1;for(let e=0;e<o.typeParameters.length;e++)if(!d(o.typeParameters[e],a.typeParameters[e],i+1))return!1;const c=o.dataClassEntries||[],l=a.dataClassEntries||[];if(c.length!==l.length)return!1;for(let e=0;e<c.length;e++)if(c[e].name!==l[e].name||c[e].hasDefault!==l[e].hasDefault||!d(c[e].type,l[e].type,i+1))return!1;if(o.fields!==a.fields){if(o.fields.size!==a.fields.size)return!1;let e=!0;if(o.fields.forEach((t,n)=>{const s=a.fields.get(n);if(s){d(t.getSynthesizedType()||r.create(),s.getSynthesizedType()||r.create(),i+1)||(e=!1)}else e=!1}),!e)return!1}return!0}e.create=n,e.cloneForSpecialization=function(e,t,s=!1){const r=n(e.details.name,e.details.flags,e.details.typeSourceId);return r.details=e.details,r.typeArguments=t,s&&(r.skipAbstractClassTest=!0),r},e.isGeneric=function(e){return e.details.typeParameters.length>0&&void 0===e.typeArguments},e.isSpecialBuiltIn=function(e,t){return!!(2&e.details.flags)&&(void 0===t||e.details.name===t)},e.isBuiltIn=s,e.hasAbstractMethods=function(e){return!!(256&e.details.flags)&&!e.skipAbstractClassTest},e.supportsAbstractMethods=function(e){return!!(128&e.details.flags)},e.isDataClass=function(e){return!!(4&e.details.flags)},e.isSkipSynthesizedInit=function(e){return!!(8&e.details.flags)},e.isTypedDictClass=function(e){return!!(16&e.details.flags)},e.isCanOmitDictValues=function(e){return!!(32&e.details.flags)},e.isEnumClass=function(e){return!!(64&e.details.flags)},e.isPropertyClass=function(e){return!!(512&e.details.flags)},e.isFinal=function(e){return!!(1024&e.details.flags)},e.isProtocolClass=function(e){return!!(2048&e.details.flags)},e.isPseudoGenericClass=function(e){return!!(4096&e.details.flags)},e.getDataClassEntries=function(e){return e.details.dataClassEntries||[]},e.getTypeParameters=function(e){return e.details.aliasClass?e.details.aliasClass.details.typeParameters:e.details.typeParameters},e.isSameGenericClass=i,e.isDerivedFrom=function e(t,n,o){if(i(t,n))return o&&o.push(t),!0;if(s(t)&&s(n,"object"))return o&&o.push(n),!0;const a=t.details.aliasClass||t;for(const s of a.details.baseClasses)if(7===s.category){if(e(s,n,o))return o&&o.push(t),!0}else if(u(s))return o&&o.push(r.create()),!0;return!1}}(i=t.ClassType||(t.ClassType={})),function(e){function t(e){return{category:8,classType:e}}e.create=t,e.cloneWithLiteral=function(e,n){const s=t(e.classType);return s.literalValue=n,s}}(o=t.ObjectType||(t.ObjectType={})),function(e){function t(e,t){return{category:5,details:{flags:e,parameters:[],docString:t}}}e.create=t,e.clone=function(e,n=!1){const s=t(e.details.flags,e.details.docString),r=n?1:0;return s.details={flags:e.details.flags,parameters:e.details.parameters.slice(r),declaredReturnType:e.details.declaredReturnType,declaration:e.details.declaration,builtInName:e.details.builtInName,docString:e.details.docString},n&&(s.details.flags&=-4,s.details.flags|=4,s.ignoreFirstParamOfDeclaration=!0),e.specializedTypes&&(s.specializedTypes={parameterTypes:e.specializedTypes.parameterTypes.slice(r),returnType:e.specializedTypes.returnType}),s.inferredReturnType=e.inferredReturnType,s},e.cloneForSpecialization=function(e,n){const r=t(e.details.flags,e.details.docString);return r.details=e.details,s.assert(n.parameterTypes.length===e.details.parameters.length),r.specializedTypes=n,r},e.isInstanceMethod=function(e){return 0==(7&e.details.flags)},e.isConstructorMethod=function(e){return 0!=(1&e.details.flags)},e.isStaticMethod=function(e){return 0!=(4&e.details.flags)},e.isClassMethod=function(e){return 0!=(2&e.details.flags)},e.isAbstractMethod=function(e){return 0!=(8&e.details.flags)},e.isGenerator=function(e){return 0!=(16&e.details.flags)},e.isSynthesizedMethod=function(e){return 0!=(64&e.details.flags)},e.isSkipConstructorCheck=function(e){return 0!=(128&e.details.flags)},e.isOverloaded=function(e){return 0!=(256&e.details.flags)},e.isDefaultParameterCheckDisabled=function(e){return 0!=(32&e.details.flags)},e.isAsync=function(e){return 0!=(512&e.details.flags)},e.isWrapReturnTypeInAwait=function(e){return 0!=(1024&e.details.flags)},e.isStubDefinition=function(e){return 0!=(2048&e.details.flags)},e.isFinal=function(e){return 0!=(4096&e.details.flags)},e.hasUnannotatedParams=function(e){return 0!=(8192&e.details.flags)},e.getEffectiveParameterType=function(e,t){return s.assert(t<e.details.parameters.length),e.specializedTypes?e.specializedTypes.parameterTypes[t]:e.details.parameters[t].type},e.addParameter=function(e,t){e.details.parameters.push(t)},e.getSpecializedReturnType=function(e){return e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType}}(a=t.FunctionType||(t.FunctionType={})),function(e){e.create=function(){return{category:6,overloads:[]}},e.addOverload=function(e,t){e.overloads.push(t)}}(t.OverloadedFunctionType||(t.OverloadedFunctionType={})),function(e){const t={category:3};e.create=function(){return t}}(t.NoneType||(t.NoneType={})),function(e){const t={category:4};e.create=function(){return t}}(c=t.NeverType||(t.NeverType={})),function(e){const t={category:2,isEllipsis:!1},n={category:2,isEllipsis:!0};e.create=function(e=!1){return e?n:t}}(l=t.AnyType||(t.AnyType={})),function(e){e.create=function(){return{category:10,subtypes:[]}},e.addTypes=function(e,t){for(const n of t)s.assert(10!==n.category),s.assert(4!==n.category),e.subtypes.push(n)},e.containsType=function(e,t,n=0){return void 0!==e.subtypes.find(e=>d(e,t,n+1))}}(p=t.UnionType||(t.UnionType={})),function(e){e.create=function(e,t=!1){return{category:11,name:e,constraints:[],isCovariant:!1,isContravariant:!1,isSynthesized:t}},e.addConstraint=function(e,t){e.constraints.push(t)}}(t.TypeVarType||(t.TypeVarType={})),t.isNoneOrNever=function(e){return 3===e.category||4===e.category},t.isAnyOrUnknown=u,t.isUnbound=function(e){return 0===e.category},t.isPossiblyUnbound=function e(t){return 0===t.category||10===t.category&&void 0!==t.subtypes.find(t=>e(t))},t.isTypeSame=d,t.removeAnyFromUnion=function(e){return h(e,e=>u(e))},t.removeUnknownFromUnion=function(e){return h(e,e=>1===e.category)},t.removeUnboundFromUnion=function(e){return h(e,e=>0===e.category)},t.removeNoneFromUnion=function(e){return h(e,e=>3===e.category)},t.removeFromUnion=h,t.combineTypes=f,t.isSameWithoutLiteralValue=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(30),r=n(23),i=n(16),o=n(55);function a(e,t){if(10===e.category){const n=[];return e.subtypes.forEach(e=>{const s=t(e);s&&n.push(s)}),i.combineTypes(n)}return t(e)||i.NeverType.create()}function c(e){return 8===e.category?(void 0!==e.literalValue&&(e=i.ObjectType.create(e.classType)),e):10===e.category?a(e,e=>c(e)):e}function l(e){if(3===e.category)return!0;if(8===e.category){if(f(e,"__len__"))return!0;if(f(e,"__bool__"))return!0;if(i.ClassType.isBuiltIn(e.classType,"bool")&&!1===e.literalValue)return!0}return!1}function p(e){if(i.isNoneOrNever(e))return!1;if(8===e.category){if(i.ClassType.isBuiltIn(e.classType,"Tuple")&&e.classType.typeArguments&&0===e.classType.typeArguments.length)return!1;if(i.ClassType.isBuiltIn(e.classType,"bool")&&!1===e.literalValue)return!1}return!0}function u(e){return!(2!==e.category||!e.isEllipsis)||7===e.category&&i.ClassType.isBuiltIn(e,"ellipsis")}function d(e,t){if(i.ClassType.isGeneric(t))return e;return h(e,m(t),!1)}function h(e,t,n=!1,s=0){if(s>100)return i.AnyType.create();if(!C(e))return e;if(t&&!n&&0===t.size())return e;if(i.isAnyOrUnknown(e))return e;if(i.isNoneOrNever(e))return e;if(11===e.category){if(t){const n=t.get(e.name);if(n)return n}return!t||n?v(e,s+1):e}if(10===e.category){const r=[];return e.subtypes.forEach(e=>{r.push(h(e,t,n,s+1))}),i.combineTypes(r)}if(8===e.category){const r=T(e.classType,t,n,s+1);if(i.ClassType.isBuiltIn(r,"Type")){const e=r.typeArguments;if(e&&e.length>=1){const r=e[0];if(8===r.category)return h(r.classType,t,n,s+1);if(11===r.category&&t){const e=t.get(r.name);if(e&&8===e.category)return e.classType}}}return r===e.classType?e:i.ObjectType.create(r)}return 7===e.category?T(e,t,n,s+1):5===e.category?b(e,t,n,s+1):6===e.category?function(e,t,n,s){const r=e.overloads.map(e=>b(e,t,n,s)),o=i.OverloadedFunctionType.create();return r.forEach(e=>{i.OverloadedFunctionType.addOverload(o,e)}),o}(e,t,n,s+1):e}function f(e,t,n=0){if(8===e.category)return g(e.classType,t,n)}function g(e,t,n=0){const r=0!=(16&n);if(7===e.category){let o=!1;for(const s of e.details.mro){if(7!==s.category){o=!0;continue}const a=d(s,e);if(7===a.category&&!(4&n&&i.ClassType.isBuiltIn(a,"object"))){if(0==(1&n)||a.details!==e.details){const e=a.details.fields;if(0==(8&n)){const n=e.get(t);if(n&&n.isInstanceMember()&&(!r||n.hasTypedDeclarations()))return{symbol:n,isInstanceMember:!0,classType:a}}const s=e.get(t);if(s&&s.isClassMember()&&(!r||s.hasTypedDeclarations())){let e=!1;if(i.ClassType.isDataClass(a)||i.ClassType.isTypedDictClass(a)){const t=s.getDeclarations();t.length>0&&1===t[0].type&&(e=!0)}return{symbol:s,isInstanceMember:e,classType:a}}}if(0!=(2&n))break}}if(o&&!r)return{symbol:s.Symbol.createWithType(0,i.UnknownType.create()),isInstanceMember:!1,classType:i.UnknownType.create()}}else if(i.isAnyOrUnknown(e))return{symbol:s.Symbol.createWithType(0,i.UnknownType.create()),isInstanceMember:!1,classType:i.UnknownType.create()}}function y(e,t){for(const n of t)e.find(e=>e===n)||e.push(n)}function m(e,t=!0){const n=i.ClassType.getTypeParameters(e);let s=e.typeArguments;if(s||t||(s=n),i.ClassType.isBuiltIn(e,"Tuple")&&e.typeArguments&&e.typeArguments.length>1){u(e.typeArguments[e.typeArguments.length-1])||(s=[i.combineTypes(e.typeArguments)])}return _(n,s)}function _(e,t){const n=new o.TypeVarMap;return e.forEach((e,s)=>{const r=e.name;let o;o=t?s>=t.length?i.AnyType.create():t[s]:v(e),n.set(r,o,!1)}),n}function T(e,t,n,s){if(0===i.ClassType.getTypeParameters(e).length)return e;let r=[],o=!1;return e.typeArguments?r=e.typeArguments.map(e=>{const r=h(e,t,n,s+1);return r!==e&&(o=!0),r}):i.ClassType.getTypeParameters(e).forEach(e=>{let s;t&&t.get(e.name)?(s=t.get(e.name),o=!0):(s=n?v(e):e,s!==e&&(o=!0)),r.push(s)}),o?i.ClassType.cloneForSpecialization(e,r):e}function v(e,t=0){return e.boundType?h(e.boundType,void 0,!1,t+1):e.constraints.length>0?i.combineTypes(e.constraints):i.UnknownType.create()}function b(e,t,n,s){const r=e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType,o=r?h(r,t,n,s+1):void 0;let a=r!==o;const c={parameterTypes:[],returnType:o};for(let r=0;r<e.details.parameters.length;r++){const o=i.FunctionType.getEffectiveParameterType(e,r),l=h(o,t,n,s+1);c.parameterTypes.push(l),o!==l&&(a=!0)}return a?i.FunctionType.cloneForSpecialization(e,c):e}function E(e){if(8===e.category){const t=e.classType;if(i.ClassType.isBuiltIn(t)){const e=t.details.name;if("Generator"===e||"AsyncGenerator"===e)return t.typeArguments;if("Iterator"===e||"AsyncIterator"===e||"AsyncIterable"===e)return t.typeArguments}}}function C(e,t=0){switch(e.category){case 7:return e.typeArguments?!(t>i.maxTypeRecursionCount)&&void 0!==e.typeArguments.find(e=>C(e,t+1)):i.ClassType.getTypeParameters(e).length>0;case 8:return!(t>i.maxTypeRecursionCount)&&C(e.classType,t+1);case 5:{if(t>i.maxTypeRecursionCount)return!1;for(let n=0;n<e.details.parameters.length;n++)if(C(i.FunctionType.getEffectiveParameterType(e,n),t+1))return!0;const n=e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType;return!(!n||!C(n,t+1))}case 6:return void 0!==e.overloads.find(e=>C(e,t+1));case 10:return void 0!==e.subtypes.find(e=>C(e,t+1));case 11:return!0}return!1}function k(e){const t=e.literalValue;if(void 0===t)return"";let n;if("string"==typeof t){n=`${"bytes"===e.classType.details.name?"b":""}'${t.toString()}'`}else n="boolean"==typeof t?t?"True":"False":t.toString();return n}t.isOptionalType=function(e){return 10===e.category&&e.subtypes.some(e=>i.isNoneOrNever(e))},t.doForSubtypes=a,t.areTypesSame=function(e){if(e.length<2)return!0;for(let t=1;t<e.length;t++)if(!i.isTypeSame(e[0],e[t]))return!1;return!0},t.stripLiteralValue=c,t.stripLiteralTypeArgsValue=function e(t,n=0){if(n>i.maxTypeRecursionCount)return t;if(7===t.category&&t.typeArguments){const s=t.typeArguments.map(t=>e(c(t),n+1));return i.ClassType.cloneForSpecialization(t,s,t.skipAbstractClassTest)}if(8===t.category)return t.classType.typeArguments&&(t=i.ObjectType.create(e(t.classType,n+1))),t;if(10===t.category)return a(t,t=>e(t,n+1));if(5===t.category){if(t.specializedTypes){const s={parameterTypes:t.specializedTypes.parameterTypes.map(t=>e(c(t),n+1)),returnType:t.specializedTypes.returnType?e(c(t.specializedTypes.returnType),n+1):void 0};t=i.FunctionType.cloneForSpecialization(t,s)}return t}if(6===t.category){const s=i.OverloadedFunctionType.create();return s.overloads=t.overloads.map(t=>e(t,n+1)),s}return t},t.transformTypeObjectToClass=function(e){if(8!==e.category)return e;const t=e.classType;if(!i.ClassType.isBuiltIn(t,"Type"))return e;if(!t.typeArguments||t.typeArguments.length<1)return e;const n=t.typeArguments[0];return 8!==n.category?e:n.classType},t.canBeFalsy=l,t.canBeTruthy=p,t.getSpecializedTupleType=function(e){let t;if(7===e.category?t=e:8===e.category&&(t=e.classType),t&&i.ClassType.isBuiltIn(t,"Tuple"))return t},t.isEllipsisType=u,t.isNoReturnType=function(e){if(8===e.category){const t=e.classType;if(i.ClassType.isBuiltIn(t,"NoReturn"))return!0}return!1},t.isProperty=function(e){return 8===e.category&&i.ClassType.isPropertyClass(e.classType)},t.partiallySpecializeType=d,t.specializeType=h,t.lookUpObjectMember=f,t.lookUpClassMember=g,t.addDefaultFunctionParameters=function(e){i.FunctionType.addParameter(e,{category:1,name:"args",type:i.AnyType.create()}),i.FunctionType.addParameter(e,{category:2,name:"kwargs",type:i.AnyType.create()})},t.getMetaclass=function e(t,n=0){if(!(n>i.maxTypeRecursionCount)){if(t.details.metaClass)return 7===t.details.metaClass.category?t.details.metaClass:i.UnknownType.create();for(const s of t.details.baseClasses)if(7===s.category){const t=e(s,n+1);if(t)return t}}},t.addTypeVarsToListIfUnique=y,t.getTypeVarArgumentsRecursive=function e(t){const n=t=>{const n=[];return t.typeArguments&&t.typeArguments.forEach(t=>{y(n,e(t))}),n};if(11===t.category)return[t];if(7===t.category)return n(t);if(8===t.category)return n(t.classType);if(10===t.category){const n=[];for(const s of t.subtypes)y(n,e(s));return n}if(5===t.category){const n=[];return t.details.parameters.forEach(t=>{y(n,e(t.type))}),t.details.declaredReturnType&&y(n,e(t.details.declaredReturnType)),n}return[]},t.selfSpecializeClassType=function(e,t=!1){if(!i.ClassType.isGeneric(e)&&!t)return e;const n=i.ClassType.getTypeParameters(e);return i.ClassType.cloneForSpecialization(e,n,t)},t.stripFirstParameter=function(e){return e.details.parameters.length>0&&0===e.details.parameters[0].category?i.FunctionType.clone(e,!0):e},t.setTypeArgumentsRecursive=function e(t,n,s,r=0){if(!s.isLocked())switch(t.category){case 10:t.subtypes.forEach(t=>{e(t,n,s,r+1)});break;case 7:t.typeArguments&&t.typeArguments.forEach(t=>{e(t,n,s,r+1)});break;case 8:e(t.classType,n,s,r+1);break;case 5:t.specializedTypes?(t.specializedTypes.parameterTypes.forEach(t=>{e(t,n,s,r+1)}),t.specializedTypes.returnType&&e(t.specializedTypes.returnType,n,s,r+1)):(t.details.parameters.forEach(t=>{e(t.type,n,s,r+1)}),t.details.declaredReturnType&&e(t.details.declaredReturnType,n,s,r+1));break;case 6:t.overloads.forEach(t=>{e(t,n,s,r+1)});break;case 11:s.has(t.name)||s.set(t.name,n,s.isNarrowable(t.name))}},t.buildTypeVarMapFromSpecializedClass=m,t.buildTypeVarMap=_,t.derivesFromClassRecursive=function e(t,n){if(i.ClassType.isSameGenericClass(t,n))return!0;for(const s of t.details.baseClasses)if(7===s.category&&e(s,n))return!0;return!1},t.removeFalsinessFromType=function(e){return a(e,e=>{if(8===e.category){if(void 0!==e.literalValue)return e.literalValue?e:void 0;if(i.ClassType.isBuiltIn(e.classType,"bool"))return i.ObjectType.cloneWithLiteral(e,!0)}if(p(e))return e})},t.removeTruthinessFromType=function(e){return a(e,e=>{if(8===e.category){if(void 0!==e.literalValue)return e.literalValue?void 0:e;if(i.ClassType.isBuiltIn(e.classType,"bool"))return i.ObjectType.cloneWithLiteral(e,!1)}if(l(e))return e})},t.getDeclaredGeneratorYieldType=function(e,t){const n=i.FunctionType.getSpecializedReturnType(e);if(n){const e=E(n);return e&&e.length>=1&&7===t.category?i.ObjectType.create(i.ClassType.cloneForSpecialization(t,[e[0]])):n}},t.getDeclaredGeneratorSendType=function(e){const t=i.FunctionType.getSpecializedReturnType(e);if(t){const e=E(t);return e&&e.length>=2?e[1]:i.UnknownType.create()}},t.getDeclaredGeneratorReturnType=function(e){const t=i.FunctionType.getSpecializedReturnType(e);if(t){const e=E(t);return e&&e.length>=3?e[2]:i.UnknownType.create()}},t.convertClassToObject=function(e){return a(e,e=>7===e.category?i.ObjectType.create(e):e)},t.getMembersForClass=function(e,t,n){for(let s=e.details.mro.length-1;s>=0;s--){const o=e.details.mro[s];if(7===o.category){const e=i.ClassType.isTypedDictClass(o);o.details.fields.forEach((s,i)=>{(s.isClassMember()||n&&s.isInstanceMember())&&(e&&r.isTypedDictMemberAccessedThroughIndex(s)||t.get(i)||t.set(i,s))})}}},t.getMembersForModule=function(e,t){e.loaderFields&&e.loaderFields.forEach((e,n)=>{t.set(n,e)}),e.fields.forEach((e,n)=>{t.set(n,e)})},t.containsUnknown=function e(t,n=!1,s=0){if(s>i.maxTypeRecursionCount)return!1;if(1===t.category)return!0;if(10===t.category){for(const r of t.subtypes)if(e(r,n,s+1))return!0;return!1}if(8===t.category)return e(t.classType,!1,s+1);if(7===t.category){if(t.typeArguments&&!n&&!i.ClassType.isPseudoGenericClass(t))for(const r of t.typeArguments)if(e(r,n,s+1))return!0;return!1}if(6===t.category)return t.overloads.some(t=>e(t,!1,s+1));if(5===t.category){for(let n=0;n<t.details.parameters.length;n++)if(t.details.parameters[n].name){if(e(i.FunctionType.getEffectiveParameterType(t,n),!1,s+1))return!0}return!1}return!1},t.getConcreteTypeFromTypeVar=v,t.requiresSpecialization=C,t.computeMroLinearization=function(e){let t=!0;const n=[];e.details.baseClasses.forEach(e=>{if(7===e.category){const t=m(e,!1);n.push(e.details.mro.map(e=>h(e,t)))}else n.push([e])}),n.push(e.details.baseClasses.map(t=>h(t,m(e,!1))));const s=m(e,!1);e.details.mro.push(h(e,s));const r=(e,t)=>t.some(t=>t.findIndex(t=>7===t.category&&i.ClassType.isSameGenericClass(t,e,!1))>0),o=(e,t)=>{for(let n=0;n<t.length;n++)t[n]=t[n].filter(t=>7!==t.category||!i.ClassType.isSameGenericClass(t,e,!1))};for(;;){let s=!1,i=void 0;for(const t of n)if(t.length>0){if(void 0===i&&(i=t),7!==t[0].category){s=!0,e.details.mro.push(t[0]),t.shift();continue}if(!r(t[0],n)){s=!0,e.details.mro.push(t[0]),o(t[0],n);continue}}if(!i)break;s||(t=!1,7!==i[0].category?(e.details.mro.push(i[0]),i.shift()):(e.details.mro.push(i[0]),o(i[0],n)))}return t},t.printLiteralValue=k,t.printLiteralType=function(e){const t=k(e);return t?`Literal[${t}]`:""}},function(e,t,n){"use strict";function s(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every(e=>s(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(98),r=n(25);function i(e,t){return e===t?0:void 0===e?-1:void 0===t?1:r.compareComparableValues(e.toUpperCase(),t.toUpperCase())}function o(e,t){return r.compareComparableValues(e,t)}t.computeCompletionSimilarity=function(e,t){if(t.startsWith(e))return 1;const n=t.toLocaleLowerCase(),r=e.toLocaleLowerCase();if(n.startsWith(r))return.75;let i=n.length,o=Number.MAX_VALUE;for(;i>0;){const e=s.default(n.substr(0,i),r);e<o&&(o=e),i--}return o>=e.length?0:.5*((e.length-o)/e.length)},t.hashString=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t},t.compareStringsCaseInsensitive=i,t.compareStringsCaseSensitive=o,t.getStringComparer=function(e){return e?i:o},t.equateStringsCaseInsensitive=function(e,t){return 0===i(e,t)},t.equateStringsCaseSensitive=function(e,t){return 0===o(e,t)}},function(e,t,n){"use strict";var s;function r(e){return e>>8==3}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.V24=516]="V24",e[e.V25=517]="V25",e[e.V26=518]="V26",e[e.V27=519]="V27",e[e.V30=768]="V30",e[e.V31=769]="V31",e[e.V32=770]="V32",e[e.V33=771]="V33",e[e.V34=772]="V34",e[e.V35=773]="V35",e[e.V36=774]="V36",e[e.V37=775]="V37",e[e.V38=776]="V38"}(s=t.PythonVersion||(t.PythonVersion={})),t.latestStablePythonVersion=s.V38,t.latestPythonVersion=s.V38,t.versionToString=function(e){return`${e>>8&255}.${255&e}`},t.versionFromString=function(e){const t=e.split(".");if(2!==t.length)return;const n=parseInt(t[0],10),i=parseInt(t[1],10);if(isNaN(n)||isNaN(i))return;if(n>255||i>255)return;const o=256*n+i;return void 0!==s[o]&&r(o)?o:void 0},t.is3x=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Diagnostic=class{constructor(e,t,n){this.category=e,this.message=t,this.range=n,this._relatedInfo=[]}addAction(e){void 0===this._actions?this._actions=[e]:this._actions.push(e)}getActions(){return this._actions}setRule(e){this._rule=e}getRule(){return this._rule}addRelatedInfo(e,t,n){this._relatedInfo.push({filePath:t,message:e,range:n})}getRelatedInfo(){return this._relatedInfo}};class s{constructor(){this._messages=[],this._childAddenda=[]}addMessage(e){this._messages.push(e)}createAddendum(){const e=new s;return this.addAddendum(e),e}getString(e=5,t=5){let n=this._getLinesRecursive(e);n.length>t&&(n=n.slice(0,t),n.push("..."));const s=n.join("\n");return s.length>0?"\n"+s:""}getMessageCount(){return this._messages.length}addAddendum(e){this._childAddenda.push(e)}_getLinesRecursive(e){if(e<=0)return[];const t=[];for(const n of this._childAddenda)t.push(...n._getLinesRecursive(e-1));const n=this._messages.length>0?"  ":"";return this._messages.concat(t).map(e=>n+e)}}t.DiagnosticAddendum=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(0);let r=1;function i(e,t){t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),s.TextRange.getEnd(t)>s.TextRange.getEnd(e)&&(e.length=s.TextRange.getEnd(t)-e.start)}t.getNextNodeId=function(){return r++},t.extendRange=i,function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:37,id:r++,statements:[]}}}(t.ModuleNode||(t.ModuleNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:51,id:r++,statements:[]}}}(t.SuiteNode||(t.SuiteNode={})),function(e){e.create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:19,id:r++,testExpression:t,ifSuite:n,elseSuite:s};return t.parent=o,n.parent=o,i(o,t),i(o,n),s&&(i(o,s),s.parent=o),o}}(t.IfNode||(t.IfNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:58,id:r++,testExpression:t,whileSuite:n};return t.parent=s,n.parent=s,i(s,n),s}}(t.WhileNode||(t.WhileNode={})),function(e){e.create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:27,id:r++,targetExpression:t,iterableExpression:n,forSuite:s};return t.parent=o,n.parent=o,s.parent=o,i(o,s),o}}(t.ForNode||(t.ForNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:34,id:r++,targetExpression:t,iterableExpression:n};return t.parent=s,n.parent=s,i(s,t),i(s,n),s}}(t.ListComprehensionForNode||(t.ListComprehensionForNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:35,id:r++,testExpression:t};return t.parent=n,i(n,t),n}}(t.ListComprehensionIfNode||(t.ListComprehensionIfNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:54,id:r++,trySuite:t,exceptClauses:[]};return t.parent=n,i(n,t),n}}(t.TryNode||(t.TryNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:26,id:r++,exceptSuite:t};return t.parent=n,i(n,t),n}}(t.ExceptNode||(t.ExceptNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:29,id:r++,decorators:[],name:t,parameters:[],suite:n};return t.parent=s,n.parent=s,i(s,n),s}}(t.FunctionNode||(t.FunctionNode={})),function(e){e.create=function(e,t){return{start:e.start,length:e.length,nodeType:42,id:r++,category:t}}}(t.ParameterNode||(t.ParameterNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:10,id:r++,decorators:[],name:t,arguments:[],suite:n};return t.parent=s,n.parent=s,i(s,n),s},e.createDummyForDecorators=function(e){const t={start:0,length:0,nodeType:10,id:r++,decorators:e,name:{start:0,length:0,id:0,nodeType:39,token:{type:7,start:0,length:0,comments:[],value:""},value:""},arguments:[],suite:{start:0,length:0,id:0,nodeType:51,statements:[]}};return e.forEach(e=>{e.parent=t,i(t,e)}),t}}(t.ClassNode||(t.ClassNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:59,id:r++,withItems:[],suite:t};return t.parent=n,i(n,t),n}}(t.WithNode||(t.WithNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:60,id:r++,expression:e};return e.parent=t,t}}(t.WithItemNode||(t.WithItemNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:13,id:r++,leftExpression:t,arguments:void 0};return t.parent=n,i(n,t),n}}(t.DecoratorNode||(t.DecoratorNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:48,id:r++,statements:[]}}}(t.StatementListNode||(t.StatementListNode={})),t.isExpressionNode=function(e){switch(e.nodeType){case 0:case 56:case 7:case 4:case 55:case 6:case 52:case 57:case 53:case 9:case 33:case 24:case 47:case 61:case 62:case 36:case 31:case 39:case 11:case 18:case 41:case 50:case 28:case 49:case 15:case 16:case 32:case 46:return!0;default:return!1}},function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:0,id:r++,category:t,child:n};return n&&(n.parent=s,i(s,n)),s}}(t.ErrorNode||(t.ErrorNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:56,id:r++,operator:n,expression:t};return t.parent=s,i(s,t),s}}(t.UnaryOperationNode||(t.UnaryOperationNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:7,id:r++,leftExpression:e,operator:n,rightExpression:t};return e.parent=s,t.parent=s,i(s,t),s}}(t.BinaryOperationNode||(t.BinaryOperationNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:4,id:r++,name:e,rightExpression:t};return e.parent=n,t.parent=n,i(n,t),n}}(t.AssignmentExpressionNode||(t.AssignmentExpressionNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:3,id:r++,leftExpression:e,rightExpression:t};return e.parent=n,t.parent=n,i(n,t),n}}(t.AssignmentNode||(t.AssignmentNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:55,id:r++,valueExpression:e,typeAnnotation:t};return e.parent=n,t.parent=n,i(n,t),n}}(t.TypeAnnotationNode||(t.TypeAnnotationNode={})),function(e){e.create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:5,id:r++,leftExpression:e,operator:n,rightExpression:t,destExpression:s};return e.parent=o,t.parent=o,s.parent=o,i(o,t),o}}(t.AugmentedAssignmentNode||(t.AugmentedAssignmentNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:6,id:r++,expression:t};return t.parent=n,i(n,t),n}}(t.AwaitNode||(t.AwaitNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:52,id:r++,ifExpression:e,testExpression:t,elseExpression:n};return e.parent=s,t.parent=s,n.parent=s,i(s,n),s}}(t.TernaryNode||(t.TernaryNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:57,id:r++,expression:t};return t.parent=n,i(n,t),n}}(t.UnpackNode||(t.UnpackNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:53,id:r++,expressions:[]}}}(t.TupleNode||(t.TupleNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:9,id:r++,leftExpression:e,arguments:[]};return e.parent=t,t}}(t.CallNode||(t.CallNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:33,id:r++,expression:e,comprehensions:[]};return e.parent=t,t}}(t.ListComprehensionNode||(t.ListComprehensionNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:25,id:r++,items:n};return n.forEach(e=>{e.parent=s}),i(s,t),s}}(t.IndexItemsNode||(t.IndexItemsNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:24,id:r++,baseExpression:e,items:t};return e.parent=n,t.parent=n,i(n,t),n}}(t.IndexNode||(t.IndexNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:47,id:r++}}}(t.SliceNode||(t.SliceNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:61,id:r++,expression:t};return t&&(t.parent=n,i(n,t)),n}}(t.YieldNode||(t.YieldNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:62,id:r++,expression:t};return t.parent=n,i(n,t),n}}(t.YieldFromNode||(t.YieldFromNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:36,id:r++,leftExpression:e,memberName:t};return e.parent=n,t.parent=n,i(n,t),n}}(t.MemberAccessNode||(t.MemberAccessNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:31,id:r++,parameters:[],expression:t};return t.parent=n,i(n,t),n}}(t.LambdaNode||(t.LambdaNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:39,id:r++,token:e,value:e.value}}}(t.NameNode||(t.NameNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:11,id:r++,constType:e.keywordType}}}(t.ConstantNode||(t.ConstantNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:18,id:r++}}}(t.EllipsisNode||(t.EllipsisNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:41,id:r++,value:e.value,isInteger:e.isInteger,isImaginary:e.isImaginary}}}(t.NumberNode||(t.NumberNode={})),function(e){e.create=function(e,t,n){return{start:e.start,length:e.length,nodeType:50,id:r++,token:e,value:t,hasUnescapeErrors:n}}}(t.StringNode||(t.StringNode={})),function(e){e.create=function(e,t,n,s){const i={start:e.start,length:e.length,nodeType:28,id:r++,token:e,value:t,hasUnescapeErrors:n,expressions:s};return s.forEach(e=>{e.parent=i}),i}}(t.FormatStringNode||(t.FormatStringNode={})),function(e){e.create=function(e){const t={start:e[0].start,length:e[0].length,nodeType:49,id:r++,strings:e};return e.length>0&&(e.forEach(e=>{e.parent=t}),i(t,e[e.length-1])),t}}(t.StringListNode||(t.StringListNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:15,id:r++,entries:[]}}}(t.DictionaryNode||(t.DictionaryNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:17,id:r++,keyExpression:e,valueExpression:t};return e.parent=n,t.parent=n,i(n,t),n}}(t.DictionaryKeyEntryNode||(t.DictionaryKeyEntryNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:16,id:r++,expandExpression:e};return e.parent=t,t}}(t.DictionaryExpandEntryNode||(t.DictionaryExpandEntryNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:46,id:r++,entries:[]}}}(t.SetNode||(t.SetNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:32,id:r++,entries:[]}}}(t.ListNode||(t.ListNode={})),function(e){e.create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:1,id:r++,valueExpression:t,argumentCategory:n};return t.parent=s,i(s,t),s}}(t.ArgumentNode||(t.ArgumentNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:14,id:r++,expressions:[]}}}(t.DelNode||(t.DelNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:43,id:r++}}}(t.PassNode||(t.PassNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:20,id:r++,list:[]}}}(t.ImportNode||(t.ImportNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:38,id:r++,leadingDots:0,nameParts:[]}}}(t.ModuleNameNode||(t.ModuleNameNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:21,id:r++,module:e};return e.parent=t,t}}(t.ImportAsNode||(t.ImportAsNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:22,id:r++,module:t,imports:[],isWildcardImport:!1,usesParens:!1};return t.parent=n,i(n,t),n}}(t.ImportFromNode||(t.ImportFromNode={})),function(e){e.create=function(e){const t={start:e.start,length:e.length,nodeType:23,id:r++,name:e};return e.parent=t,t}}(t.ImportFromAsNode||(t.ImportFromAsNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:30,id:r++,nameList:[]}}}(t.GlobalNode||(t.GlobalNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:40,id:r++,nameList:[]}}}(t.NonlocalNode||(t.NonlocalNode={})),function(e){e.create=function(e,t){const n={start:e.start,length:e.length,nodeType:2,id:r++,testExpression:t};return t.parent=n,i(n,t),n}}(t.AssertNode||(t.AssertNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:8,id:r++}}}(t.BreakNode||(t.BreakNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:12,id:r++}}}(t.ContinueNode||(t.ContinueNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:45,id:r++}}}(t.ReturnNode||(t.ReturnNode={})),function(e){e.create=function(e){return{start:e.start,length:e.length,nodeType:44,id:r++}}}(t.RaiseNode||(t.RaiseNode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(29);t.getLastTypedDeclaredForSymbol=function(e){const t=e.getTypedDeclarations();if(t.length>0)return t[t.length-1]},t.isTypedDictMemberAccessedThroughIndex=function(e){const t=e.getTypedDeclarations();if(t.length>0){if(1===t[t.length-1].type)return!0}return!1},t.isFinalVariable=function(e){return e.getDeclarations().some(e=>s.isFinalVariableDeclaration(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class s{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var n=!1,s=0,r=this._callbacks.length;s<r;s++)if(this._callbacks[s]===e){if(this._contexts[s]===t)return this._callbacks.splice(s,1),void this._contexts.splice(s,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],n=this._callbacks.slice(0),s=this._contexts.slice(0),r=0,i=n.length;r<i;r++)try{t.push(n[r].apply(s[r],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{let i;return this._callbacks||(this._callbacks=new s),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}},Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=r,r._noop=function(){}},function(e,t,n){"use strict";function s(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e<t?-1:1}Object.defineProperty(t,"__esModule",{value:!0}),t.returnFalse=function(){return!1},t.returnTrue=function(){return!0},t.returnUndefined=function(){},t.identity=function(e){return e},t.toLowerCase=function(e){return e.toLowerCase()},t.equateValues=function(e,t){return e===t},t.compareComparableValues=s,t.compareValues=function(e,t){return s(e,t)},t.isArray=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},t.isString=function(e){return"string"==typeof e},t.isNumber=function(e){return"number"==typeof e};const r=Object.prototype.hasOwnProperty;t.hasProperty=function(e,t){return r.call(e,t)},t.toBoolean=function(e){return"TRUE"===(null==e?void 0:e.trim().toUpperCase())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NullConsole=class{constructor(){this.logCount=0,this.errorCount=0}log(e){this.logCount++}error(e){this.errorCount++}};t.StandardConsole=class{log(e){console.log(e)}error(e){console.error(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(){this._startTime=Date.now()}getDurationInMilliseconds(){return Date.now()-this._startTime}getDurationInSeconds(){return this.getDurationInMilliseconds()/1e3}}t.Duration=s;class r{constructor(){this.totalTime=0,this.isTiming=!1}timeOperation(e){if(this.isTiming)e();else{this.isTiming=!0;const t=new s;e(),this.totalTime+=t.getDurationInMilliseconds(),this.isTiming=!1}}subtractFromTime(e){if(this.isTiming){this.isTiming=!1;const t=new s;e(),this.totalTime-=t.getDurationInMilliseconds(),this.isTiming=!0}else e()}printTime(){const e=this.totalTime/1e3;return(Math.round(100*e)/100).toString()+"sec"}}t.TimingStat=r;class i{constructor(){this.totalDuration=new s,this.findFilesTime=new r,this.readFileTime=new r,this.tokenizeFileTime=new r,this.parseFileTime=new r,this.resolveImportsTime=new r,this.cycleDetectionTime=new r,this.bindTime=new r,this.typeCheckerTime=new r}printSummary(e){e.log(`Completed in ${this.totalDuration.getDurationInSeconds()}sec`)}printDetails(e){e.log(""),e.log("Timing stats"),e.log("Find Source Files:    "+this.findFilesTime.printTime()),e.log("Read Source Files:    "+this.readFileTime.printTime()),e.log("Tokenize:             "+this.tokenizeFileTime.printTime()),e.log("Parse:                "+this.parseFileTime.printTime()),e.log("Resolve Imports:      "+this.resolveImportsTime.printTime()),e.log("Bind:                 "+this.bindTime.printTime()),e.log("Check:                "+this.typeCheckerTime.printTime()),e.log("Detect Cycles:        "+this.cycleDetectionTime.printTime())}}t.TimingStats=i,t.timingStats=new i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(4),r=n(0),i=n(7),o=n(14);function a(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map(e=>e.value).join("."),t}t.getTopLevelImports=function(e){const t={orderedImports:[],mapByFilePath:new Map};let n=!1,s=!1;return e.statements.forEach(e=>{48===e.nodeType?e.statements.forEach(e=>{20===e.nodeType?(s=!0,function(e,t,n){e.list.forEach(s=>{const r=i.getImportInfo(s.module);let o;r&&r.isImportFound&&(o=r.resolvedPaths[r.resolvedPaths.length-1]);const c={node:e,subnode:s,importResult:r,resolvedPath:o,moduleName:a(s.module),followsNonImportStatement:n};t.orderedImports.push(c),o&&(t.mapByFilePath.has(o)||t.mapByFilePath.set(o,c))})}(e,t,n),n=!1):22===e.nodeType?(s=!0,function(e,t,n){const s=i.getImportInfo(e.module);let r;s&&s.isImportFound&&(r=s.resolvedPaths[s.resolvedPaths.length-1]);const o={node:e,importResult:s,resolvedPath:r,moduleName:a(e.module),followsNonImportStatement:n};if(t.orderedImports.push(o),r){const e=t.mapByFilePath.get(r);(!e||20===e.node.nodeType||e.moduleName.length>o.moduleName.length)&&t.mapByFilePath.set(r,o)}}(e,t,n),n=!1):n=s}):n=s}),t},t.getTextEditsForAutoImportSymbolAddition=function(e,t,n){const i=[];let o;if(t.node&&22===t.node.nodeType&&!t.node.imports.some(t=>t.name.value===e)){for(const n of t.node.imports){if(n.name.value>e)break;o=n}const a=o?r.TextRange.getEnd(o):t.node.imports.length>0?t.node.imports[0].start:t.node.start+t.node.length,c=s.convertOffsetToPosition(a,n.tokenizerOutput.lines);i.push({range:{start:c,end:c},replacementText:o?", "+e:e+", "})}return i},t.getTextEditsForAutoImportInsertion=function(e,t,n,i,a){const c=[];let l,p=`from ${n} import ${e}`;if(t.orderedImports.length>0){let e=!0,o=t.orderedImports[0],c=0;for(const s of t.orderedImports){const r=s.importResult?s.importResult.importType:c;if(i<r){!e&&c<i&&(p=a.tokenizerOutput.predominantEndOfLineSequence+p);break}if(i===r&&s.moduleName>n)break;if(s.followsNonImportStatement){i>c&&(p=a.tokenizerOutput.predominantEndOfLineSequence+p);break}s===t.orderedImports[t.orderedImports.length-1]&&i>r&&(p=a.tokenizerOutput.predominantEndOfLineSequence+p),e=!e&&i<c&&i===r,c=r,o=s}o?(e?p+=a.tokenizerOutput.predominantEndOfLineSequence:p=a.tokenizerOutput.predominantEndOfLineSequence+p,l=s.convertOffsetToPosition(e?o.node.start:r.TextRange.getEnd(o.node),a.tokenizerOutput.lines)):l={line:0,character:0}}else{l={line:0,character:0};let e=!1;for(const t of a.parseTree.statements){let n=!0;if(48===t.nodeType&&1===t.statements.length){const e=t.statements[0];(49===e.nodeType||3===e.nodeType&&39===e.leftExpression.nodeType&&o.isDunderName(e.leftExpression.value))&&(n=!1)}if(n){l=s.convertOffsetToPosition(t.start,a.tokenizerOutput.lines),e=!1;break}l=s.convertOffsetToPosition(t.start+t.length,a.tokenizerOutput.lines),e=!0}p+=a.tokenizerOutput.predominantEndOfLineSequence+a.tokenizerOutput.predominantEndOfLineSequence,e?p=a.tokenizerOutput.predominantEndOfLineSequence+p:p+=a.tokenizerOutput.predominantEndOfLineSequence}return c.push({range:{start:l,end:l},replacementText:p}),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasTypeForDeclaration=function(e){switch(e.type){case 0:case 4:case 5:case 3:return!0;case 2:return!!e.node.typeAnnotation;case 1:return!!e.typeAnnotationNode;case 6:return!1}},t.areDeclarationsSame=function(e,t){return e.type===t.type&&(e.path===t.path&&(e.range.start.line===t.range.start.line&&e.range.start.character===t.range.start.character))},t.isFinalVariableDeclaration=function(e){return 1===e.type&&!!e.isFinal}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(29);let r=1;t.indeterminateSymbolId=0;class i{constructor(e=4){this.id=r++,this._flags=e}static createWithType(e,t){const n=new i(e);return n._synthesizedType=t,n}isInitiallyUnbound(){return!!(1&this._flags)}setIsExternallyHidden(){this._flags|=2}isExternallyHidden(){return!!(2&this._flags)}setIsIgnoredForProtocolMatch(){this._flags|=32}isIgnoredForProtocolMatch(){return!!(32&this._flags)}setIsClassMember(){this._flags|=4}isClassMember(){return!!(4&this._flags)}setIsInstanceMember(){this._flags|=8}isInstanceMember(){return!!(8&this._flags)}setIsPrivateMember(){this._flags|=16}isPrivateMember(){return!!(16&this._flags)}addDeclaration(e){if(this._declarations){const t=this._declarations.findIndex(t=>s.areDeclarationsSame(t,e));if(t<0)this._declarations.push(e);else{const n=this._declarations[t];s.hasTypeForDeclaration(e)?(this._declarations[t]=e,1===n.type&&1===e.type&&!e.inferredTypeSource&&n.inferredTypeSource&&(e.inferredTypeSource=n.inferredTypeSource)):1===e.type&&1===n.type&&(e.isFinal&&(n.isFinal=!0),!n.inferredTypeSource&&e.inferredTypeSource&&(n.inferredTypeSource=e.inferredTypeSource))}}else this._declarations=[e]}hasDeclarations(){return!!this._declarations&&this._declarations.length>0}getDeclarations(){return this._declarations?this._declarations:[]}hasTypedDeclarations(){return!!this._synthesizedType||this.getDeclarations().some(e=>s.hasTypeForDeclaration(e))}getTypedDeclarations(){return this.getDeclarations().filter(e=>s.hasTypeForDeclaration(e))}getSynthesizedType(){return this._synthesizedType}}t.Symbol=i},function(e,t,n){"use strict";const s=n(2),r={DOT_LITERAL:"\\.",PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:"\\/",ONE_CHAR:"(?=.)",QMARK:"[^/]",END_ANCHOR:"(?:\\/|$)",DOTS_SLASH:"\\.{1,2}(?:\\/|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|\\/)\\.{1,2}(?:\\/|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:\\/|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:\\/|$))",QMARK_NO_DOT:"[^.\\/]",STAR:"[^/]*?",START_ANCHOR:"(?:^|\\/)"},i={...r,SLASH_LITERAL:"[\\\\/]",QMARK:"[^\\\\/]",STAR:"[^\\\\/]*?",DOTS_SLASH:"\\.{1,2}(?:[\\\\/]|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|[\\\\/])\\.{1,2}(?:[\\\\/]|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:[\\\\/]|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:[\\\\/]|$))",QMARK_NO_DOT:"[^.\\\\/]",START_ANCHOR:"(?:^|[\\\\/])",END_ANCHOR:"(?:[\\\\/]|$)"};e.exports={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:s.sep,extglobChars:e=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:e=>!0===e?i:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(24),r=n(18);let i=Buffer.from("\r","ascii")[0],o=Buffer.from("\n","ascii")[0];class a{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(8192)}append(e){var t=e;if("string"==typeof e){var n=e,s=Buffer.byteLength(n,this.encoding);(t=Buffer.allocUnsafe(s)).write(n,0,s,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var r=8192*(Math.ceil((this.index+t.length)/8192)+1);0===this.index?(this.buffer=Buffer.allocUnsafe(r),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],r)}this.index+=t.length}tryReadHeaders(){let e=void 0,t=0;for(;t+3<this.index&&(this.buffer[t]!==i||this.buffer[t+1]!==o||this.buffer[t+2]!==i||this.buffer[t+3]!==o);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach(t=>{let n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");let s=t.substr(0,n),r=t.substr(n+1).trim();e[s]=r});let n=t+4;return this.buffer=this.buffer.slice(n),this.index=this.index-n,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),n=e;return this.buffer.copy(this.buffer,0,n),this.index=this.index-n,t}get numberOfBytes(){return this.index}}!function(e){e.is=function(e){let t=e;return t&&r.func(t.listen)&&r.func(t.dispose)&&r.func(t.onError)&&r.func(t.onClose)&&r.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));class c{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter,this.partialMessageEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=c;class l extends c{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new a(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",e=>{this.onData(e)}),this.readable.on("error",e=>this.fireError(e)),this.readable.on("close",()=>this.fireClose())}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var n=JSON.parse(t);this.callback(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=l;t.IPCMessageReader=class extends c{constructor(e){super(),this.process=e;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose())}listen(e){this.process.on("message",e)}};t.SocketMessageReader=class extends l{constructor(e,t="utf-8"){super(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(24),r=n(18);!function(e){e.is=function(e){let t=e;return t&&r.func(t.dispose)&&r.func(t.onClose)&&r.func(t.onError)&&r.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));class i{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=i;t.StreamMessageWriter=class extends i{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",e=>this.fireError(e)),this.writable.on("close",()=>this.fireClose())}write(e){let t=JSON.stringify(e),n=["Content-Length: ",Buffer.byteLength(t,this.encoding).toString(),"\r\n","\r\n"];try{this.writable.write(n.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.IPCMessageWriter=class extends i{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose)}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.SocketMessageWriter=class extends i{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",e=>this.fireError(e)),this.socket.on("close",()=>this.fireClose())}dispose(){super.dispose(),this.socket.destroy()}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),n=["Content-Length: ",Buffer.byteLength(t,this.encoding).toString(),"\r\n","\r\n"];try{this.sending=!0,this.socket.write(n.join(""),"ascii",n=>{n&&this.handleError(n,e);try{this.socket.write(t,this.encoding,t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})}catch(n){this.handleError(n,e)}})}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(2),r=n(47),i=n(6),o=n(20);class a{constructor(e,t,n){this.extraPaths=[],this.root=e,this.pythonVersion=t||o.latestStablePythonVersion,this.pythonPlatform=n}}function c(){return{strictListInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportTypeshedErrors:"error",reportMissingImports:"error",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none"}}function l(){return{strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportTypeshedErrors:"none",reportMissingImports:"none",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none"}}function p(){return{strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportTypeshedErrors:"none",reportMissingImports:"error",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none"}}t.ExecutionEnvironment=a,t.cloneDiagnosticRuleSet=function(e){return Object.assign({},e)},t.getBooleanDiagnosticRules=function(){return["strictListInference","strictDictionaryInference","strictParameterNoneValue"]},t.getDiagLevelDiagnosticRules=function(){return["reportGeneralTypeIssues","reportTypeshedErrors","reportMissingImports","reportMissingTypeStubs","reportImportCycles","reportUnusedImport","reportUnusedClass","reportUnusedFunction","reportUnusedVariable","reportDuplicateImport","reportOptionalSubscript","reportOptionalMemberAccess","reportOptionalCall","reportOptionalIterable","reportOptionalContextManager","reportOptionalOperand","reportUntypedFunctionDecorator","reportUntypedClassDecorator","reportUntypedBaseClass","reportUntypedNamedTuple","reportPrivateUsage","reportConstantRedefinition","reportIncompatibleMethodOverride","reportInvalidStringEscapeSequence","reportUnknownParameterType","reportUnknownArgumentType","reportUnknownLambdaType","reportUnknownVariableType","reportUnknownMemberType","reportCallInDefaultInitializer","reportUnnecessaryIsInstance","reportUnnecessaryCast","reportAssertAlwaysTrue","reportSelfClsParameterName","reportImplicitStringConcatenation"]},t.getStrictDiagnosticRuleSet=c,t.getNoTypeCheckingDiagnosticRuleSet=l,t.getDefaultDiagnosticRuleSet=p;class u{constructor(e,t){this.include=[],this.exclude=[],this.ignore=[],this.strict=[],this.executionEnvironments=[],this.projectRoot=e,this.diagnosticRuleSet=u.getDiagnosticRuleSet(t)}static getDiagnosticRuleSet(e){return"strict"===e?{strictListInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportTypeshedErrors:"error",reportMissingImports:"error",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none"}:"off"===e?{strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportTypeshedErrors:"none",reportMissingImports:"none",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none"}:{strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportTypeshedErrors:"none",reportMissingImports:"error",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none"}}findExecEnvironment(e){let t=this.executionEnvironments.find(t=>{const n=i.ensureTrailingDirectorySeparator(i.normalizePath(i.combinePaths(this.projectRoot,t.root)));return e.startsWith(n)});return t||(t=new a(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform)),t}addExecEnvironmentForAutoSearchPaths(e){const t=i.combinePaths(this.projectRoot,r.src);if(e.existsSync(t)&&!e.existsSync(i.combinePaths(t,"__init__.py"))){const e=new a(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform);e.extraPaths.push(t),this.executionEnvironments.push(e)}}initializeFromJson(e,t,n){if(this.include=[],void 0!==e.include)if(Array.isArray(e.include)){e.include.forEach((e,t)=>{"string"!=typeof e?n.log(`Index ${t} of "include" array should be a string.`):s.isAbsolute(e)?n.log(`Ignoring path "${e}" in "include" array because it is not relative.`):this.include.push(i.getFileSpec(this.projectRoot,e))})}else n.log('Config "include" entry must must contain an array.');if(this.exclude=[],void 0!==e.exclude)if(Array.isArray(e.exclude)){e.exclude.forEach((e,t)=>{"string"!=typeof e?n.log(`Index ${t} of "exclude" array should be a string.`):s.isAbsolute(e)?n.log(`Ignoring path "${e}" in "exclude" array because it is not relative.`):this.exclude.push(i.getFileSpec(this.projectRoot,e))})}else n.log('Config "exclude" entry must contain an array.');if(this.ignore=[],void 0!==e.ignore)if(Array.isArray(e.ignore)){e.ignore.forEach((e,t)=>{"string"!=typeof e?n.log(`Index ${t} of "ignore" array should be a string.`):s.isAbsolute(e)?n.log(`Ignoring path "${e}" in "ignore" array because it is not relative.`):this.ignore.push(i.getFileSpec(this.projectRoot,e))})}else n.log('Config "ignore" entry must contain an array.');if(this.strict=[],void 0!==e.strict)if(Array.isArray(e.strict)){e.strict.forEach((e,t)=>{"string"!=typeof e?n.log(`Index ${t} of "strict" array should be a string.`):s.isAbsolute(e)?n.log(`Ignoring path "${e}" in "strict" array because it is not relative.`):this.strict.push(i.getFileSpec(this.projectRoot,e))})}else n.log('Config "strict" entry must contain an array.');let r;void 0!==e.typeCheckingMode&&("off"===e.typeCheckingMode||"basic"===e.typeCheckingMode||"strict"===e.typeCheckingMode?r=e.typeCheckingMode:n.log('Config "typeCheckingMode" entry must contain "off", "basic", or "strict".'));const a=u.getDiagnosticRuleSet(r||t);if(this.diagnosticRuleSet={strictListInference:this._convertBoolean(e.strictListInference,"strictListInference",a.strictListInference),strictDictionaryInference:this._convertBoolean(e.strictDictionaryInference,"strictDictionaryInference",a.strictDictionaryInference),strictParameterNoneValue:this._convertBoolean(e.strictParameterNoneValue,"strictParameterNoneValue",a.strictParameterNoneValue),enableTypeIgnoreComments:this._convertBoolean(e.enableTypeIgnoreComments,"enableTypeIgnoreComments",a.enableTypeIgnoreComments),reportGeneralTypeIssues:this._convertDiagnosticLevel(e.reportGeneralTypeIssues,"reportGeneralTypeIssues",a.reportGeneralTypeIssues),reportTypeshedErrors:this._convertDiagnosticLevel(e.reportTypeshedErrors,"reportTypeshedErrors",a.reportTypeshedErrors),reportMissingImports:this._convertDiagnosticLevel(e.reportMissingImports,"reportMissingImports",a.reportMissingImports),reportUnusedImport:this._convertDiagnosticLevel(e.reportUnusedImport,"reportUnusedImport",a.reportUnusedImport),reportUnusedClass:this._convertDiagnosticLevel(e.reportUnusedClass,"reportUnusedClass",a.reportUnusedClass),reportUnusedFunction:this._convertDiagnosticLevel(e.reportUnusedFunction,"reportUnusedFunction",a.reportUnusedFunction),reportUnusedVariable:this._convertDiagnosticLevel(e.reportUnusedVariable,"reportUnusedVariable",a.reportUnusedVariable),reportDuplicateImport:this._convertDiagnosticLevel(e.reportDuplicateImport,"reportDuplicateImport",a.reportDuplicateImport),reportMissingTypeStubs:this._convertDiagnosticLevel(e.reportMissingTypeStubs,"reportMissingTypeStubs",a.reportMissingTypeStubs),reportImportCycles:this._convertDiagnosticLevel(e.reportImportCycles,"reportImportCycles",a.reportImportCycles),reportOptionalSubscript:this._convertDiagnosticLevel(e.reportOptionalSubscript,"reportOptionalSubscript",a.reportOptionalSubscript),reportOptionalMemberAccess:this._convertDiagnosticLevel(e.reportOptionalMemberAccess,"reportOptionalMemberAccess",a.reportOptionalMemberAccess),reportOptionalCall:this._convertDiagnosticLevel(e.reportOptionalCall,"reportOptionalCall",a.reportOptionalCall),reportOptionalIterable:this._convertDiagnosticLevel(e.reportOptionalIterable,"reportOptionalIterable",a.reportOptionalIterable),reportOptionalContextManager:this._convertDiagnosticLevel(e.reportOptionalContextManager,"reportOptionalContextManager",a.reportOptionalContextManager),reportOptionalOperand:this._convertDiagnosticLevel(e.reportOptionalOperand,"reportOptionalOperand",a.reportOptionalOperand),reportUntypedFunctionDecorator:this._convertDiagnosticLevel(e.reportUntypedFunctionDecorator,"reportUntypedFunctionDecorator",a.reportUntypedFunctionDecorator),reportUntypedClassDecorator:this._convertDiagnosticLevel(e.reportUntypedClassDecorator,"reportUntypedClassDecorator",a.reportUntypedClassDecorator),reportUntypedBaseClass:this._convertDiagnosticLevel(e.reportUntypedBaseClass,"reportUntypedBaseClass",a.reportUntypedBaseClass),reportUntypedNamedTuple:this._convertDiagnosticLevel(e.reportUntypedNamedTuple,"reportUntypedNamedTuple",a.reportUntypedNamedTuple),reportPrivateUsage:this._convertDiagnosticLevel(e.reportPrivateUsage,"reportPrivateUsage",a.reportPrivateUsage),reportConstantRedefinition:this._convertDiagnosticLevel(e.reportConstantRedefinition,"reportConstantRedefinition",a.reportConstantRedefinition),reportIncompatibleMethodOverride:this._convertDiagnosticLevel(e.reportIncompatibleMethodOverride,"reportIncompatibleMethodOverride",a.reportIncompatibleMethodOverride),reportInvalidStringEscapeSequence:this._convertDiagnosticLevel(e.reportInvalidStringEscapeSequence,"reportInvalidStringEscapeSequence",a.reportInvalidStringEscapeSequence),reportUnknownParameterType:this._convertDiagnosticLevel(e.reportUnknownParameterType,"reportUnknownParameterType",a.reportUnknownParameterType),reportUnknownArgumentType:this._convertDiagnosticLevel(e.reportUnknownArgumentType,"reportUnknownArgumentType",a.reportUnknownArgumentType),reportUnknownLambdaType:this._convertDiagnosticLevel(e.reportUnknownLambdaType,"reportUnknownLambdaType",a.reportUnknownLambdaType),reportUnknownVariableType:this._convertDiagnosticLevel(e.reportUnknownVariableType,"reportUnknownVariableType",a.reportUnknownVariableType),reportUnknownMemberType:this._convertDiagnosticLevel(e.reportUnknownMemberType,"reportUnknownMemberType",a.reportUnknownMemberType),reportCallInDefaultInitializer:this._convertDiagnosticLevel(e.reportCallInDefaultInitializer,"reportCallInDefaultInitializer",a.reportCallInDefaultInitializer),reportUnnecessaryIsInstance:this._convertDiagnosticLevel(e.reportUnnecessaryIsInstance,"reportUnnecessaryIsInstance",a.reportUnnecessaryIsInstance),reportUnnecessaryCast:this._convertDiagnosticLevel(e.reportUnnecessaryCast,"reportUnnecessaryCast",a.reportUnnecessaryCast),reportAssertAlwaysTrue:this._convertDiagnosticLevel(e.reportAssertAlwaysTrue,"reportAssertAlwaysTrue",a.reportAssertAlwaysTrue),reportSelfClsParameterName:this._convertDiagnosticLevel(e.reportSelfClsParameterName,"reportSelfClsParameterName",a.reportSelfClsParameterName),reportImplicitStringConcatenation:this._convertDiagnosticLevel(e.reportImplicitStringConcatenation,"reportImplicitStringConcatenation",a.reportImplicitStringConcatenation)},this.venvPath=void 0,void 0!==e.venvPath&&("string"!=typeof e.venvPath?n.log('Config "venvPath" field must contain a string.'):this.venvPath=i.normalizePath(i.combinePaths(this.projectRoot,e.venvPath))),this.defaultVenv=void 0,void 0!==e.venv&&("string"!=typeof e.venv?n.log('Config "venv" field must contain a string.'):this.defaultVenv=e.venv),this.defaultPythonVersion=void 0,void 0!==e.pythonVersion)if("string"==typeof e.pythonVersion){const t=o.versionFromString(e.pythonVersion);t?this.defaultPythonVersion=t:n.log('Config "pythonVersion" field contains unsupported version.')}else n.log('Config "pythonVersion" field must contain a string.');if(this.defaultPythonPlatform=void 0,void 0!==e.pythonPlatform&&("string"!=typeof e.pythonPlatform?n.log('Config "pythonPlatform" field must contain a string.'):this.defaultPythonPlatform=e.pythonPlatform),this.typeshedPath=void 0,void 0!==e.typeshedPath&&("string"!=typeof e.typeshedPath?n.log('Config "typeshedPath" field must contain a string.'):this.typeshedPath=e.typeshedPath?i.normalizePath(i.combinePaths(this.projectRoot,e.typeshedPath)):""),this.typingsPath=void 0,void 0!==e.typingsPath&&("string"!=typeof e.typingsPath?n.log('Config "typingsPath" field must contain a string.'):this.typingsPath=i.normalizePath(i.combinePaths(this.projectRoot,e.typingsPath))),void 0!==e.verboseOutput&&("boolean"!=typeof e.verboseOutput?n.log('Config "verboseOutput" field must be true or false.'):this.verboseOutput=e.verboseOutput),void 0!==e.useLibraryCodeForTypes&&("boolean"!=typeof e.useLibraryCodeForTypes?n.log('Config "useLibraryCodeForTypes" field must be true or false.'):this.useLibraryCodeForTypes=e.useLibraryCodeForTypes),this.executionEnvironments=[],void 0!==e.executionEnvironments)if(Array.isArray(e.executionEnvironments)){e.executionEnvironments.forEach((e,t)=>{const s=this._initExecutionEnvironmentFromJson(e,t,n);s&&this.executionEnvironments.push(s)})}else n.log('Config "executionEnvironments" field must contain an array.')}_convertBoolean(e,t,n){return void 0===e?n:"boolean"==typeof e?!!e:(console.log(`Config "${t}" entry must be true or false.`),n)}_convertDiagnosticLevel(e,t,n){return void 0===e?n:"boolean"==typeof e?e?"error":"none":"string"!=typeof e||"error"!==e&&"warning"!==e&&"none"!==e?(console.log(`Config "${t}" entry must be true, false, "error", "warning" or "none".`),n):e}_initExecutionEnvironmentFromJson(e,t,n){try{const s=new a(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform);if(e.root&&"string"==typeof e.root?s.root=i.normalizePath(i.combinePaths(this.projectRoot,e.root)):n.log(`Config executionEnvironments index ${t}: missing root value.`),e.extraPaths)if(Array.isArray(e.extraPaths)){e.extraPaths.forEach((e,r)=>{"string"!=typeof e?n.log(`Config executionEnvironments index ${t}:`+` extraPaths field ${r} must be a string.`):s.extraPaths.push(i.normalizePath(i.combinePaths(this.projectRoot,e)))})}else n.log(`Config executionEnvironments index ${t}: extraPaths field must contain an array.`);if(e.pythonVersion)if("string"==typeof e.pythonVersion){const r=o.versionFromString(e.pythonVersion);r?s.pythonVersion=r:n.log(`Config executionEnvironments index ${t} contains unsupported pythonVersion.`)}else n.log(`Config executionEnvironments index ${t} pythonVersion must be a string.`);return e.pythonPlatform&&("string"==typeof e.pythonPlatform?s.pythonPlatform=e.pythonPlatform:n.log(`Config executionEnvironments index ${t} pythonPlatform must be a string.`)),e.venv&&("string"==typeof e.venv?s.venv=e.venv:n.log(`Config executionEnvironments index ${t} venv must be a string.`)),s}catch(e){n.log(`Config executionEnvironments index ${t} is not accessible.`)}}}t.ConfigOptions=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(25);function r(e,t){return t<0?e.length+t:t}function i(e,t,n,s){if(void 0===t||0===t.length)return e;if(void 0===e)return t.slice(n,s);n=void 0===n?0:r(t,n),s=void 0===s?t.length:r(t,s);for(let r=n;r<s&&r<t.length;r++)void 0!==t[r]&&e.push(t[r]);return e}function o(e,t){return t}function a(e,t){return!!e&&(t?e.some(t):e.length>0)}function c(e,t,n,s,r){if(!a(e))return-1;let i=r||0,o=e.length-1;for(;i<=o;){const r=i+(o-i>>1);switch(s(n(e[r]),t)){case-1:i=r+1;break;case 0:return r;case 1:o=r-1}}return~i}t.emptyArray=[],t.contains=function(e,t,n=s.equateValues){if(e)for(const s of e)if(n(s,t))return!0;return!1},t.append=function(e,t){return void 0===t?e:void 0===e?[t]:(e.push(t),e)},t.find=function(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(t(s,n))return s}},t.addRange=i,t.insertAt=function(e,t,n){if(0===t)e.unshift(n);else if(t===e.length)e.push(n);else{for(let n=e.length;n>t;n--)e[n]=e[n-1];e[t]=n}return e},t.cloneAndSort=function(e,t){return 0===e.length?e:e.slice().sort(t)},t.stableSort=function(e,t){const n=function(e){return e.map(o)}(e);return function(e,t,n){t.sort((t,r)=>n(e[t],e[r])||s.compareValues(t,r))}(e,n,t),n.map(t=>e[t])},t.map=function(e,t){if(e)return e.map(t)},t.some=a,t.every=function(e,t){return!e||e.every(t)},t.binarySearch=function(e,t,n,s,r){return c(e,n(t),n,s,r)},t.binarySearchKey=c,t.flatten=function(e){const t=[];for(const n of e)n&&(s.isArray(n)?i(t,n):t.push(n));return t},t.getNestedProperty=function(e,t){return t.split(".").reduce((e,t)=>e&&e[t],e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1);!function(e){e[e.Unreachable=1]="Unreachable",e[e.Start=2]="Start",e[e.BranchLabel=4]="BranchLabel",e[e.LoopLabel=8]="LoopLabel",e[e.Assignment=16]="Assignment",e[e.Unbind=32]="Unbind",e[e.WildcardImport=64]="WildcardImport",e[e.TrueCondition=128]="TrueCondition",e[e.FalseCondition=512]="FalseCondition",e[e.Call=1024]="Call",e[e.PreFinallyGate=2048]="PreFinallyGate",e[e.PostFinally=4096]="PostFinally",e[e.AssignmentAlias=8192]="AssignmentAlias"}(t.FlowFlags||(t.FlowFlags={}));let r=1;t.getUniqueFlowNodeId=function(){return r++},t.isCodeFlowSupportedForReference=function e(t){return 39===t.nodeType||36===t.nodeType&&e(t.leftExpression)},t.createKeyForReference=function(e){let t;if(39===e.nodeType)t=e.value;else{t=e.memberName.value;let n=e.leftExpression;for(;36===n.nodeType;)t=n.memberName.value+`.${t}`,n=n.leftExpression;s.assert(39===n.nodeType),t=n.value+`.${t}`}return t}},function(e,t,n){"use strict";const s=n(2),r="win32"===process.platform,{REGEX_BACKSLASH:i,REGEX_REMOVE_BACKSLASH:o,REGEX_SPECIAL_CHARS:a,REGEX_SPECIAL_CHARS_GLOBAL:c}=n(31);t.hasRegexChars=e=>a.test(e),t.escapeRegex=e=>e.replace(c,"\\$1"),t.toPosixSlashes=e=>e.replace(i,"/"),t.removeBackslashes=e=>e.replace(o,e=>"\\"===e?"":e),t.supportsLookbehinds=()=>{const e=process.version.slice(1).split(".").map(Number);return 3===e.length&&e[0]>=9||8===e[0]&&e[1]>=10},t.isWindows=e=>e&&"boolean"==typeof e.windows?e.windows:!0===r||"\\"===s.sep,t.escapeLast=(e,n,s)=>{const r=e.lastIndexOf(n,s);return-1===r?e:"\\"===e[r-1]?t.escapeLast(e,n,r-1):e.slice(0,r)+"\\"+e.slice(r)},t.removePrefix=(e,t={})=>{let n=e;return n.startsWith("./")&&(n=n.slice(2),t.prefix="./"),n},t.wrapOutput=(e,t={},n={})=>{let s=`${n.contains?"":"^"}(?:${e})${n.contains?"":"$"}`;return!0===t.negated&&(s=`(?:^(?!${s}).*$)`),s}},function(e,t,n){"use strict";const s=n(40);e.exports=(e,t={})=>{let n=(e,r={})=>{let i=t.escapeInvalid&&s.isInvalidBrace(r),o=!0===e.invalid&&!0===t.escapeInvalid,a="";if(e.value)return(i||o)&&s.isOpenOrClose(e)?"\\"+e.value:e.value;if(e.value)return e.value;if(e.nodes)for(let t of e.nodes)a+=n(t);return a};return n(e)}},function(e,t,n){"use strict";t.isInteger=e=>"number"==typeof e?Number.isInteger(e):"string"==typeof e&&""!==e.trim()&&Number.isInteger(Number(e)),t.find=(e,t)=>e.nodes.find(e=>e.type===t),t.exceedsLimit=(e,n,s=1,r)=>!1!==r&&(!(!t.isInteger(e)||!t.isInteger(n))&&(Number(n)-Number(e))/Number(s)>=r),t.escapeNode=(e,t=0,n)=>{let s=e.nodes[t];s&&(n&&s.type===n||"open"===s.type||"close"===s.type)&&!0!==s.escaped&&(s.value="\\"+s.value,s.escaped=!0)},t.encloseBrace=e=>"brace"===e.type&&(e.commas>>0+e.ranges>>0==0&&(e.invalid=!0,!0)),t.isInvalidBrace=e=>"brace"===e.type&&(!(!0!==e.invalid&&!e.dollar)||(e.commas>>0+e.ranges>>0==0||!0!==e.open||!0!==e.close)&&(e.invalid=!0,!0)),t.isOpenOrClose=e=>"open"===e.type||"close"===e.type||(!0===e.open||!0===e.close),t.reduce=e=>e.reduce((e,t)=>("text"===t.type&&e.push(t.value),"range"===t.type&&(t.type="text"),e),[]),t.flatten=(...e)=>{const t=[],n=e=>{for(let s=0;s<e.length;s++){let r=e[s];Array.isArray(r)?n(r,t):void 0!==r&&t.push(r)}return t};return n(e),t}},function(e,t,n){"use strict";const{sep:s}=n(2),{platform:r}=process;t.EV_ALL="all",t.EV_READY="ready",t.EV_ADD="add",t.EV_CHANGE="change",t.EV_ADD_DIR="addDir",t.EV_UNLINK="unlink",t.EV_UNLINK_DIR="unlinkDir",t.EV_RAW="raw",t.EV_ERROR="error",t.STR_DATA="data",t.STR_END="end",t.STR_CLOSE="close",t.FSEVENT_CREATED="created",t.FSEVENT_MODIFIED="modified",t.FSEVENT_DELETED="deleted",t.FSEVENT_MOVED="moved",t.FSEVENT_CLONED="cloned",t.FSEVENT_UNKNOWN="unknown",t.FSEVENT_TYPE_DIRECTORY="directory",t.FSEVENT_TYPE_SYMLINK="symlink",t.KEY_LISTENERS="listeners",t.KEY_ERR="errHandlers",t.KEY_RAW="rawEmitters",t.HANDLER_KEYS=[t.KEY_LISTENERS,t.KEY_ERR,t.KEY_RAW],t.DOT_SLASH=`.${s}`,t.BACK_SLASH_RE=/\\/g,t.DOUBLE_SLASH_RE=/\/\//,t.SLASH_OR_BACK_SLASH_RE=/[/\\]/,t.DOT_RE=/\..*\.(sw[px])$|~$|\.subl.*\.tmp/,t.REPLACER_RE=/^\.[/\\]/,t.SLASH="/",t.BRACE_START="{",t.BANG="!",t.ONE_DOT=".",t.TWO_DOTS="..",t.STAR="*",t.GLOBSTAR="**",t.ROOT_GLOBSTAR="/**/*",t.SLASH_GLOBSTAR="/**",t.DIR_SUFFIX="Dir",t.ANYMATCH_OPTS={dot:!0},t.STRING_TYPE="string",t.FUNCTION_TYPE="function",t.EMPTY_STR="",t.EMPTY_FN=()=>{},t.IDENTITY_FN=e=>e,t.isWindows="win32"===r,t.isMacos="darwin"===r},function(e,t){e.exports=require("net")},function(e,t,n){"use strict";function s(e){return"string"==typeof e||e instanceof String}function r(e){return"function"==typeof e}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=r,t.array=i,t.stringArray=function(e){return i(e)&&e.every(e=>s(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&r(e.then)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class r extends s{constructor(){super([r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-","4",r._randomHex(),r._randomHex(),r._randomHex(),"-",r._oneOf(r._timeHighBits),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return r._oneOf(r._chars)}}function i(){return new r}r._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],r._timeHighBits=["8","9","a","b"],t.empty=new s("00000000-0000-0000-0000-000000000000"),t.v4=i;const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return o.test(e)}t.isUUID=a,t.parse=function(e){if(!a(e))throw new Error("invalid uuid");return new s(e)},t.generateUuid=function(){return i().asHex()}},function(e,t){e.exports=require("child_process")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(3),r=n(35),i=n(26),o=n(1),a=n(6),c=n(27),l=n(49),p=n(99),u=n(50);t.configFileNames=["pyrightconfig.json","mspythonconfig.json"];class d{constructor(e,t,n,s,o,a){this._typeStubTargetIsSingleFile=!1,this._watchForSourceChanges=!1,this._watchForLibraryChanges=!1,this._verboseOutput=!1,this._requireTrackedFileUpdate=!0,this._lastUserInteractionTime=Date.now(),this._instanceName=e,this._console=n||new i.StandardConsole,this._configOptions=null!=o?o:new r.ConfigOptions(process.cwd()),this._importResolverFactory=s||d.createImportResolver,this._importResolver=this._importResolverFactory(t,this._configOptions),this._program=new p.Program(this._importResolver,this._configOptions,this._console,a),this._executionRootPath="",this._typeStubTargetImportName=void 0}clone(e){return new d(e,this._fs,this._console,this._importResolverFactory,this._configOptions)}dispose(){this._removeSourceFileWatchers(),this._removeConfigFileWatcher(),this._removeLibraryFileWatcher(),this._clearReloadConfigTimer(),this._clearReanalysisTimer(),this._clearLibraryReanalysisTimer()}static createImportResolver(e,t){return new l.ImportResolver(e,t)}setCompletionCallback(e){this._onCompletionCallback=e}setMaxAnalysisDuration(e){this._maxAnalysisTime=e}setOptions(e){this._watchForSourceChanges=!!e.watchForSourceChanges,this._watchForLibraryChanges=!!e.watchForLibraryChanges,this._typeCheckingMode=e.typeCheckingMode,this._verboseOutput=!!e.verboseOutput,this._configOptions=this._getConfigOptions(e),this._program.setConfigOptions(this._configOptions),this._typeStubTargetImportName=e.typeStubTargetImportName,this._executionRootPath=a.normalizePath(a.combinePaths(e.executionRoot,this._configOptions.projectRoot)),this._applyConfigOptions()}setFileOpened(e,t,n){this._program.setFileOpened(e,t,n),this._scheduleReanalysis(!1)}updateOpenFileContents(e,t,n){this._program.setFileOpened(e,t,n),this._program.markFilesDirty([e]),this._scheduleReanalysis(!1)}setFileClosed(e){const t=this._program.setFileClosed(e);this._reportDiagnosticsForRemovedFiles(t),this._scheduleReanalysis(!1)}getDefinitionForPosition(e,t,n){return this._program.getDefinitionsForPosition(e,t,n)}getReferencesForPosition(e,t,n,s){return this._program.getReferencesForPosition(e,t,n,s)}addSymbolsForDocument(e,t,n){this._program.addSymbolsForDocument(e,t,n)}addSymbolsForWorkspace(e,t,n){this._program.addSymbolsForWorkspace(e,t,n)}getHoverForPosition(e,t,n){return this._program.getHoverForPosition(e,t,n)}getSignatureHelpForPosition(e,t,n){return this._program.getSignatureHelpForPosition(e,t,n)}getCompletionsForPosition(e,t,n,s){return this._program.getCompletionsForPosition(e,t,n,s)}resolveCompletionItem(e,t,n){this._program.resolveCompletionItem(e,t,n)}performQuickAction(e,t,n,s){return this._program.performQuickAction(e,t,n,s)}renameSymbolAtPosition(e,t,n,s){return this._program.renameSymbolAtPosition(e,t,n,s)}printStats(){this._console.log(""),this._console.log("Analysis stats");const e=this._program.getFileCount();this._console.log("Total files analyzed: "+e.toString())}printDependencies(e){this._program.printDependencies(this._executionRootPath,e)}getDiagnosticsForRange(e,t){return this._program.getDiagnosticsForRange(e,this._configOptions,t)}getImportResolver(){return this._importResolver}recordUserInteractionTime(){this._lastUserInteractionTime=Date.now(),this._analyzeTimer&&this._scheduleReanalysis(!1)}get test_ImportResolver(){return this._importResolver}get test_configOptions(){return this._configOptions}get test_program(){return this._program}test_getConfigOptions(e){return this._getConfigOptions(e)}test_getFileNamesFromFileSpecs(){return this._getFileNamesFromFileSpecs()}_getConfigOptions(e){var t;let n,s=e.executionRoot;e.fileSpecs&&e.fileSpecs.length>0?e.configFilePath&&this._console.log("Project cannot be mixed with source files on a command line."):e.configFilePath?(n=a.combinePaths(e.executionRoot,a.normalizePath(e.configFilePath)),this._fs.existsSync(n)?n.toLowerCase().endsWith(".json")?s=a.getDirectoryPath(n):(s=n,n=this._findConfigFile(n),n||this._console.log(`Configuration file not found at ${s}.`)):(this._console.log(`Configuration file not found at ${n}.`),n=e.executionRoot)):s&&(n=this._findConfigFileHereOrUp(s),n?s=a.getDirectoryPath(n):(this._console.log("No configuration file found."),n=void 0));const i=new r.ConfigOptions(s,this._typeCheckingMode),o=["**/node_modules","**/__pycache__",".git"];if(e.fileSpecs.length>0?e.fileSpecs.forEach(e=>{i.include.push(a.getFileSpec(s,e))}):n||e.executionRoot&&(i.include.push(a.getFileSpec(e.executionRoot,".")),o.forEach(t=>{i.exclude.push(a.getFileSpec(e.executionRoot,t))})),this._configFilePath=n,n){this._console.log(`Loading configuration file at ${n}`);const t=this._parseConfigFile(n);if(t){i.initializeFromJson(t,this._typeCheckingMode,this._console);const s=a.getDirectoryPath(n);0===i.include.length&&(this._console.log(`No include entries specified; assuming ${n}`),i.include.push(a.getFileSpec(s,"."))),0===i.exclude.length&&(o.forEach(e=>{this._console.log(`Auto-excluding ${e}`),i.exclude.push(a.getFileSpec(s,e))}),void 0===i.autoExcludeVenv&&(i.autoExcludeVenv=!0)),e.autoSearchPaths&&0===i.executionEnvironments.length&&i.addExecEnvironmentForAutoSearchPaths(this._fs)}this._updateConfigFileWatcher(),this._updateLibraryFileWatcher()}else e.autoSearchPaths&&i.addExecEnvironmentForAutoSearchPaths(this._fs),i.autoExcludeVenv=!0;const c=t=>{const n=e.fromVsCodeExtension?"the VS Code settings":"a command-line option";this._console.log(`The ${t} has been specified in both the config file and `+`${n}. The value in the config file (${i.venvPath}) `+"will take precedence")};if(e.venvPath&&(i.venvPath?c("venvPath"):i.venvPath=e.venvPath),e.pythonPath&&(this._console.log(`Setting pythonPath for service "${this._instanceName}": `+`"${e.pythonPath}"`),i.pythonPath=e.pythonPath),e.typeshedPath&&(i.typeshedPath?c("typeshedPath"):i.typeshedPath=e.typeshedPath),i.verboseOutput=!!e.verboseOutput,i.checkOnlyOpenFiles=!!e.checkOnlyOpenFiles,i.useLibraryCodeForTypes=!!e.useLibraryCodeForTypes,void 0===i.typingsPath&&(i.typingsPath=a.normalizePath(a.combinePaths(i.projectRoot,"typings"))),i.venvPath){if(this._fs.existsSync(i.venvPath)&&a.isDirectory(this._fs,i.venvPath)||this._console.log(`venvPath ${i.venvPath} is not a valid directory.`),i.defaultVenv=null!==(t=i.defaultVenv)&&void 0!==t?t:this._configOptions.defaultVenv,i.defaultVenv){const e=a.combinePaths(i.venvPath,i.defaultVenv);if(this._fs.existsSync(e)&&a.isDirectory(this._fs,e)){const e=[];void 0===u.findPythonSearchPaths(this._fs,i,void 0,e)&&(this._console.log("site-packages directory cannot be located for venvPath "+`${i.venvPath} and venv ${i.defaultVenv}.`),i.verboseOutput&&e.forEach(e=>{this._console.log(`  ${e}`)}))}else this._console.log(`venv ${i.defaultVenv} subdirectory not found `+`in venv path ${i.venvPath}.`)}}else{const e=[],t=u.getPythonPathFromPythonInterpreter(this._fs,i.pythonPath,e).paths;0===t.length?i.verboseOutput&&this._console.log("No search paths found for configured python interpreter."):i.verboseOutput&&(this._console.log("Search paths found for configured python interpreter:"),t.forEach(e=>{this._console.log(`  ${e}`)})),i.verboseOutput&&e.length>0&&(this._console.log("When attempting to get search paths from python interpreter:"),e.forEach(e=>{this._console.log(`  ${e}`)}))}return(i.defaultVenv||i.executionEnvironments.find(e=>!!e.venv))&&(i.venvPath||this._console.log("venvPath not specified, so venv settings will be ignored.")),i.typeshedPath&&(this._fs.existsSync(i.typeshedPath)&&a.isDirectory(this._fs,i.typeshedPath)||this._console.log(`typeshedPath ${i.typeshedPath} is not a valid directory.`)),i.typingsPath&&(this._fs.existsSync(i.typingsPath)&&a.isDirectory(this._fs,i.typingsPath)||this._console.log(`typingsPath ${i.typingsPath} is not a valid directory.`)),i}writeTypeStub(e){const t=this._configOptions.typingsPath;if(!this._typeStubTargetPath||!this._typeStubTargetImportName){const e=`Import '${this._typeStubTargetImportName}'`+" could not be resolved";throw this._console.error(e),new Error(e)}if(!t){const e="No typings path was specified";throw this._console.log(e),new Error(e)}const n=this._typeStubTargetImportName.split(".");if(0===n[0].length){const e=`Import '${this._typeStubTargetImportName}'`+" could not be resolved";throw this._console.error(e),new Error(e)}try{this._fs.existsSync(t)||this._fs.mkdirSync(t)}catch(e){const n=`Could not create typings directory '${t}'`;throw this._console.error(n),new Error(n)}const s=a.combinePaths(t,n[0]);try{this._fs.existsSync(s)||this._fs.mkdirSync(s)}catch(e){const t=`Could not create typings subdirectory '${s}'`;throw this._console.error(t),new Error(t)}this._program.writeTypeStub(this._typeStubTargetPath,this._typeStubTargetIsSingleFile,s,e)}invalidateAndForceReanalysis(){this._importResolver.invalidateCache(),this._program.markAllFilesDirty(!0)}restart(){this._applyConfigOptions()}get _fs(){return this._importResolver.fileSystem}_findConfigFileHereOrUp(e){return a.forEachAncestorDirectory(e,e=>this._findConfigFile(e))}_findConfigFile(e){for(const n of t.configFileNames){const t=a.combinePaths(e,n);if(this._fs.existsSync(t))return t}}_parseConfigFile(e){let t="",n=0;for(;;){try{t=this._fs.readFileSync(e,"utf8")}catch(t){return this._console.log(`Config file "${e}" could not be read.`),void this._reportConfigParseError()}let s,r=!1;try{return s=JSON.parse(t),s}catch(e){r=!0}if(!r)break;if(n++>=5)return this._console.log(`Config file "${e}" could not be parsed. Verify that JSON is correct.`),void this._reportConfigParseError()}}_getFileNamesFromFileSpecs(){const e=new Map;return c.timingStats.findFilesTime.timeOperation(()=>{const t=this._matchFiles(this._configOptions.include,this._configOptions.exclude);for(const n of t)e.set(n,n)}),[...e.values()]}_updateTrackedFileList(e){if(this._typeStubTargetImportName){const e=this._configOptions.findExecEnvironment(this._executionRootPath),t={leadingDots:0,nameParts:this._typeStubTargetImportName.split("."),importedSymbols:[]},n=this._importResolver.resolveImport("",e,t);if(n.isImportFound){const e=[],t=n.resolvedPaths[n.resolvedPaths.length-1];let s=a.getDirectoryPath(t);for(let e=n.resolvedPaths.length-2;e>=0;e--){const t=n.resolvedPaths[e];s=t?a.getDirectoryPath(t):a.getDirectoryPath(s)}a.isDirectory(this._fs,s)&&(this._typeStubTargetPath=s),t?(e.push(t),this._typeStubTargetIsSingleFile=1===n.resolvedPaths.length&&"__init__"!==a.stripFileExtension(a.getFileName(n.resolvedPaths[0]))):this._typeStubTargetIsSingleFile=!1,n.implicitImports.forEach(t=>{e.push(t.path)}),this._program.setAllowedThirdPartyImports([this._typeStubTargetImportName]),this._program.setTrackedFiles(e)}else this._console.log(`Import '${this._typeStubTargetImportName}' not found`)}else{let t=[];this._console.log("Searching for source files"),t=this._getFileNamesFromFileSpecs();const n=this._program.setTrackedFiles(t);this._reportDiagnosticsForRemovedFiles(n),this._program.markAllFilesDirty(e),0===t.length?this._console.log("No source files found."):this._console.log(`Found ${t.length} `+`source ${1===t.length?"file":"files"}`)}this._requireTrackedFileUpdate=!1}_isInExcludePath(e,t){return!!t.find(t=>t.regExp.test(e))}_matchFiles(e,t){const n=/\.pyi?$/,s=[["bin","activate"],["Scripts","activate"],["pyvenv.cfg"]],r=[],i=(e,o)=>{if(this._configOptions.autoExcludeVenv&&s.some(t=>this._fs.existsSync(a.combinePaths(e,...t))))return void this._console.log(`Auto-excluding ${e}`);const{files:c,directories:l}=a.getFileSystemEntries(this._fs,e);for(const s of c){const i=a.combinePaths(e,s);o.test(i)&&!this._isInExcludePath(i,t)&&n.test(i)&&r.push(i)}for(const n of l){const s=a.combinePaths(e,n);o.test(s)&&(this._isInExcludePath(s,t)||i(s,o))}};return e.forEach(e=>{let s=!1;if(!this._isInExcludePath(e.wildcardRoot,t))try{const t=this._fs.statSync(e.wildcardRoot);t.isFile()?n.test(e.wildcardRoot)&&(r.push(e.wildcardRoot),s=!0):t.isDirectory()&&(i(e.wildcardRoot,e.regExp),s=!0)}catch(e){}s||this._console.log(`File or directory "${e.wildcardRoot}" does not exist.`)}),r}_removeSourceFileWatchers(){this._sourceFileWatcher&&(this._sourceFileWatcher.close(),this._sourceFileWatcher=void 0)}_updateSourceFileWatchers(){if(this._removeSourceFileWatchers(),this._importResolver.invalidateCache(),this._watchForSourceChanges&&this._configOptions.include.length>0){const e=this._configOptions.include.map(e=>a.combinePaths(this._executionRootPath,e.wildcardRoot));try{this._verboseOutput&&this._console.log(`Adding fs watcher for directories:\n ${e.join("\n")}`),this._sourceFileWatcher=this._fs.createFileSystemWatcher(e,(e,t)=>{this._verboseOutput&&this._console.log(`Received fs event '${e}' for path '${t}'`),"change"===e?(this._program.markFilesDirty([t]),this._scheduleReanalysis(!1)):this._scheduleReanalysis(!0)})}catch(t){this._console.log(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}}_removeLibraryFileWatcher(){this._libraryFileWatcher&&(this._libraryFileWatcher.close(),this._libraryFileWatcher=void 0)}_updateLibraryFileWatcher(){if(this._removeLibraryFileWatcher(),this._importResolver.invalidateCache(),!this._watchForLibraryChanges)return;const e=u.findPythonSearchPaths(this._fs,this._configOptions,void 0,[],!0,this._executionRootPath);if(e&&e.length>0)try{this._verboseOutput&&this._console.log(`Adding fs watcher for library directories:\n ${e.join("\n")}`),this._libraryFileWatcher=this._fs.createFileSystemWatcher(e,(e,t)=>{this._verboseOutput&&this._console.log(`Received fs event '${e}' for path '${t}'`),this._scheduleLibraryAnalysis()})}catch(t){this._console.log(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}_clearLibraryReanalysisTimer(){this._libraryReanalysisTimer&&(clearTimeout(this._libraryReanalysisTimer),this._libraryReanalysisTimer=void 0)}_scheduleLibraryAnalysis(){this._clearLibraryReanalysisTimer(),this._libraryReanalysisTimer=setTimeout(()=>{this._clearLibraryReanalysisTimer(),this.invalidateAndForceReanalysis(),this._scheduleReanalysis(!1)},100)}_removeConfigFileWatcher(){this._configFileWatcher&&(this._configFileWatcher.close(),this._configFileWatcher=void 0)}_updateConfigFileWatcher(){this._removeConfigFileWatcher(),this._configFilePath&&(this._configFileWatcher=this._fs.createFileSystemWatcher([this._configFilePath],e=>{this._verboseOutput&&this._console.log(`Received fs event '${e}' for config file`),this._scheduleReloadConfigFile()}))}_clearReloadConfigTimer(){this._reloadConfigTimer&&(clearTimeout(this._reloadConfigTimer),this._reloadConfigTimer=void 0)}_scheduleReloadConfigFile(){this._clearReloadConfigTimer(),this._reloadConfigTimer=setTimeout(()=>{this._clearReloadConfigTimer(),this._reloadConfigFile()},100)}_reloadConfigFile(){if(this._configFilePath){this._updateConfigFileWatcher(),this._console.log(`Reloading configuration file at ${this._configFilePath}`);const e=this._parseConfigFile(this._configFilePath);e&&this._configOptions.initializeFromJson(e,this._typeCheckingMode,this._console),this._applyConfigOptions()}}_applyConfigOptions(){this._importResolver=this._importResolverFactory(this._fs,this._configOptions),this._program.setImportResolver(this._importResolver),this._updateLibraryFileWatcher(),this._updateSourceFileWatchers(),this._updateTrackedFileList(!0),this._scheduleReanalysis(!1)}_clearReanalysisTimer(){this._analyzeTimer&&(clearTimeout(this._analyzeTimer),this._analyzeTimer=void 0)}_scheduleReanalysis(e){e&&(this._requireTrackedFileUpdate=!0),this._clearReanalysisTimer();const t=Date.now()-this._lastUserInteractionTime,n=Math.max(500-t,20);this._analyzeTimer=setTimeout(()=>{this._analyzeTimer=void 0,this._requireTrackedFileUpdate&&this._updateTrackedFileList(!1),this._reanalyze()&&this._scheduleReanalysis(!1)},n)}_useInteractiveMode(){return Date.now()-this._lastUserInteractionTime<1e3}_reanalyze(){let e=!1;try{const t=new c.Duration;e=this._program.analyze(this._maxAnalysisTime,this._useInteractiveMode(),s.getGlobalCancellationToken());const n=this._program.getFilesToAnalyzeCount();o.assert(0===n||e);const r={diagnostics:this._program.getDiagnostics(this._configOptions),filesInProgram:this._program.getFileCount(),filesRequiringAnalysis:n,checkingOnlyOpenFiles:this._program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:t.getDurationInSeconds()};(r.diagnostics.length>0||!e)&&this._onCompletionCallback&&this._onCompletionCallback(r)}catch(e){if(s.OperationCanceledException.is(e))return!0;const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.log("Error performing analysis: "+t),this._onCompletionCallback&&this._onCompletionCallback({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!0,configParseErrorOccurred:!1,elapsedTime:0})}return e}_reportDiagnosticsForRemovedFiles(e){e.length>0&&this._onCompletionCallback&&this._onCompletionCallback({diagnostics:e,filesInProgram:this._program.getFileCount(),filesRequiringAnalysis:this._program.getFilesToAnalyzeCount(),checkingOnlyOpenFiles:this._program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0})}_reportConfigParseError(){this._onCompletionCallback&&this._onCompletionCallback({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!1,configParseErrorOccurred:!0,elapsedTime:0})}}t.AnalyzerService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeshedFallback="typeshed-fallback",t.lib="lib",t.sitePackages="site-packages",t.src="src"},function(e,t,n){"use strict";n.r(t),n.d(t,"URI",(function(){return h}));var s,r,i,o=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});if("object"==typeof process)i="win32"===process.platform;else if("object"==typeof navigator){var a=navigator.userAgent;i=a.indexOf("Windows")>=0}var c=/^\w[\w\d+.-]*$/,l=/^\//,p=/^\/\//;var u="/",d=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,h=function(){function e(e,t,n,s,r,i){void 0===i&&(i=!1),"object"==typeof e?(this.scheme=e.scheme||"",this.authority=e.authority||"",this.path=e.path||"",this.query=e.query||"",this.fragment=e.fragment||""):(this.scheme=function(e,t){return e||t?e:"file"}(e,i),this.authority=t||"",this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==u&&(t=u+t):t=u}return t}(this.scheme,n||""),this.query=s||"",this.fragment=r||"",function(e,t){if(!e.scheme&&t)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'+e.authority+'", path: "'+e.path+'", query: "'+e.query+'", fragment: "'+e.fragment+'"}');if(e.scheme&&!c.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!l.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(p.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}(this,i))}return e.isUri=function(t){return t instanceof e||!!t&&("string"==typeof t.authority&&"string"==typeof t.fragment&&"string"==typeof t.path&&"string"==typeof t.query&&"string"==typeof t.scheme&&"function"==typeof t.fsPath&&"function"==typeof t.with&&"function"==typeof t.toString)},Object.defineProperty(e.prototype,"fsPath",{get:function(){return T(this)},enumerable:!0,configurable:!0}),e.prototype.with=function(e){if(!e)return this;var t=e.scheme,n=e.authority,s=e.path,r=e.query,i=e.fragment;return void 0===t?t=this.scheme:null===t&&(t=""),void 0===n?n=this.authority:null===n&&(n=""),void 0===s?s=this.path:null===s&&(s=""),void 0===r?r=this.query:null===r&&(r=""),void 0===i?i=this.fragment:null===i&&(i=""),t===this.scheme&&n===this.authority&&s===this.path&&r===this.query&&i===this.fragment?this:new g(t,n,s,r,i)},e.parse=function(e,t){void 0===t&&(t=!1);var n=d.exec(e);return n?new g(n[2]||"",decodeURIComponent(n[4]||""),decodeURIComponent(n[5]||""),decodeURIComponent(n[7]||""),decodeURIComponent(n[9]||""),t):new g("","","","","")},e.file=function(e){var t="";if(i&&(e=e.replace(/\\/g,u)),e[0]===u&&e[1]===u){var n=e.indexOf(u,2);-1===n?(t=e.substring(2),e=u):(t=e.substring(2,n),e=e.substring(n)||u)}return new g("file",t,e,"","")},e.from=function(e){return new g(e.scheme,e.authority,e.path,e.query,e.fragment)},e.prototype.toString=function(e){return void 0===e&&(e=!1),v(this,e)},e.prototype.toJSON=function(){return this},e.revive=function(t){if(t){if(t instanceof e)return t;var n=new g(t);return n._formatted=t.external,n._fsPath=t._sep===f?t.fsPath:null,n}return t},e}(),f=i?1:void 0,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._formatted=null,t._fsPath=null,t}return o(t,e),Object.defineProperty(t.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=T(this)),this._fsPath},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){return void 0===e&&(e=!1),e?v(this,!0):(this._formatted||(this._formatted=v(this,!1)),this._formatted)},t.prototype.toJSON=function(){var e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=f),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e},t}(h),y=((r={})[58]="%3A",r[47]="%2F",r[63]="%3F",r[35]="%23",r[91]="%5B",r[93]="%5D",r[64]="%40",r[33]="%21",r[36]="%24",r[38]="%26",r[39]="%27",r[40]="%28",r[41]="%29",r[42]="%2A",r[43]="%2B",r[44]="%2C",r[59]="%3B",r[61]="%3D",r[32]="%20",r);function m(e,t){for(var n=void 0,s=-1,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||45===i||46===i||95===i||126===i||t&&47===i)-1!==s&&(n+=encodeURIComponent(e.substring(s,r)),s=-1),void 0!==n&&(n+=e.charAt(r));else{void 0===n&&(n=e.substr(0,r));var o=y[i];void 0!==o?(-1!==s&&(n+=encodeURIComponent(e.substring(s,r)),s=-1),n+=o):-1===s&&(s=r)}}return-1!==s&&(n+=encodeURIComponent(e.substring(s))),void 0!==n?n:e}function _(e){for(var t=void 0,n=0;n<e.length;n++){var s=e.charCodeAt(n);35===s||63===s?(void 0===t&&(t=e.substr(0,n)),t+=y[s]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function T(e){var t;return t=e.authority&&e.path.length>1&&"file"===e.scheme?"//"+e.authority+e.path:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?e.path[1].toLowerCase()+e.path.substr(2):e.path,i&&(t=t.replace(/\//g,"\\")),t}function v(e,t){var n=t?_:m,s="",r=e.scheme,i=e.authority,o=e.path,a=e.query,c=e.fragment;if(r&&(s+=r,s+=":"),(i||"file"===r)&&(s+=u,s+=u),i){var l=i.indexOf("@");if(-1!==l){var p=i.substr(0,l);i=i.substr(l+1),-1===(l=p.indexOf(":"))?s+=n(p,!1):(s+=n(p.substr(0,l),!1),s+=":",s+=n(p.substr(l+1),!1)),s+="@"}-1===(l=(i=i.toLowerCase()).indexOf(":"))?s+=n(i,!1):(s+=n(i.substr(0,l),!1),s+=i.substr(l))}if(o){if(o.length>=3&&47===o.charCodeAt(0)&&58===o.charCodeAt(2))(d=o.charCodeAt(1))>=65&&d<=90&&(o="/"+String.fromCharCode(d+32)+":"+o.substr(3));else if(o.length>=2&&58===o.charCodeAt(1)){var d;(d=o.charCodeAt(0))>=65&&d<=90&&(o=String.fromCharCode(d+32)+":"+o.substr(2))}s+=n(o,!0)}return a&&(s+="?",s+=n(a,!1)),c&&(s+="#",s+=t?c:m(c,!1)),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(6),r=n(20),i=n(19),o=n(50),a=n(14);t.ImportResolver=class{constructor(e,t){this._cachedPythonSearchPaths=new Map,this._cachedImportResults=new Map,this.fileSystem=e,this._configOptions=t}invalidateCache(){this._cachedPythonSearchPaths=new Map,this._cachedImportResults=new Map}resolveImport(e,t,n){const s=this._formatImportName(n),r=[];if(n.leadingDots>0){const t=this._resolveRelativeImport(e,n,s,r);if(t)return t.isRelative=!0,t}else{const i=this._lookUpResultsInCache(t,s,n.importedSymbols);if(i)return i;if(n.nameParts.length>0){const e=this._findTypeshedPath(t,n,s,!0,r);if(e)return e.isTypeshedFile=!0,this._addResultsToCache(t,s,e,n.importedSymbols)}let o;r.push("Looking in root directory of execution environment "+`'${t.root}'`);let a=this.resolveAbsoluteImport(t.root,n,s,r);if(a&&a.isImportFound)return this._addResultsToCache(t,s,a,n.importedSymbols);o=a;for(const e of t.extraPaths){if(r.push(`Looking in extraPath '${e}'`),a=this.resolveAbsoluteImport(e,n,s,r),a&&a.isImportFound)return this._addResultsToCache(t,s,a,n.importedSymbols);a&&(void 0===o||a.resolvedPaths.length>o.resolvedPaths.length)&&(o=a)}if(this._configOptions.typingsPath){r.push(`Looking in typingsPath '${this._configOptions.typingsPath}'`);const e=this.resolveAbsoluteImport(this._configOptions.typingsPath,n,s,r);if(e&&e.isImportFound)return e.importType=2,e.isLocalTypingsFile=!0,this._addResultsToCache(t,s,e,n.importedSymbols)}r.push("Looking for typeshed path");const c=this._findTypeshedPath(t,n,s,!1,r);if(c)return c.isTypeshedFile=!0,this._addResultsToCache(t,s,c,n.importedSymbols);const l=this._getPythonSearchPaths(t,r);if(l.length>0)for(const e of l){r.push(`Looking in python search path '${e}'`);const i=this.resolveAbsoluteImport(e,n,s,r,!0,!0,!0);if(i){if(i.importType=1,i.isImportFound&&i.isStubFile)return this._addResultsToCache(t,s,i,n.importedSymbols);(void 0===o||i.resolvedPaths.length>o.resolvedPaths.length)&&(o=i)}}else r.push("No python interpreter search path");const p=this.resolveImportEx(e,t,n,s,r);if(void 0!==p)return this._addResultsToCache(t,s,p,n.importedSymbols);if(o)return this._addResultsToCache(t,s,o,n.importedSymbols)}const i={importName:s,isRelative:!1,isImportFound:!1,importFailureInfo:r,resolvedPaths:[],importType:2,isStubFile:!1,isPydFile:!1,implicitImports:[]};return this._addResultsToCache(t,s,i,void 0)}resolveImportEx(e,t,n,s,r=[]){}getCompletionSuggestions(e,t,n,s){const r=[],i=[];if(n.leadingDots>0)this._getCompletionSuggestionsRelative(e,n,i,s);else{n.nameParts.length>0&&this._getCompletionSuggestionsTypeshedPath(t,n,!0,i,s),this._getCompletionSuggestionsAbsolute(t.root,n,i,s);for(const e of t.extraPaths)this._getCompletionSuggestionsAbsolute(e,n,i,s);this._configOptions.typingsPath&&this._getCompletionSuggestionsAbsolute(this._configOptions.typingsPath,n,i,s),this._getCompletionSuggestionsTypeshedPath(t,n,!1,i,s);const e=this._getPythonSearchPaths(t,r);for(const t of e)this._getCompletionSuggestionsAbsolute(t,n,i,s)}return i}getModuleNameForImport(e,t){let n,s=0;const r=[],i=this._getTypeshedPath(!0,t,r);if(i&&(n=this._getModuleNameFromPath(i,e,!0),n))return{moduleName:n,importType:s};n=this._getModuleNameFromPath(t.root,e);for(const r of t.extraPaths){const t=this._getModuleNameFromPath(r,e);(!n||t&&t.length<n.length)&&(n=t,s=2)}if(this._configOptions.typingsPath){const t=this._getModuleNameFromPath(this._configOptions.typingsPath,e);(!n||t&&t.length<n.length)&&(n=t,s=2)}const o=this._getTypeshedPath(!1,t,r);if(o){const t=this._getModuleNameFromPath(o,e,!0);(!n||t&&t.length<n.length)&&(n=t,s=1)}const a=this._getPythonSearchPaths(t,r);for(const t of a){const r=this._getModuleNameFromPath(t,e);(!n||r&&r.length<n.length)&&(n=r,s=1)}return n?{moduleName:n,importType:s}:{moduleName:"",importType:2}}_lookUpResultsInCache(e,t,n){const s=this._cachedImportResults.get(e.root);if(!s)return;const r=s.get(t);return r?this._filterImplicitImports(r,n):void 0}_addResultsToCache(e,t,n,s){let r=this._cachedImportResults.get(e.root);return r||(r=new Map,this._cachedImportResults.set(e.root,r)),r.set(t,n),this._filterImplicitImports(n,s)}_getModuleNameFromPath(e,t,n=!1){e=s.ensureTrailingDirectorySeparator(e);let r=s.stripFileExtension(t);if(!r.startsWith(e))return;r.endsWith("__init__")&&(r=r.substr(0,r.length-9));const i=r.substr(e.length),o=s.getPathComponents(i);if(o.shift(),n){if(0===o.length)return;o.shift()}return 0!==o.length?o.join("."):void 0}_getPythonSearchPaths(e,t){const n=e.venv?e.venv:"<default>";return this._cachedPythonSearchPaths.has(n)||this._cachedPythonSearchPaths.set(n,o.findPythonSearchPaths(this.fileSystem,this._configOptions,e.venv,t)||[]),this._cachedPythonSearchPaths.get(n)}_findTypeshedPath(e,t,n,i,o){o.push(`Looking for typeshed ${i?"stdlib":"third_party"} path`);const a=this._getTypeshedPath(i,e,o);if(!a)return;let c=255&e.pythonVersion;for(;;){const e=c>0?r.versionToString(768+c):0===c?"3":"2and3",l=s.combinePaths(a,e);if(this.fileSystem.existsSync(l)){const e=this.resolveAbsoluteImport(l,t,n,o);if(e&&e.isImportFound)return e.importType=i?0:1,e}if(-1===c)break;c--}o.push("Typeshed path not found")}_getCompletionSuggestionsTypeshedPath(e,t,n,i,o){const a=this._getTypeshedPath(n,e,[]);if(!a)return;let c=255&e.pythonVersion;for(;;){const e=c>0?r.versionToString(768+c):0===c?"3":"2and3",n=s.combinePaths(a,e);if(this.fileSystem.existsSync(n)&&this._getCompletionSuggestionsAbsolute(n,t,i,o),-1===c)break;c--}}_getTypeshedPath(e,t,n){if(e){if(void 0!==this._cachedTypeshedStdLibPath)return this._cachedTypeshedStdLibPath}else if(void 0!==this._cachedTypeshedThirdPartyPath)return this._cachedTypeshedThirdPartyPath;let r="";if(this._configOptions.typeshedPath){const e=this._configOptions.typeshedPath;this.fileSystem.existsSync(e)&&s.isDirectory(this.fileSystem,e)&&(r=e)}else{const e=this._getPythonSearchPaths(t,n);for(const t of e){const e=s.combinePaths(t,"typeshed");if(this.fileSystem.existsSync(e)&&s.isDirectory(this.fileSystem,e)){r=e;break}}}if(r||(r=o.getTypeShedFallbackPath(this.fileSystem)||""),r=o.getTypeshedSubdirectory(r,e),this.fileSystem.existsSync(r)&&s.isDirectory(this.fileSystem,r))return e?this._cachedTypeshedStdLibPath=r:this._cachedTypeshedThirdPartyPath=r,r}_resolveRelativeImport(e,t,n,r){r.push("Attempting to resolve relative import");let i=s.getDirectoryPath(e);for(let e=1;e<t.leadingDots;e++){if(""===i)return void r.push(`Invalid relative path '${n}'`);i=s.getDirectoryPath(i)}const o=this.resolveAbsoluteImport(i,t,n,r);if(o)return this._filterImplicitImports(o,t.importedSymbols)}_getCompletionSuggestionsRelative(e,t,n,r){let i=s.getDirectoryPath(e);for(let e=1;e<t.leadingDots;e++){if(""===i)return;i=s.getDirectoryPath(i)}this._getCompletionSuggestionsAbsolute(i,t,n,r)}resolveAbsoluteImport(e,t,n,r,i=!1,o=!1,a=!1){r.push(`Attempting to resolve using root path '${e}'`);const c=[];let l,p=e,u=!1,d=!1,h=!1,f=[];if(0===t.nameParts.length){const e=s.combinePaths(p,"__init__.py"),t=e+"i",n=e+"d";this.fileSystem.existsSync(t)&&s.isFile(this.fileSystem,t)?(r.push(`Resolved import with file '${t}'`),c.push(t),d=!0):this.fileSystem.existsSync(e)&&s.isFile(this.fileSystem,e)?(r.push(`Resolved import with file '${e}'`),c.push(e)):o&&this.fileSystem.existsSync(n)&&s.isFile(this.fileSystem,n)?(r.push(`Resolved import with file '${n}'`),c.push(n),h=!0):(r.push(`Partially resolved import with directory '${p}'`),c.push(""),u=!0),f=this._findImplicitImports(p,[e,t])}else for(let e=0;e<t.nameParts.length;e++){const n=e===t.nameParts.length-1;p=s.combinePaths(p,t.nameParts[e]);let i=!1;if(a){const e=p+"-stubs";i=this.fileSystem.existsSync(e)&&s.isDirectory(this.fileSystem,e),i&&(p=e)}if(i||(i=this.fileSystem.existsSync(p)&&s.isDirectory(this.fileSystem,p)),i){if(!n){c.push("");continue}const e=s.combinePaths(p,"__init__.py"),t=e+"i";let i=!1;if(this.fileSystem.existsSync(t)&&s.isFile(this.fileSystem,t)?(r.push(`Resolved import with file '${t}'`),c.push(t),n&&(d=!0),i=!0):this.fileSystem.existsSync(e)&&s.isFile(this.fileSystem,e)&&(r.push(`Resolved import with file '${e}'`),c.push(e),i=!0),i){f=this._findImplicitImports(p,[e,t]);break}}const l=s.stripTrailingDirectorySeparator(p)+".py",g=l+"i",y=l+"d";this.fileSystem.existsSync(g)&&s.isFile(this.fileSystem,g)?(r.push(`Resolved import with file '${g}'`),c.push(g),n&&(d=!0)):this.fileSystem.existsSync(l)&&s.isFile(this.fileSystem,l)?(r.push(`Resolved import with file '${l}'`),c.push(l)):o&&this.fileSystem.existsSync(y)&&s.isFile(this.fileSystem,y)?(r.push(`Resolved import with file '${y}'`),c.push(y),n&&(h=!0)):i?(r.push(`Partially resolved import with directory '${p}'`),c.push(""),n&&(f=this._findImplicitImports(p,[l,g]),u=!0)):r.push(`Did not find file '${g}',`+` '${l}' or '${y}'`);break}return i?l=c.length>0:(l=c.length>=t.nameParts.length,u&&0===f.length&&(l=!1)),{importName:n,isRelative:!1,isImportFound:l,importFailureInfo:r,importType:2,resolvedPaths:c,searchPath:e,isStubFile:d,isPydFile:h,implicitImports:f}}_getCompletionSuggestionsAbsolute(e,t,n,r){let i=e;const o=t.nameParts.map(e=>e);if(t.hasTrailingDot&&o.push(""),0===o.length)this._addFilteredSuggestions(i,"",n,r);else for(let e=0;e<o.length&&(e===o.length-1&&this._addFilteredSuggestions(i,o[e],n,r),i=s.combinePaths(i,o[e]),this.fileSystem.existsSync(i)&&s.isDirectory(this.fileSystem,i));e++);}_addFilteredSuggestions(e,t,n,r){const o=s.getFileSystemEntries(this.fileSystem,e);o.files.forEach(e=>{const o=s.stripFileExtension(e),a=s.getFileExtension(e);".py"!==a&&".pyi"!==a&&".pyd"!==a||"__init__"!==o&&(!t||i.computeCompletionSimilarity(t,o)>=r)&&this._addUniqueSuggestion(o,n)}),o.directories.forEach(e=>{t&&!e.startsWith(t)||this._addUniqueSuggestion(e,n)})}_addUniqueSuggestion(e,t){t.some(t=>t===e)||/[.-]/.test(e)||a.isDunderName(e)||t.push(e)}_filterImplicitImports(e,t){if(void 0===t){const t=Object.assign({},e);return t.implicitImports=[],t}if(0===t.length)return e;if(0===e.implicitImports.length)return e;const n=e.implicitImports.filter(e=>t.some(t=>t===e.name));if(n.length===e.implicitImports.length)return e;const s=Object.assign({},e);return s.implicitImports=n,s}_findImplicitImports(e,t){const n=new Map,r=s.getFileSystemEntries(this.fileSystem,e);for(const i of r.files)if(i.endsWith(".py")||i.endsWith(".pyi")){const r=s.combinePaths(e,i);if(!t.find(e=>e===r)){const e=s.stripFileExtension(i),t={isStubFile:i.endsWith(".pyi"),name:e,path:r},o=n.get(t.name);o&&o.isStubFile||n.set(t.name,t)}}for(const i of r.directories){const r=s.combinePaths(e,i,"__init__.py"),o=r+"i";let a=!1,c="";if(this.fileSystem.existsSync(o)&&s.isFile(this.fileSystem,o)?(a=!0,c=o):this.fileSystem.existsSync(r)&&s.isFile(this.fileSystem,r)&&(c=r),c&&!t.find(e=>e===c)){const e={isStubFile:a,name:i,path:c};n.set(e.name,e)}}return[...n.values()]}_formatImportName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+e.nameParts.map(e=>e).join(".")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(45),r=n(47),i=n(6),o=new Map;function a(e,t,n){const r=t||"",a=o.get(r);if(a)return a;const c={paths:[],prefix:""};try{const r=e.getModulePath();r&&e.chdir(r);const o=["-c","import sys, json; json.dump(dict(path=sys.path, prefix=sys.prefix), sys.stdout)"];let a;t?(n.push(`Executing interpreter at '${t}'`),a=s.execFileSync(t,o,{encoding:"utf8"})):(n.push("Executing python interpreter"),a=s.execFileSync("python",o,{encoding:"utf8"}));try{const t=JSON.parse(a);for(let s of t.path)if(s=s.trim(),s){const t=i.normalizePath(s);e.existsSync(t)&&i.isDirectory(e,t)?c.paths.push(t):n.push(`Skipping '${t}' because it is not a valid directory`)}c.prefix=t.prefix,0===c.paths.length&&n.push("Found no valid directories")}catch(e){throw n.push(`Could not parse output: '${a}'`),e}}catch(e){c.paths=[],c.prefix=""}return o.set(r,c),n.push(`Received ${c.paths.length} paths from interpreter`),c.paths.forEach(e=>{n.push(`  ${e}`)}),c}t.getTypeShedFallbackPath=function(e){let t=e.getModulePath();if(!t)return;t=i.getDirectoryPath(i.ensureTrailingDirectorySeparator(i.normalizePath(t)));const n=i.combinePaths(t,r.typeshedFallback);if(e.existsSync(n))return n;const s=i.combinePaths(i.getDirectoryPath(t),r.typeshedFallback);return e.existsSync(s)?s:void 0},t.getTypeshedSubdirectory=function(e,t){return i.combinePaths(e,t?"stdlib":"third_party")},t.findPythonSearchPaths=function(e,t,n,s,o,c){let l;if(s.push("Finding python search paths"),void 0!==n?t.venvPath&&(l=i.combinePaths(t.venvPath,n)):t.defaultVenv&&t.venvPath&&(l=i.combinePaths(t.venvPath,t.defaultVenv)),l){let t=i.combinePaths(l,r.lib);if(e.existsSync(t)?s.push(`Found path '${t}'; looking for ${r.sitePackages}`):(s.push(`Did not find '${t}'; trying 'Lib' instead`),t=i.combinePaths(l,"Lib"),e.existsSync(t)?s.push(`Found path '${t}'; looking for ${r.sitePackages}`):(s.push(`Did not find '${t}'`),t="")),t){const n=i.combinePaths(t,r.sitePackages);if(e.existsSync(n))return s.push(`Found path '${n}'`),[n];s.push(`Did not find '${n}', so looking for python subdirectory`);const o=i.getFileSystemEntries(e,t);for(let n=0;n<o.directories.length;n++){const a=o.directories[n];if(a.startsWith("python")){const n=i.combinePaths(t,a,r.sitePackages);if(e.existsSync(n))return s.push(`Found path '${n}'`),[n];s.push(`Path '${n}' is not a valid directory`)}}}s.push(`Did not find '${r.sitePackages}'. Falling back on python interpreter.`)}const p=a(e,t.pythonPath,s);if(o&&c){return p.paths.filter(e=>!i.containsPath(c,e,!0)||i.containsPath(p.prefix,e,!0))}return p.paths},t.getPythonPathFromPythonInterpreter=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(21),r=n(4);class i{constructor(e){this._diagnosticList=e||[],this._diagnosticMap=new Map}fetchAndClear(){const e=this._diagnosticList;return this._diagnosticList=[],this._diagnosticMap.clear(),e}addError(e,t){return this.addDiagnostic(new s.Diagnostic(0,e,t))}addWarning(e,t){return this.addDiagnostic(new s.Diagnostic(1,e,t))}addUnusedCode(e,t){return this.addDiagnostic(new s.Diagnostic(2,e,t))}addDiagnostic(e){const t=`${e.range.start.line},${e.range.start.character}-`+`${e.range.end.line}-${e.range.end.character}:${e.message.substr(0,25)}}`;return this._diagnosticMap.has(t)||(this._diagnosticList.push(e),this._diagnosticMap.set(t,e)),e}addDiagnostics(e){this._diagnosticList.push(...e)}getErrors(){return this._diagnosticList.filter(e=>0===e.category)}getWarnings(){return this._diagnosticList.filter(e=>1===e.category)}}t.DiagnosticSink=i;t.TextRangeDiagnosticSink=class extends i{constructor(e,t){super(t),this._lines=e}addErrorWithTextRange(e,t){return this.addError(e,r.convertOffsetsToRange(t.start,t.start+t.length,this._lines))}addWarningWithTextRange(e,t){return this.addWarning(e,r.convertOffsetsToRange(t.start,t.start+t.length,this._lines))}addUnusedCodeWithTextRange(e,t){return this.addUnusedCode(e,r.convertOffsetsToRange(t.start,t.start+t.length,this._lines))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(0);t.TextRangeCollection=class{constructor(e){this._items=e}get start(){return this._items.length>0?this._items[0].start:0}get end(){const e=this._items[this._items.length-1];return this._items.length>0?e.start+e.length:0}get length(){return this.end-this.start}get count(){return this._items.length}contains(e){return e>=this.start&&e<this.end}getItemAt(e){if(e<0||e>=this._items.length)throw new Error("index is out of range");return this._items[e]}getItemAtPosition(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<n;){const s=Math.floor(t+(n-t)/2),r=this._items[s];if(e>=r.start&&(s>=this.count-1||e<this._items[s+1].start))return s;e<r.start?n=s-1:t=s+1}return t}getItemContaining(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<=n;){const r=Math.floor(t+(n-t)/2),i=this._items[r];if(s.TextRange.contains(i,e))return r;if(r<this.count-1&&s.TextRange.getEnd(i)<=e&&e<this._items[r+1].start)return-1;e<i.start?n=r-1:t=r+1}return-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDocStringToMarkdown=function(e){return new E(e).convert()};const s=/\S|$/,r=/\r?\n/,i=/\S/,o=/^\s*~~~+$/,a=/^\s*\+\+\++$/,c=/^(\s+\* )(.*)$/,l=/^\s*\.\. /,p=/^\s*\.\.\s+(\w+)::\s*(.*)$/,u=/ *>>> /,d=/^\s*:(param|arg|type|return|rtype|raise|except|var|ivar|cvar|copyright|license)/,h=[{exp:/^\s*=+(\s+=+)+$/,replacement:"="},{exp:/^\s*-+(\s+-+)+$/,replacement:"-"},{exp:/^\s*~+(\s+-+)+$/,replacement:"~"},{exp:/^\s*\++(\s+\++)+$/,replacement:"+"}],f=/\s/g,g=/``/g,y=/\t/g,m=/~/g,_=/\+/g,T=/(?<!\\)([_*~[\]])/g,v=/^\s*::$/,b=[{exp:/\s+::$/g,replacement:""},{exp:/(\S)\s*::$/g,replacement:"$1:"},{exp:/:[\w_\-+:.]+:`/g,replacement:"`"},{exp:/`:[\w_\-+:.]+:/g,replacement:"`"}];class E{constructor(e){this._builder="",this._skipAppendEmptyLine=!0,this._insideInlineCode=!1,this._appendDirectiveBlock=!1,this._stateStack=[],this._lineNum=0,this._blockIndent=0,this._state=this._parseText,this._lines=function(e){let t=(e=e.replace(y," ".repeat(8))).split(r).map(e=>e.trimRight());if(t.length>0){let e=t[0].trimLeft();""===e?e=void 0:t.splice(0,1),t=function(e,t){const n=void 0===t?function(e){const t=e.filter(e=>!k(e)).map(C);return t.length>0?Math.min(...t):0}(e):t;return e.map(e=>n>e.length?"":e.substr(n))}(t),void 0!==e&&t.splice(0,0,e)}return t}(e)}convert(){for(;void 0!==this._currentLineOrUndefined();){const e=this._state,t=this._lineNum;if(this._state(),this._state===e&&this._lineNum===t)break}return this._state===this._parseBacktickBlock||this._state===this._parseDocTest||this._state===this._parseLiteralBlock?this._trimOutputAndAppendLine("```"):this._insideInlineCode&&this._trimOutputAndAppendLine("`",!0),this._builder.trim()}_eatLine(){this._lineNum++}_currentLineOrUndefined(){return this._lineNum<this._lines.length?this._lines[this._lineNum]:void 0}_currentLine(){return this._currentLineOrUndefined()||""}_currentIndent(){return C(this._currentLine())}_lineAt(e){return e<this._lines.length?this._lines[e]:void 0}_nextBlockIndent(){return C(this._lines.slice(this._lineNum+1).find(e=>!k(e))||"")}_currentLineIsOutsideBlock(){return this._currentIndent()<this._blockIndent}_currentLineWithinBlock(){return this._currentLine().substr(this._blockIndent)}_pushAndSetState(e){this._state===this._parseText&&(this._insideInlineCode=!1),this._stateStack.push(this._state),this._state=e}_popState(){this._state=this._stateStack.splice(0,1)[0],this._state===this._parseText&&(this._insideInlineCode=!1)}_parseText(){k(this._currentLineOrUndefined())?this._state=this._parseEmpty:this._beginBacktickBlock()||this._beginLiteralBlock()||this._beginDocTest()||this._beginDirective()||(this._appendTextLine(this._currentLine()),this._eatLine())}_appendTextLine(e){e=this._preprocessTextLine(e),!this._insideInlineCode&&d.test(e)&&this._appendLine();const t=e.split("`");for(let e=0;e<t.length;e++){let n=t[e];if(e>0&&(this._insideInlineCode=!this._insideInlineCode,this._append("`")),this._insideInlineCode)this._append(n);else{if(0===e){if(1===t.length){for(const e of h)if(e.exp.test(n)){n=n.replace(f,e.replacement);break}if(o.test(n)){this._append(n.replace(m,"-"));continue}if(a.test(n)){this._append(n.replace(_,"-"));continue}}const e=c.exec(n);null!==e&&3===e.length&&(this._append(e[1]),n=e[2])}n=n.replace(T,"\\$1"),this._append(n)}}this._builder+="\n"}_preprocessTextLine(e){return v.test(e)?"":(b.forEach(t=>e=e.replace(t.exp,t.replacement)),e=e.replace(g,"`"))}_parseEmpty(){if(k(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();this._state=this._parseText}_beginMinIndentCodeBlock(e){this._appendLine("```"),this._pushAndSetState(e),this._blockIndent=this._currentIndent()}_beginBacktickBlock(){return!!this._currentLine().startsWith("```")&&(this._appendLine(this._currentLine()),this._pushAndSetState(this._parseBacktickBlock),this._eatLine(),!0)}_parseBacktickBlock(){this._currentLine().startsWith("```")?(this._appendLine("```"),this._appendLine(),this._popState()):this._appendLine(this._currentLine()),this._eatLine()}_beginDocTest(){return!!u.test(this._currentLine())&&(this._beginMinIndentCodeBlock(this._parseDocTest),this._appendLine(this._currentLineWithinBlock()),this._eatLine(),!0)}_parseDocTest(){if(this._currentLineIsOutsideBlock()||k(this._currentLine()))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLineWithinBlock()),this._eatLine()}_beginLiteralBlock(){const e=this._lineAt(this._lineNum-1);if(void 0===e)return!1;if(!k(e))return!1;let t=this._lineNum-2;for(;t>=0;t--){const e=this._lineAt(t);if(!k(e)){if(e.endsWith("::"))break;return!1}}return!(t<0)&&(0===this._currentIndent()?(this._appendLine("```"),this._pushAndSetState(this._parseLiteralBlockSingleLine),!0):(this._beginMinIndentCodeBlock(this._parseLiteralBlock),!0))}_parseLiteralBlock(){return k(this._currentLineOrUndefined())?(this._appendLine(),void this._eatLine()):this._currentLineIsOutsideBlock()?(this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState()):(this._appendLine(this._currentLineWithinBlock()),void this._eatLine())}_parseLiteralBlockSingleLine(){this._appendLine(this._currentLine()),this._appendLine("```"),this._appendLine(),this._popState(),this._eatLine()}_beginDirective(){return!!l.test(this._currentLine())&&(this._pushAndSetState(this._parseDirective),this._blockIndent=this._nextBlockIndent(),this._appendDirectiveBlock=!1,!0)}_parseDirective(){const e=p.exec(this._currentLine());if(null!==e&&3===e.length){const t=e[1],n=e[2];"class"===t&&(this._appendDirectiveBlock=!0,this._appendLine(),this._appendLine("```"),this._appendLine(n),this._appendLine("```"),this._appendLine())}0===this._blockIndent?this._popState():this._state=this._parseDirectiveBlock,this._eatLine()}_parseDirectiveBlock(){k(this._currentLineOrUndefined())||!this._currentLineIsOutsideBlock()?(this._appendDirectiveBlock&&this._appendTextLine(this._currentLine().trimLeft()),this._eatLine()):this._popState()}_appendLine(e){k(e)?this._skipAppendEmptyLine||(this._builder+="\n",this._skipAppendEmptyLine=!0):(this._builder+=e+"\n",this._skipAppendEmptyLine=!1)}_append(e){this._builder+=e,this._skipAppendEmptyLine=!1}_trimOutputAndAppendLine(e,t=!1){this._builder=this._builder.trimRight(),this._skipAppendEmptyLine=!1,t||this._appendLine(),this._appendLine(e)}}function C(e){return e.search(s)}function k(e){return void 0===e||!i.test(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeDocString=function(e){const t=e.replace(/\r/g,"").replace(/\t/g,"        ").split("\n");let n=Number.MAX_VALUE;t.forEach((e,s)=>{if(t.length<=1||s>0){const t=e.trimLeft();t&&(n=Math.min(n,e.length-t.length))}});const s=[];for(n<Number.MAX_VALUE&&t.forEach((e,t)=>{0===t?s.push(e.trimRight()):s.push(e.substr(n).trimRight())});s.length>0&&0===s[0].length;)s.shift();for(;s.length>0&&0===s[s.length-1].length;)s.pop();return s.join("\n")},t.extractParameterDocumentation=function(e,t){if(!e||!t)return;const n=e.split("\n");for(const e of n){const n=e.trim();let s=n.indexOf("@param "+t);if(s>=0)return n.substr(s+7);if(s=n.indexOf(":param "+t),s>=0)return n.substr(s+7);if(s=n.indexOf(t+": "),s>=0)return n.substr(s);if(s=n.indexOf(t+" ("),s>=0)return n.substr(s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1);class r{constructor(){this._isLocked=!1,this._typeMap=new Map,this._isNarrowableMap=new Map}clone(){const e=new r;return this._typeMap.forEach((t,n)=>{e.set(n,t,this.isNarrowable(n))}),e._isLocked=this._isLocked,e}has(e){return this._typeMap.has(e)}get(e){return this._typeMap.get(e)}forEach(e){return this._typeMap.forEach(e)}set(e,t,n){s.assert(!this._isLocked),this._typeMap.set(e,t),this._isNarrowableMap.set(e,n)}size(){return this._typeMap.size}isNarrowable(e){const t=this._isNarrowableMap.get(e);return void 0===t||t}lock(){s.assert(!this._isLocked),this._isLocked=!0}isLocked(){return this._isLocked}}t.TypeVarMap=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(10),r=n(53),i=n(8),o=n(16),a=n(17),c=n(3),l=n(4),p=n(0);t.HoverProvider=class{static getHoverForPosition(e,t,n,s){c.throwIfCancellationRequested(s);const r=l.convertPositionToOffset(t,e.tokenizerOutput.lines);if(void 0===r)return;const a=i.findNodeByOffset(e.parseTree,r);if(void 0===a)return;const u={parts:[],range:{start:l.convertOffsetToPosition(a.start,e.tokenizerOutput.lines),end:l.convertOffsetToPosition(p.TextRange.getEnd(a),e.tokenizerOutput.lines)}};if(39===a.nodeType){const e=n.getDeclarationsForNameNode(a);if(e&&e.length>0)this._addResultsForDeclaration(u.parts,e[0],a,n);else if((!a.parent||38!==a.parent.nodeType)&&0===u.parts.length){const e=n.getType(a)||o.UnknownType.create();let t="";t=9===e.category?"(module) "+a.value:a.value+": "+n.printType(e),this._addResultsPart(u.parts,t,!0),this._addDocumentationPart(u.parts,a,n)}}return u.parts.length>0?u:void 0}static _addResultsForDeclaration(e,t,n,s){const r=s.resolveAliasDeclaration(t);if(r)switch(r.type){case 0:this._addResultsPart(e,n.value+this._getTypeText(n,s),!0),this._addDocumentationPart(e,n,s);break;case 1:{const t=r.isConstant||r.isFinal?"constant":"variable";this._addResultsPart(e,`(${t}) `+n.value+this._getTypeText(n,s),!0),this._addDocumentationPart(e,n,s);break}case 2:this._addResultsPart(e,"(parameter) "+n.value+this._getTypeText(n,s),!0),this._addDocumentationPart(e,n,s);break;case 4:case 5:{let t=n.value,r=n;if(r.parent&&36===r.parent.nodeType&&n===r.parent.memberName&&(r=n.parent),r&&r.parent&&9===r.parent.nodeType&&r.parent.leftExpression===r){const e=s.getType(n);if(e&&7===e.category){const n=a.lookUpClassMember(e,"__init__",12);if(n){const e=s.getTypeOfMember(n);if(e&&5===e.category){t+=`(${s.printFunctionParts(e)[0].join(", ")})`}}}}this._addResultsPart(e,"(class) "+t,!0),this._addDocumentationPart(e,n,s);break}case 3:{let t="function";if(r.isMethod){const e=s.getTypeForDeclaration(r);t=e&&a.isProperty(e)?"property":"method"}this._addResultsPart(e,`(${t}) `+n.value+this._getTypeText(n,s),!0),this._addDocumentationPart(e,n,s);break}case 6:this._addResultsPart(e,"(module) "+n.value,!0),this._addDocumentationPart(e,n,s)}else this._addResultsPart(e,"(import) "+n.value+this._getTypeText(n,s),!0)}static _getTypeText(e,t){const n=t.getType(e)||o.UnknownType.create();return": "+t.printType(n)}static _addDocumentationPart(e,t,n){const s=n.getType(t);s&&this._addDocumentationPartForType(e,s)}static _addDocumentationPartForType(e,t){9===t.category?this._addDocumentationResultsPart(e,t.docString):7===t.category||5===t.category?this._addDocumentationResultsPart(e,t.details.docString):6===t.category&&t.overloads.forEach(t=>{this._addDocumentationResultsPart(e,t.details.docString)})}static _addDocumentationResultsPart(e,t){t&&this._addResultsPart(e,r.convertDocStringToMarkdown(t))}static _addResultsPart(e,t,n=!1){e.push({python:n,text:t})}},t.convertHoverResults=function(e){if(!e)return;const t=e.parts.map(e=>e.python?"```python\n"+e.text+"\n```\n":e.text).join("");return{contents:{kind:s.MarkupKind.Markdown,value:t},range:e.range}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1),r=n(21),i=n(51),o=n(4),a=n(20),c=n(27),l=n(22),p=n(58),u=n(109),d=n(60);class h{constructor(){this.isStubFile=!1,this.pythonVersion=a.latestStablePythonVersion}}t.ParseOptions=h;class f{constructor(){this._tokenIndex=0,this._parseOptions=new h,this._diagSink=new i.DiagnosticSink,this._isInLoop=!1,this._isInFinally=!1,this._isParsingTypeAnnotation=!1,this._isParsingIndexTrailer=!1,this._futureImportMap=new Map,this._importedModules=[],this._containsWildcardImport=!1,this._assignmentExpressionsAllowed=!0}parseSourceFile(e,t,n){c.timingStats.tokenizeFileTime.timeOperation(()=>{this._startNewParse(e,0,e.length,t,n)});const r=l.ModuleNode.create({start:0,length:e.length});return c.timingStats.parseFileTime.timeOperation(()=>{for(;!this._atEof();)if(!this._consumeTokenIfType(2)){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError("Inconsistent use of tabs and spaces in indentation",t):this._addError("Unexpected indentation",e)}const t=this._parseStatement();t?(t.parent=r,r.statements.push(t)):this._consumeTokensUntilType(2)}}),s.assert(void 0!==this._tokenizerOutput),{text:e,parseTree:r,importedModules:this._importedModules,futureImports:this._futureImportMap,tokenizerOutput:this._tokenizerOutput,containsWildcardImport:this._containsWildcardImport}}parseTextExpression(e,t,n,s,r){const o=new i.DiagnosticSink;let a;return this._startNewParse(e,t,n,s,o),r?this._parseTypeAnnotation(()=>{a=this._parseAtomExpression()}):a=this._parseTestExpression(!1),2===this._peekTokenType()&&this._getNextToken(),this._atEof()||this._addError("Unexpected token at end of expression",this._peekToken()),{parseTree:a,lines:this._tokenizerOutput.lines,diagnostics:o.fetchAndClear()}}_startNewParse(e,t,n,s,r){this._fileContents=e,this._parseOptions=s,this._diagSink=r;const i=new u.Tokenizer;this._tokenizerOutput=i.tokenize(e,t,n),this._tokenIndex=0}_parseStatement(){switch(this._consumeTokenIfType(4)&&this._addError("Unindent not expected",this._peekToken()),this._peekKeywordType()){case 19:return this._parseIfStatement();case 33:return this._parseWhileStatement();case 16:return this._parseForStatement();case 32:return this._parseTryStatement();case 34:return this._parseWithStatement();case 9:return this._parseFunctionDef();case 6:return this._parseClassDef();case 3:return this._parseAsyncStatement()}return 21===this._peekOperatorType()?this._parseDecorated():this._parseSimpleStatement()}_parseAsyncStatement(){const e=this._getKeywordToken(3);switch(this._peekKeywordType()){case 9:return this._parseFunctionDef(e);case 34:return this._parseWithStatement(e);case 16:return this._parseForStatement(e)}this._addError('Expected "def", "with" or "for" to follow "async"',e)}_parseIfStatement(e=19){const t=this._getKeywordToken(e),n=this._parseTestExpression(!0),s=this._parseSuite(),r=l.IfNode.create(t,n,s);return this._consumeTokenIfKeyword(12)?(r.elseSuite=this._parseSuite(),r.elseSuite.parent=r,l.extendRange(r,r.elseSuite)):11===this._peekKeywordType()&&(r.elseSuite=this._parseIfStatement(11),r.elseSuite.parent=r,l.extendRange(r,r.elseSuite)),r}_parseLoopSuite(){const e=this._isInLoop,t=this._isInFinally;this._isInLoop=!0,this._isInFinally=!1;const n=this._parseSuite();return this._isInLoop=e,this._isInFinally=t,n}_parseSuite(){const e=this._peekToken(),t=l.SuiteNode.create(e);if(!this._consumeTokenIfType(10))return this._addError('Expected ":"',e),t;if(this._consumeTokenIfType(2)){const e=this._peekToken();if(this._consumeTokenIfType(3)){const t=e;t.isIndentAmbiguous&&this._addError("Inconsistent use of tabs and spaces in indentation",t)}else this._addError("Expected indented block",this._peekToken());for(;;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError("Inconsistent use of tabs and spaces in indentation",t):this._addError("Indent not expected",e)}const n=this._parseStatement();n?(n.parent=t,t.statements.push(n)):this._consumeTokensUntilType(2);const s=this._peekToken();if(this._consumeTokenIfType(4)){s.matchesIndent||this._addError("Unindent amount does not match previous indent",s);break}if(1===this._peekTokenType())break}}else{const e=this._parseSimpleStatement();t.statements.push(e),e.parent=t}return t.statements.length>0&&l.extendRange(t,t.statements[t.statements.length-1]),t}_parseForStatement(e){const t=this._getKeywordToken(16),n=this._parseExpressionList(!0),s=this._makeExpressionOrTuple(n);let r,i,o;this._consumeTokenIfKeyword(21)?(r=this._parseTestListAsExpression(2,'Expected expression after "in"'),i=this._parseLoopSuite(),this._consumeTokenIfKeyword(12)&&(o=this._parseSuite())):(r=this._handleExpressionParseError(0,'Expected "in"'),i=l.SuiteNode.create(this._peekToken()));const a=l.ForNode.create(t,s,r,i);return a.elseSuite=o,o&&(l.extendRange(a,o),o.parent=a),e&&(a.isAsync=!0,l.extendRange(a,e)),a}_tryParseListComprehension(e){const t=this._tryParseCompForStatement();if(!t)return;const n=l.ListComprehensionNode.create(e),s=[t];for(;;){const e=this._tryParseCompForStatement()||this._tryParseCompIfStatement();if(!e)break;e.parent=n,s.push(e)}return n.comprehensions=s,s.length>0&&(s.forEach(e=>{e.parent=n}),l.extendRange(n,s[s.length-1])),n}_tryParseCompForStatement(){const e=this._peekKeywordType();if(3===e){const e=this._peekToken(1);if(8!==e.type||16!==e.keywordType)return}else if(16!==e)return;let t;3===this._peekKeywordType()&&(t=this._getKeywordToken(3));const n=this._getKeywordToken(16),s=this._parseExpressionList(!0),r=this._makeExpressionOrTuple(s);let i;this._consumeTokenIfKeyword(21)?this._disallowAssignmentExpression(()=>{i=this._parseOrTest()}):i=this._handleExpressionParseError(0,'Expected "in"');const o=l.ListComprehensionForNode.create(t||n,r,i);return t&&(o.isAsync=!0),o}_tryParseCompIfStatement(){if(19!==this._peekKeywordType())return;const e=this._getKeywordToken(19),t=this._tryParseLambdaExpression()||this._parseAssignmentExpression();return l.ListComprehensionIfNode.create(e,t)}_parseWhileStatement(){const e=this._getKeywordToken(33),t=l.WhileNode.create(e,this._parseTestExpression(!0),this._parseLoopSuite());return this._consumeTokenIfKeyword(12)&&(t.elseSuite=this._parseSuite(),t.elseSuite.parent=t,l.extendRange(t,t.elseSuite)),t}_parseTryStatement(){const e=this._getKeywordToken(32),t=this._parseSuite(),n=l.TryNode.create(e,t);let s=!1;for(;;){const e=this._peekToken();if(!this._consumeTokenIfKeyword(13))break;let t,r;if(10!==this._peekTokenType())if(t=this._parseTestExpression(!0),this._consumeTokenIfKeyword(1))r=this._getTokenIfIdentifier(),r||this._addError('Expected symbol name after "as"',this._peekToken());else{const e=this._peekToken();this._consumeTokenIfType(12)&&(this._addError('Expected "as" after exception type',e),this._parseTestExpression(!1))}t?s&&this._addError("A named except clause cannot appear after catch-all except clause",t):(s&&this._addError("Only one catch-all except clause is allowed",e),s=!0);const i=this._parseSuite(),o=l.ExceptNode.create(e,i);t&&(o.typeExpression=t,o.typeExpression.parent=o),r&&(o.name=l.NameNode.create(r),o.name.parent=o),n.exceptClauses.push(o),o.parent=n}return n.exceptClauses.length>0&&(l.extendRange(n,n.exceptClauses[n.exceptClauses.length-1]),this._consumeTokenIfKeyword(12)&&(n.elseSuite=this._parseSuite(),n.elseSuite.parent=n,l.extendRange(n,n.elseSuite))),this._consumeTokenIfKeyword(15)&&(n.finallySuite=this._parseSuite(),n.finallySuite.parent=n,l.extendRange(n,n.finallySuite)),n}_parseFunctionDef(e,t){const n=this._getKeywordToken(9),s=this._getTokenIfIdentifier();if(!s)return this._addError('Expected function name after "def"',n),l.ErrorNode.create(n,10);if(!this._consumeTokenIfType(13))return this._addError('Expected "("',this._peekToken()),l.ErrorNode.create(s,10,l.NameNode.create(s));const r=this._parseVarArgsList(14,!0);let i;this._consumeTokenIfType(14)||(this._addError('Expected ")"',this._peekToken()),this._consumeTokensUntilType(10)),this._consumeTokenIfType(21)&&this._parseTypeAnnotation(()=>{i=this._parseAtomExpression()});const o=this._parseSuite(),a=l.FunctionNode.create(n,l.NameNode.create(s),o);return e&&(a.isAsync=!0,l.extendRange(a,e)),a.parameters=r,r.forEach(e=>{e.parent=a}),t&&(a.decorators=t,t.forEach(e=>{e.parent=a}),t.length>0&&l.extendRange(a,t[0])),i&&(a.returnTypeAnnotation=i,a.returnTypeAnnotation.parent=a,l.extendRange(a,i)),a}_parseVarArgsList(e,t){const n=new Map,s=[];let r=!1,i=!1,o=!1,a=!1,c=!1,l=!1;for(;this._peekTokenType()!==e;){const p=this._parseParameter(t);if(!p){this._consumeTokensUntilType(e);break}if(p.name){const e=p.name.value;n.set(e,e)||this._addError(`Duplicate parameter "${e}"`,p.name)}if(0===p.category&&(p.name?p.defaultValue?r=!0:r&&!o&&(i||(this._addError("Non-default argument follows default argument",p),i=!0)):(a?this._addError('Only one "/" parameter is allowed',p):o&&this._addError('"/" parameter must appear before "*" parameter',p),a=!0)),s.push(p),1===p.category&&(p.name?(c&&this._addError('Only one "*" parameter is allowed',p),c=!0):(o&&this._addError('Only one "*" separator is allowed',p),o=!0)),2===p.category?(l&&this._addError('Only one "**" parameter is allowed',p),l=!0):l&&this._addError('Parameter cannot follow "**" parameter',p),!this._consumeTokenIfType(12))break}if(s.length>0){const e=s[s.length-1];1!==e.category||e.name||this._addError('Named argument must follow "*"',e)}return s}_parseParameter(e){let t=0,n=0;const s=this._peekToken();this._consumeTokenIfOperator(25)?t=1:this._consumeTokenIfOperator(28)?t=2:this._consumeTokenIfOperator(10)&&(this._getLanguageVersion()<a.PythonVersion.V38&&this._addError("Position-only argument separator requires Python 3.8 or greater",s),n=1);const r=this._getTokenIfIdentifier();if(!r){if(1===t){return l.ParameterNode.create(s,1)}if(1===n){return l.ParameterNode.create(s,0)}if(13===this._peekTokenType()){const e=this._getNextToken();this._consumeTokensUntilType(14)&&this._getNextToken(),this._addError("Sublist parameters are not supported in Python 3.x",e)}else this._addError("Expected parameter name",this._peekToken())}let i=0;1===t?i=1:2===t&&(i=2);const o=l.ParameterNode.create(s,i);return r&&(o.name=l.NameNode.create(r),o.name.parent=o,l.extendRange(o,r)),e&&this._consumeTokenIfType(10)&&this._parseTypeAnnotation(()=>{o.typeAnnotation=this._parseAtomExpression(),o.typeAnnotation.parent=o,l.extendRange(o,o.typeAnnotation)}),this._consumeTokenIfOperator(2)&&(o.defaultValue=this._parseTestExpression(!1),o.defaultValue.parent=o,l.extendRange(o,o.defaultValue),t>0&&this._addError('Parameter with "*" or "**" cannot have default value',o.defaultValue)),o}_parseWithStatement(e){const t=this._getKeywordToken(34),n=[];for(;n.push(this._parseWithItem()),this._consumeTokenIfType(12););const s=this._parseSuite(),r=l.WithNode.create(t,s);return e&&(r.isAsync=!0,l.extendRange(r,e)),r.withItems=n,n.forEach(e=>{e.parent=r}),r}_parseWithItem(){const e=this._parseTestExpression(!0),t=l.WithItemNode.create(e);return this._consumeTokenIfKeyword(1)&&(t.target=this._parseExpression(!1),t.target.parent=t,l.extendRange(t,t.target)),t}_parseDecorated(){const e=[];for(;21===this._peekOperatorType();)e.push(this._parseDecorator());const t=this._peekToken();if(8===t.type)if(3===t.keywordType){if(this._getNextToken(),9===this._peekKeywordType())return this._parseFunctionDef(t,e);this._addError('Expected function definition after "async"',this._peekToken())}else{if(9===t.keywordType)return this._parseFunctionDef(void 0,e);if(6===t.keywordType)return this._parseClassDef(e)}return this._addError("Expected function or class declaration after decorator",this._peekToken()),l.ClassNode.createDummyForDecorators(e)}_parseDecorator(){const e=this._getNextToken();let t;for(s.assert(21===e.operatorType);;){const e=this._getTokenIfIdentifier();if(!e){this._addError("Expected decorator name",this._peekToken()),t=t?l.ErrorNode.create(this._peekToken(),7,t):l.ErrorNode.create(this._peekToken(),4);break}const n=l.NameNode.create(e);if(t=t?l.MemberAccessNode.create(t,n):n,!this._consumeTokenIfType(20))break}const n=l.DecoratorNode.create(e,t);if(this._consumeTokenIfType(13)){n.arguments=this._parseArgList(),n.arguments.forEach(e=>{e.parent=n,l.extendRange(n,e)});const e=this._peekToken();this._consumeTokenIfType(14)?l.extendRange(n,e):this._addError('Expected ")"',this._peekToken())}return this._consumeTokenIfType(2)||(this._addError("Expected new line at end of decorator",this._peekToken()),this._consumeTokensUntilType(2)),n}_parseClassDef(e){const t=this._getKeywordToken(6);let n=this._getTokenIfIdentifier();n||(this._addError("Expected class name",this._peekToken()),n=d.IdentifierToken.create(0,0,"",void 0));let s=[];this._consumeTokenIfType(13)&&(s=this._parseArgList(),this._consumeTokenIfType(14)||this._addError('Expected ")"',this._peekToken()));const r=this._parseSuite(),i=l.ClassNode.create(t,l.NameNode.create(n),r);return i.arguments=s,s.forEach(e=>{e.parent=i}),e&&(i.decorators=e,e.length>0&&(e.forEach(e=>{e.parent=i}),l.extendRange(i,e[0]))),i}_parsePassStatement(){return l.PassNode.create(this._getKeywordToken(28))}_parseBreakStatement(){const e=this._getKeywordToken(5);return this._isInLoop||this._addError('"break" can be used only within a loop',e),l.BreakNode.create(e)}_parseContinueStatement(){const e=this._getKeywordToken(7);return this._isInLoop?this._isInFinally&&this._addError('"continue" cannot be used within a finally clause',e):this._addError('"continue" can be used only within a loop',e),l.ContinueNode.create(e)}_parseReturnStatement(){const e=this._getKeywordToken(30),t=l.ReturnNode.create(e);if(!this._isNextTokenNeverExpression()){const e=this._parseTestOrStarListAsExpression(!0,2,'Expected expression after "return"');this._reportConditionalErrorForStarTupleElement(e),t.returnExpression=e,t.returnExpression.parent=t,l.extendRange(t,e)}return t}_parseFromStatement(){const e=this._getKeywordToken(17),t=this._parseDottedModuleName(!0),n=l.ImportFromNode.create(e,t),s=0===t.leadingDots&&1===t.nameParts.length&&"__future__"===t.nameParts[0].value,r=this._peekToken();if(this._consumeTokenIfKeyword(20)){l.extendRange(n,r);const e=this._peekToken();if(this._consumeTokenIfOperator(25))l.extendRange(n,e),n.isWildcardImport=!0,this._containsWildcardImport=!0;else{const e=this._consumeTokenIfType(13);for(;;){const e=this._getTokenIfIdentifier();if(!e)break;const t=l.ImportFromAsNode.create(l.NameNode.create(e));if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(t.alias=l.NameNode.create(e),t.alias.parent=t,l.extendRange(t,e)):this._addError("Expected alias symbol name",this._peekToken())}if(n.imports.push(t),t.parent=n,l.extendRange(n,t),s&&this._futureImportMap.set(e.value,!0),!this._consumeTokenIfType(12))break}if(0===n.imports.length&&this._addError("Expected one or more symbol names after import",this._peekToken()),e){n.usesParens=!0;const e=this._peekToken();this._consumeTokenIfType(14)?l.extendRange(n,e):this._addError('Expected ")"',this._peekToken())}}}else this._addError('Expected "import"',this._peekToken()),t.hasTrailingDot||(n.missingImportKeyword=!0);return this._importedModules.push({nameNode:n.module,leadingDots:n.module.leadingDots,nameParts:n.module.nameParts.map(e=>e.value),importedSymbols:n.imports.map(e=>e.name.value)}),n}_parseImportStatement(){const e=this._getKeywordToken(20),t=l.ImportNode.create(e);for(;;){const e=this._parseDottedModuleName(),n=l.ImportAsNode.create(e);if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(n.alias=l.NameNode.create(e),n.alias.parent=n,l.extendRange(n,n.alias)):this._addError('Expected identifier after "as"',this._peekToken())}if(t.list.push(n),n.parent=t,this._importedModules.push({nameNode:n.module,leadingDots:n.module.leadingDots,nameParts:n.module.nameParts.map(e=>e.value),importedSymbols:void 0}),!this._consumeTokenIfType(12))break}return t.list.length>0&&l.extendRange(t,t.list[t.list.length-1]),t}_parseDottedModuleName(e=!1){const t=l.ModuleNameNode.create(this._peekToken());for(;;)if(this._consumeTokenIfType(19))t.leadingDots+=3;else{if(!this._consumeTokenIfType(20))break;t.leadingDots++}for(;;){const n=this._getTokenIfIdentifier([20]);if(!n){e&&0!==t.leadingDots||(this._addError("Expected module name",this._peekToken()),t.hasTrailingDot=!0);break}const s=l.NameNode.create(n);t.nameParts.push(s),s.parent=t,l.extendRange(t,s);const r=this._peekToken();if(!this._consumeTokenIfType(20))break;l.extendRange(t,r)}return t}_parseGlobalStatement(){const e=this._getKeywordToken(18),t=l.GlobalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach(e=>{e.parent=t}),l.extendRange(t,t.nameList[t.nameList.length-1])),t}_parseNonlocalStatement(){const e=this._getKeywordToken(25),t=l.NonlocalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach(e=>{e.parent=t}),l.extendRange(t,t.nameList[t.nameList.length-1])),t}_parseNameList(){const e=[];for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError("Expected identifier",this._peekToken());break}if(e.push(l.NameNode.create(t)),!this._consumeTokenIfType(12))break}return e}_parseRaiseStatement(){const e=this._getKeywordToken(29),t=l.RaiseNode.create(e);return this._isNextTokenNeverExpression()||(t.typeExpression=this._parseTestExpression(!0),t.typeExpression.parent=t,l.extendRange(t,t.typeExpression),this._consumeTokenIfKeyword(17)?(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,l.extendRange(t,t.valueExpression)):this._consumeTokenIfType(12)&&(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,l.extendRange(t,t.valueExpression),this._consumeTokenIfType(12)&&(t.tracebackExpression=this._parseTestExpression(!0),t.tracebackExpression.parent=t,l.extendRange(t,t.tracebackExpression)))),t}_parseAssertStatement(){const e=this._getKeywordToken(2),t=this._parseTestExpression(!0),n=l.AssertNode.create(e,t);if(this._consumeTokenIfType(12)){const e=this._parseTestExpression(!0);n.exceptionExpression=e,n.exceptionExpression.parent=n,l.extendRange(n,e)}return n}_parseDelStatement(){const e=this._getKeywordToken(10),t=this._parseExpressionList(!0);t.parseError||0!==t.list.length||this._addError('Expected expression after "del"',this._peekToken());const n=l.DelNode.create(e);return n.expressions=t.list,n.expressions.length>0&&(n.expressions.forEach(e=>{e.parent=n}),l.extendRange(n,n.expressions[n.expressions.length-1])),n}_parseYieldExpression(){const e=this._getKeywordToken(35),t=this._peekToken();if(this._consumeTokenIfKeyword(17))return this._getLanguageVersion()<a.PythonVersion.V33&&this._addError('Use of "yield from" requires Python 3.3 or newer',t),l.YieldFromNode.create(e,this._parseTestExpression(!0));let n;return this._isNextTokenNeverExpression()||(n=this._parseTestOrStarListAsExpression(!0,2,"Expected expression in yield statement"),this._reportConditionalErrorForStarTupleElement(n)),l.YieldNode.create(e,n)}_tryParseYieldExpression(){if(35===this._peekKeywordType())return this._parseYieldExpression()}_parseSimpleStatement(){const e=l.StatementListNode.create(this._peekToken());for(;;){if(0===this._peekTokenType()){const e=this._getNextToken(),t=this._fileContents.substr(e.start,e.length).replace(/[\S\W]/g,"");this._addError(`Invalid character in token "${t}"`,e),this._consumeTokensUntilType(2);break}const t=this._parseSmallStatement();if(e.statements.push(t),t.parent=e,l.extendRange(e,t),0===t.nodeType)break;if(!this._consumeTokenIfType(11))break;const n=this._peekTokenType();if(2===n||1===n)break}return this._consumeTokenIfType(2)||this._addError("Statements must be separated by newlines or semicolons",this._peekToken()),e}_parseSmallStatement(){switch(this._peekKeywordType()){case 28:return this._parsePassStatement();case 5:return this._parseBreakStatement();case 7:return this._parseContinueStatement();case 30:return this._parseReturnStatement();case 17:return this._parseFromStatement();case 20:return this._parseImportStatement();case 18:return this._parseGlobalStatement();case 25:return this._parseNonlocalStatement();case 29:return this._parseRaiseStatement();case 2:return this._parseAssertStatement();case 10:return this._parseDelStatement();case 35:return this._parseYieldExpression()}return this._parseExpressionStatement()}_makeExpressionOrTuple(e){if(1===e.list.length&&!e.trailingComma)return e.list[0];const t=e.list.length>0?e.list[0]:this._peekToken(-1),n=l.TupleNode.create(t);return n.expressions=e.list,e.list.length>0&&(e.list.forEach(e=>{e.parent=n}),l.extendRange(n,e.list[e.list.length-1])),n}_parseTestListAsExpression(e,t){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(e,t);const n=this._parseTestExpressionList();return n.parseError?n.parseError:this._makeExpressionOrTuple(n)}_parseTestOrStarListAsExpression(e,t,n){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(t,n);const s=this._parseTestOrStarExpressionList(e);return s.parseError?s.parseError:this._makeExpressionOrTuple(s)}_parseExpressionList(e){return this._parseExpressionListGeneric(()=>this._parseExpression(e))}_parseTestExpressionList(){return this._parseExpressionListGeneric(()=>this._parseTestExpression(!1))}_parseTestOrStarExpressionList(e){const t=this._parseExpressionListGeneric(()=>this._parseTestOrStarExpression(e));if(!t.parseError){let e=!1;for(const n of t.list)if(57===n.nodeType){if(e){this._addError("Only one unpack operation allowed in list",n);break}e=!0}}return t}_parseExpression(e){const t=this._peekToken();return e&&this._consumeTokenIfOperator(25)?l.UnpackNode.create(t,this._parseExpression(!1)):this._parseBitwiseOrExpression()}_parseTestOrStarExpression(e){return 25===this._peekOperatorType()?this._parseExpression(!0):this._parseTestExpression(e)}_parseTestExpression(e){if(23===this._peekKeywordType())return this._parseLambdaExpression();const t=e?this._parseAssignmentExpression():this._parseOrTest();if(0===t.nodeType)return t;if(!this._consumeTokenIfKeyword(19))return t;const n=this._parseAssignmentExpression();if(0===n.nodeType)return n;if(!this._consumeTokenIfKeyword(12))return this._handleExpressionParseError(1,'Expected "else"');const s=this._parseTestExpression(!0);return 0===s.nodeType?s:l.TernaryNode.create(t,n,s)}_parseAssignmentExpression(){const e=this._parseOrTest();if(0===e.nodeType)return e;if(39!==e.nodeType)return e;const t=this._peekToken();if(!this._consumeTokenIfOperator(34))return e;let n;return this._assignmentExpressionsAllowed||this._addError('Operator ":=" not allowed in this context',t),this._getLanguageVersion()<a.PythonVersion.V38&&this._addError('Operator ":=" requires Python 3.8 or newer',t),n=23===this._peekKeywordType()?this._parseLambdaExpression():this._parseOrTest(),l.AssignmentExpressionNode.create(e,n)}_parseOrTest(){let e=this._parseAndTest();if(0===e.nodeType)return e;for(;this._consumeTokenIfKeyword(27);){const t=this._parseAndTest();e=l.BinaryOperationNode.create(e,t,36)}return e}_parseAndTest(){let e=this._parseNotTest();if(0===e.nodeType)return e;for(;this._consumeTokenIfKeyword(0);){const t=this._parseNotTest();e=l.BinaryOperationNode.create(e,t,35)}return e}_parseNotTest(){const e=this._peekToken();if(this._consumeTokenIfKeyword(26)){const t=this._parseNotTest();return l.UnaryOperationNode.create(e,t,37)}return this._parseComparison()}_parseComparison(){let e=this._parseBitwiseOrExpression();if(0===e.nodeType)return e;for(;;){let t;if(u.Tokenizer.isOperatorComparison(this._peekOperatorType()))t=this._peekOperatorType(),this._getNextToken();else if(this._consumeTokenIfKeyword(21))t=40;else if(this._consumeTokenIfKeyword(22))t=this._consumeTokenIfKeyword(26)?39:38;else if(26===this._peekKeywordType()){const e=this._peekToken(1);8===e.type&&21===e.keywordType&&(this._getNextToken(),this._getNextToken(),t=41)}if(void 0===t)break;const n=this._parseBitwiseOrExpression();e=l.BinaryOperationNode.create(e,n,t)}return e}_parseBitwiseOrExpression(){let e=this._parseBitwiseXorExpression();if(0===e.nodeType)return e;for(;this._consumeTokenIfOperator(6);){const t=this._parseBitwiseXorExpression();e=l.BinaryOperationNode.create(e,t,6)}return e}_parseBitwiseXorExpression(){let e=this._parseBitwiseAndExpression();if(0===e.nodeType)return e;for(;this._consumeTokenIfOperator(8);){const t=this._parseBitwiseAndExpression();e=l.BinaryOperationNode.create(e,t,8)}return e}_parseBitwiseAndExpression(){let e=this._parseShiftExpression();if(0===e.nodeType)return e;for(;this._consumeTokenIfOperator(3);){const t=this._parseShiftExpression();e=l.BinaryOperationNode.create(e,t,3)}return e}_parseShiftExpression(){let e=this._parseArithmeticExpression();if(0===e.nodeType)return e;let t=this._peekOperatorType();for(;17===t||30===t;){this._getNextToken();const n=this._parseArithmeticExpression();e=l.BinaryOperationNode.create(e,n,t),t=this._peekOperatorType()}return e}_parseArithmeticExpression(){let e=this._parseArithmeticTerm();if(0===e.nodeType)return e;let t=this._peekOperatorType();for(;0===t||32===t;){this._getNextToken();const n=this._parseArithmeticTerm();if(0===n.nodeType)return n;e=l.BinaryOperationNode.create(e,n,t),t=this._peekOperatorType()}return e}_parseArithmeticTerm(){let e=this._parseArithmeticFactor();if(0===e.nodeType)return e;let t=this._peekOperatorType();for(;25===t||21===t||10===t||23===t||13===t;){this._getNextToken();const n=this._parseArithmeticFactor();e=l.BinaryOperationNode.create(e,n,t),t=this._peekOperatorType()}return e}_parseArithmeticFactor(){const e=this._peekToken(),t=this._peekOperatorType();if(0===t||32===t||5===t){this._getNextToken();const n=this._parseArithmeticFactor();return l.UnaryOperationNode.create(e,n,t)}const n=this._parseAtomExpression();if(0===n.nodeType)return n;if(this._consumeTokenIfOperator(28)){const e=this._parseArithmeticFactor();return l.BinaryOperationNode.create(n,e,28)}return n}_parseAtomExpression(){let e;4!==this._peekKeywordType()||this._isParsingTypeAnnotation||(e=this._getKeywordToken(4),this._getLanguageVersion()<a.PythonVersion.V35&&this._addError('Use of "await" requires Python 3.5 or newer',e));let t=this._parseAtom();if(0===t.nodeType)return t;for(;;){const e=this._peekToken();if(this._consumeTokenIfType(13)){const e=this._parseArgList(),n=l.CallNode.create(t);n.arguments=e,e.length>0&&(e.forEach(e=>{e.parent=n}),l.extendRange(n,e[e.length-1]));const s=this._peekToken();if(!this._consumeTokenIfType(14))return this._addError('Expected ")"',this._peekToken()),this._consumeTokensUntilType(2),l.extendRange(n,this._peekToken()),n;if(l.extendRange(n,s),this._isParsingTypeAnnotation){const e=new r.DiagnosticAddendum;39===t.nodeType&&"type"===t.value&&e.addMessage("Use Type[T] instead"),this._addError("Function call not allowed in type annotation"+e.getString(),n)}t=n}else if(this._consumeTokenIfType(15)){const n=39===t.nodeType&&"Literal"===t.value||36===t.nodeType&&39===t.leftExpression.nodeType&&"typing"===t.leftExpression.value&&"Literal"===t.memberName.value,s=this._isParsingIndexTrailer,r=this._isParsingTypeAnnotation;n&&(this._isParsingTypeAnnotation=!1),this._isParsingIndexTrailer=!0;const i=this._parseSubscriptList();this._isParsingTypeAnnotation=r,this._isParsingIndexTrailer=s;const o=this._peekToken(),a=l.IndexItemsNode.create(e,o,i),c=l.IndexNode.create(t,a);if(l.extendRange(c,c),!this._consumeTokenIfType(16))return this._handleExpressionParseError(6,'Expected "]"',c);t=c}else{if(!this._consumeTokenIfType(20))break;{const e=this._getTokenIfIdentifier();if(!e)return this._handleExpressionParseError(7,'Expected member name after "."',t);t=l.MemberAccessNode.create(t,l.NameNode.create(e))}}}return e?l.AwaitNode.create(e,t):t}_parseSubscriptList(){const e=this._parseExpressionListGeneric(()=>this._parseSubscript(),()=>10!==this._peekTokenType()&&this._isNextTokenNeverExpression());return e.parseError?[e.parseError]:0===e.list.length?[this._handleExpressionParseError(3,"Expected index or slice expression")]:e.list}_parseSubscript(){const e=this._peekToken(),t=[void 0,void 0,void 0];let n=0,s=!1;for(;;){const e=this._peekTokenType();if(16===e||12===e)break;if(10!==e&&(t[n]=this._parseTestExpression(!1)),n++,n>=3||!this._consumeTokenIfType(10))break;s=!0}if(!s)return t[0];const r=l.SliceNode.create(e);r.startValue=t[0],r.startValue&&(r.startValue.parent=r),r.endValue=t[1],r.endValue&&(r.endValue.parent=r),r.stepValue=t[2],r.stepValue&&(r.stepValue.parent=r);const i=t[2]||t[1]||t[0];return i&&l.extendRange(r,i),r}_parseArgList(){const e=[];let t=!1;for(;;){const n=this._peekTokenType();if(14===n||2===n||1===n)break;const s=this._parseArgument();if(s.name?t=!0:t&&0===s.argumentCategory&&this._addError("Positional argument cannot appear after named arguments",s),e.push(s),!this._consumeTokenIfType(12))break}return e}_parseArgument(){const e=this._peekToken();let t=0;this._consumeTokenIfOperator(25)?t=1:this._consumeTokenIfOperator(28)&&(t=2);let n,s=this._parseTestExpression(!1);if(0===t)if(this._consumeTokenIfOperator(2)){const e=s;s=this._parseTestExpression(!1),39===e.nodeType?n=e.token:this._addError("Expected parameter name",e)}else{const e=this._tryParseListComprehension(s);e&&(s=e)}const r=l.ArgumentNode.create(e,s,t);return n&&(r.name=l.NameNode.create(n),r.name.parent=r),r}_parseAtom(){const e=this._peekToken();if(19===e.type)return l.EllipsisNode.create(this._getNextToken());if(6===e.type){const e=l.NumberNode.create(this._getNextToken());return this._isParsingTypeAnnotation&&this._addError("Numeric literal not allowed in type annotation",e),e}if(7===e.type)return l.NameNode.create(this._getNextToken());if(5===e.type)return this._parseStringList();if(22===e.type){this._getNextToken(),this._addError("Expressions surrounded by backticks are not supported in Python 3.x; use repr instead",e);const t=this._parseTestListAsExpression(2,"Expected expression");return this._consumeTokenIfType(22),t}if(13===e.type){const e=this._parseTupleAtom();if(this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new r.DiagnosticAddendum;t.addMessage("Use Tuple[T1, ..., Tn] instead"),this._addError("Tuple expression not allowed in type annotation"+t.getString(),e)}return e}if(15===e.type){const e=this._parseListAtom();if(this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new r.DiagnosticAddendum;t.addMessage("Use List[T] instead"),this._addError("List expression not allowed in type annotation"+t.getString(),e)}return e}if(17===e.type){const e=this._parseDictionaryOrSetAtom();if(this._isParsingTypeAnnotation){const t=new r.DiagnosticAddendum;t.addMessage("Use Dict[T1, T2] instead"),this._addError("Dictionary expression not allowed in type annotation"+t.getString(),e)}return e}if(8===e.type){const t=e;if(14===t.keywordType||31===t.keywordType||8===t.keywordType||24===t.keywordType){const e=l.ConstantNode.create(this._getNextToken());return this._isParsingTypeAnnotation&&24!==t.keywordType&&this._addError("Keyword not allowed in type annotation",e),e}const n=this._getTokenIfIdentifier();if(n)return l.NameNode.create(n)}return this._handleExpressionParseError(2,"Expected expression")}_handleExpressionParseError(e,t,n){this._addError(t,this._peekToken());const s=l.ErrorNode.create(this._peekToken(),e,n);return this._consumeTokensUntilType(2),s}_parseLambdaExpression(e=!0){const t=this._getKeywordToken(23),n=this._parseVarArgsList(10,!1);let s;this._consumeTokenIfType(10)||this._addError('Expected ":"',this._peekToken()),s=e?this._parseTestExpression(!1):this._tryParseLambdaExpression(!1)||this._parseOrTest();const r=l.LambdaNode.create(t,s);return r.parameters=n,n.forEach(e=>{e.parent=r}),r}_tryParseLambdaExpression(e=!0){if(23===this._peekKeywordType())return this._parseLambdaExpression(e)}_parseTupleAtom(){const e=this._getNextToken();s.assert(13===e.type);const t=this._tryParseYieldExpression();if(t)return 14!==this._peekTokenType()?this._handleExpressionParseError(8,'Expected ")"'):(l.extendRange(t,this._getNextToken()),t);const n=this._parseTestListWithComprehension(),r=this._makeExpressionOrTuple(n);return 14!==this._peekTokenType()?this._handleExpressionParseError(8,'Expected ")"'):(l.extendRange(r,this._getNextToken()),r)}_parseListAtom(){const e=this._getNextToken();s.assert(15===e.type);const t=this._parseTestListWithComprehension(),n=this._peekToken();if(!this._consumeTokenIfType(16))return this._handleExpressionParseError(9,'Expected "]"');const r=l.ListNode.create(e);return l.extendRange(r,n),t.list.length>0&&(t.list.forEach(e=>{e.parent=r}),l.extendRange(r,t.list[t.list.length-1])),r.entries=t.list,r}_parseTestListWithComprehension(){let e=!1;return this._parseExpressionListGeneric(()=>{let t=this._parseTestOrStarExpression(!0);const n=this._tryParseListComprehension(t);return n&&(t=n,e=!0),t},()=>this._isNextTokenNeverExpression(),()=>e)}_parseDictionaryOrSetAtom(){const e=this._getNextToken();s.assert(17===e.type);const t=[],n=[];let r=!1,i=!1,o=!1,a=!0;for(;18!==this._peekTokenType();){let e,c,p;if(this._consumeTokenIfOperator(28)?e=this._parseExpression(!1):(c=this._parseTestOrStarExpression(!0),this._consumeTokenIfType(10)&&(p=this._parseTestExpression(!1))),c&&p)if(57===c.nodeType&&this._addError("Unpack operation not allowed in dictionaries",c),i)this._addError("Key/value pairs are not allowed within a set",p);else{const e=l.DictionaryKeyEntryNode.create(c,p);let n=e;const s=this._tryParseListComprehension(e);s&&(n=s,o=!0,a||this._addError("Comprehension cannot be used with other dictionary entries",n)),t.push(n),r=!0}else if(e)if(i)this._addError("Unpack operator not allowed within a set",e);else{const n=l.DictionaryExpandEntryNode.create(e);let s=n;const i=this._tryParseListComprehension(n);i&&(s=i,o=!0,a||this._addError("Comprehension cannot be used with other dictionary entries",e)),t.push(s),r=!0}else if(s.assert(void 0!==c),c)if(r)this._addError("Dictionary entries must contain key/value pairs",c);else{const e=this._tryParseListComprehension(c);e&&(c=e,o=!0,a||this._addError("Comprehension cannot be used with other set entries",c)),n.push(c),i=!0}if(o)break;if(!this._consumeTokenIfType(12))break;a=!1}let c=this._peekToken();if(this._consumeTokenIfType(18)||(this._addError('Expected "}"',this._peekToken()),c=void 0),i){const t=l.SetNode.create(e);return c&&l.extendRange(t,c),n.length>0&&l.extendRange(t,n[n.length-1]),n.forEach(e=>{e.parent=t}),t.entries=n,t}const p=l.DictionaryNode.create(e);return c&&l.extendRange(p,c),t.length>0&&(t.forEach(e=>{e.parent=p}),l.extendRange(p,t[t.length-1])),p.entries=t,p}_parseExpressionListGeneric(e,t=(()=>this._isNextTokenNeverExpression()),n=(()=>!1)){let s=!1;const r=[];let i;for(;!t();){const t=e();if(0===t.nodeType){i=t;break}if(r.push(t),n())break;if(!this._consumeTokenIfType(12)){s=!1;break}s=!0}return{trailingComma:s,list:r,parseError:i}}_parseExpressionStatement(){let e,t=this._parseTestOrStarListAsExpression(!1,2,"Expected expression");if(0===t.nodeType)return t;if(this._consumeTokenIfType(10)){if(this._parseTypeAnnotation(()=>{e=this._parseAtomExpression(),t=l.TypeAnnotationNode.create(t,e),!this._parseOptions.isStubFile&&this._getLanguageVersion()<a.PythonVersion.V36&&this._addError("Type annotations for variables requires Python 3.6 or newer; use type comment for compatibility with previous versions",e)}),!this._consumeTokenIfOperator(2))return t;const n=this._parseTestExpression(!1);return l.AssignmentNode.create(t,n)}if(this._consumeTokenIfOperator(2))return this._parseChainAssignments(t);if(!e&&u.Tokenizer.isOperatorAssignment(this._peekOperatorType())){const e=this._getNextToken(),n=this._tryParseYieldExpression()||this._parseTestListAsExpression(2,"Expected expression to the right of operator"),s=Object.assign({},t);return s.id=l.getNextNodeId(),l.AugmentedAssignmentNode.create(t,n,e.operatorType,s)}return t}_parseChainAssignments(e){let t;if(t=this._tryParseYieldExpression(),t||(t=this._parseTestOrStarListAsExpression(!1,2,'Expected expression to the right of "="')),0===t.nodeType)return l.AssignmentNode.create(e,t);if(this._consumeTokenIfOperator(2)&&(t=this._parseChainAssignments(t),0===t.nodeType))return t;const n=l.AssignmentNode.create(e,t),s=this._getTypeAnnotationComment();return s&&(n.typeAnnotationComment=s,n.typeAnnotationComment.parent=n,l.extendRange(n,n.typeAnnotationComment)),n}_parseTypeAnnotation(e){const t=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!0,e(),this._isParsingTypeAnnotation=t}_reportStringTokenErrors(e,t){65536&e.flags&&this._addError("String literal is unterminated",e),t.nonAsciiInBytes&&this._addError("Non-ASCII character not allowed in bytes string literal",e),64&e.flags&&(this._getLanguageVersion()<a.PythonVersion.V36&&this._addError("Format string literals (f-strings) require Python 3.6 or newer",e),32&e.flags&&this._addError("Format string literals (f-strings) cannot be binary",e),16&e.flags&&this._addError("Format string literals (f-strings) cannot be unicode",e))}_makeStringNode(e){const t=p.getUnescapedString(e);return this._reportStringTokenErrors(e,t),l.StringNode.create(e,t.value,t.unescapeErrors.length>0)}_getTypeAnnotationComment(){if(0===this._tokenIndex)return;const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex-1),t=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);if(e.start+e.length===t.start)return;const n=this._fileContents.substring(e.start+e.length,t.start).match(/^(\s*#\s*type:\s*)([^\r\n]*)/);if(!n)return;const s=n[2];if(s.trim().match(/^ignore(\s|$)/))return;const r=e.start+e.length+n[1].length,i=d.StringToken.create(r,s.length,0,s,0,void 0),o=this._makeStringNode(i),a=l.StringListNode.create([o]),c=(new f).parseTextExpression(this._fileContents,r,s.length,this._parseOptions,!0);return c.diagnostics.forEach(e=>{this._addError(e.message,a)}),c.parseTree?c.parseTree:void 0}_parseFormatString(e){const t=p.getUnescapedString(e);this._reportStringTokenErrors(e,t);const n=[];for(const s of t.formatStringSegments)if(s.isExpression){const t=new f,r=this._getFormatStringExpressionLength(s.value),i=t.parseTextExpression(this._fileContents,e.start+e.prefixLength+e.quoteMarkLength+s.offset,r,this._parseOptions,!1);i.diagnostics.forEach(t=>{const n=(t.range?o.convertPositionToOffset(t.range.start,i.lines):e.start)||e.start,s={start:n,length:((t.range?(o.convertPositionToOffset(t.range.end,i.lines)||0)+1:e.start+e.length)||e.start+e.length)-n};this._addError(t.message,s)}),i.parseTree&&n.push(i.parseTree)}return l.FormatStringNode.create(e,t.value,t.unescapeErrors.length>0,n)}_getFormatStringExpressionLength(e){let t=0,n=!1,s=!1,r=0,i=0,o=0,c=!1;for(;t<e.length;){const a=e[t],l=n||s||r>0||i>0||o>0,p=n||s;if("="===a)c=!0;else{if(":"===a){if(!l)break}else if("!"===a){if(!l&&(t===e.length-1||"="!==e[t+1]))break}else"'"===a?s||(n=!n):'"'===a?n||(s=!s):"("===a?p||i++:")"===a?!p&&i>0&&i--:"{"===a?p||r++:"}"===a?!p&&r>0&&r--:"["===a?p||o++:"]"===a&&!p&&o>0&&o--;c=!1}t++}return this._parseOptions.pythonVersion>=a.PythonVersion.V38&&c&&t--,t}_parseStringList(){const e=[];for(;5===this._peekTokenType();){const t=this._getNextToken();64&t.flags?e.push(this._parseFormatString(t)):e.push(this._makeStringNode(t))}const t=l.StringListNode.create(e);if(this._isParsingTypeAnnotation)if(t.strings.length>1)this._addError("Type annotations cannot span multiple string literals",t);else if(4&t.strings[0].token.flags)this._addError("Type annotations cannot use triple quotes",t);else if(64&t.strings[0].token.flags)this._addError("Type annotations cannot use format string literals (f-strings)",t);else{const e=t.strings[0].token,n=p.getUnescapedString(t.strings[0].token).value,s=e.start,r=e.prefixLength+e.quoteMarkLength;if(n.length!==e.length-r-e.quoteMarkLength)this._addError("Type annotations cannot contain escape characters",t);else{const e=(new f).parseTextExpression(this._fileContents,s+r,n.length,this._parseOptions,!0);e.diagnostics.forEach(e=>{this._addError(e.message,t)}),e.parseTree&&(t.typeAnnotation=e.parseTree,t.typeAnnotation.parent=t)}}return t}_reportConditionalErrorForStarTupleElement(e){if(53===e.nodeType&&!(this._parseOptions.pythonVersion>=a.PythonVersion.V38))for(const t of e.expressions)if(57===t.nodeType)return void this._addError("Unpack operation not allowed in tuples prior to Python 3.8",t)}_isNextTokenNeverExpression(){switch(this._peekToken().type){case 8:switch(this._peekKeywordType()){case 16:case 21:case 19:return!0}break;case 9:switch(this._peekOperatorType()){case 1:case 33:case 26:case 11:case 24:case 4:case 7:case 9:case 18:case 31:case 29:case 14:case 2:return!0}break;case 3:case 4:case 2:case 1:case 11:case 14:case 16:case 18:case 12:case 10:return!0}return!1}_disallowAssignmentExpression(e){const t=this._assignmentExpressionsAllowed;this._assignmentExpressionsAllowed=!1,e(),this._assignmentExpressionsAllowed=t}_getNextToken(){const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);return this._atEof()||this._tokenIndex++,e}_atEof(){return this._tokenIndex>=this._tokenizerOutput.tokens.count-1}_peekToken(e=0){return this._tokenIndex+e<0&&this._tokenizerOutput.tokens.getItemAt(0),this._tokenIndex+e>=this._tokenizerOutput.tokens.count?this._tokenizerOutput.tokens.getItemAt(this._tokenizerOutput.tokens.count-1):this._tokenizerOutput.tokens.getItemAt(this._tokenIndex+e)}_peekTokenType(){return this._peekToken().type}_peekKeywordType(){const e=this._peekToken();if(8===e.type)return e.keywordType}_peekOperatorType(){const e=this._peekToken();if(9===e.type)return e.operatorType}_getTokenIfIdentifier(e=[]){const t=this._peekToken();if(7===t.type)return this._getNextToken();if(0===t.type)return this._getNextToken(),this._addError("Invalid character in identifier",t),d.IdentifierToken.create(t.start,t.length,"",t.comments);if(8===t.type){const n=this._peekKeywordType();if(!e.find(e=>e===n)){const e=this._fileContents.substr(t.start,t.length);return this._getNextToken(),d.IdentifierToken.create(t.start,t.length,e,t.comments)}}}_consumeTokensUntilType(e){for(;;){const t=this._peekToken();if(t.type===e)return!0;if(1===t.type)return!1;this._getNextToken()}}_consumeTokenIfType(e){return this._peekTokenType()===e&&(this._getNextToken(),!0)}_consumeTokenIfKeyword(e){return this._peekKeywordType()===e&&(this._getNextToken(),!0)}_consumeTokenIfOperator(e){return this._peekOperatorType()===e&&(this._getNextToken(),!0)}_getKeywordToken(e){const t=this._getNextToken();return s.assert(8===t.type),s.assert(t.keywordType===e),t}_getLanguageVersion(){return this._parseOptions.pythonVersion}_addError(e,t){s.assert(void 0!==t),this._diagSink.addError(e,o.convertOffsetsToRange(t.start,t.start+t.length,this._tokenizerOutput.lines))}}t.Parser=f},function(e,t,n){"use strict";function s(e){return e>=48&&e<=57||(e>=97&&e<=122||e>=65&&e<=65)}function r(e){return e>=48&&e<=55}function i(e){return e>=48&&e<=57||(e>=97&&e<=102||e>=65&&e<=70)}function o(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-97+10:e>=65&&e<=70?e-65+10:0}Object.defineProperty(t,"__esModule",{value:!0}),t.getUnescapedString=function(e){const t=e.escapedValue,n=0!=(8&e.flags),a=0!=(32&e.flags),c=0!=(64&e.flags);let l=0,p={offset:0,length:0,value:"",isExpression:!1},u=0;const d={value:"",unescapeErrors:[],nonAsciiInBytes:!1,formatStringSegments:[]},h=()=>{n||d.unescapeErrors.push({offset:u-1,length:2,errorType:0})},f=(e=0)=>u+e>=t.length?3:t.charCodeAt(u+e),g=e=>{let t=!1,n=0,s="";for(let s=0;s<e;s++){const e=f(1+s);if(!i(e)){t=!0;break}n=16*n+o(e)}return t?(h(),s="\\"+String.fromCharCode(f()),u++):(s=String.fromCharCode(n),u+=1+e),s},y=e=>{const t=String.fromCharCode(e);d.value+=t,p.value+=t};for(;;){let e=f();if(3===e)return c&&(p.isExpression&&d.unescapeErrors.push({offset:p.offset,length:u-p.offset,errorType:3}),u!==p.offset&&(p.length=u-p.offset,d.formatStringSegments.push(p))),d;if(92===e){c&&p.isExpression&&d.unescapeErrors.push({offset:u,length:1,errorType:1}),u++,e=f();let t="";if(13===e||10===e)13===e&&10===f(1)&&(n&&(t+=String.fromCharCode(e)),u++,e=f()),n&&(t="\\"+t+String.fromCharCode(e)),u++;else if(n)t="\\"+String.fromCharCode(e),u++;else switch(e){case 92:case 39:case 34:t=String.fromCharCode(e),u++;break;case 97:t="",u++;break;case 98:t="\b",u++;break;case 102:t="\f",u++;break;case 110:t="\n",u++;break;case 114:t="\r",u++;break;case 116:t="\t",u++;break;case 118:t="\v",u++;break;case 120:t=g(2);break;case 78:{let n=!1,r=1;if(123!==f(r))n=!0;else for(r++;;){const e=f(r);if(125===e)break;if(!s(e)){n=!0;break}r++}n?(h(),t="\\"+String.fromCharCode(e),u++):(t="-",u+=1+r);break}case 117:t=g(4);break;case 85:t=g(8);break;default:if(r(e)){let n=e-48;u++,e=f(),r(e)&&(n=8*n+e-48,u++,e=f(),r(e)&&(n=8*n+e-48,u++)),t=String.fromCharCode(n)}else t="\\"+String.fromCharCode(e),h(),u++}d.value+=t,p.value+=t}else if(10===e||13===e)13===e&&10===f(1)&&(y(e),u++,e=f()),y(e),u++;else if(c&&123===e)p.isExpression||123!==f(1)?(p.length=u-p.offset,p.length>0&&d.formatStringSegments.push(p),u++,p={offset:u,length:0,value:"",isExpression:!0},l++):(y(e),u+=2);else if(c&&125===e)p.isExpression||125!==f(1)?0===l?(d.unescapeErrors.push({offset:u,length:1,errorType:2}),u++):(l--,p.length=u-p.offset,d.formatStringSegments.push(p),u++,p={offset:u,length:0,value:"",isExpression:!1}):(y(e),u+=2);else if(!p.isExpression||39!==e&&34!==e)a&&e>=128&&(d.nonAsciiInBytes=!0),y(e),u++;else{const t=e;y(e);const n=f(1)===t&&f(2)===t;for(n&&(u+=2,y(e),y(e),d.value+=String.fromCharCode(e),d.value+=String.fromCharCode(e));;){u++;let e=f();if(3===e)break;if(92!==e){if(10===e||13===e)break;if(e===t){if(!n){u++,y(e);break}if(f(1)===t&&f(2)===t){u+=3,y(e),y(e),y(e);break}}y(e)}else y(e),u++,e=f(),y(e)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(110);var r;!function(e){e[e.NotIdentifierChar=0]="NotIdentifierChar",e[e.StartIdentifierChar=1]="StartIdentifierChar",e[e.IdentifierChar=2]="IdentifierChar"}(r||(r={}));const i=new Array(256),o={};let a=!1;function c(e){return e>=48&&e<=57||95===e}t.isIdentifierStartChar=function(e){return e<256?i[e]===r.StartIdentifierChar:(a||(d(!1),a=!0),o[e]===r.StartIdentifierChar)},t.isIdentifierChar=function(e){return e<256?i[e]===r.StartIdentifierChar||i[e]===r.IdentifierChar:o[e]===r.StartIdentifierChar||o[e]===r.IdentifierChar},t.isWhiteSpace=function(e){return 32===e||9===e||12===e},t.isLineBreak=function(e){return 13===e||10===e},t.isNumber=function(e){return e>=48&&e<=57||95===e},t.isDecimal=c,t.isHex=function(e){return c(e)||e>=97&&e<=102||e>=65&&e<=70||95===e},t.isOctal=function(e){return e>=48&&e<=55||95===e},t.isBinary=function(e){return 48===e||49===e||95===e};const l=[[95,6277,6278,8472,8494,12443,12444],s.unicodeLu,s.unicodeLl,s.unicodeLt,s.unicodeLo,s.unicodeLm,s.unicodeNl],p=[[183,903,4969,4970,4971,4972,4973,4974,4975,4976,4977,6618],s.unicodeMn,s.unicodeMc,s.unicodeNd,s.unicodePc];function u(e,t,n){for(let s=0;s<e.length;s++){const r=e[s];let a,c;Array.isArray(r)?(a=r[0],c=r[1]):a=c=r;for(let e=a;e<=c;e++)e<256?i[e]=t:o[e]=t;if(n&&a>=256)break}}function d(e){i.fill(r.NotIdentifierChar),p.forEach(t=>{u(t,r.IdentifierChar,e)}),l.forEach(t=>{u(t,r.StartIdentifierChar,e)})}d(!0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e,t,n){return{start:e,length:t,value:n}}}(t.Comment||(t.Comment={})),function(e){e.create=function(e,t,n,s){return{start:t,length:n,type:e,comments:s}}}(t.Token||(t.Token={})),function(e){e.create=function(e,t,n,s,r){return{start:e,length:t,type:3,isIndentAmbiguous:s,comments:r,indentAmount:n}}}(t.IndentToken||(t.IndentToken={})),function(e){e.create=function(e,t,n,s,r){return{start:e,length:t,type:4,comments:r,indentAmount:n,matchesIndent:s}}}(t.DedentToken||(t.DedentToken={})),function(e){e.create=function(e,t,n,s){return{start:e,length:t,type:2,comments:s,newLineType:n}}}(t.NewLineToken||(t.NewLineToken={})),function(e){e.create=function(e,t,n,s){return{start:e,length:t,type:8,comments:s,keywordType:n}}}(t.KeywordToken||(t.KeywordToken={})),function(e){e.create=function(e,t,n,s,r,i){return{start:e,length:t,type:5,flags:n,escapedValue:s,prefixLength:r,quoteMarkLength:4&n?3:1,comments:i}}}(t.StringToken||(t.StringToken={})),function(e){e.create=function(e,t,n,s,r,i){return{start:e,length:t,type:6,isInteger:s,isImaginary:r,value:n,comments:i}}}(t.NumberToken||(t.NumberToken={})),function(e){e.create=function(e,t,n,s){return{start:e,length:t,type:9,operatorType:n,comments:s}}}(t.OperatorToken||(t.OperatorToken={})),function(e){e.create=function(e,t,n,s){return{start:e,length:t,type:7,value:n,comments:s}}}(t.IdentifierToken||(t.IdentifierToken={}))},function(e,t,n){"use strict";function s(e,t){if(56===e.nodeType){if(36===e.operator||35===e.operator){const n=r(e.expression,t);if(void 0!==n)return!n}}else if(7===e.nodeType){if(36===e.operator||35===e.operator){const n=s(e.leftExpression,t),r=s(e.rightExpression,t);if(void 0===n||void 0===r)return;return 36===e.operator?n||r:n&&r}if(a(e.leftExpression)&&53===e.rightExpression.nodeType){const n=function(e){let t;if(2===e.expressions.length){if(41===e.expressions[0].nodeType&&!e.expressions[0].isImaginary&&41===e.expressions[1].nodeType&&!e.expressions[1].isImaginary){const n=e.expressions[0],s=e.expressions[1];t=256*n.value+s.value}}else if(1===e.expressions.length){const n=e.expressions[0];t=256*n.value}return t}(e.rightExpression);return i(e.operator,t.pythonVersion,n)}if(24===e.leftExpression.nodeType&&a(e.leftExpression.baseExpression)&&1===e.leftExpression.items.items.length&&41===e.leftExpression.items.items[0].nodeType&&!e.leftExpression.items.items[0].isImaginary&&0===e.leftExpression.items.items[0].value&&41===e.rightExpression.nodeType)return i(e.operator,Math.floor(t.pythonVersion/256),e.rightExpression.value);if(function(e){if(36===e.nodeType&&39===e.leftExpression.nodeType&&"sys"===e.leftExpression.value&&"platform"===e.memberName.value)return!0;return!1}(e.leftExpression)&&49===e.rightExpression.nodeType){const n=e.rightExpression.strings.map(e=>e.value).join(""),s=function(e){if("Darwin"===e.pythonPlatform)return"darwin";if("Windows"===e.pythonPlatform)return"win32";if("Linux"===e.pythonPlatform)return"linux";return}(t);return o(e.operator,s||"",n)}if(function(e){if(36===e.nodeType&&39===e.leftExpression.nodeType&&"os"===e.leftExpression.value&&"name"===e.memberName.value)return!0;return!1}(e.leftExpression)&&49===e.rightExpression.nodeType){const n=e.rightExpression.strings.map(e=>e.value).join(""),s=function(e){if("Darwin"===e.pythonPlatform)return"posix";if("Windows"===e.pythonPlatform)return"nt";if("Linux"===e.pythonPlatform)return"posix";return}(t);if(void 0!==s)return o(e.operator,s,n)}}else if(11===e.nodeType){if(31===e.constType)return!0;if(14===e.constType)return!1}else if(39===e.nodeType){if("TYPE_CHECKING"===e.value)return!0}else if(36===e.nodeType&&"TYPE_CHECKING"===e.memberName.value&&39===e.leftExpression.nodeType&&"typing"===e.leftExpression.value)return!0}function r(e,t){return(11!==e.nodeType||24!==e.constType)&&s(e,t)}function i(e,t,n){if(void 0!==t&&void 0!==n){if(19===e)return t<n;if(20===e)return t<=n;if(15===e)return t>n;if(16===e)return t>=n;if(12===e)return t===n;if(27===e)return t!==n}}function o(e,t,n){if(void 0!==t&&void 0!==n){if(12===e)return t===n;if(27===e)return t!==n}}function a(e){return 36===e.nodeType&&39===e.leftExpression.nodeType&&"sys"===e.leftExpression.value&&"version_info"===e.memberName.value}Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateStaticBoolExpression=s,t.evaluateStaticBoolLikeExpression=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(7),r=n(8);t.getBuiltInScope=function(e){let t=e;for(;4!==t.type;)t=t.parent;return t},t.getScopeForNode=function(e){const t=r.getEvaluationScopeNode(e);return s.getScope(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(121),r=n(6);function i(e,t){return t.replace(/\$\{(.*?)\}/g,(t,n)=>"workspaceFolder"===n.trim()?e:t)}t.AnalyzerServiceExecutor=class{static runWithOptions(e,t,n,o){const a=function(e,t,n,o){const a=new s.CommandLineOptions(t,!0);a.checkOnlyOpenFiles=n.openFilesOnly,a.useLibraryCodeForTypes=n.useLibraryCodeForTypes,a.watchForLibraryChanges=n.watchForLibraryChanges,a.typeCheckingMode=n.typeCheckingMode,a.watchForSourceChanges=!a.checkOnlyOpenFiles,n.venvPath&&(a.venvPath=r.combinePaths(t||e,r.normalizePath(i(e,n.venvPath))));n.pythonPath&&"python"!==n.pythonPath.trim()&&(a.pythonPath=r.combinePaths(t||e,r.normalizePath(i(e,n.pythonPath))));n.typeshedPath&&(a.typeshedPath=i(e,n.typeshedPath));o&&(a.typeStubTargetImportName=o);return a.autoSearchPaths=n.autoSearchPaths,a}(e,t.rootPath,n,o);t.serviceInstance.setOptions(a)}}},function(e,t,n){"use strict";e.exports=n(131)},function(e,t){
/*!
 * normalize-path <https://github.com/jonschlinkert/normalize-path>
 *
 * Copyright (c) 2014-2018, Jon Schlinkert.
 * Released under the MIT License.
 */
e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("expected path to be a string");if("\\"===e||"/"===e)return"/";var n=e.length;if(n<=1)return e;var s="";if(n>4&&"\\"===e[3]){var r=e[2];"?"!==r&&"."!==r||"\\\\"!==e.slice(0,2)||(e=e.slice(2),s="//")}var i=e.split(/[/\\]+/);return!1!==t&&""===i[i.length-1]&&i.pop(),s+i.join("/")}},function(e,t,n){
/*!
 * is-glob <https://github.com/jonschlinkert/is-glob>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
var s=n(136),r={"{":"}","(":")","[":"]"},i=/\\(.)|(^!|\*|[\].+)]\?|\[[^\\\]]+\]|\{[^\\}]+\}|\(\?[:!=][^\\)]+\)|\([^|]+\|[^\\)]+\))/,o=/\\(.)|(^!|[*?{}()[\]]|\(\?)/;e.exports=function(e,t){if("string"!=typeof e||""===e)return!1;if(s(e))return!0;var n,a=i;for(t&&!1===t.strict&&(a=o);n=a.exec(e);){if(n[2])return!0;var c=n.index+n[0].length,l=n[1],p=l?r[l]:null;if(l&&p){var u=e.indexOf(p,c);-1!==u&&(c=u+1)}e=e.slice(c)}return!1}},function(e,t,n){"use strict";
/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const s=n(15),r=n(139),i=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),o=e=>"number"==typeof e||"string"==typeof e&&""!==e,a=e=>Number.isInteger(+e),c=e=>{let t=`${e}`,n=-1;if("-"===t[0]&&(t=t.slice(1)),"0"===t)return!1;for(;"0"===t[++n];);return n>0},l=(e,t,n)=>{if(t>0){let n="-"===e[0]?"-":"";n&&(e=e.slice(1)),e=n+e.padStart(n?t-1:t,"0")}return!1===n?String(e):e},p=(e,t)=>{let n="-"===e[0]?"-":"";for(n&&(e=e.slice(1),t--);e.length<t;)e="0"+e;return n?"-"+e:e},u=(e,t,n,s)=>{if(n)return r(e,t,{wrap:!1,...s});let i=String.fromCharCode(e);return e===t?i:`[${i}-${String.fromCharCode(t)}]`},d=(e,t,n)=>{if(Array.isArray(e)){let t=!0===n.wrap,s=n.capture?"":"?:";return t?`(${s}${e.join("|")})`:e.join("|")}return r(e,t,n)},h=(...e)=>new RangeError("Invalid range arguments: "+s.inspect(...e)),f=(e,t,n)=>{if(!0===n.strictRanges)throw h([e,t]);return[]},g=(e,t,n=1,s={})=>{let r=Number(e),i=Number(t);if(!Number.isInteger(r)||!Number.isInteger(i)){if(!0===s.strictRanges)throw h([e,t]);return[]}0===r&&(r=0),0===i&&(i=0);let o=r>i,a=String(e),f=String(t),g=String(n);n=Math.max(Math.abs(n),1);let y=c(a)||c(f)||c(g),m=y?Math.max(a.length,f.length,g.length):0,_=!1===y&&!1===((e,t,n)=>"string"==typeof e||"string"==typeof t||!0===n.stringify)(e,t,s),T=s.transform||(e=>t=>!0===e?Number(t):String(t))(_);if(s.toRegex&&1===n)return u(p(e,m),p(t,m),!0,s);let v={negatives:[],positives:[]},b=[],E=0;for(;o?r>=i:r<=i;)!0===s.toRegex&&n>1?v[(C=r)<0?"negatives":"positives"].push(Math.abs(C)):b.push(l(T(r,E),m,_)),r=o?r-n:r+n,E++;var C;return!0===s.toRegex?n>1?((e,t)=>{e.negatives.sort((e,t)=>e<t?-1:e>t?1:0),e.positives.sort((e,t)=>e<t?-1:e>t?1:0);let n,s=t.capture?"":"?:",r="",i="";return e.positives.length&&(r=e.positives.join("|")),e.negatives.length&&(i=`-(${s}${e.negatives.join("|")})`),n=r&&i?`${r}|${i}`:r||i,t.wrap?`(${s}${n})`:n})(v,s):d(b,null,{wrap:!1,...s}):b},y=(e,t,n,s={})=>{if(null==t&&o(e))return[e];if(!o(e)||!o(t))return f(e,t,s);if("function"==typeof n)return y(e,t,1,{transform:n});if(i(n))return y(e,t,0,n);let r={...s};return!0===r.capture&&(r.wrap=!0),n=n||r.step||1,a(n)?a(e)&&a(t)?g(e,t,n,r):((e,t,n=1,s={})=>{if(!a(e)&&e.length>1||!a(t)&&t.length>1)return f(e,t,s);let r=s.transform||(e=>String.fromCharCode(e)),i=`${e}`.charCodeAt(0),o=`${t}`.charCodeAt(0),c=i>o,l=Math.min(i,o),p=Math.max(i,o);if(s.toRegex&&1===n)return u(l,p,!1,s);let h=[],g=0;for(;c?i>=o:i<=o;)h.push(r(i,g)),i=c?i-n:i+n,g++;return!0===s.toRegex?d(h,null,{wrap:!1,options:s}):h})(e,t,Math.max(Math.abs(n),1),r):null==n||i(n)?y(e,t,1,n):((e,t)=>{if(!0===t.strictRanges)throw new TypeError(`Expected step "${e}" to be a number`);return[]})(n,r)};e.exports=y},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(15),i=n(69),o=n(6),a=n(124),c=n(153);class l extends a.LanguageServerBase{constructor(){super("Pyright",o.getDirectoryPath(__dirname)),this._controller=new i.CommandController(this)}getSettings(e){return s(this,void 0,void 0,(function*(){const t={};try{const n=yield this.getConfiguration(e,"python");n&&(t.pythonPath=o.normalizeSlashes(n.pythonPath),t.venvPath=o.normalizeSlashes(n.venvPath));const s=yield this.getConfiguration(e,"python.analysis");if(s){const e=s.typeshedPaths;e&&r.isArray(e)&&e.length>0&&(t.typeshedPath=o.normalizeSlashes(e[0])),t.autoSearchPaths=!!s.autoSearchPaths}else t.autoSearchPaths=!1;const i=yield this.getConfiguration(e,"pyright");i?(t.openFilesOnly=!!i.openFilesOnly,t.useLibraryCodeForTypes=!!i.useLibraryCodeForTypes,t.disableLanguageServices=!!i.disableLanguageServices,t.disableOrganizeImports=!!i.disableOrganizeImports,t.typeCheckingMode=i.typeCheckingMode):(t.openFilesOnly=!0,t.useLibraryCodeForTypes=!1,t.disableLanguageServices=!1,t.disableOrganizeImports=!1,t.typeCheckingMode=void 0)}catch(e){this.console.log(`Error reading settings: ${e}`)}return t}))}executeCommand(e,t){return this._controller.execute(e,t)}executeCodeAction(e,t){return s(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const n=o.convertUriToPath(e.textDocument.uri),s=this.getWorkspaceForFile(n);return c.CodeActionProvider.getCodeActionsForPosition(s,n,e.range,t)}))}}t.server=new l},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),i=n(97),o=n(122),a=n(123);t.CommandController=class{constructor(e){this._createStub=new i.CreateTypeStubCommand(e),this._restartServer=new a.RestartServerCommand(e),this._quickAction=new o.QuickActionCommand(e)}execute(e,t){return s(this,void 0,void 0,(function*(){switch(e.command){case"pyright.organizeimports":case"pyright.addoptionalforparam":return this._quickAction.execute(e,t);case"pyright.createtypestub":return this._createStub.execute(e,t);case"pyright.restartserver":return this._restartServer.execute(e);default:return new r.ResponseError(1,"Unsupported command")}}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(18);var r;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.ContentModified=-32801,e.MessageWriteError=1,e.MessageReadError=2}(r=t.ErrorCodes||(t.ErrorCodes={}));class i extends Error{constructor(e,t,n){super(t),this.code=s.number(e)?e:r.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,i.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=i;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o;t.RequestType0=class extends o{constructor(e){super(e,0)}};t.RequestType=class extends o{constructor(e){super(e,1)}};t.RequestType1=class extends o{constructor(e){super(e,1)}};t.RequestType2=class extends o{constructor(e){super(e,2)}};t.RequestType3=class extends o{constructor(e){super(e,3)}};t.RequestType4=class extends o{constructor(e){super(e,4)}};t.RequestType5=class extends o{constructor(e){super(e,5)}};t.RequestType6=class extends o{constructor(e){super(e,6)}};t.RequestType7=class extends o{constructor(e){super(e,7)}};t.RequestType8=class extends o{constructor(e){super(e,8)}};t.RequestType9=class extends o{constructor(e){super(e,9)}};t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}};t.NotificationType0=class extends o{constructor(e){super(e,0)}};t.NotificationType1=class extends o{constructor(e){super(e,1)}};t.NotificationType2=class extends o{constructor(e){super(e,2)}};t.NotificationType3=class extends o{constructor(e){super(e,3)}};t.NotificationType4=class extends o{constructor(e){super(e,4)}};t.NotificationType5=class extends o{constructor(e){super(e,5)}};t.NotificationType6=class extends o{constructor(e){super(e,6)}};t.NotificationType7=class extends o{constructor(e){super(e,7)}};t.NotificationType8=class extends o{constructor(e){super(e,8)}};t.NotificationType9=class extends o{constructor(e){super(e,9)}},t.isRequestMessage=function(e){let t=e;return t&&s.string(t.method)&&(s.string(t.id)||s.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&s.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(s.string(t.id)||s.number(t.id)||null===t.id)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(24),r=n(18);var i;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:s.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:s.Event.None}),e.is=function(t){let n=t;return n&&(n===e.None||n===e.Cancelled||r.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(i=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let n=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(n)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new s.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=i.Cancelled}dispose(){this._token?this._token instanceof a&&this._token.dispose():this._token=i.None}}},function(e,t,n){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(s=t.Touch||(t.Touch={}));t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,n=s.None){let r=this._map.get(e);if(r)r.value=t,n!==s.None&&this.touch(r,n);else{switch(r={key:e,value:t,next:void 0,previous:void 0},n){case s.None:this.addItemLast(r);break;case s.First:this.addItemFirst(r);break;case s.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._head;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.next}forEachReverse(e,t){let n=this._tail;for(;n;)t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),n=n.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===s.First||t===s.Last)if(t===s.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===s.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(2),r=n(34),i=n(74),o=n(42),a=n(32),c=n(33);t.generateRandomPipeName=function(){const e=i.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:s.join(r.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let n,s=new Promise((e,t)=>{n=e});return new Promise((r,i)=>{let l=o.createServer(e=>{l.close(),n([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])});l.on("error",i),l.listen(e,()=>{l.removeListener("error",i),r({onConnected:()=>s})})})},t.createServerPipeTransport=function(e,t="utf-8"){const n=o.createConnection(e);return[new a.SocketMessageReader(n,t),new c.SocketMessageWriter(n,t)]}},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(42),r=n(32),i=n(33);t.createClientSocketTransport=function(e,t="utf-8"){let n,o=new Promise((e,t)=>{n=e});return new Promise((a,c)=>{let l=s.createServer(e=>{l.close(),n([new r.SocketMessageReader(e,t),new i.SocketMessageWriter(e,t)])});l.on("error",c),l.listen(e,"127.0.0.1",()=>{l.removeListener("error",c),a({onConnected:()=>o})})})},t.createServerSocketTransport=function(e,t="utf-8"){const n=s.createConnection(e,"127.0.0.1");return[new r.SocketMessageReader(n,t),new i.SocketMessageWriter(n,t)]}},function(e,t,n){"use strict";var s,r,i,o,a,c,l,p,u,d,h,f,g,y,m,_,T,v,b,E,C;n.r(t),n.d(t,"Position",(function(){return s})),n.d(t,"Range",(function(){return r})),n.d(t,"Location",(function(){return i})),n.d(t,"LocationLink",(function(){return o})),n.d(t,"Color",(function(){return a})),n.d(t,"ColorInformation",(function(){return c})),n.d(t,"ColorPresentation",(function(){return l})),n.d(t,"FoldingRangeKind",(function(){return p})),n.d(t,"FoldingRange",(function(){return u})),n.d(t,"DiagnosticRelatedInformation",(function(){return d})),n.d(t,"DiagnosticSeverity",(function(){return h})),n.d(t,"DiagnosticTag",(function(){return f})),n.d(t,"DiagnosticCode",(function(){return g})),n.d(t,"Diagnostic",(function(){return y})),n.d(t,"Command",(function(){return m})),n.d(t,"TextEdit",(function(){return _})),n.d(t,"TextDocumentEdit",(function(){return T})),n.d(t,"CreateFile",(function(){return v})),n.d(t,"RenameFile",(function(){return b})),n.d(t,"DeleteFile",(function(){return E})),n.d(t,"WorkspaceEdit",(function(){return C})),n.d(t,"WorkspaceChange",(function(){return Z})),n.d(t,"TextDocumentIdentifier",(function(){return k})),n.d(t,"VersionedTextDocumentIdentifier",(function(){return S})),n.d(t,"TextDocumentItem",(function(){return x})),n.d(t,"MarkupKind",(function(){return w})),n.d(t,"MarkupContent",(function(){return I})),n.d(t,"CompletionItemKind",(function(){return R})),n.d(t,"InsertTextFormat",(function(){return F})),n.d(t,"CompletionItemTag",(function(){return P})),n.d(t,"InsertReplaceEdit",(function(){return A})),n.d(t,"CompletionItem",(function(){return N})),n.d(t,"CompletionList",(function(){return D})),n.d(t,"MarkedString",(function(){return O})),n.d(t,"Hover",(function(){return M})),n.d(t,"ParameterInformation",(function(){return L})),n.d(t,"SignatureInformation",(function(){return U})),n.d(t,"DocumentHighlightKind",(function(){return $})),n.d(t,"DocumentHighlight",(function(){return q})),n.d(t,"SymbolKind",(function(){return W})),n.d(t,"SymbolTag",(function(){return V})),n.d(t,"SymbolInformation",(function(){return B})),n.d(t,"DocumentSymbol",(function(){return j})),n.d(t,"CodeActionKind",(function(){return z})),n.d(t,"CodeActionContext",(function(){return H})),n.d(t,"CodeAction",(function(){return G})),n.d(t,"CodeLens",(function(){return K})),n.d(t,"FormattingOptions",(function(){return Y})),n.d(t,"DocumentLink",(function(){return Q})),n.d(t,"SelectionRange",(function(){return X})),n.d(t,"EOL",(function(){return te})),n.d(t,"TextDocument",(function(){return ee})),function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return ne.objectLiteral(t)&&ne.number(t.line)&&ne.number(t.character)}}(s||(s={})),function(e){e.create=function(e,t,n,r){if(ne.number(e)&&ne.number(t)&&ne.number(n)&&ne.number(r))return{start:s.create(e,t),end:s.create(n,r)};if(s.is(e)&&s.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+r+"]")},e.is=function(e){var t=e;return ne.objectLiteral(t)&&s.is(t.start)&&s.is(t.end)}}(r||(r={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return ne.defined(t)&&r.is(t.range)&&(ne.string(t.uri)||ne.undefined(t.uri))}}(i||(i={})),function(e){e.create=function(e,t,n,s){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:s}},e.is=function(e){var t=e;return ne.defined(t)&&r.is(t.targetRange)&&ne.string(t.targetUri)&&(r.is(t.targetSelectionRange)||ne.undefined(t.targetSelectionRange))&&(r.is(t.originSelectionRange)||ne.undefined(t.originSelectionRange))}}(o||(o={})),function(e){e.create=function(e,t,n,s){return{red:e,green:t,blue:n,alpha:s}},e.is=function(e){var t=e;return ne.number(t.red)&&ne.number(t.green)&&ne.number(t.blue)&&ne.number(t.alpha)}}(a||(a={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return r.is(t.range)&&a.is(t.color)}}(c||(c={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return ne.string(t.label)&&(ne.undefined(t.textEdit)||_.is(t))&&(ne.undefined(t.additionalTextEdits)||ne.typedArray(t.additionalTextEdits,_.is))}}(l||(l={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(p||(p={})),function(e){e.create=function(e,t,n,s,r){var i={startLine:e,endLine:t};return ne.defined(n)&&(i.startCharacter=n),ne.defined(s)&&(i.endCharacter=s),ne.defined(r)&&(i.kind=r),i},e.is=function(e){var t=e;return ne.number(t.startLine)&&ne.number(t.startLine)&&(ne.undefined(t.startCharacter)||ne.number(t.startCharacter))&&(ne.undefined(t.endCharacter)||ne.number(t.endCharacter))&&(ne.undefined(t.kind)||ne.string(t.kind))}}(u||(u={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return ne.defined(t)&&i.is(t.location)&&ne.string(t.message)}}(d||(d={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(h||(h={})),function(e){e.Unnecessary=1,e.Deprecated=2}(f||(f={})),function(e){e.is=function(e){var t=e;return null!=t&&(ne.number(t.value)||ne.string(t.value))&&ne.string(t.target)}}(g||(g={})),function(e){e.create=function(e,t,n,s,r,i){var o={range:e,message:t};return ne.defined(n)&&(o.severity=n),ne.defined(s)&&(o.code=s),ne.defined(r)&&(o.source=r),ne.defined(i)&&(o.relatedInformation=i),o},e.is=function(e){var t=e;return ne.defined(t)&&r.is(t.range)&&ne.string(t.message)&&(ne.number(t.severity)||ne.undefined(t.severity))&&(ne.number(t.code)||ne.string(t.code)||ne.undefined(t.code))&&(ne.string(t.source)||ne.undefined(t.source))&&(ne.undefined(t.relatedInformation)||ne.typedArray(t.relatedInformation,d.is))}}(y||(y={})),function(e){e.create=function(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var r={title:e,command:t};return ne.defined(n)&&n.length>0&&(r.arguments=n),r},e.is=function(e){var t=e;return ne.defined(t)&&ne.string(t.title)&&ne.string(t.command)}}(m||(m={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return ne.objectLiteral(t)&&ne.string(t.newText)&&r.is(t.range)}}(_||(_={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return ne.defined(t)&&S.is(t.textDocument)&&Array.isArray(t.edits)}}(T||(T={})),function(e){e.create=function(e,t){var n={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"create"===t.kind&&ne.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||ne.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ne.boolean(t.options.ignoreIfExists)))}}(v||(v={})),function(e){e.create=function(e,t,n){var s={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(s.options=n),s},e.is=function(e){var t=e;return t&&"rename"===t.kind&&ne.string(t.oldUri)&&ne.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||ne.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ne.boolean(t.options.ignoreIfExists)))}}(b||(b={})),function(e){e.create=function(e,t){var n={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"delete"===t.kind&&ne.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||ne.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||ne.boolean(t.options.ignoreIfNotExists)))}}(E||(E={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return ne.string(e.kind)?v.is(e)||b.is(e)||E.is(e):T.is(e)})))}}(C||(C={}));var k,S,x,w,I,R,F,P,A,N,D,O,M,L,U,$,q,W,V,B,j,z,H,G,K,Y,Q,X,J=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(_.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(_.replace(e,t))},e.prototype.delete=function(e){this.edits.push(_.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}(),Z=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach((function(e){if(T.is(e)){var n=new J(e.edits);t._textEditChanges[e.textDocument.uri]=n}})):e.changes&&Object.keys(e.changes).forEach((function(n){var s=new J(e.changes[n]);t._textEditChanges[n]=s})))}return Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(S.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t=e;if(!(s=this._textEditChanges[t.uri])){var n={textDocument:t,edits:r=[]};this._workspaceEdit.documentChanges.push(n),s=new J(r),this._textEditChanges[t.uri]=s}return s}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var s;if(!(s=this._textEditChanges[e])){var r=[];this._workspaceEdit.changes[e]=r,s=new J(r),this._textEditChanges[e]=s}return s},e.prototype.createFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(v.create(e,t))},e.prototype.renameFile=function(e,t,n){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(b.create(e,t,n))},e.prototype.deleteFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(E.create(e,t))},e.prototype.checkDocumentChanges=function(){if(!this._workspaceEdit||!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.")},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return ne.defined(t)&&ne.string(t.uri)}}(k||(k={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ne.defined(t)&&ne.string(t.uri)&&(null===t.version||ne.number(t.version))}}(S||(S={})),function(e){e.create=function(e,t,n,s){return{uri:e,languageId:t,version:n,text:s}},e.is=function(e){var t=e;return ne.defined(t)&&ne.string(t.uri)&&ne.string(t.languageId)&&ne.number(t.version)&&ne.string(t.text)}}(x||(x={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(w||(w={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(w||(w={})),function(e){e.is=function(e){var t=e;return ne.objectLiteral(e)&&w.is(t.kind)&&ne.string(t.value)}}(I||(I={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(R||(R={})),function(e){e.PlainText=1,e.Snippet=2}(F||(F={})),function(e){e.Deprecated=1}(P||(P={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&ne.string(t.newText)&&r.is(t.insert)&&r.is(t.replace)}}(A||(A={})),function(e){e.create=function(e){return{label:e}}}(N||(N={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(D||(D={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return ne.string(t)||ne.objectLiteral(t)&&ne.string(t.language)&&ne.string(t.value)}}(O||(O={})),function(e){e.is=function(e){var t=e;return!!t&&ne.objectLiteral(t)&&(I.is(t.contents)||O.is(t.contents)||ne.typedArray(t.contents,O.is))&&(void 0===e.range||r.is(e.range))}}(M||(M={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(L||(L={})),function(e){e.create=function(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var r={label:e};return ne.defined(t)&&(r.documentation=t),ne.defined(n)?r.parameters=n:r.parameters=[],r}}(U||(U={})),function(e){e.Text=1,e.Read=2,e.Write=3}($||($={})),function(e){e.create=function(e,t){var n={range:e};return ne.number(t)&&(n.kind=t),n}}(q||(q={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(W||(W={})),function(e){e.Deprecated=1}(V||(V={})),function(e){e.create=function(e,t,n,s,r){var i={name:e,kind:t,location:{uri:s,range:n}};return r&&(i.containerName=r),i}}(B||(B={})),function(e){e.create=function(e,t,n,s,r,i){var o={name:e,detail:t,kind:n,range:s,selectionRange:r};return void 0!==i&&(o.children=i),o},e.is=function(e){var t=e;return t&&ne.string(t.name)&&ne.number(t.kind)&&r.is(t.range)&&r.is(t.selectionRange)&&(void 0===t.detail||ne.string(t.detail))&&(void 0===t.deprecated||ne.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(j||(j={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(z||(z={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return ne.defined(t)&&ne.typedArray(t.diagnostics,y.is)&&(void 0===t.only||ne.typedArray(t.only,ne.string))}}(H||(H={})),function(e){e.create=function(e,t,n){var s={title:e};return m.is(t)?s.command=t:s.edit=t,void 0!==n&&(s.kind=n),s},e.is=function(e){var t=e;return t&&ne.string(t.title)&&(void 0===t.diagnostics||ne.typedArray(t.diagnostics,y.is))&&(void 0===t.kind||ne.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||m.is(t.command))&&(void 0===t.isPreferred||ne.boolean(t.isPreferred))&&(void 0===t.edit||C.is(t.edit))}}(G||(G={})),function(e){e.create=function(e,t){var n={range:e};return ne.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return ne.defined(t)&&r.is(t.range)&&(ne.undefined(t.command)||m.is(t.command))}}(K||(K={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return ne.defined(t)&&ne.number(t.tabSize)&&ne.boolean(t.insertSpaces)}}(Y||(Y={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return ne.defined(t)&&r.is(t.range)&&(ne.undefined(t.target)||ne.string(t.target))}}(Q||(Q={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&r.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(X||(X={}));var ee,te=["\n","\r\n","\r"];!function(e){e.create=function(e,t,n,s){return new se(e,t,n,s)},e.is=function(e){var t=e;return!!(ne.defined(t)&&ne.string(t.uri)&&(ne.undefined(t.languageId)||ne.string(t.languageId))&&ne.number(t.lineCount)&&ne.func(t.getText)&&ne.func(t.positionAt)&&ne.func(t.offsetAt))},e.applyEdits=function(e,t){for(var n=e.getText(),s=function e(t,n){if(t.length<=1)return t;var s=t.length/2|0,r=t.slice(0,s),i=t.slice(s);e(r,n),e(i,n);var o=0,a=0,c=0;for(;o<r.length&&a<i.length;){var l=n(r[o],i[a]);t[c++]=l<=0?r[o++]:i[a++]}for(;o<r.length;)t[c++]=r[o++];for(;a<i.length;)t[c++]=i[a++];return t}(t,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),r=n.length,i=s.length-1;i>=0;i--){var o=s[i],a=e.offsetAt(o.range.start),c=e.offsetAt(o.range.end);if(!(c<=r))throw new Error("Overlapping edit");n=n.substring(0,a)+o.newText+n.substring(c,n.length),r=a}return n}}(ee||(ee={}));var ne,se=function(){function e(e,t,n,s){this._uri=e,this._languageId=t,this._version=n,this._content=s,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,s=0;s<t.length;s++){n&&(e.push(s),n=!1);var r=t.charAt(s);n="\r"===r||"\n"===r,"\r"===r&&s+1<t.length&&"\n"===t.charAt(s+1)&&s++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return s.create(0,e);for(;n<r;){var i=Math.floor((n+r)/2);t[i]>e?r=i:n=i+1}var o=n-1;return s.create(o,e-t[o])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],s=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,s),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(ne||(ne={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(78),r=n(9),i=n(5),o=n(79);t.ImplementationRequest=o.ImplementationRequest;const a=n(80);t.TypeDefinitionRequest=a.TypeDefinitionRequest;const c=n(81);t.WorkspaceFoldersRequest=c.WorkspaceFoldersRequest,t.DidChangeWorkspaceFoldersNotification=c.DidChangeWorkspaceFoldersNotification;const l=n(82);t.ConfigurationRequest=l.ConfigurationRequest;const p=n(83);t.DocumentColorRequest=p.DocumentColorRequest,t.ColorPresentationRequest=p.ColorPresentationRequest;const u=n(84);t.FoldingRangeRequest=u.FoldingRangeRequest;const d=n(85);t.DeclarationRequest=d.DeclarationRequest;const h=n(86);t.SelectionRangeRequest=h.SelectionRangeRequest;const f=n(87);var g,y;t.WorkDoneProgress=f.WorkDoneProgress,t.WorkDoneProgressCreateRequest=f.WorkDoneProgressCreateRequest,t.WorkDoneProgressCancelNotification=f.WorkDoneProgressCancelNotification,function(e){e.is=function(e){const t=e;return s.string(t.language)||s.string(t.scheme)||s.string(t.pattern)}}(g=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!s.string(t)&&!g.is(t))return!1;return!0}}(y=t.DocumentSelector||(t.DocumentSelector={})),function(e){e.type=new i.ProtocolRequestType("client/registerCapability")}(t.RegistrationRequest||(t.RegistrationRequest={})),function(e){e.type=new i.ProtocolRequestType("client/unregisterCapability")}(t.UnregistrationRequest||(t.UnregistrationRequest={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(t.ResourceOperationKind||(t.ResourceOperationKind={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(t.FailureHandlingKind||(t.FailureHandlingKind={})),function(e){e.hasId=function(e){const t=e;return t&&s.string(t.id)&&t.id.length>0}}(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||y.is(t.documentSelector))}}(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})),function(e){e.is=function(e){const t=e;return s.objectLiteral(t)&&(void 0===t.workDoneProgress||s.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&s.boolean(t.workDoneProgress)}}(t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})),function(e){e.type=new i.ProtocolRequestType("initialize")}(t.InitializeRequest||(t.InitializeRequest={})),function(e){e.unknownProtocolVersion=1}(t.InitializeError||(t.InitializeError={})),function(e){e.type=new i.ProtocolNotificationType("initialized")}(t.InitializedNotification||(t.InitializedNotification={})),function(e){e.type=new i.ProtocolRequestType0("shutdown")}(t.ShutdownRequest||(t.ShutdownRequest={})),function(e){e.type=new i.ProtocolNotificationType0("exit")}(t.ExitNotification||(t.ExitNotification={})),function(e){e.type=new i.ProtocolNotificationType("workspace/didChangeConfiguration")}(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4}(t.MessageType||(t.MessageType={})),function(e){e.type=new i.ProtocolNotificationType("window/showMessage")}(t.ShowMessageNotification||(t.ShowMessageNotification={})),function(e){e.type=new i.ProtocolRequestType("window/showMessageRequest")}(t.ShowMessageRequest||(t.ShowMessageRequest={})),function(e){e.type=new i.ProtocolNotificationType("window/logMessage")}(t.LogMessageNotification||(t.LogMessageNotification={})),function(e){e.type=new i.ProtocolNotificationType("telemetry/event")}(t.TelemetryEventNotification||(t.TelemetryEventNotification={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})),function(e){e.method="textDocument/didOpen",e.type=new i.ProtocolNotificationType(e.method)}(t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})),function(e){e.method="textDocument/didChange",e.type=new i.ProtocolNotificationType(e.method)}(t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})),function(e){e.method="textDocument/didClose",e.type=new i.ProtocolNotificationType(e.method)}(t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})),function(e){e.method="textDocument/didSave",e.type=new i.ProtocolNotificationType(e.method)}(t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})),function(e){e.method="textDocument/willSave",e.type=new i.ProtocolNotificationType(e.method)}(t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})),function(e){e.method="textDocument/willSaveWaitUntil",e.type=new i.ProtocolRequestType(e.method)}(t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})),function(e){e.type=new i.ProtocolNotificationType("workspace/didChangeWatchedFiles")}(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(t.FileChangeType||(t.FileChangeType={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(t.WatchKind||(t.WatchKind={})),function(e){e.type=new i.ProtocolNotificationType("textDocument/publishDiagnostics")}(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(t.CompletionTriggerKind||(t.CompletionTriggerKind={})),function(e){e.method="textDocument/completion",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.CompletionRequest||(t.CompletionRequest={})),function(e){e.method="completionItem/resolve",e.type=new i.ProtocolRequestType(e.method)}(t.CompletionResolveRequest||(t.CompletionResolveRequest={})),function(e){e.method="textDocument/hover",e.type=new i.ProtocolRequestType(e.method)}(t.HoverRequest||(t.HoverRequest={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})),function(e){e.method="textDocument/signatureHelp",e.type=new i.ProtocolRequestType(e.method)}(t.SignatureHelpRequest||(t.SignatureHelpRequest={})),function(e){e.method="textDocument/definition",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DefinitionRequest||(t.DefinitionRequest={})),function(e){e.method="textDocument/references",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.ReferencesRequest||(t.ReferencesRequest={})),function(e){e.method="textDocument/documentHighlight",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})),function(e){e.method="textDocument/documentSymbol",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})),function(e){e.method="textDocument/codeAction",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.CodeActionRequest||(t.CodeActionRequest={})),function(e){e.method="workspace/symbol",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})),function(e){e.type=new i.ProtocolRequestType("textDocument/codeLens"),e.resultType=new r.ProgressType}(t.CodeLensRequest||(t.CodeLensRequest={})),function(e){e.type=new i.ProtocolRequestType("codeLens/resolve")}(t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})),function(e){e.method="textDocument/documentLink",e.type=new i.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DocumentLinkRequest||(t.DocumentLinkRequest={})),function(e){e.type=new i.ProtocolRequestType("documentLink/resolve")}(t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})),function(e){e.method="textDocument/formatting",e.type=new i.ProtocolRequestType(e.method)}(t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})),function(e){e.method="textDocument/rangeFormatting",e.type=new i.ProtocolRequestType(e.method)}(t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})),function(e){e.method="textDocument/onTypeFormatting",e.type=new i.ProtocolRequestType(e.method)}(t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})),function(e){e.method="textDocument/rename",e.type=new i.ProtocolRequestType(e.method)}(t.RenameRequest||(t.RenameRequest={})),function(e){e.method="textDocument/prepareRename",e.type=new i.ProtocolRequestType(e.method)}(t.PrepareRenameRequest||(t.PrepareRenameRequest={})),function(e){e.type=new i.ProtocolRequestType("workspace/executeCommand")}(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})),function(e){e.type=new i.ProtocolRequestType("workspace/applyEdit")}(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={}))},function(e,t,n){"use strict";function s(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every(e=>s(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9),r=n(5);!function(e){e.method="textDocument/implementation",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.ImplementationRequest||(t.ImplementationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9),r=n(5);!function(e){e.method="textDocument/typeDefinition",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.TypeDefinitionRequest||(t.TypeDefinitionRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5);!function(e){e.type=new s.ProtocolRequestType0("workspace/workspaceFolders")}(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})),function(e){e.type=new s.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")}(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5);!function(e){e.type=new s.ProtocolRequestType("workspace/configuration")}(t.ConfigurationRequest||(t.ConfigurationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9),r=n(5);!function(e){e.method="textDocument/documentColor",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DocumentColorRequest||(t.DocumentColorRequest={})),function(e){e.type=new r.ProtocolRequestType("textDocument/colorPresentation")}(t.ColorPresentationRequest||(t.ColorPresentationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9),r=n(5);!function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(t.FoldingRangeKind||(t.FoldingRangeKind={})),function(e){e.method="textDocument/foldingRange",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.FoldingRangeRequest||(t.FoldingRangeRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9),r=n(5);!function(e){e.method="textDocument/declaration",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DeclarationRequest||(t.DeclarationRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9),r=n(5);!function(e){e.method="textDocument/selectionRange",e.type=new r.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.SelectionRangeRequest||(t.SelectionRangeRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9),r=n(5);!function(e){e.type=new s.ProgressType}(t.WorkDoneProgress||(t.WorkDoneProgress={})),function(e){e.type=new r.ProtocolRequestType("window/workDoneProgress/create")}(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})),function(e){e.type=new r.ProtocolNotificationType("window/workDoneProgress/cancel")}(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5);!function(e){e.method="textDocument/prepareCallHierarchy",e.type=new s.ProtocolRequestType(e.method)}(t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})),function(e){e.method="callHierarchy/incomingCalls",e.type=new s.ProtocolRequestType(e.method)}(t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})),function(e){e.method="callHierarchy/outgoingCalls",e.type=new s.ProtocolRequestType(e.method)}(t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5);!function(e){e.comment="comment",e.keyword="keyword",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.namespace="namespace",e.type="type",e.struct="struct",e.class="class",e.interface="interface",e.enum="enum",e.typeParameter="typeParameter",e.function="function",e.member="member",e.property="property",e.macro="macro",e.variable="variable",e.parameter="parameter",e.label="label"}(t.SemanticTokenTypes||(t.SemanticTokenTypes={})),function(e){e.documentation="documentation",e.declaration="declaration",e.definition="definition",e.static="static",e.abstract="abstract",e.deprecated="deprecated",e.readonly="readonly"}(t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})),function(e){e.is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(t.SemanticTokens||(t.SemanticTokens={})),function(e){e.method="textDocument/semanticTokens",e.type=new s.ProtocolRequestType(e.method)}(t.SemanticTokensRequest||(t.SemanticTokensRequest={})),function(e){e.method="textDocument/semanticTokens/edits",e.type=new s.ProtocolRequestType(e.method)}(t.SemanticTokensEditsRequest||(t.SemanticTokensEditsRequest={})),function(e){e.method="textDocument/semanticTokens/range",e.type=new s.ProtocolRequestType(e.method)}(t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(13),r=n(43);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?r.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(s.ConfigurationRequest.type,t).then(t=>Array.isArray(e)?t:t[0])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(13);t.WorkspaceFoldersFeature=e=>class extends e{initialize(e){let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new s.Emitter,this.connection.onNotification(s.DidChangeWorkspaceFoldersNotification.type,e=>{this._onDidChangeWorkspaceFolders.fire(e.event)}))}getWorkspaceFolders(){return this.connection.sendRequest(s.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._unregistration||(this._unregistration=this.connection.client.register(s.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(13),r=n(44);class i{constructor(e,t){this._connection=e,this._token=t,i.Instances.set(this._token,this),this._source=new s.CancellationTokenSource}get token(){return this._source.token}begin(e,t,n,r){let i={kind:"begin",title:e,percentage:t,message:n,cancellable:r};this._connection.sendProgress(s.WorkDoneProgress.type,this._token,i)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(s.WorkDoneProgress.type,this._token,n)}done(){i.Instances.delete(this._token),this._source.dispose(),this._connection.sendProgress(s.WorkDoneProgress.type,this._token,{kind:"end"})}cancel(){this._source.cancel()}}i.Instances=new Map;class o{constructor(){this._source=new s.CancellationTokenSource}get token(){return this._source.token}begin(){}report(){}done(){}}var a;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new o;const n=t.workDoneToken;return delete t.workDoneToken,new i(e,n)},t.ProgressFeature=e=>class extends e{initialize(e){var t,n;!0===(null===(n=null===(t=e)||void 0===t?void 0:t.window)||void 0===n?void 0:n.workDoneProgress)&&(this._progressSupported=!0,this.connection.onNotification(s.WorkDoneProgressCancelNotification.type,e=>{let t=i.Instances.get(e.token);void 0!==t&&t.cancel()}))}attachWorkDoneProgress(e){return void 0===e?new o:new i(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=r.generateUuid();return this.connection.sendRequest(s.WorkDoneProgressCreateRequest.type,{token:e}).then(()=>new i(this.connection,e))}return Promise.resolve(new o)}},function(e){e.type=new s.ProgressType}(a||(a={}));class c{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(a.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new c(e,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(94),r=n(2),i=n(11),o=n(45);function a(){return"win32"===process.platform}function c(e,t,n,s){const a=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((c,l)=>{let p=process.env,u=Object.create(null);Object.keys(p).forEach(e=>u[e]=p[e]),t&&i.existsSync(t)&&(u.NODE_PATH?u.NODE_PATH=t+r.delimiter+u.NODE_PATH:u.NODE_PATH=t,s&&s(`NODE_PATH value is: ${u.NODE_PATH}`)),u.ELECTRON_RUN_AS_NODE="1";try{let t=o.fork("",[],{cwd:n,env:u,execArgv:["-e",a]});if(void 0===t.pid)return void l(new Error(`Starting process to resolve node module  ${e} failed`));t.on("error",e=>{l(e)}),t.on("message",n=>{"r"===n.c&&(t.send({c:"e"}),n.s?c(n.r):l(new Error(`Failed to resolve module: ${e}`)))});let s={c:"rs",a:e};t.send(s)}catch(e){l(e)}})}function l(e){let t="npm";const n=Object.create(null);Object.keys(process.env).forEach(e=>n[e]=process.env[e]),n.NO_UPDATE_NOTIFIER="true";const s={encoding:"utf8",env:n};a()&&(t="npm.cmd",s.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let n=o.spawnSync(t,["config","get","prefix"],s).stdout;if(!n)return void(e&&e("'npm config get prefix' didn't return a value."));let c=n.trim();return e&&e(`'npm config get prefix' value is: ${c}`),c.length>0?a()?r.join(c,"node_modules"):r.join(c,"lib","node_modules"):void 0}catch(e){return}finally{process.removeListener("SIGPIPE",i)}}var p;t.uriToFilePath=function(e){let t=s.parse(e);if("file:"!==t.protocol||!t.path)return;let n=t.path.split("/");for(var i=0,o=n.length;i<o;i++)n[i]=decodeURIComponent(n[i]);if("win32"===process.platform&&n.length>1){let e=n[0],t=n[1];0===e.length&&t.length>1&&":"===t[1]&&n.shift()}return r.normalize(n.join("/"))},t.resolve=c,t.resolveGlobalNodePath=l,t.resolveGlobalYarnPath=function(e){let t="yarn",n={encoding:"utf8"};a()&&(t="yarn.cmd",n.shell=!0);let s=()=>{};try{process.on("SIGPIPE",s);let i=o.spawnSync(t,["global","dir","--json"],n),a=i.stdout;if(!a)return void(e&&(e("'yarn global dir' didn't return a value."),i.stderr&&e(i.stderr)));let c=a.trim().split(/\r?\n/);for(let e of c)try{let t=JSON.parse(e);if("log"===t.type)return r.join(t.data,"node_modules")}catch(e){}return}catch(e){return}finally{process.removeListener("SIGPIPE",s)}},function(e){let t=void 0;function n(){return void 0!==t||(t="win32"!==process.platform&&(!i.existsSync(__filename.toUpperCase())||!i.existsSync(__filename.toLowerCase()))),t}e.isCaseSensitive=n,e.isParent=function(e,t){return n()?0===r.normalize(t).indexOf(r.normalize(e)):0===r.normalize(t).toLowerCase().indexOf(r.normalize(e).toLowerCase())}}(p=t.FileSystem||(t.FileSystem={})),t.resolveModulePath=function(e,t,n,s){return n?(r.isAbsolute(n)||(n=r.join(e,n)),c(t,n,n,s).then(e=>p.isParent(n,e)?e:Promise.reject(new Error(`Failed to load ${t} from node path location.`))).then(void 0,n=>c(t,l(s),e,s))):c(t,l(s),e,s)}},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(13);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>{this.connection.onRequest(s.Proposed.CallHierarchyPrepareRequest.type,(t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0))},onIncomingCalls:e=>{const t=s.Proposed.CallHierarchyIncomingCallsRequest.type;this.connection.onRequest(t,(n,s)=>e(n,s,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n)))},onOutgoingCalls:e=>{const t=s.Proposed.CallHierarchyOutgoingCallsRequest.type;this.connection.onRequest(t,(n,s)=>e(n,s,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n)))}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(13);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{on:e=>{const t=s.Proposed.SemanticTokensRequest.type;this.connection.onRequest(t,(n,s)=>e(n,s,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n)))},onEdits:e=>{const t=s.Proposed.SemanticTokensEditsRequest.type;this.connection.onRequest(t,(n,s)=>e(n,s,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n)))},onRange:e=>{const t=s.Proposed.SemanticTokensRangeRequest.type;this.connection.onRequest(t,(n,s)=>e(n,s,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n)))}}}};t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,s,r){let i=e,o=t;this._dataLen>0&&(i-=this._prevLine,0===i&&(o-=this._prevChar)),this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._data[this._dataLen++]=n,this._data[this._dataLen++]=s,this._data[this._dataLen++]=r,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){if(void 0!==this._prevData){const e=this._prevData.length,t=this._data.length;let n=0;for(;n<t&&n<e&&this._prevData[n]===this._data[n];)n++;if(n<t&&n<e){let s=0;for(;s<t&&s<e&&this._prevData[e-1-s]===this._data[t-1-s];)s++;const r=this._data.slice(n,t-s);return{resultId:this.id,edits:[{start:n,deleteCount:e-s-n,data:r}]}}return n<t?{resultId:this.id,edits:[{start:n,deleteCount:0,data:this._data.slice(n)}]}:n<e?{resultId:this.id,edits:[{start:n,deleteCount:e-n}]}:{resultId:this.id,edits:[]}}return this.build()}}},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(46),i=n(3),o=n(6),a=n(63);t.CreateTypeStubCommand=class{constructor(e){this._ls=e}execute(e,t){return s(this,void 0,void 0,(function*(){if(e.arguments&&e.arguments.length>=2){const n=e.arguments[0],s=e.arguments[1],r=e.arguments[2],c=this._createTypeStubService(r),l={workspaceName:`Create Type Stub ${s}`,rootPath:n,rootUri:o.convertPathToUri(n),serviceInstance:c,disableLanguageServices:!0,disableOrganizeImports:!0};c.setCompletionCallback(e=>{if(0===e.filesRequiringAnalysis)try{c.writeTypeStub(t),c.dispose();const e=`Type stub was successfully created for '${s}'.`;this._ls.window.showInformationMessage(e),this._handlePostCreateTypeStub()}catch(e){if(i.OperationCanceledException.is(e)){const e=`Type stub creation for '${s}' was canceled`;this._ls.console.error(e)}else{let t="";e instanceof Error&&(t=": "+e.message),t=`An error occurred when creating type stub for '${s}'`+t,this._ls.console.error(t),this._ls.window.showErrorMessage(t)}}});const p=yield this._ls.getSettings(l);a.AnalyzerServiceExecutor.runWithOptions(this._ls.rootPath,l,p,s)}else;}))}_createTypeStubService(e){const t=this._createAnalyzerService(e);return t.setMaxAnalysisDuration({openFilesTimeInMs:500,noOpenFilesTimeInMs:500}),t}_createAnalyzerService(e){if(this._ls.console.log("Starting type stub service instance"),e){return this._ls.getWorkspaceForFile(e).serviceInstance.clone("Type stub")}return new r.AnalyzerService("Type stub",this._ls.fs,this._ls.console)}_handlePostCreateTypeStub(){this._ls.reanalyze()}}},function(e,t,n){"use strict";const s=[],r=[],i=(e,t)=>{if(e===t)return 0;const n=e;e.length>t.length&&(e=t,t=n);let i=e.length,o=t.length;for(;i>0&&e.charCodeAt(~-i)===t.charCodeAt(~-o);)i--,o--;let a,c,l,p,u=0;for(;u<i&&e.charCodeAt(u)===t.charCodeAt(u);)u++;if(i-=u,o-=u,0===i)return o;let d=0,h=0;for(;d<i;)r[d]=e.charCodeAt(u+d),s[d]=++d;for(;h<o;)for(a=t.charCodeAt(u+h),l=h++,c=h,d=0;d<i;d++)p=a===r[d]?l:l+1,l=s[d],c=s[d]=l>c?p>c?c+1:p:p>l?l+1:p;return c};e.exports=i,e.exports.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(10),r=n(3),i=n(26),o=n(1),a=n(6),c=n(0),l=n(27),p=n(7),u=n(100),d=n(101),h=n(118),f=n(120);t.Program=class{constructor(e,t,n,s){this._extension=s,this._sourceFileList=[],this._sourceFileMap=new Map,this._lookUpImport=e=>{const t=this._sourceFileMap.get(e);if(!t)return;t.sourceFile.isBindingRequired()&&l.timingStats.typeCheckerTime.subtractFromTime(()=>{this._bindFile(t)});const n=t.sourceFile.getModuleSymbolTable();return n?{symbolTable:n,docString:t.sourceFile.getModuleDocString()}:void 0},this._console=n||new i.StandardConsole,this._evaluator=h.createTypeEvaluator(this._lookUpImport),this._importResolver=e,this._configOptions=t}setConfigOptions(e){this._configOptions=e}setImportResolver(e){this._importResolver=e}setTrackedFiles(e){if(this._sourceFileList.length>0){const t=new Map;e.forEach(e=>{t.set(e,e)}),this._sourceFileList.forEach(e=>{const n=e.sourceFile.getFilePath();t.has(n)||(e.isTracked=!1)})}return this.addTrackedFiles(e),this._removeUnneededFiles()}setAllowedThirdPartyImports(e){this._allowedThirdPartyImports=e}getFileCount(){return this._sourceFileList.length}getFilesToAnalyzeCount(){let e=0;return this._sourceFileList.forEach(t=>{(t.sourceFile.isParseRequired()||t.sourceFile.isBindingRequired()||t.sourceFile.isCheckingRequired())&&(!this._configOptions.checkOnlyOpenFiles&&t.isTracked||t.isOpenByClient)&&e++}),e}isCheckingOnlyOpenFiles(){return this._configOptions.checkOnlyOpenFiles}addTrackedFiles(e){e.forEach(e=>{this.addTrackedFile(e)})}addTrackedFile(e){let t=this._sourceFileMap.get(e);if(t)return t.isTracked=!0,t.sourceFile;const n=new d.SourceFile(this._fs,e,!1,!1,this._console);return t={sourceFile:n,isTracked:!0,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:!1,diagnosticsVersion:n.getDiagnosticVersion(),imports:[],importedBy:[]},this._addToSourceFileListAndMap(t),n}setFileOpened(e,t,n){let s=this._sourceFileMap.get(e);if(s)s.isOpenByClient=!0,this._configOptions.checkOnlyOpenFiles&&(s.diagnosticsVersion=void 0);else{const t=new d.SourceFile(this._fs,e,!1,!1,this._console);s={sourceFile:t,isTracked:!1,isOpenByClient:!0,isTypeshedFile:!1,isThirdPartyImport:!1,diagnosticsVersion:t.getDiagnosticVersion(),imports:[],importedBy:[]},this._addToSourceFileListAndMap(s)}s.sourceFile.setClientVersion(t,n)}setFileClosed(e){const t=this._sourceFileMap.get(e);return t&&(t.isOpenByClient=!1,t.sourceFile.setClientVersion(null,""),this._configOptions.checkOnlyOpenFiles&&(t.diagnosticsVersion=void 0)),this._removeUnneededFiles()}markAllFilesDirty(e){const t=new Map;this._sourceFileList.forEach(n=>{e?n.sourceFile.markDirty():n.sourceFile.didContentsChangeOnDisk()&&(n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,t))}),t.size>0&&this._createNewEvaluator()}markFilesDirty(e){const t=new Map;e.forEach(e=>{const n=this._sourceFileMap.get(e);n&&(n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,t))}),t.size>0&&this._createNewEvaluator()}getSourceFile(e){const t=this._sourceFileMap.get(e);if(t)return t.sourceFile}analyze(e,t,n=s.CancellationToken.None){return this._runEvaluatorWithCancellationToken(n,()=>{const n=new l.Duration,s=this._sourceFileList.filter(e=>e.isOpenByClient&&e.sourceFile.isCheckingRequired());if(s.length>0){const t=e?e.openFilesTimeInMs:Number.MAX_VALUE;for(const e of s)if(this._checkTypes(e)&&n.getDurationInMilliseconds()>t)return!0;if(void 0!==e)return!0}if(!this._configOptions.checkOnlyOpenFiles){const s=this._sourceFileList,r=e?t?e.openFilesTimeInMs:e.noOpenFilesTimeInMs:Number.MAX_VALUE;for(const e of s)if(this._checkTypes(e)&&n.getDurationInMilliseconds()>r)return!0}return!1})}printDependencies(e,t){const n=this._sourceFileList.filter(e=>!e.isTypeshedFile).sort((e,t)=>e.sourceFile.getFilePath()<t.sourceFile.getFilePath()?1:-1),s=[];n.forEach(n=>{this._console.log("");let r=n.sourceFile.getFilePath();const i=a.getRelativePath(r,e);i&&(r=i),this._console.log(`${r}`),this._console.log(` Imports     ${n.imports.length} `+`file${1===n.imports.length?"":"s"}`),t&&n.imports.forEach(e=>{this._console.log(`    ${e.sourceFile.getFilePath()}`)}),this._console.log(` Imported by ${n.importedBy.length} `+`file${1===n.importedBy.length?"":"s"}`),t&&n.importedBy.forEach(e=>{this._console.log(`    ${e.sourceFile.getFilePath()}`)}),0===n.importedBy.length&&s.push(n.sourceFile)}),s.length>0&&(this._console.log(""),this._console.log(`${s.length} file${1===s.length?"":"s"}`+" not explicitly imported"),s.forEach(e=>{this._console.log(`    ${e.getFilePath()}`)}))}writeTypeStub(e,t,n,s){for(const i of this._sourceFileList){r.throwIfCancellationRequested(s);const o=i.sourceFile.getFilePath(),c=a.getRelativePath(o,e);if(void 0!==c){let e=a.normalizePath(a.combinePaths(n,c));e=t?a.combinePaths(a.getDirectoryPath(e),"__init__.pyi"):a.stripFileExtension(e)+".pyi";const r=a.getDirectoryPath(e);try{a.makeDirectories(this._fs,r,n)}catch(e){throw new Error(`Could not create directory for '${r}'`)}this._bindFile(i),this._runEvaluatorWithCancellationToken(s,()=>{new f.TypeStubWriter(e,i.sourceFile,this._evaluator).write()})}}}get _fs(){return this._importResolver.fileSystem}_createNewEvaluator(){this._evaluator=h.createTypeEvaluator(this._lookUpImport)}_parseFile(e){if(this._isFileNeeded(e)&&e.sourceFile.isParseRequired()&&(e.sourceFile.parse(this._configOptions,this._importResolver)&&this._updateSourceFileImports(e,this._configOptions),e.sourceFile.isFileDeleted())){e.isTracked=!1;const t=new Map;this._markFileDirtyRecursive(e,t),this._importResolver.invalidateCache()}}_bindFile(e){if(!this._isFileNeeded(e)||!e.sourceFile.isBindingRequired())return;let t;if(this._parseFile(e),e.builtinsImport){this._bindFile(e.builtinsImport);const n=e.builtinsImport.sourceFile.getParseResults();n&&(t=p.getScope(n.parseTree),o.assert(void 0!==t))}e.sourceFile.bind(this._configOptions,this._lookUpImport,t)}_buildModuleSymbolsMap(e){const t=new Map;return this._sourceFileList.forEach(n=>{if(n!==e){const e=n.sourceFile.getModuleSymbolTable();e&&t.set(n.sourceFile.getFilePath(),e)}}),t}_checkTypes(e){if(!this._isFileNeeded(e))return!1;if(!e.sourceFile.isCheckingRequired())return!1;if((e.isThirdPartyImport||e.isTypeshedFile&&"none"===this._configOptions.diagnosticRuleSet.reportTypeshedErrors)&&!e.isOpenByClient)return!1;if(this._configOptions.checkOnlyOpenFiles&&!e.isOpenByClient)return!1;if(this._bindFile(e),this._evaluator.hasGrownTooLarge()&&(this._console.log("Emptying type cache to avoid heap overflow"),this._createNewEvaluator()),e.sourceFile.check(this._evaluator),"none"!==this._configOptions.diagnosticRuleSet.reportImportCycles&&!this._allowedThirdPartyImports){const t=new Map;this._getImportsRecursive(e,t,0),t.forEach(e=>{l.timingStats.cycleDetectionTime.timeOperation(()=>{this._detectAndReportImportCycles(e)})})}return!0}_getImportsRecursive(e,t,n){const s=e.sourceFile.getFilePath();if(!t.has(s))if(n>256)e.sourceFile.setHitMaxImportDepth(256);else{t.set(s,e);for(const s of e.imports)this._getImportsRecursive(s,t,n+1)}}_detectAndReportImportCycles(e,t=[],n=new Map){if(e.sourceFile.isStubFile()||e.isThirdPartyImport)return;const s=e.sourceFile.getFilePath();if(n.has(s))t.length>1&&e===t[0]&&this._logImportCycle(t);else{if(n.has(s))return;n.set(s,!0),t.push(e);for(const s of e.imports)this._detectAndReportImportCycles(s,t,n);n.set(s,!1),t.pop()}}_logImportCycle(e){const t=new u.CircularDependency;e.forEach(e=>{t.appendPath(e.sourceFile.getFilePath())}),t.normalizeOrder();const n=t.getPaths()[0],s=this._sourceFileMap.get(n);o.assert(void 0!==s),s.sourceFile.addCircularDependency(t)}_markFileDirtyRecursive(e,t){const n=e.sourceFile.getFilePath();t.has(n)||(e.sourceFile.markReanalysisRequired(),t.set(n,!0),e.importedBy.forEach(e=>{this._markFileDirtyRecursive(e,t)}))}getDiagnostics(e){const t=this._removeUnneededFiles();return this._sourceFileList.forEach(n=>{if(n.isOpenByClient||!e.checkOnlyOpenFiles&&!n.isThirdPartyImport){const s=n.sourceFile.getDiagnostics(e,n.diagnosticsVersion);void 0!==s&&(t.push({filePath:n.sourceFile.getFilePath(),diagnostics:s}),n.diagnosticsVersion=n.sourceFile.getDiagnosticVersion())}}),t}getDiagnosticsForRange(e,t,n){const s=this.getSourceFile(e);if(!s)return[];const r=s.getDiagnostics(t);return r?r.filter(e=>c.doRangesOverlap(e.range,n)):[]}getDefinitionsForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._sourceFileMap.get(e);if(s)return this._bindFile(s),s.sourceFile.getDefinitionsForPosition(t,this._evaluator,n)})}getReferencesForPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,()=>{const r=this._sourceFileMap.get(e);if(!r)return;this._bindFile(r);const i=r.sourceFile.getReferencesForPosition(t,n,this._evaluator,s);if(i){if(i.requiresGlobalSearch)for(const e of this._sourceFileList)e!==r&&(this._bindFile(e),e.sourceFile.addReferences(i,n,this._evaluator,s));return i.locations}})}addSymbolsForDocument(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._sourceFileMap.get(e);s&&(this._bindFile(s),s.sourceFile.addHierarchicalSymbolsForDocument(t,this._evaluator,n))})}addSymbolsForWorkspace(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{if(t)for(const s of this._sourceFileList)this._bindFile(s),s.sourceFile.addSymbolsForDocument(e,this._evaluator,t,n)})}getHoverForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._sourceFileMap.get(e);if(s)return this._bindFile(s),s.sourceFile.getHoverForPosition(t,this._evaluator,n)})}getSignatureHelpForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._sourceFileMap.get(e);if(s)return this._bindFile(s),s.sourceFile.getSignatureHelpForPosition(t,this._lookUpImport,this._evaluator,n)})}getCompletionsForPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,()=>{var r,i;const o=this._sourceFileMap.get(e);if(!o)return;this._bindFile(o);let a=o.sourceFile.getCompletionsForPosition(t,n,this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,()=>this._buildModuleSymbolsMap(o),s);if(a&&(null===(r=this._extension)||void 0===r?void 0:r.completionListExtension)){const e=null===(i=o.sourceFile.getParseResults())||void 0===i?void 0:i.parseTree;e&&(a=this._extension.completionListExtension.updateCompletionList(a,e,t,this._configOptions))}return a})}resolveCompletionItem(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._sourceFileMap.get(e);s&&(this._bindFile(s),s.sourceFile.resolveCompletionItem(this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,()=>this._buildModuleSymbolsMap(s),t,n))})}renameSymbolAtPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,()=>{const r=this._sourceFileMap.get(e);if(!r)return;const i=r.sourceFile.getReferencesForPosition(t,!0,this._evaluator,s);if(!i)return;if(i.requiresGlobalSearch)for(const e of this._sourceFileList)e!==r&&(this._bindFile(e),e.sourceFile.addReferences(i,!0,this._evaluator,s));const o=[];return i.locations.forEach(e=>{o.push({filePath:e.path,range:e.range,replacementText:n})}),o})}performQuickAction(e,t,n,s){const r=this._sourceFileMap.get(e);if(r)return this._bindFile(r),r.sourceFile.performQuickAction(t,n,s)}_runEvaluatorWithCancellationToken(e,t){try{return e?this._evaluator.runWithCancellationToken(e,t):t()}catch(e){throw this._createNewEvaluator(),e}}_removeUnneededFiles(){const e=[];for(let t=0;t<this._sourceFileList.length;){const n=this._sourceFileList[t];this._isFileNeeded(n)?(this._configOptions.checkOnlyOpenFiles&&!n.isOpenByClient&&n.diagnosticsVersion!==n.sourceFile.getDiagnosticVersion()&&(e.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.diagnosticsVersion=n.sourceFile.getDiagnosticVersion()),t++):(e.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.sourceFile.prepareForClose(),this._sourceFileMap.delete(n.sourceFile.getFilePath()),this._sourceFileList.splice(t,1),n.imports.forEach(s=>{const r=s.importedBy.findIndex(e=>e===n);if(o.assert(r>=0),s.importedBy.splice(r,1),!this._isFileNeeded(s)){const n=this._sourceFileList.findIndex(e=>e===s);n>=0&&n<t&&(e.push({filePath:s.sourceFile.getFilePath(),diagnostics:[]}),s.sourceFile.prepareForClose(),this._sourceFileMap.delete(s.sourceFile.getFilePath()),this._sourceFileList.splice(n,1),t--)}}))}return e}_isFileNeeded(e){return!e.sourceFile.isFileDeleted()&&(!(!e.isTracked&&!e.isOpenByClient)||0!==e.importedBy.length&&this._isImportNeededRecursive(e,new Map))}_isImportNeededRecursive(e,t){if(e.isTracked||e.isOpenByClient)return!0;const n=e.sourceFile.getFilePath();if(t.has(n))return!1;t.set(n,!0);for(const n of e.importedBy)if(this._isImportNeededRecursive(n,t))return!0;return!1}_isImportAllowed(e,t,n){let s=this._configOptions.useLibraryCodeForTypes;return!((1===t.importType||e.isThirdPartyImport&&2===t.importType)&&(this._allowedThirdPartyImports&&(t.isRelative||this._allowedThirdPartyImports.some(e=>t.importName===e||!!t.importName.startsWith(e+".")))&&(s=!0),!n))||s}_updateSourceFileImports(e,t){const n=[],s=e.sourceFile.getImports(),r=new Map;s.forEach(n=>{if(n.isImportFound){if(this._isImportAllowed(e,n,n.isStubFile)&&n.resolvedPaths.length>0){const t=n.resolvedPaths[n.resolvedPaths.length-1];t&&r.set(t,{isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:1===n.importType||e.isThirdPartyImport&&2===n.importType})}n.implicitImports.forEach(t=>{this._isImportAllowed(e,n,t.isStubFile)&&r.set(t.path,{isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:1===n.importType||e.isThirdPartyImport&&2===n.importType})})}else t.verboseOutput&&(e.isTypeshedFile&&"none"===t.diagnosticRuleSet.reportTypeshedErrors||(this._console.log(`Could not import '${n.importName}' `+`in file '${e.sourceFile.getFilePath()}'`),n.importFailureInfo&&n.importFailureInfo.forEach(e=>{this._console.log(`  ${e}`)})))});const i=new Map;e.imports.forEach(t=>{const n=t.sourceFile.getFilePath();r.has(n)?i.set(n,t):t.importedBy=t.importedBy.filter(t=>t.sourceFile.getFilePath()!==e.sourceFile.getFilePath())}),r.forEach((t,s)=>{if(!i.has(s)){let r;if(this._sourceFileMap.has(s))r=this._sourceFileMap.get(s);else{const e=new d.SourceFile(this._fs,s,t.isTypeshedFile,t.isThirdPartyImport,this._console);r={sourceFile:e,isTracked:!1,isOpenByClient:!1,isTypeshedFile:t.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,diagnosticsVersion:e.getDiagnosticVersion(),imports:[],importedBy:[]},this._addToSourceFileListAndMap(r),n.push(r)}r.importedBy.push(e),i.set(s,r)}}),e.imports=[],r.forEach((t,n)=>{this._sourceFileMap.has(n)&&e.imports.push(this._sourceFileMap.get(n))}),e.builtinsImport=void 0;const o=e.sourceFile.getBuiltinsImport();if(o){const t=o.resolvedPaths[o.resolvedPaths.length-1];e.builtinsImport=this._sourceFileMap.get(t)}return n}_addToSourceFileListAndMap(e){const t=e.sourceFile.getFilePath();o.assert(!this._sourceFileMap.has(t)),this._sourceFileList.push(e),this._sourceFileMap.set(t,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CircularDependency=class{constructor(){this._paths=[]}appendPath(e){this._paths.push(e)}getPaths(){return this._paths}normalizeOrder(){let e=0;this._paths.forEach((t,n)=>{t<this._paths[e]&&(e=n)}),0!==e&&(this._paths=this._paths.slice(e).concat(this._paths.slice(0,e)))}isEqual(e){if(e._paths.length!==this._paths.length)return!1;for(let t=0;t<this._paths.length;t++)if(this._paths[t]!==e._paths[t])return!1;return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(3),r=n(35),i=n(26),o=n(1),a=n(21),c=n(51),l=n(6),p=n(19),u=n(0),d=n(52),h=n(27),f=n(102),g=n(103),y=n(104),m=n(56),_=n(105),T=n(107),v=n(108),b=n(22),E=n(57),C=n(7),k=n(112),S=n(114),x=n(115),w=n(116),I=n(117);t.SourceFile=class{constructor(e,t,n,s,o){this._isFileDeleted=!1,this._diagnosticVersion=0,this._fileContentsVersion=0,this._lastFileContentLength=void 0,this._lastFileContentHash=void 0,this._clientVersion=null,this._analyzedFileContentsVersion=-1,this._parseTreeNeedsCleaning=!1,this._isBindingInProgress=!1,this._parseDiagnostics=[],this._bindDiagnostics=[],this._checkerDiagnostics=[],this._diagnosticRuleSet=r.getDefaultDiagnosticRuleSet(),this._circularDependencies=[],this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this.fileSystem=e,this._console=o||new i.StandardConsole,this._filePath=t,this._isStubFile=t.endsWith(".pyi"),this._isTypeshedStubFile=n,this._isThirdPartyImport=s;const a=l.getFileName(t);this._isTypingStubFile=this._isStubFile&&("typing.pyi"===a||"typing_extensions.pyi"===a),this._isBuiltInStubFile=!1,this._isStubFile&&(this._filePath.endsWith(l.normalizeSlashes("/collections/__init__.pyi"))||"builtins.pyi"===a||"_importlib_modulespec.pyi"===a||"dataclasses.pyi"===a||"abc.pyi"===a||"enum.pyi"===a)&&(this._isBuiltInStubFile=!0)}getFilePath(){return this._filePath}getDiagnosticVersion(){return this._diagnosticVersion}isStubFile(){return this._isStubFile}getDiagnostics(e,t){if(this._diagnosticVersion===t)return;let n=!0;this._isThirdPartyImport&&(n=!1);let s=[];if(s=s.concat(this._parseDiagnostics,this._bindDiagnostics,this._checkerDiagnostics),e.diagnosticRuleSet.enableTypeIgnoreComments){const e=this._parseResults?this._parseResults.tokenizerOutput.typeIgnoreLines:{};Object.keys(e).length>0&&(s=s.filter(t=>{for(let n=t.range.start.line;n<=t.range.end.line;n++)if(e[n])return!1;return!0}))}if("none"!==e.diagnosticRuleSet.reportImportCycles&&this._circularDependencies.length>0){const t="warning"===e.diagnosticRuleSet.reportImportCycles?1:0;this._circularDependencies.forEach(e=>{s.push(new a.Diagnostic(t,"Cycle detected in import chain\n"+e.getPaths().map(e=>"  "+e).join("\n"),u.getEmptyRange()))})}return void 0!==this._hitMaxImportDepth&&s.push(new a.Diagnostic(0,`Import chain depth exceeded ${this._hitMaxImportDepth}`,u.getEmptyRange())),this._isTypeshedStubFile&&("none"===e.diagnosticRuleSet.reportTypeshedErrors?n=!1:"warning"===e.diagnosticRuleSet.reportTypeshedErrors&&(s=s.map(e=>0===e.category?new a.Diagnostic(1,e.message,e.range):e))),e.ignore.find(e=>e.regExp.test(this._filePath))&&(s=[]),e.diagnosticRuleSet.enableTypeIgnoreComments&&this._parseResults&&this._parseResults.tokenizerOutput.typeIgnoreAll&&(s=[]),n||(s=s.filter(e=>2===e.category)),s}getImports(){return this._imports||[]}getBuiltinsImport(){return this._builtinsImport}getModuleSymbolTable(){return this._moduleSymbolTable}getModuleDocString(){return this._binderResults?this._binderResults.moduleDocString:void 0}didContentsChangeOnDisk(){if(null!==this._clientVersion)return!1;if(void 0===this._lastFileContentLength)return!1;try{const e=this.fileSystem.readFileSync(this._filePath,"utf8");if(e.length!==this._lastFileContentLength)return!0;if(p.hashString(e)!==this._lastFileContentHash)return!0}catch(e){return!0}return!1}markDirty(){this._fileContentsVersion++,this._isCheckingNeeded=!0,this._moduleSymbolTable=void 0,this._binderResults=void 0}markReanalysisRequired(){this._isCheckingNeeded=!0,this._parseResults&&this._parseResults.containsWildcardImport&&(this._parseTreeNeedsCleaning=!0,this._isBindingNeeded=!0,this._moduleSymbolTable=void 0,this._binderResults=void 0)}setClientVersion(e,t){this._clientVersion=e,null===e?this._fileContents=void 0:(void 0!==this._fileContents&&this._fileContents!==t&&this.markDirty(),this._fileContents=t)}prepareForClose(){}isFileDeleted(){return this._isFileDeleted}isParseRequired(){return this._analyzedFileContentsVersion!==this._fileContentsVersion}isBindingRequired(){return!this._isBindingInProgress&&(!!this.isParseRequired()||this._isBindingNeeded)}isCheckingRequired(){return!!this.isBindingRequired()||this._isCheckingNeeded}getParseResults(){if(!this.isParseRequired())return this._parseResults}addCircularDependency(e){let t=!1;this._circularDependencies.length<4&&(this._circularDependencies.some(t=>t.isEqual(e))||(this._circularDependencies.push(e),t=!0)),t&&this._diagnosticVersion++}setHitMaxImportDepth(e){this._hitMaxImportDepth=e}parse(e,t){if(!this.isParseRequired())return!1;const n=new c.DiagnosticSink;let s=this._fileContents;if(null===this._clientVersion)try{h.timingStats.readFileTime.timeOperation(()=>{s=this.fileSystem.readFileSync(this._filePath,"utf8"),this._lastFileContentLength=s.length,this._lastFileContentHash=p.hashString(s)})}catch(e){n.addError("Source file could not be read",u.getEmptyRange()),s="",this.fileSystem.existsSync(this._filePath)||(this._isFileDeleted=!0)}const r=e.findExecEnvironment(this._filePath),i=new E.ParseOptions;this._filePath.endsWith("pyi")&&(i.isStubFile=!0),i.pythonVersion=r.pythonVersion;try{const a=(new E.Parser).parseSourceFile(s,i,n);o.assert(void 0!==a&&void 0!==a.tokenizerOutput),this._parseResults=a,h.timingStats.resolveImportsTime.timeOperation(()=>{[this._imports,this._builtinsImport,this._typingModulePath,this._collectionsModulePath]=this._resolveImports(t,a.importedModules,r),this._parseDiagnostics=n.fetchAndClear()});const c=void 0!==e.strict.find(e=>e.regExp.test(this._filePath));this._diagnosticRuleSet=x.getFileLevelDirectives(this._parseResults.tokenizerOutput.tokens,e.diagnosticRuleSet,c)}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.log(`An internal error occurred while parsing ${this.getFilePath()}: `+t),this._parseResults={text:"",parseTree:b.ModuleNode.create({start:0,length:0}),importedModules:[],futureImports:new Map,tokenizerOutput:{tokens:new d.TextRangeCollection([]),lines:new d.TextRangeCollection([]),typeIgnoreAll:!1,typeIgnoreLines:{},predominantEndOfLineSequence:"\n",predominantTabSequence:"    ",predominantSingleQuoteCharacter:"'"},containsWildcardImport:!1},this._imports=void 0,this._builtinsImport=void 0;const n=new c.DiagnosticSink;n.addError("An internal error occurred while parsing file",u.getEmptyRange()),this._parseDiagnostics=n.fetchAndClear()}return this._analyzedFileContentsVersion=this._fileContentsVersion,this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._parseTreeNeedsCleaning=!1,this._hitMaxImportDepth=void 0,this._diagnosticVersion++,!0}getDefinitionsForPosition(e,t,n){if(this._parseResults)return g.DefinitionProvider.getDefinitionsForPosition(this._parseResults,e,t,n)}getReferencesForPosition(e,t,n,s){if(this._parseResults)return T.ReferencesProvider.getReferencesForPosition(this._parseResults,this._filePath,e,t,n,s)}addReferences(e,t,n,s){this._parseResults&&T.ReferencesProvider.addReferences(this._parseResults,this._filePath,e,t,n,s)}addHierarchicalSymbolsForDocument(e,t,n){this._parseResults&&y.DocumentSymbolProvider.addHierarchicalSymbolsForDocument(e,this._parseResults,t,n)}addSymbolsForDocument(e,t,n,s){this._parseResults&&y.DocumentSymbolProvider.addSymbolsForDocument(e,n,this._filePath,this._parseResults,t,s)}getHoverForPosition(e,t,n){if(!this._isBindingNeeded&&this._parseResults)return m.HoverProvider.getHoverForPosition(this._parseResults,e,t,n)}getSignatureHelpForPosition(e,t,n,s){if(this._parseResults)return v.SignatureHelpProvider.getSignatureHelpForPosition(this._parseResults,e,n,s)}getCompletionsForPosition(e,t,n,s,r,i,o,a){if(!this._parseResults)return;if(void 0===this._fileContents)return;return new f.CompletionProvider(t,this._parseResults,this._fileContents,s,e,this._filePath,n,r,i,o,a).getCompletionsForPosition()}resolveCompletionItem(e,t,n,s,r,i,o){if(!this._parseResults||void 0===this._fileContents)return;const a=i.data;new f.CompletionProvider(a.workspacePath,this._parseResults,this._fileContents,t,a.position,this._filePath,e,n,s,r,o).resolveCompletionItem(i)}performQuickAction(e,t,n){if(this._parseResults&&void 0!==this._fileContents)return _.performQuickAction(e,t,this._parseResults,n)}bind(e,t,n){o.assert(!this.isParseRequired()),o.assert(this.isBindingRequired()),o.assert(!this._isBindingInProgress),o.assert(void 0!==this._parseResults);try{h.timingStats.bindTime.timeOperation(()=>{this._cleanParseTreeIfRequired();const s=this._buildFileInfo(e,this._parseResults.text,t,n);C.setFileInfo(this._parseResults.parseTree,s);const r=new k.Binder(s);if(this._isBindingInProgress=!0,this._binderResults=r.bindModule(this._parseResults.parseTree),e.internalTestMode){(new I.TestWalker).walk(this._parseResults.parseTree)}this._bindDiagnostics=s.diagnosticSink.fetchAndClear();const i=C.getScope(this._parseResults.parseTree);o.assert(void 0!==i),this._moduleSymbolTable=i.symbolTable})}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.log(`An internal error occurred while performing name binding for ${this.getFilePath()}: `+t);const n=new c.DiagnosticSink;n.addError("An internal error occurred while performing name binding",u.getEmptyRange()),this._bindDiagnostics=n.fetchAndClear()}finally{this._isBindingInProgress=!1}this._diagnosticVersion++,this._isCheckingNeeded=!0,this._isBindingNeeded=!1}check(e){o.assert(!this.isParseRequired()),o.assert(!this.isBindingRequired()),o.assert(!this._isBindingInProgress),o.assert(this.isCheckingRequired()),o.assert(void 0!==this._parseResults);try{h.timingStats.typeCheckerTime.timeOperation(()=>{new S.Checker(this._parseResults.parseTree,e).check(),this._isCheckingNeeded=!1;const t=C.getFileInfo(this._parseResults.parseTree);this._checkerDiagnostics=t.diagnosticSink.fetchAndClear()})}catch(e){if(!s.OperationCanceledException.is(e)){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.log(`An internal error occurred while while performing type checking for ${this.getFilePath()}: `+t);const n=new c.DiagnosticSink;n.addError("An internal error occurred while performing type checking",u.getEmptyRange()),this._checkerDiagnostics=n.fetchAndClear(),this._isCheckingNeeded=!1}throw e}finally{this._circularDependencies=[],this._diagnosticVersion++}}_buildFileInfo(e,t,n,s){o.assert(void 0!==this._parseResults);const r=new c.TextRangeDiagnosticSink(this._parseResults.tokenizerOutput.lines);return{importLookup:n,futureImports:this._parseResults.futureImports,builtinsScope:s,typingModulePath:this._typingModulePath,collectionsModulePath:this._collectionsModulePath,diagnosticSink:r,executionEnvironment:e.findExecEnvironment(this._filePath),diagnosticRuleSet:this._diagnosticRuleSet,fileContents:t,lines:this._parseResults.tokenizerOutput.lines,filePath:this._filePath,isStubFile:this._isStubFile,isTypingStubFile:this._isTypingStubFile,isBuiltInStubFile:this._isBuiltInStubFile,accessedSymbolMap:new Map}}_cleanParseTreeIfRequired(){if(this._parseResults&&this._parseTreeNeedsCleaning){new w.ParseTreeCleanerWalker(this._parseResults.parseTree).clean(),this._parseTreeNeedsCleaning=!1}}_resolveImports(e,t,n){const s=[];let r=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["builtins"],importedSymbols:void 0});0===r.resolvedPaths.length||r.resolvedPaths[0]!==this.getFilePath()?s.push(r):r=void 0;const i=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["typing"],importedSymbols:void 0});let o,a;0!==i.resolvedPaths.length&&i.resolvedPaths[0]===this.getFilePath()||(s.push(i),o=i.resolvedPaths[0]);for(const r of t){const t=e.resolveImport(this._filePath,n,{leadingDots:r.leadingDots,nameParts:r.nameParts,importedSymbols:r.importedSymbols});t.isImportFound&&t.isTypeshedFile&&r.nameParts.length>=1&&"collections"===r.nameParts[0]&&(a=t.resolvedPaths[t.resolvedPaths.length-1]),s.push(t),C.setImportInfo(r.nameNode,t)}return[s,r,o,a]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(10),r=n(7),i=n(53),o=n(28),a=n(8),c=n(14),l=n(23),p=n(16),u=n(17),d=n(3),h=n(6),f=n(4),g=n(19),y=n(0),m=n(0),_=n(22),T=["True","False","None","and","or","await","not","is","lambda","yield","assert","async","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","nonlocal","pass","raise","return","try","while","yield"];var v;!function(e){e[e.LikelyKeyword=0]="LikelyKeyword",e[e.RecentImportModuleName=1]="RecentImportModuleName",e[e.ImportModuleName=2]="ImportModuleName",e[e.LiteralValue=3]="LiteralValue",e[e.NamedParameter=4]="NamedParameter",e[e.RecentKeywordOrSymbol=5]="RecentKeywordOrSymbol",e[e.RecentAutoImport=6]="RecentAutoImport",e[e.Keyword=7]="Keyword",e[e.NormalSymbol=8]="NormalSymbol",e[e.PrivateSymbol=9]="PrivateSymbol",e[e.DunderSymbol=10]="DunderSymbol",e[e.AutoImport=11]="AutoImport"}(v||(v={}));class b{constructor(e,t,n,s,r,i,o,a,c,l,p){this._workspacePath=e,this._parseResults=t,this._fileContents=n,this._importResolver=s,this._position=r,this._filePath=i,this._configOptions=o,this._importLookup=a,this._evaluator=c,this._moduleSymbolsCallback=l,this._cancellationToken=p}getCompletionsForPosition(){const e=f.convertPositionToOffset(this._position,this._parseResults.tokenizerOutput.lines);if(void 0===e)return;let t=a.findNodeByOffset(this._parseResults.parseTree,e);const n=t,s=t?a.getNodeDepth(t):0;if(!n||39!==n.nodeType){let r=e;for(;r>=0;){r--;const e=this._fileContents.substr(r,1);if("("===e||"\n"===e)break;const i=a.findNodeByOffset(this._parseResults.parseTree,r);if(i&&i!==n){a.getNodeDepth(i)>s&&(t=i);break}}}if(void 0===t)return;const r=this._parseResults.tokenizerOutput.lines.getItemAt(this._position.line),i=this._fileContents.substr(r.start,r.length),o=i.substr(0,this._position.character),c=i.substr(this._position.character),l=o.search(/\w+$/),p=l>=0?o.substr(l):"";if(this._isWithinComment(e,o))return;let u=t;for(;u&&0!==u.nodeType;)u=u.parent;let h=u||t;for(;;){if(d.throwIfCancellationRequested(this._cancellationToken),50===h.nodeType)return this._getStringLiteralCompletions(h,p,o,c);if(49===h.nodeType)return;if(38===h.nodeType)return this._getImportModuleCompletions(h);if(0===h.nodeType)return this._getExpressionErrorCompletions(h,p,o,c);if(36===h.nodeType)return this._getMemberAccessCompletions(h.leftExpression,p);if(39===h.nodeType){if(h.parent&&38===h.parent.nodeType)return this._getImportModuleCompletions(h.parent);if(h.parent&&23===h.parent.nodeType){const e=h.parent.parent;if(e&&22===e.nodeType)return h.parent.name===h?this._getImportFromCompletions(e,p):this._getImportFromCompletions(e,"")}else if(h.parent&&36===h.parent.nodeType)return this._getMemberAccessCompletions(h.parent.leftExpression,p)}if(22===h.nodeType)return this._getImportFromCompletions(h,p);if(_.isExpressionNode(h)||13===h.nodeType)return this._getExpressionCompletions(h,p,o,c);if(51===h.nodeType||37===h.nodeType)return this._getStatementCompletions(h,p,o,c);if(!h.parent)break;h=h.parent}}resolveCompletionItem(e){d.throwIfCancellationRequested(this._cancellationToken);const t=e.data,n=e.label;let s="";t.autoImportText&&(s=t.autoImportText);const r=b._mostRecentCompletions.findIndex(e=>e.label===n&&e.autoImportText===s);r>0&&(b._mostRecentCompletions=b._mostRecentCompletions.splice(r,1)),0!==r&&b._mostRecentCompletions.unshift({label:n,autoImportText:s}),b._mostRecentCompletions.length>128&&b._mostRecentCompletions.pop(),t.symbolId&&(this._itemToResolve=e,this.getCompletionsForPosition())}_isWithinComment(e,t){const n=this._parseResults.tokenizerOutput.tokens.getItemAtPosition(e);if(n<0)return!1;const s=this._parseResults.tokenizerOutput.tokens.getItemAt(n);return!(e>s.start&&e<m.TextRange.getEnd(s))&&!!t.match(/#/)}_getExpressionErrorCompletions(e,t,n,s){switch(e.category){case 0:return this._createSingleKeywordCompletionList("in");case 1:return this._createSingleKeywordCompletionList("else");case 2:case 3:case 4:return this._getExpressionCompletions(e,t,n,s);case 7:if(e.child&&_.isExpressionNode(e.child))return this._getMemberAccessCompletions(e.child,t);break;case 10:if(e.child&&39===e.child.nodeType)return this._getMethodOverrideCompletions(e.child)}}_createSingleKeywordCompletionList(e){const t=s.CompletionItem.create(e);return t.kind=s.CompletionItemKind.Keyword,t.sortText=this._makeSortText(v.LikelyKeyword,e),s.CompletionList.create([t])}_getMethodOverrideCompletions(e){const t=a.getEnclosingClass(e,!0);if(!t)return;const n=this._evaluator.getTypeOfClass(t);if(!n)return;const r=new Map;for(let e=n.classType.details.mro.length-1;e>0;e--){const t=n.classType.details.mro[e];7===t.category&&u.getMembersForClass(t,r,!1)}const i=s.CompletionList.create();return r.forEach((t,n)=>{const r=l.getLastTypedDeclaredForSymbol(t);if(r&&3===r.type){if(g.computeCompletionSimilarity(e.value,n)>.25){const o={start:{line:this._position.line,character:this._position.character-e.length},end:{line:this._position.line,character:this._position.character}},a=this._printMethodSignature(r.node)+":",c=s.TextEdit.replace(o,a);this._addSymbol(n,t,e.value,i,void 0,c)}}}),i}_printMethodSignature(e){const t=e.parameters.map(e=>{let t="";return 1===e.category?t+="*":2===e.category&&(t+="**"),e.name&&(t+=e.name.value),e.typeAnnotation&&(t+=": "+a.printExpression(e.typeAnnotation)),t}).join(", ");let n=e.name.value+"("+t+")";return e.returnTypeAnnotation&&(n+=" -> "+a.printExpression(e.returnTypeAnnotation)),n}_getMemberAccessCompletions(e,t){const n=this._evaluator.getType(e),r=new Map;n&&u.doForSubtypes(n,e=>{8===e.category?u.getMembersForClass(e.classType,r,!0):7===e.category?u.getMembersForClass(e,r,!1):9===e.category&&u.getMembersForModule(e,r)});const i=s.CompletionList.create();return this._addSymbolsForSymbolTable(r,e=>!0,t,i),i}_getStatementCompletions(e,t,n,s){return this._getExpressionCompletions(e,t,n,s)}_getExpressionCompletions(e,t,n,r){if(41===e.nodeType)return;const i=s.CompletionList.create();if(this._addCallArgumentCompletions(e,t,n,r,i),this._addSymbols(e,t,i),this._findMatchingKeywords(T,t).map(e=>{const t=s.CompletionItem.create(e);t.kind=s.CompletionItemKind.Keyword,i.items.push(t),t.sortText=this._makeSortText(v.Keyword,e)}),t.startsWith("_")||this._itemToResolve||this._getAutoImportCompletions(t,i),0===e.nodeType)if(3===e.category)this._getIndexStringLiteral(e,i);else if(2===e.category&&e.parent&&3===e.parent.nodeType){const t=this._evaluator.getDeclaredTypeForExpression(e.parent.leftExpression);t&&this._addLiteralValuesForTargetType(t,n,r,i)}return i}_addCallArgumentCompletions(e,t,n,s,r){const i=f.convertPositionToOffset(this._position,this._parseResults.tokenizerOutput.lines),o=this._evaluator.getCallSignatureInfo(e,i,this._parseResults.tokenizerOutput.tokens);if(o){const e=f.convertOffsetToPosition(o.callNode.leftExpression.start+o.callNode.leftExpression.length,this._parseResults.tokenizerOutput.lines);y.comparePositions(this._position,e)>0&&(this._addNamedParameters(o,t,r),this._addLiteralValuesForArgument(o,n,s,r))}}_addLiteralValuesForArgument(e,t,n,s){e.signatures.forEach(e=>{if(!e.activeParam)return;const r=e.type,i=r.details.parameters.indexOf(e.activeParam);if(i<0)return;const o=r.details.parameters[i].type;this._addLiteralValuesForTargetType(o,t,n,s)})}_addLiteralValuesForTargetType(e,t,n,s){const r=this._getQuoteValueFromPriorText(t);u.doForSubtypes(e,e=>{8===e.category&&p.ClassType.isBuiltIn(e.classType,"str")&&void 0!==e.literalValue&&this._addStringLiteralToCompletionList(e.literalValue,r.stringValue,n,r.quoteCharacter,s)})}_getStringLiteralCompletions(e,t,n,r){let i=e.parent;if(!i||49!==i.nodeType||i.strings.length>1)return;if(i=i.parent,!i)return;const o=s.CompletionList.create();if(25===i.nodeType){if(i=i.parent,!i||24!==i.nodeType)return;const e=this._evaluator.getType(i.baseExpression);if(!e||8!==e.category)return;const t=e.classType;if(!p.ClassType.isTypedDictClass(t))return;const s=this._evaluator.getTypedDictMembersForClass(t),a=this._getQuoteValueFromPriorText(n);s.forEach((e,t)=>{this._addStringLiteralToCompletionList(t,a.stringValue,r,a.quoteCharacter,o)})}else if(3===i.nodeType){const e=this._evaluator.getDeclaredTypeForExpression(i.leftExpression);e&&this._addLiteralValuesForTargetType(e,n,r,o)}else this._addCallArgumentCompletions(e,t,n,r,o);return o}_getQuoteValueFromPriorText(e){const t=e.lastIndexOf("'"),n=e.lastIndexOf('"');let s=this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter,r=void 0;return t>n?(s="'",r=e.substr(t+1)):n>t&&(s='"',r=e.substr(n+1)),{stringValue:r,quoteCharacter:s}}_getIndexStringLiteral(e,t){if(!e.parent||25!==e.parent.nodeType)return;const n=e.parent;if(!n.parent||24!==n.parent.nodeType)return;const s=this._evaluator.getType(n.parent.baseExpression);if(!s||8!==s.category)return;const r=s.classType;p.ClassType.isTypedDictClass(r)&&this._evaluator.getTypedDictMembersForClass(r).forEach((e,n)=>{this._addStringLiteralToCompletionList(n,void 0,void 0,this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter,t)})}_addStringLiteralToCompletionList(e,t,n,r,i){if(g.computeCompletionSimilarity(t||"",e)>.25){const o=`${r}${e}${r}`,a=s.CompletionItem.create(o);a.kind=s.CompletionItemKind.Text,a.sortText=this._makeSortText(v.LiteralValue,o);let c=this._position.character;void 0!==t&&(c-=t.length+1);let l=this._position.character;void 0!==n&&n.startsWith(r)&&l++;const p={start:{line:this._position.line,character:c},end:{line:this._position.line,character:l}};a.textEdit=s.TextEdit.replace(p,o),i.items.push(a)}}_getAutoImportCompletions(e,t){const n=this._moduleSymbolsCallback(),r=o.getTopLevelImports(this._parseResults.parseTree);n.forEach((i,o)=>{const a=h.stripFileExtension(h.getFileName(o));if(!c.isPrivateOrProtectedName(a)){i.forEach((n,s)=>{if((e.length>2?g.computeCompletionSimilarity(e,s)>.25:e.length>0&&s.startsWith(e))&&!n.isExternallyHidden()){const i=t.items.find(e=>e.label===s&&!e.data.autoImport),a=n.getDeclarations();if(a&&a.length>0&&void 0===i&&a[0].path===o){const i=r.mapByFilePath.get(o);let a,c;i?a=i.moduleName:(c=this._getModuleNameAndTypeFromFilePath(o),a=c.moduleName);const l=this._getTextEditsForAutoImportByFilePath(s,r,o,a,c?c.importType:2);this._addSymbol(s,n,e,t,a,void 0,l)}}});const a=h.getDirectoryPath(o),c=h.combinePaths(a,"__init__.py"),l=c+"i";if(n.has(c)||n.has(l)){const n=h.getFileName(a),i=this._getModuleNameAndTypeFromFilePath(h.getDirectoryPath(a));if(i.moduleName){const a=`Auto-import from ${i.moduleName}`;if(!t.items.find(e=>{if(e.label===n){if(!e.data.autoImport)return!0;if(e.data&&e.data.autoImport===a)return!0}return!1})){const c=this._getTextEditsForAutoImportByFilePath(n,r,o,i.moduleName,i?i.importType:2);this._addNameToCompletionList(n,s.CompletionItemKind.Module,e,t,n,"",a,void 0,c)}}}}})}_getModuleNameAndTypeFromFilePath(e){const t=this._configOptions.findExecEnvironment(this._filePath);return this._importResolver.getModuleNameForImport(e,t)}_getTextEditsForAutoImportByFilePath(e,t,n,s,r){const i=t.mapByFilePath.get(n);return i&&22===i.node.nodeType?o.getTextEditsForAutoImportSymbolAddition(e,i,this._parseResults):o.getTextEditsForAutoImportInsertion(e,t,s,r,this._parseResults)}_getImportFromCompletions(e,t){if(e.isWildcardImport)return;const n=r.getImportInfo(e.module);if(!n)return;const i=s.CompletionList.create(),o=n.resolvedPaths.length>0?n.resolvedPaths[n.resolvedPaths.length-1]:"",a=this._importLookup(o);return a&&this._addSymbolsForSymbolTable(a.symbolTable,t=>!e.imports.find(e=>e.name.value===t),t,i),n.implicitImports.forEach(n=>{e.imports.find(e=>e.name.value===n.name)||this._addNameToCompletionList(n.name,s.CompletionItemKind.Module,t,i)}),i}_findMatchingKeywords(e,t){return e.filter(e=>!t||g.computeCompletionSimilarity(t,e)>.25)}_addNamedParameters(e,t,n){const r=new Map;e.signatures.forEach(e=>{this._addNamedParametersToMap(e.type,r)}),e.callNode.arguments.forEach(e=>{e.name&&r.delete(e.name.value)}),r.forEach(e=>{if(g.computeCompletionSimilarity(t,e)>.25){const t=s.CompletionItem.create(e);t.kind=s.CompletionItemKind.Variable;const r={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};t.data=r,t.sortText=this._makeSortText(v.NamedParameter,e),n.items.push(t)}})}_addNamedParametersToMap(e,t){e.details.parameters.forEach(e=>{e.name&&!e.isNameSynthesized&&(c.isPrivateOrProtectedName(e.name)||t.set(e.name,e.name))})}_addSymbols(e,t,n){let s=e;for(;s;){let e=r.getScope(s);if(e){for(;e;)this._addSymbolsForSymbolTable(e.symbolTable,()=>!0,t,n),e=e.parent;break}s=s.parent}}_addSymbolsForSymbolTable(e,t,n,s){e.forEach((e,r)=>{!e.isExternallyHidden()&&t(r)&&this._addSymbol(r,e,n,s)})}_addSymbol(e,t,n,r,o,a,c){let p=l.getLastTypedDeclaredForSymbol(t);if(!p){const e=t.getDeclarations();e.length>0&&(p=e[e.length-1])}if(p){let l,u=s.CompletionItemKind.Variable;if(p=this._evaluator.resolveAliasDeclaration(p),p&&(u=this._convertDeclarationTypeToItemKind(p),this._itemToResolve)){if(this._itemToResolve.data.symbolId===t.id){const n=this._evaluator.getEffectiveTypeOfSymbol(t);if(n){let t,r;switch(p.type){case 0:case 1:case 2:t=e+": "+this._evaluator.printType(n);break;case 3:t=6===n.category?n.overloads.map(t=>e+this._evaluator.printType(t)).join("\n"):e+": "+this._evaluator.printType(n);break;case 4:case 5:t="class "+e+"()";break;case 6:if(t=e,p.path){const e=this._importLookup(p.path);e&&(r=e.docString)}break;default:t=e}9===n.category?r=n.docString:(7===n.category||5===n.category)&&(r=n.details.docString);let o="```python\n"+t+"\n```\n";r&&(o+="---\n",o+=i.convertDocStringToMarkdown(r)),o&&(this._itemToResolve.documentation={kind:s.MarkupKind.Markdown,value:o})}}}o&&(l=`Auto-import from ${o}`),this._addNameToCompletionList(e,u,n,r,void 0,void 0,l,a,c,t.id)}else{if(t.getSynthesizedType()){const i=s.CompletionItemKind.Variable;this._addNameToCompletionList(e,i,n,r,void 0,void 0,void 0,a,c,t.id)}}}_addNameToCompletionList(e,t,n,r,o,a,l,p,u,d){if(g.computeCompletionSimilarity(n,e)>.25){const h=s.CompletionItem.create(e);h.kind=t;const f={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};h.data=f,l?(h.sortText=this._makeSortText(v.AutoImport,e,l),f.autoImportText=l):c.isDunderName(e)?h.sortText=this._makeSortText(v.DunderSymbol,e):""===n&&c.isPrivateOrProtectedName(e)?h.sortText=this._makeSortText(v.PrivateSymbol,e):h.sortText=this._makeSortText(v.NormalSymbol,e),void 0!==d&&(f.symbolId=d);let g="";l&&(g+=l,g+="\n\n",h.data.autoImport=l),o&&(g+="```python\n"+o+"\n```\n"),a&&(g+="---\n",g+=i.convertDocStringToMarkdown(a)),g&&(h.documentation={kind:s.MarkupKind.Markdown,value:g}),p&&(h.textEdit=p),u&&(h.additionalTextEdits=u.map(e=>({range:{start:{line:e.range.start.line,character:e.range.start.character},end:{line:e.range.end.line,character:e.range.end.character}},newText:e.replacementText}))),r.items.push(h)}}_getRecentListIndex(e,t){return b._mostRecentCompletions.findIndex(n=>n.label===e&&n.autoImportText===t)}_makeSortText(e,t,n=""){const s=this._getRecentListIndex(t,n);return s>=0&&(e===v.AutoImport?e=v.RecentAutoImport:e===v.ImportModuleName?e=v.RecentImportModuleName:e!==v.Keyword&&e!==v.NormalSymbol&&e!==v.PrivateSymbol&&e!==v.DunderSymbol||(e=v.RecentKeywordOrSymbol)),this._formatInteger(e,2)+"."+this._formatInteger(s,4)+"."+t}_formatInteger(e,t){const n="0".charCodeAt(0);let s="";for(let r=0;r<t;r++){let t=Math.floor(e%10);t<0&&(t=9),s=String.fromCharCode(t+n)+s,e=Math.floor(e/10)}return s}_convertDeclarationTypeToItemKind(e){const t=this._evaluator.resolveAliasDeclaration(e);if(!t)return s.CompletionItemKind.Variable;switch(t.type){case 0:return s.CompletionItemKind.Class;case 2:return s.CompletionItemKind.Variable;case 1:return t.isConstant||t.isFinal?s.CompletionItemKind.Constant:s.CompletionItemKind.Variable;case 3:return t.isMethod?s.CompletionItemKind.Method:s.CompletionItemKind.Function;case 4:case 5:return s.CompletionItemKind.Class;case 6:return s.CompletionItemKind.Module}}_getImportModuleCompletions(e){const t=this._configOptions.findExecEnvironment(this._filePath),n={leadingDots:e.leadingDots,hasTrailingDot:e.hasTrailingDot,nameParts:e.nameParts.map(e=>e.value),importedSymbols:[]},r=this._importResolver.getCompletionSuggestions(this._filePath,t,n,.25),i=s.CompletionList.create();if(!e.hasTrailingDot&&e.parent&&22===e.parent.nodeType&&e.parent.missingImportKeyword){const e="import",t=s.CompletionItem.create(e);t.kind=s.CompletionItemKind.Keyword,i.items.push(t),t.sortText=this._makeSortText(v.Keyword,e)}return r.forEach(e=>{const t=s.CompletionItem.create(e);t.kind=s.CompletionItemKind.Module,i.items.push(t),t.sortText=this._makeSortText(v.ImportModuleName,e)}),i}}t.CompletionProvider=b,b._mostRecentCompletions=[]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(8),r=n(3),i=n(4),o=n(0);t.DefinitionProvider=class{static getDefinitionsForPosition(e,t,n,o){r.throwIfCancellationRequested(o);const a=i.convertPositionToOffset(t,e.tokenizerOutput.lines);if(void 0===a)return;const c=s.findNodeByOffset(e.parseTree,a);if(void 0===c)return;const l=[];if(39===c.nodeType){const e=n.getDeclarationsForNameNode(c);e&&e.forEach(e=>{const t=n.resolveAliasDeclaration(e);t&&t.path&&this._addIfUnique(l,{path:t.path,range:t.range})})}return l.length>0?l:void 0}static _addIfUnique(e,t){for(const n of e)if(n.path===t.path&&o.rangesAreEqual(n.range,t.range))return;e.push(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(10),r=n(48),i=n(7),o=n(8),a=n(12),c=n(23),l=n(17),p=n(3),u=n(4),d=n(19);class h extends a.ParseTreeWalker{constructor(e,t,n,s,r,i){super(),this._filePath=e,this._parseResults=t,this._symbolResults=n,this._query=s,this._evaluator=r,this._cancellationToken=i}findSymbols(){this.walk(this._parseResults.parseTree)}visitModule(e){return this._addSymbolInformationForScope(e,""),!0}visitClass(e){const t=e.name.value;return this._addSymbolInformationForScope(e,t),!0}visitFunction(e){const t=e.name.value;let n=t;const s=o.getEnclosingClass(e,!0);return s&&(n=s.name.value+"."+t),this._addSymbolInformationForScope(e,n),!0}visitListComprehension(e){return this._addSymbolInformationForScope(e),!0}_addSymbolInformationForScope(e,t){p.throwIfCancellationRequested(this._cancellationToken);const n=i.getScope(e);n&&n.symbolTable.forEach((e,n)=>{if(!e.isIgnoredForProtocolMatch()){let s=c.getLastTypedDeclaredForSymbol(e);!s&&e.hasDeclarations()&&(s=e.getDeclarations()[0]),s&&this._addSymbolInformationFromDeclaration(n,s,t)}})}_addSymbolInformationFromDeclaration(e,t,n){if(t.path!==this._filePath)return;if(void 0!==this._query){if(d.computeCompletionSimilarity(this._query,e)<.5)return}if(!this._evaluator.resolveAliasDeclaration(t))return;const s={uri:r.URI.file(this._filePath).toString(),range:t.range},i=f(e,t,this._evaluator);if(void 0===i)return;const o={name:e,kind:i,location:s};n&&(o.containerName=n),this._symbolResults.push(o)}}function f(e,t,n){let r;switch(t.type){case 4:case 5:r=s.SymbolKind.Class;break;case 3:if(t.isMethod){const e=n.getTypeForDeclaration(t);r=e&&l.isProperty(e)?s.SymbolKind.Property:s.SymbolKind.Method}else r=s.SymbolKind.Function;break;case 6:r=s.SymbolKind.Module;break;case 2:if("self"===e||"cls"===e||"_"===e)return;r=s.SymbolKind.Variable;break;case 1:if("_"===e)return;r=t.isConstant||t.isFinal?s.SymbolKind.Constant:s.SymbolKind.Variable;break;default:r=s.SymbolKind.Variable}return r}function g(e,t,n,s,r){p.throwIfCancellationRequested(r);const o=i.getScope(e);o&&o.symbolTable.forEach((e,i)=>{if(!e.isIgnoredForProtocolMatch()){let o=c.getLastTypedDeclaredForSymbol(e);!o&&e.hasDeclarations()&&(o=e.getDeclarations()[0]),o&&function(e,t,n,s,r,i){if(6===t.type)return;const o=f(e,t,n);if(void 0===o)return;const a=t.range;let c=a;const l=[];if(4===t.type||3===t.type){g(t.node,l,s,n,i);const e=u.convertOffsetsToRange(t.node.start,t.node.name.start+t.node.length,s.tokenizerOutput.lines);c=e}const p={name:e,kind:o,range:c,selectionRange:a,children:l};r.push(p)}(i,o,s,n,t,r)}})}t.DocumentSymbolProvider=class{static addSymbolsForDocument(e,t,n,s,r,i){new h(n,s,e,t,r,i).findSymbols()}static addHierarchicalSymbolsForDocument(e,t,n,s){g(t.parseTree,e,t,n,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(28),r=n(8),i=n(3),o=n(4),a=n(0),c=n(106);t.performQuickAction=function(e,t,n,l){if("pyright.organizeimports"===e){return new c.ImportSorter(n,l).sort()}if("pyright.addoptionalforparam"===e&&t.length>=1){return function(e,t,n){i.throwIfCancellationRequested(n);let c=r.findNodeByOffset(e.parseTree,t);for(;c&&42!==c.nodeType;)c=c.parent;if(!c||!c.typeAnnotation)return[];const l=[],p=o.convertOffsetToPosition(c.typeAnnotation.start,e.tokenizerOutput.lines),u=o.convertOffsetToPosition(a.TextRange.getEnd(c.typeAnnotation),e.tokenizerOutput.lines);l.push({range:{start:p,end:p},replacementText:"Optional["}),l.push({range:{start:u,end:u},replacementText:"]"});const d=s.getTopLevelImports(e.parseTree),h=d.orderedImports.find(e=>"typing"===e.moduleName);if(h&&22===h.node.nodeType){const t=s.getTextEditsForAutoImportSymbolAddition("Optional",h,e);l.push(...t)}else{const t=s.getTextEditsForAutoImportInsertion("Optional",d,"typing",0,e);l.push(...t)}return l}(n,parseInt(t[0],10),l)}return[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(28),r=n(3),i=n(4),o=n(0);t.ImportSorter=class{constructor(e,t){this._parseResults=e,this._cancellationToken=t}sort(){r.throwIfCancellationRequested(this._cancellationToken);const e=[],t=s.getTopLevelImports(this._parseResults.parseTree),n=t.orderedImports.map(e=>e).sort((e,t)=>this._compareImportStatements(e,t));if(0===n.length)return[];const i=this._getPrimaryReplacementRange(t.orderedImports);return e.push({range:i,replacementText:this._generateSortedImportText(n)}),this._addSecondaryReplacementRanges(t.orderedImports,e),e}_compareImportStatements(e,t){const n=this._getImportGroup(e),s=this._getImportGroup(t);return n<s?-1:n>s?1:e.moduleName<t.moduleName?-1:1}_getImportGroup(e){return e.importResult?0===e.importResult.importType?0:1===e.importResult.importType||e.importResult.isLocalTypingsFile?1:e.importResult.isRelative?3:2:2}_getPrimaryReplacementRange(e){let t=e.findIndex(e=>e.followsNonImportStatement);t<0&&(t=e.length);const n=e[t-1].node;return{start:i.convertOffsetToPosition(e[0].node.start,this._parseResults.tokenizerOutput.lines),end:i.convertOffsetToPosition(o.TextRange.getEnd(n),this._parseResults.tokenizerOutput.lines)}}_addSecondaryReplacementRanges(e,t){let n=e.findIndex(e=>e.followsNonImportStatement);if(!(n<0))for(;;){let s=e.findIndex((e,t)=>t>n&&e.followsNonImportStatement);if(s<0&&(s=e.length),t.push({range:{start:i.convertOffsetToPosition(e[n].node.start,this._parseResults.tokenizerOutput.lines),end:i.convertOffsetToPosition(o.TextRange.getEnd(e[s-1].node),this._parseResults.tokenizerOutput.lines)},replacementText:""}),n=s,n>=e.length)break}}_generateSortedImportText(e){let t="",n=this._getImportGroup(e[0]);for(const s of e){const r=this._getImportGroup(s);let i;n!==r&&(t+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence,n=r),i=20===s.node.nodeType?this._formatImportNode(s.subnode,s.moduleName):this._formatImportFromNode(s.node,s.moduleName),s!==e[e.length-1]&&(i+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence),t+=i}return t}_formatImportNode(e,t){let n=`import ${t}`;return e.alias&&(n+=` as ${e.alias.value}`),n}_formatImportFromNode(e,t){const n=e.imports.sort((e,t)=>this._compareSymbols(e,t)).map(e=>{let t=e.name.value;return e.alias&&(t+=` as ${e.alias.value}`),t});let s=`from ${t} import `;if(e.isWildcardImport)return s+"*";const r=n.join(", ");if(s.length+r.length<=80)return s+r;s+="(\n";let i=0;for(;i<n.length;){let e=this._parseResults.tokenizerOutput.predominantTabSequence+n[i];i<n.length-1?e+=",":e+=")",i++;let t=e;for(;i<n.length&&(t+=" "+n[i],i<n.length-1?t+=",":t+=")",!(t.length>80));)e=t,i++;s+=e,i<n.length&&(s+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence)}return s}_compareSymbols(e,t){return e.name.value<t.name.value?-1:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(7),r=n(29),i=n(8),o=n(12),a=n(3),c=n(4),l=n(0);class p extends o.ParseTreeWalker{constructor(e,t,n,s,r,i){super(),this._parseResults=e,this._filePath=t,this._referencesResult=n,this._includeDeclaration=s,this._evaluator=r,this._cancellationToken=i}findReferences(){this.walk(this._parseResults.parseTree)}walk(e){s.isCodeUnreachable(e)||super.walk(e)}visitName(e){a.throwIfCancellationRequested(this._cancellationToken);const t=this._evaluator.getDeclarationsForNameNode(e);return t&&t.length>0&&t.some(e=>this._resultsContainsDeclaration(e))&&(this._includeDeclaration||e!==this._referencesResult.nodeAtOffset)&&this._referencesResult.locations.push({path:this._filePath,range:{start:c.convertOffsetToPosition(e.start,this._parseResults.tokenizerOutput.lines),end:c.convertOffsetToPosition(l.TextRange.getEnd(e),this._parseResults.tokenizerOutput.lines)}}),!0}_resultsContainsDeclaration(e){const t=this._evaluator.resolveAliasDeclaration(e);return!!t&&this._referencesResult.declarations.some(e=>r.areDeclarationsSame(e,t))}}t.ReferencesProvider=class{static getReferencesForPosition(e,t,n,s,r,o){a.throwIfCancellationRequested(o);const l=c.convertPositionToOffset(n,e.tokenizerOutput.lines);if(void 0===l)return;const u=i.findNodeByOffset(e.parseTree,l);if(void 0===u)return;if(39!==u.nodeType)return;const d=r.getDeclarationsForNameNode(u);if(!d)return;const h=[];if(d.forEach(e=>{const t=r.resolveAliasDeclaration(e);t&&h.push(t)}),0===h.length)return;const f={requiresGlobalSearch:h.some(e=>{if(e.path!==t)return!0;const n=i.getEvaluationScopeNode(e.node);return 37===n.nodeType||10===n.nodeType}),nodeAtOffset:u,declarations:h,locations:[]};return new p(e,t,f,s,r,o).findReferences(),f}static addReferences(e,t,n,s,r,i){new p(e,t,n,s,r,i).findReferences()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(54),r=n(8),i=n(3),o=n(4);t.SignatureHelpProvider=class{static getSignatureHelpForPosition(e,t,n,s){i.throwIfCancellationRequested(s);const a=o.convertPositionToOffset(t,e.tokenizerOutput.lines);if(void 0===a)return;let c=r.findNodeByOffset(e.parseTree,a);const l=c,p=c?r.getNodeDepth(c):0;let u=a;for(;u>=0;){u--;const t=r.findNodeByOffset(e.parseTree,u);if(t&&t!==l){r.getNodeDepth(t)>p&&(c=t);break}}if(void 0===c)return;const d=n.getCallSignatureInfo(c,a,e.tokenizerOutput.tokens);if(!d)return;const h=[];let f,g;return d.signatures.forEach((e,t)=>{if(h.push(this._makeSignature(e.type,n)),void 0===f&&e.activeParam){const n=e.type.details.parameters.indexOf(e.activeParam);-1!==n&&(f=t,g=n)}}),{signatures:h,activeSignature:f,activeParameter:g}}static _makeSignature(e,t){const n=t.printFunctionParts(e),r=[],i=e.details.docString;let o="(";return n[0].forEach((t,a)=>{const c=e.details.parameters[a].name||"";r.push({startOffset:o.length,endOffset:o.length+t.length,documentation:s.extractParameterDocumentation(i||"",c)}),o+=t,a<n[0].length-1&&(o+=", ")}),o+=") -> "+n[1],{label:o,parameters:r,documentation:i}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(52),r=n(59),i=n(111),o=n(60),a={and:0,as:1,assert:2,async:3,await:4,break:5,class:6,continue:7,__debug__:8,def:9,del:10,elif:11,else:12,except:13,finally:15,for:16,from:17,global:18,if:19,import:20,in:21,is:22,lambda:23,nonlocal:25,not:26,or:27,pass:28,raise:29,return:30,try:32,while:33,with:34,yield:35,False:14,None:24,True:31},c={0:3,1:4,2:4,3:2,4:4,5:1,6:2,7:4,8:2,9:4,10:2,11:4,12:10,13:2,14:4,15:10,16:10,17:2,18:4,19:10,20:10,21:2,22:4,23:2,24:4,25:2,26:4,27:10,28:2,29:4,30:2,31:4,32:2,33:4,35:2,36:2,37:1,38:2,39:2,40:2,41:2};t.Tokenizer=class{constructor(){this._cs=new i.CharacterStream(""),this._tokens=[],this._prevLineStart=0,this._parenDepth=0,this._lineRanges=[],this._indentAmounts=[],this._typeIgnoreAll=!1,this._typeIgnoreLines={},this._crCount=0,this._crLfCount=0,this._lfCount=0,this._indentCount=0,this._indentTabCount=0,this._indentSpacesTotal=0,this._singleQuoteCount=0,this._doubleQuoteCount=0}tokenize(e,t,n){if(void 0===t)t=0;else if(t<0||t>e.length)throw new Error("Invalid range start");if(void 0===n)n=e.length;else{if(n<0||t+n>e.length)throw new Error("Invalid range length");t+n<e.length&&(e=e.substr(0,t+n))}this._cs=new i.CharacterStream(e),this._cs.position=t,this._tokens=[],this._prevLineStart=0,this._parenDepth=0,this._lineRanges=[],this._indentAmounts=[];const r=t+n;for(;!(this._cs.isEndOfStream()||(this._addNextToken(),this._cs.position>=r)););0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(o.NewLineToken.create(this._cs.position,0,3,this._getComments())),this._setIndent(0,0,!0,!1),this._tokens.push(o.Token.create(1,this._cs.position,0,this._getComments())),this._addLineRange();let a="\n";this._crCount>this._crLfCount&&this._crCount>this._lfCount?a="\r":this._crLfCount>this._crCount&&this._crLfCount>this._lfCount&&(a="\r\n");let c="    ";if(this._indentTabCount>this._indentCount/2)c="\t";else if(this._indentCount>0){let e=Math.round(this._indentSpacesTotal/this._indentCount);e<1?e=1:e>8&&(e=8),c="";for(let t=0;t<e;t++)c+=" "}return{tokens:new s.TextRangeCollection(this._tokens),lines:new s.TextRangeCollection(this._lineRanges),typeIgnoreLines:this._typeIgnoreLines,typeIgnoreAll:this._typeIgnoreAll,predominantEndOfLineSequence:a,predominantTabSequence:c,predominantSingleQuoteCharacter:this._singleQuoteCount>=this._doubleQuoteCount?"'":'"'}}static getOperatorInfo(e){return c[e]}static isOperatorAssignment(e){return void 0!==e&&void 0!==c[e]&&0!=(4&c[e])}static isOperatorComparison(e){return void 0!==e&&void 0!==c[e]&&0!=(8&c[e])}_addNextToken(){this._cs.skipWhitespace(),this._cs.isEndOfStream()||this._handleCharacter()||this._cs.moveNext()}_handleCharacter(){const e=this._getStringPrefixLength();if(e>=0){let t="";e>0&&(t=this._cs.getText().substr(this._cs.position,e),this._cs.advance(e));const n=this._getQuoteTypeFlags(t);if(0!==n)return this._handleString(n,e),!0}if(35===this._cs.currentChar)return this._handleComment(),!0;switch(this._cs.currentChar){case 65279:if(0===this._cs.position)return!1;this._handleInvalid();break;case 13:{const e=10===this._cs.nextChar?2:1,t=2===e?2:0;return this._handleNewLine(e,t),!0}case 10:return this._handleNewLine(1,1),!0;case 92:return 13===this._cs.nextChar?(10===this._cs.lookAhead(2)?this._cs.advance(3):this._cs.advance(2),this._addLineRange(),!0):10===this._cs.nextChar?(this._cs.advance(2),this._addLineRange(),!0):(this._handleInvalid(),!1);case 40:this._parenDepth++,this._tokens.push(o.Token.create(13,this._cs.position,1,this._getComments()));break;case 41:this._parenDepth>0&&this._parenDepth--,this._tokens.push(o.Token.create(14,this._cs.position,1,this._getComments()));break;case 91:this._parenDepth++,this._tokens.push(o.Token.create(15,this._cs.position,1,this._getComments()));break;case 93:this._parenDepth>0&&this._parenDepth--,this._tokens.push(o.Token.create(16,this._cs.position,1,this._getComments()));break;case 123:this._parenDepth++,this._tokens.push(o.Token.create(17,this._cs.position,1,this._getComments()));break;case 125:this._parenDepth>0&&this._parenDepth--,this._tokens.push(o.Token.create(18,this._cs.position,1,this._getComments()));break;case 44:this._tokens.push(o.Token.create(12,this._cs.position,1,this._getComments()));break;case 96:this._tokens.push(o.Token.create(22,this._cs.position,1,this._getComments()));break;case 59:this._tokens.push(o.Token.create(11,this._cs.position,1,this._getComments()));break;case 58:if(61===this._cs.nextChar){this._tokens.push(o.OperatorToken.create(this._cs.position,2,34,this._getComments())),this._cs.advance(1);break}this._tokens.push(o.Token.create(10,this._cs.position,1,this._getComments()));break;default:if(this._isPossibleNumber()&&this._tryNumber())return!0;if(46===this._cs.currentChar){if(46===this._cs.nextChar&&46===this._cs.lookAhead(2))return this._tokens.push(o.Token.create(19,this._cs.position,3,this._getComments())),this._cs.advance(3),!0;this._tokens.push(o.Token.create(20,this._cs.position,1,this._getComments()));break}return!(!this._tryIdentifier()&&!this._tryOperator())||(this._handleInvalid(),!1)}return!1}_addLineRange(){const e=this._cs.position-this._prevLineStart;e>0&&this._lineRanges.push({start:this._prevLineStart,length:e}),this._prevLineStart=this._cs.position}_handleNewLine(e,t){0===this._parenDepth&&3!==t&&(0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(o.NewLineToken.create(this._cs.position,e,t,this._getComments()))),0===t?this._crCount++:2===t?this._crLfCount++:this._lfCount++,this._cs.advance(e),this._addLineRange(),this._readIndentationAfterNewLine()}_readIndentationAfterNewLine(){let e=0,t=0,n=!1,s=!1;for(;!this._cs.isEndOfStream();)switch(this._cs.currentChar){case 32:e++,t++,s=!0,this._cs.moveNext();break;case 9:e++,t+=8-t%8,n=!0,this._cs.moveNext();break;case 12:e=0,t=0,n=!1,s=!1,this._cs.moveNext();break;default:return void this._setIndent(e,t,s,n);case 35:case 10:case 13:return}}_setIndent(e,t,n,s){if(!(this._parenDepth>0))if(0===this._indentAmounts.length)t>0&&(this._indentCount++,s&&this._indentTabCount++,this._indentSpacesTotal+=t,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:s}),this._tokens.push(o.IndentToken.create(this._cs.position,0,t,!1,this._getComments())));else{const r=this._indentAmounts[this._indentAmounts.length-1];if(r.tab8Spaces<t){const i=(r.isSpacePresent&&s||r.isTabPresent&&n)&&r.tab1Spaces>=e;this._indentCount++,s&&this._indentTabCount++,this._indentSpacesTotal+=t-this._indentAmounts[this._indentAmounts.length-1].tab8Spaces,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:s}),this._tokens.push(o.IndentToken.create(this._cs.position,0,t,i,this._getComments()))}else{const e=[];for(;this._indentAmounts.length>0&&this._indentAmounts[this._indentAmounts.length-1].tab8Spaces>t;)e.push(this._indentAmounts.length>1?this._indentAmounts[this._indentAmounts.length-2].tab8Spaces:0),this._indentAmounts.pop();e.forEach((n,s)=>{const r=s<e.length-1||n===t,i=s<e.length-1?n:t;this._tokens.push(o.DedentToken.create(this._cs.position,0,i,r,this._getComments()))})}}}_tryIdentifier(){const e=this._cs.position;if(r.isIdentifierStartChar(this._cs.currentChar))for(this._cs.moveNext();r.isIdentifierChar(this._cs.currentChar);)this._cs.moveNext();if(this._cs.position>e){const t=this._cs.getText().substr(e,this._cs.position-e);return void 0!==a[t]?this._tokens.push(o.KeywordToken.create(e,this._cs.position-e,a[t],this._getComments())):this._tokens.push(o.IdentifierToken.create(e,this._cs.position-e,t,this._getComments())),!0}return!1}_isPossibleNumber(){return!!r.isDecimal(this._cs.currentChar)||!(46!==this._cs.currentChar||!r.isDecimal(this._cs.nextChar))}_tryNumber(){const e=this._cs.position;if(48===this._cs.currentChar){let t=0,n=0;if((120===this._cs.nextChar||88===this._cs.nextChar)&&r.isHex(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;r.isHex(this._cs.currentChar);)this._cs.moveNext();t=16}if((98===this._cs.nextChar||66===this._cs.nextChar)&&r.isBinary(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;r.isBinary(this._cs.currentChar);)this._cs.moveNext();t=2}if((111===this._cs.nextChar||79===this._cs.nextChar)&&r.isOctal(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;r.isOctal(this._cs.currentChar);)this._cs.moveNext();t=8}if(t>0){const s=this._cs.getText().substr(e,this._cs.position-e),r=parseInt(s.substr(n).replace(/_/g,""),t);if(!isNaN(r))return this._tokens.push(o.NumberToken.create(e,s.length,r,!0,!1,this._getComments())),!0}}let t=!1,n=!1;if(this._cs.currentChar>=49&&this._cs.currentChar<=57){for(;r.isDecimal(this._cs.currentChar);)n=!0,this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(48===this._cs.currentChar){for(n=!0;48===this._cs.currentChar||95===this._cs.currentChar;)this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(t){let t=this._cs.getText().substr(e,this._cs.position-e);const n=parseInt(t.replace(/_/g,""),10);if(!isNaN(n)){let s=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(s=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(o.NumberToken.create(e,t.length,n,!0,s,this._getComments())),!0}}if(this._cs.position=e,(n||46===this._cs.currentChar&&this._cs.nextChar>=48&&this._cs.nextChar<=57)&&this._skipFloatingPointCandidate()){let t=this._cs.getText().substr(e,this._cs.position-e);const n=parseFloat(t);if(!isNaN(n)){let s=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(s=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(o.NumberToken.create(e,this._cs.position-e,n,!1,s,this._getComments())),!0}}return this._cs.position=e,!1}_tryOperator(){let e=0;const t=this._cs.nextChar;let n;switch(this._cs.currentChar){case 43:e=61===t?2:1,n=2===e?1:0;break;case 38:e=61===t?2:1,n=2===e?4:3;break;case 124:e=61===t?2:1,n=2===e?7:6;break;case 94:e=61===t?2:1,n=2===e?9:8;break;case 61:e=61===t?2:1,n=2===e?12:2;break;case 33:if(61!==t)return!1;e=2,n=27;break;case 37:e=61===t?2:1,n=2===e?24:23;break;case 126:e=1,n=5;break;case 45:if(62===t)return this._tokens.push(o.Token.create(21,this._cs.position,2,this._getComments())),this._cs.advance(2),!0;e=61===t?2:1,n=2===e?33:32;break;case 42:42===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?29:28):(e=61===t?2:1,n=2===e?26:25);break;case 47:47===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?14:13):(e=61===t?2:1,n=2===e?11:10);break;case 60:60===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?18:17):(e=61===t?2:1,n=2===e?20:19);break;case 62:62===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?31:30):(e=61===t?2:1,n=2===e?16:15);break;case 64:e=61===t?2:1,n=2===e?22:21;break;default:return!1}return this._tokens.push(o.OperatorToken.create(this._cs.position,e,n,this._getComments())),this._cs.advance(e),e>0}_handleInvalid(){const e=this._cs.position;this._cs.skipToWhitespace();const t=this._cs.position-e;return t>0&&(this._tokens.push(o.Token.create(0,e,t,this._getComments())),!0)}_getComments(){const e=this._comments;return this._comments=void 0,e}_handleComment(){const e=this._cs.position+1;this._cs.skipToEol();const t=this._cs.position-e,n=this._cs.getText().substr(e,t),s=o.Comment.create(e,t,n);n.match(/^\s*type:\s*ignore(\s|$)/)&&(this._tokens.findIndex(e=>2!==e.type&&e&&3!==e.type)<0?this._typeIgnoreAll=!0:this._typeIgnoreLines[this._lineRanges.length]=!0),this._comments?this._comments.push(s):this._comments=[s]}_getStringPrefixLength(){if(39===this._cs.currentChar||34===this._cs.currentChar)return 0;if(39===this._cs.nextChar||34===this._cs.nextChar)switch(this._cs.currentChar){case 102:case 70:case 114:case 82:case 98:case 66:case 117:case 85:return 1}if(39===this._cs.lookAhead(2)||34===this._cs.lookAhead(2)){switch(this._cs.getText().substr(this._cs.position,2).toLowerCase()){case"rf":case"fr":case"ur":case"ru":case"br":case"rb":return 2}}return-1}_getQuoteTypeFlags(e){let t=0;e=e.toLowerCase();for(let n=0;n<e.length;n++)switch(e[n]){case"u":t|=16;break;case"b":t|=32;break;case"r":t|=8;break;case"f":t|=64}return 39===this._cs.currentChar?(t|=1,39===this._cs.nextChar&&39===this._cs.lookAhead(2)&&(t|=4)):34===this._cs.currentChar&&(t|=2,34===this._cs.nextChar&&34===this._cs.lookAhead(2)&&(t|=4)),t}_handleString(e,t){const n=this._cs.position-t;4&e?this._cs.advance(3):(this._cs.moveNext(),1&e?this._singleQuoteCount++:this._doubleQuoteCount++);const s=this._skipToEndOfStringLiteral(e),r=this._cs.position;this._tokens.push(o.StringToken.create(n,r-n,s.flags,s.escapedValue,t,this._getComments()))}_skipToEndOfStringLiteral(e){const t=1&e?39:34,n=0!=(4&e);let s="";for(;;){if(this._cs.isEndOfStream())return{escapedValue:s,flags:e|=65536};if(92===this._cs.currentChar)s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext(),13===this._cs.getCurrentChar()||10===this._cs.getCurrentChar()?(13===this._cs.getCurrentChar()&&10===this._cs.nextChar&&(s+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext()),s+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext(),this._addLineRange()):(s+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext());else if(10===this._cs.currentChar||13===this._cs.currentChar){if(!n)return{escapedValue:s,flags:e|=65536};13===this._cs.currentChar&&10===this._cs.nextChar&&(s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext(),this._addLineRange()}else{if(!n&&this._cs.currentChar===t){this._cs.moveNext();break}if(n&&this._cs.currentChar===t&&this._cs.nextChar===t&&this._cs.lookAhead(2)===t){this._cs.advance(3);break}s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()}}return{escapedValue:s,flags:e}}_skipFloatingPointCandidate(){const e=this._cs.position;return this._skipFractionalNumber(),this._cs.position>e&&(101!==this._cs.currentChar&&69!==this._cs.currentChar||(this._cs.moveNext(),this._skipDecimalNumber(!0))),this._cs.position>e}_skipFractionalNumber(){this._skipDecimalNumber(!1),46===this._cs.currentChar&&this._cs.moveNext(),this._skipDecimalNumber(!1)}_skipDecimalNumber(e){for(!e||45!==this._cs.currentChar&&43!==this._cs.currentChar||this._cs.moveNext();r.isDecimal(this._cs.currentChar);)this._cs.moveNext()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unicodeLu=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11310],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,[65313,65338],[66560,66599],[66736,66771],[68736,68786],[71840,71871],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],t.unicodeLl=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11358],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,2581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,43002,[43824,43866],[43872,43877],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[68800,68850],[71872,71903],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[125218,125251]],t.unicodeLt=[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],t.unicodeLo=[170,186,443,[448,451],660,[1488,1514],[1520,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2208,2228],[2230,2237],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,3294,[3296,3297],[3313,3314],[3333,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3719,3720],3722,3725,[3732,3735],[3737,3743],[3745,3747],3749,3751,[3754,3755],[3757,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4304,4346],[4349,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5900],[5902,5905],[5920,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6263],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6987],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7409],[7413,7414],[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12590],[12593,12686],[12704,12730],[12784,12799],[13312,19893],[19968,40938],[40960,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,43261,[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68147],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[69635,69687],[69763,69807],[69840,69864],[69891,69926],[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],[71424,71449],71935,72192,[72203,72242],72250,72272,[72284,72323],[72326,72329],[72384,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73728,74649],[74880,75075],[77824,78894],[82944,83526],[92160,92728],[92736,92766],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94020],94032,[94208,100332],[100352,101106],[110592,110878],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173782],[173824,177972],[177984,178205],[178208,183969],[183984,191456],[194560,195101]],t.unicodeLm=[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],65392,[65438,65439],[92992,92995],[94099,94111],[94176,94177]],t.unicodeNl=[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]],t.unicodeMn=[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2260,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,2902,[2914,2915],2946,3008,3021,3072,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3769],[3771,3772],[3784,3789],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7673],[7675,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],[43204,43205],[43232,43249],[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],43452,43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],69633,[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70090,70092],[70191,70193],70196,[70198,70199],70206,70367,[70371,70378],[70400,70401],70460,70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[92912,92916],[92976,92982],[94095,94098],[113821,113822],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[125136,125142],[125252,125258],[917760,917999]],t.unicodeMc=[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,[7410,7411],7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43453,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,70018,[70067,70069],[70079,70080],[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[72199,72200],72249,[72279,72280],72343,72751,72766,72873,72881,72884,[94033,94078],[119141,119142],[119149,119154]],t.unicodeNd=[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72784,72793],[73040,73049],[92768,92777],[93008,93017],[120782,120831],[125264,125273]],t.unicodePc=[95,[8255,8256],8276,[65075,65076],[65101,65103],65343]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(59);t.CharacterStream=class{constructor(e){this._text=e,this._position=0,this._currentChar=e.length>0?e.charCodeAt(0):0,this._isEndOfStream=0===e.length}getText(){return this._text}get position(){return this._position}set position(e){this._position=e,this._checkBounds()}get currentChar(){return this._currentChar}getCurrentChar(){return this._currentChar}get nextChar(){return this.position+1<this._text.length?this._text.charCodeAt(this.position+1):0}get prevChar(){return this.position-1>=0?this._text.charCodeAt(this.position-1):0}isEndOfStream(){return this._isEndOfStream}lookAhead(e){const t=this._position+e;return t<0||t>=this._text.length?0:this._text.charCodeAt(t)}advance(e){this.position+=e}moveNext(){return this._position<this._text.length-1?(this._position+=1,this._currentChar=this._text.charCodeAt(this._position),!0):(this.advance(1),!this.isEndOfStream())}isAtWhiteSpace(){return s.isWhiteSpace(this.currentChar)}isAtLineBreak(){return s.isLineBreak(this.currentChar)}skipLineBreak(){13===this._currentChar?(this.moveNext(),10===this.currentChar&&this.moveNext()):10===this._currentChar&&this.moveNext()}skipWhitespace(){for(;!this.isEndOfStream()&&this.isAtWhiteSpace();)this.moveNext()}skipToEol(){for(;!this.isEndOfStream()&&!this.isAtLineBreak();)this.moveNext()}skipToWhitespace(){for(;!this.isEndOfStream()&&!this.isAtWhiteSpace();)this.moveNext()}charCodeAt(e){return this._text.charCodeAt(e)}get length(){return this._text.length}_checkBounds(){this._position<0&&(this._position=0),this._isEndOfStream=this._position>=this._text.length,this._isEndOfStream&&(this._position=this._text.length),this._currentChar=this._isEndOfStream?0:this._text.charCodeAt(this._position)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1),r=n(4),i=n(20),o=n(0),a=n(0),c=n(58),l=n(7),p=n(37),u=n(8),d=n(12),h=n(113),f=n(61),g=n(30),y=n(14);class m extends d.ParseTreeWalker{constructor(e){super(),this._deferredBindingTasks=[],this._notLocalBindings=new Map,this._nestedExceptDepth=0,this._fileInfo=e}bindModule(e){const t=void 0===this._fileInfo.builtinsScope;return this._createNewScope(t?4:3,this._fileInfo.builtinsScope,()=>{l.setScope(e,this._currentScope),this._addBuiltInSymbolToCurrentScope("__doc__",e,"str"),this._addBuiltInSymbolToCurrentScope("__name__",e,"str"),this._addBuiltInSymbolToCurrentScope("__loader__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__package__",e,"str"),this._addBuiltInSymbolToCurrentScope("__spec__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__path__",e,"Iterable[str]"),this._addBuiltInSymbolToCurrentScope("__file__",e,"str"),this._addBuiltInSymbolToCurrentScope("__cached__",e,"str"),this._addBuiltInSymbolToCurrentScope("__dict__",e,"Dict[str, Any]"),this._currentFlowNode=this._createStartFlowNode(),this._walkStatementsAndReportUnreachable(e.statements),l.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap)}),this._bindDeferred(),{moduleDocString:u.getDocString(e.statements)}}visitModule(e){return s.fail("We should never get here"),!1}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitModuleName(e){const t=l.getImportInfo(e);if(s.assert(void 0!==t),t)if(t.isImportFound){if(1===t.importType&&!t.isStubFile){const n=this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingTypeStubs,"reportMissingTypeStubs",`Stub file not found for "${t.importName}"`,e);if(n){const e={action:"pyright.createtypestub",moduleName:t.importName};n.addAction(e)}}}else this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingImports,"reportMissingImports",`Import "${t.importName}" could not be resolved`,e);return!0}visitClass(e){this.walkMultiple(e.decorators);const t={type:4,node:e,path:this._fileInfo.filePath,range:r.convertOffsetsToRange(e.name.start,a.TextRange.getEnd(e.name),this._fileInfo.lines)},n=this._bindNameToScope(this._currentScope,e.name.value);return n&&n.addDeclaration(t),l.setDeclaration(e,t),this.walkMultiple(e.arguments),this._createNewScope(2,this._currentScope,()=>{l.setScope(e,this._currentScope),this._addBuiltInSymbolToCurrentScope("__name__",e,"str"),this._fileInfo.executionEnvironment.pythonVersion>=i.PythonVersion.V33&&this._addBuiltInSymbolToCurrentScope("__qualname__",e,"str"),this.walk(e.suite)}),this._addSymbolToCurrentScope(e.name.value,!0),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitFunction(e){const t=this._bindNameToScope(this._currentScope,e.name.value),n=u.getEnclosingClass(e,!0),o={type:3,node:e,isMethod:!!n,isGenerator:!1,path:this._fileInfo.filePath,range:r.convertOffsetsToRange(e.name.start,a.TextRange.getEnd(e.name),this._fileInfo.lines)};t&&t.addDeclaration(o),l.setDeclaration(e,o),this.walkMultiple(e.decorators),e.parameters.forEach(e=>{e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation)}),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation);let c=e.parent;for(;c&&37!==c.nodeType&&29!==c.nodeType;)c=c.parent;s.assert(void 0!==c);const p=l.getScope(c);return s.assert(void 0!==p),this._createNewScope(1,p,()=>{l.setScope(e,this._currentScope),this._addBuiltInSymbolToCurrentScope("__doc__",e,"str"),this._addBuiltInSymbolToCurrentScope("__name__",e,"str"),this._fileInfo.executionEnvironment.pythonVersion>=i.PythonVersion.V33&&this._addBuiltInSymbolToCurrentScope("__qualname__",e,"str"),this._addBuiltInSymbolToCurrentScope("__module__",e,"str"),this._addBuiltInSymbolToCurrentScope("__defaults__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__code__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__globals__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__dict__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__closure__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__annotations__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__kwdefaults__",e,"Any"),u.getEnclosingClass(e)&&this._addBuiltInSymbolToCurrentScope("__class__",e,"class"),this._deferBinding(()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach(e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:r.convertOffsetsToRange(e.start,a.TextRange.getEnd(e),this._fileInfo.lines)};t.addDeclaration(n),l.setDeclaration(e.name,n)}this._createFlowAssignment(e.name)}}),this._targetFunctionDeclaration=o,this._currentReturnTarget=this._createBranchLabel(),this.walk(e.suite),l.setAfterFlowNode(e.suite,this._currentFlowNode),this._addAntecedent(this._currentReturnTarget,this._currentFlowNode);const t=this._finishFlowLabel(this._currentReturnTarget);l.setAfterFlowNode(e,t)}),l.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap)}),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitLambda(e){return e.parameters.forEach(e=>{e.defaultValue&&this.walk(e.defaultValue)}),this._createNewScope(1,this._currentScope,()=>{l.setScope(e,this._currentScope),this._deferBinding(()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach(e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:r.convertOffsetsToRange(e.start,a.TextRange.getEnd(e),this._fileInfo.lines)};t.addDeclaration(n),l.setDeclaration(e.name,n)}this._createFlowAssignment(e.name),this.walk(e.name)}}),this.walk(e.expression),l.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap)})}),!1}visitCall(e){return this.walk(e.leftExpression),this.walkMultiple(e.arguments),this._createCallFlowNode(e),!1}visitAssignment(e){return this._handleTypingStubAssignmentOrAnnotation(e)||(this._bindPossibleTupleNamedTarget(e.leftExpression),e.typeAnnotationComment&&(this.walk(e.typeAnnotationComment),this._addTypeDeclarationForVariable(e.leftExpression,e.typeAnnotationComment)),this.walk(e.rightExpression),this._addInferredTypeAssignmentForVariable(e.leftExpression,e.rightExpression),this._createAssignmentTargetFlowNodes(e.leftExpression,!0,!1)),!1}visitAssignmentExpression(e){this.walk(e.rightExpression),this._addInferredTypeAssignmentForVariable(e.name,e.rightExpression);const t=u.getEvaluationNodeForAssignmentExpression(e);if(t){const n=l.getScope(t);let s=this._currentScope;for(;s&&s!==n;){if(s.lookUpSymbol(e.name.value)){this._addError(`Assignment expression target "${e.name.value}" `+"cannot use same name as comprehension for target",e.name);break}s=s.parent}this._bindNameToScope(n,e.name.value)}else this._addError("Assignment expression must be within module, function or lambda",e);return this._createAssignmentTargetFlowNodes(e.name,!0,!1),!1}visitAugmentedAssignment(e){return this.walk(e.leftExpression),this.walk(e.rightExpression),this._addInferredTypeAssignmentForVariable(e.destExpression,e.rightExpression),this._bindPossibleTupleNamedTarget(e.destExpression),this._createAssignmentTargetFlowNodes(e.destExpression,!1,!1),!1}visitDel(e){return e.expressions.forEach(e=>{this._bindPossibleTupleNamedTarget(e),this.walk(e),this._createAssignmentTargetFlowNodes(e,!1,!0)}),!1}visitTypeAnnotation(e){return!this._handleTypingStubAssignmentOrAnnotation(e)&&(this._bindPossibleTupleNamedTarget(e.valueExpression),this._addTypeDeclarationForVariable(e.valueExpression,e.typeAnnotation),!0)}visitFor(e){this._bindPossibleTupleNamedTarget(e.targetExpression),this._addInferredTypeAssignmentForVariable(e.targetExpression,e),this.walk(e.iterableExpression);const t=this._createLoopLabel(),n=this._createBranchLabel(),s=this._createBranchLabel();return this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=t,this._addAntecedent(n,this._currentFlowNode),this._createAssignmentTargetFlowNodes(e.targetExpression,!0,!1),this._bindLoopStatement(t,s,()=>{this.walk(e.forSuite),this._addAntecedent(t,this._currentFlowNode)}),this._currentFlowNode=this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitContinue(e){return this._currentContinueTarget&&this._addAntecedent(this._currentContinueTarget,this._currentFlowNode),this._currentFlowNode=m._unreachableFlowNode,!1}visitBreak(e){return this._currentBreakTarget&&this._addAntecedent(this._currentBreakTarget,this._currentFlowNode),this._currentFlowNode=m._unreachableFlowNode,!1}visitReturn(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.returnExpressions||(this._targetFunctionDeclaration.returnExpressions=[]),this._targetFunctionDeclaration.returnExpressions.push(e)),e.returnExpression&&this.walk(e.returnExpression),l.setFlowNode(e,this._currentFlowNode),this._currentReturnTarget&&this._addAntecedent(this._currentReturnTarget,this._currentFlowNode),this._currentFinallyTarget&&this._addAntecedent(this._currentFinallyTarget,this._currentFlowNode),this._currentFlowNode=m._unreachableFlowNode,!1}visitYield(e){return this._bindYield(e),!1}visitYieldFrom(e){return this._bindYield(e),!1}visitMemberAccess(e){return l.setFlowNode(e,this._currentFlowNode),!0}visitName(e){return l.setFlowNode(e,this._currentFlowNode),!1}visitIf(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),s=this._createBranchLabel(),r=f.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment);return this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===r?m._unreachableFlowNode:this._finishFlowLabel(t),this.walk(e.ifSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=!0===r?m._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitWhile(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),s=this._createBranchLabel(),r=f.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment),i=this._createLoopLabel();return this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=i,this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===r?m._unreachableFlowNode:this._finishFlowLabel(t),this._bindLoopStatement(i,s,()=>{this.walk(e.whileSuite)}),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=!0===r?m._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitAssert(e){const t=this._createBranchLabel(),n=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),e.exceptionExpression&&(this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.exceptionExpression)),this._currentFlowNode=this._finishFlowLabel(t),!1}visitExcept(e){if(e.typeExpression&&this.walk(e.typeExpression),e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(this._createAssignmentTargetFlowNodes(e.name,!0,!1),t){const n={type:1,node:e.name,isConstant:y.isConstantName(e.name.value),path:this._fileInfo.filePath,range:r.convertOffsetsToRange(e.name.start,a.TextRange.getEnd(e.name),this._fileInfo.lines)};t.addDeclaration(n)}}return this.walk(e.exceptSuite),e.name&&this._createFlowAssignment(e.name,!0),!1}visitRaise(e){return e.typeExpression||0!==this._nestedExceptDepth||this._addError('"raise" requires one or more parameters when used outside of except clause',e),e.typeExpression&&this.walk(e.typeExpression),e.valueExpression&&this.walk(e.valueExpression),e.tracebackExpression&&this.walk(e.tracebackExpression),this._currentFinallyTarget&&this._addAntecedent(this._currentFinallyTarget,this._currentFlowNode),this._currentFlowNode=m._unreachableFlowNode,!1}visitTry(e){const t=e.exceptClauses.map(()=>this._createBranchLabel()),n=this._createBranchLabel(),s=this._createBranchLabel();let r=!1;const i={flags:p.FlowFlags.PreFinallyGate,id:p.getUniqueFlowNodeId(),antecedent:s,isGateClosed:!1};e.finallySuite&&this._addAntecedent(n,i),t.forEach(e=>{this._addAntecedent(e,this._currentFlowNode)});const o=this._currentFinallyTarget;this._currentFinallyTarget=e.finallySuite?s:void 0;const a=this._currentExceptTargets;if(this._currentExceptTargets=t,this.walk(e.trySuite),this._currentExceptTargets=a,e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(n,this._currentFlowNode),this._isCodeUnreachable()||(r=!0),this._nestedExceptDepth++,e.exceptClauses.forEach((e,s)=>{this._currentFlowNode=this._finishFlowLabel(t[s]),this.walk(e),this._addAntecedent(n,this._currentFlowNode),this._isCodeUnreachable()||(r=!0)}),this._nestedExceptDepth--,this._currentFinallyTarget=o,this._currentFlowNode=this._finishFlowLabel(n),e.finallySuite){this.walk(e.finallySuite);const t={flags:p.FlowFlags.PostFinally,id:p.getUniqueFlowNodeId(),antecedent:this._currentFlowNode,preFinallyGate:i};this._currentFlowNode=r?t:m._unreachableFlowNode}return!1}visitAwait(e){const t=u.getEnclosingFunction(e);return void 0!==t&&t.isAsync||this._addError('"await" allowed only within async function',e),!0}visitStringList(e){for(const t of e.strings)if(t.hasUnescapeErrors){c.getUnescapedString(t.token).unescapeErrors.forEach(e=>{const n={start:t.token.start+t.token.prefixLength+t.token.quoteMarkLength+e.offset,length:e.length};0===e.errorType?this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStringEscapeSequence,"reportInvalidStringEscapeSequence","Unsupported escape sequence in string literal",n):1===e.errorType?this._addError("Escape sequence (backslash) not allowed in expression portion of f-string",n):2===e.errorType?this._addError("Single close brace not allowed within f-string literal; use double close brace",n):3===e.errorType&&this._addError("Unterminated expression in f-string; missing close brace",n)})}return!0}visitGlobal(e){const t=this._currentScope.getGlobalScope();return e.nameList.forEach(e=>{const n=e.value;0===this._notLocalBindings.get(n)&&this._addError(`"${n}" was already declared nonlocal`,e);const s=this._currentScope.lookUpSymbolRecursive(n);s&&s.scope===this._currentScope&&this._addError(`"${n}" is assigned before global declaration`,e),this._bindNameToScope(t,n),this._currentScope!==t&&this._notLocalBindings.set(n,1)}),!0}visitNonlocal(e){const t=this._currentScope.getGlobalScope();return this._currentScope===t?this._addError("Nonlocal declaration not allowed at module level",e):e.nameList.forEach(e=>{const n=e.value;1===this._notLocalBindings.get(n)&&this._addError(`"${n}" was already declared global`,e);const s=this._currentScope.lookUpSymbolRecursive(n);s&&s.scope===this._currentScope?this._addError(`"${n}" is assigned before nonlocal declaration`,e):s&&s.scope!==t||this._addError(`No binding for nonlocal "${n}" found`,e),this._notLocalBindings.set(n,0)}),!0}visitImportAs(e){if(e.module.nameParts.length>0){const t=e.module.nameParts[0].value;let n;n=e.alias?e.alias.value:t;const r=this._bindNameToScope(this._currentScope,n);r&&this._fileInfo.isStubFile&&!e.alias&&r.setIsExternallyHidden();const i=l.getImportInfo(e.module);if(s.assert(void 0!==i),i&&i.isImportFound&&i.resolvedPaths.length>0&&r){const n=r.getDeclarations().find(e=>6===e.type&&e.firstNamePart===t),s=n||{type:6,node:e,path:"",range:o.getEmptyRange(),firstNamePart:t};if(e.alias||1===e.module.nameParts.length)s.path=i.resolvedPaths[i.resolvedPaths.length-1],this._addImplicitImportsToLoaderActions(i,s);else{let t=s;for(let n=1;n<e.module.nameParts.length&&!(n>=i.resolvedPaths.length);n++){const s=e.module.nameParts[n].value;let r=t.implicitImports?t.implicitImports.get(s):void 0;r||(r={path:"",implicitImports:new Map},t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(s,r)),n===e.module.nameParts.length-1&&(r.path=i.resolvedPaths[n],this._addImplicitImportsToLoaderActions(i,r)),t=r}}n||r.addDeclaration(s)}else if(e.alias&&r){const t={type:6,node:e,path:"*** unresolved ***",range:o.getEmptyRange()};r.addDeclaration(t)}this._createFlowAssignment(e.alias?e.alias:e.module.nameParts[0])}return!0}visitImportFrom(e){const t=l.getImportInfo(e.module);let n="";if(t&&t.isImportFound&&(n=t.resolvedPaths[t.resolvedPaths.length-1]),e.isWildcardImport){if((u.getEnclosingClass(e)||u.getEnclosingFunction(e))&&this._addError("Wildcard import is not allowed within a class or function",e),t){const s=[],r=this._fileInfo.importLookup(n);if(r){this._getWildcardImportNames(r).forEach(t=>{if(!r.symbolTable.get(t).isIgnoredForProtocolMatch()){const r=this._bindNameToScope(this._currentScope,t);if(r){const i={type:6,node:e,path:n,range:o.getEmptyRange(),symbolName:t};r.addDeclaration(i),s.push(t)}}})}t.implicitImports.forEach(t=>{if(!s.some(e=>e===t.name)){const r=this._bindNameToScope(this._currentScope,t.name);if(r){const i={type:6,node:e,path:t.path,range:o.getEmptyRange()},a={type:6,node:e,path:n,symbolName:t.name,submoduleFallback:i,range:o.getEmptyRange()};r.addDeclaration(a),s.push(t.name)}}}),this._createFlowWildcardImport(e,s)}}else e.imports.forEach(s=>{const r=s.name.value,i=s.alias||s.name,a=this._bindNameToScope(this._currentScope,i.value);if(a){let i,c;this._fileInfo.isStubFile&&!s.alias&&a.setIsExternallyHidden(),t&&t.implicitImports&&(i=t.implicitImports.find(e=>e.name===r)),i&&(c={type:6,node:s,path:i.path,range:o.getEmptyRange()},0===e.module.nameParts.length&&(n=""));const l={type:6,node:s,path:n,symbolName:r,submoduleFallback:c,range:o.getEmptyRange()};a.addDeclaration(l),this._createFlowAssignment(s.alias||s.name)}});return!0}visitWith(e){return e.withItems.forEach(e=>{this.walk(e.expression),e.target&&(this._bindPossibleTupleNamedTarget(e.target),this._addInferredTypeAssignmentForVariable(e.target,e),this._createAssignmentTargetFlowNodes(e.target,!0,!1))}),this.walk(e.suite),!1}visitTernary(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),s=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),this._currentFlowNode=this._finishFlowLabel(t),this.walk(e.ifExpression),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.elseExpression),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitUnaryOperation(e){if(37===e.operator&&this._currentFalseTarget&&this._currentTrueTarget)this._bindConditional(e.expression,this._currentFalseTarget,this._currentTrueTarget);else{const t=this._currentTrueTarget,n=this._currentFalseTarget;this._currentTrueTarget=void 0,this._currentFalseTarget=void 0,this.walk(e.expression),this._currentFalseTarget=n,this._currentTrueTarget=t}return!1}visitBinaryOperation(e){if(35===e.operator||36===e.operator){let t,n=this._currentTrueTarget,s=this._currentFalseTarget;n&&s||(t=this._createBranchLabel(),n=s=t);const r=this._createBranchLabel();35===e.operator?this._bindConditional(e.leftExpression,r,s):this._bindConditional(e.leftExpression,n,r),this._currentFlowNode=this._finishFlowLabel(r),this._bindConditional(e.rightExpression,n,s),t&&(this._currentFlowNode=this._finishFlowLabel(t))}else{const t=this._currentTrueTarget,n=this._currentFalseTarget;this._currentTrueTarget=void 0,this._currentFalseTarget=void 0,this.walk(e.leftExpression),this.walk(e.rightExpression),this._currentFalseTarget=n,this._currentTrueTarget=t}return!1}visitListComprehension(e){return this._createNewScope(0,this._currentScope,()=>{l.setScope(e,this._currentScope);const t=this._createBranchLabel(),n=[];for(let t=0;t<e.comprehensions.length;t++){const s=e.comprehensions[t],r=new Map;34===s.nodeType&&this._bindPossibleTupleNamedTarget(s.targetExpression,r),n.push(r)}for(let s=0;s<e.comprehensions.length;s++){const r=e.comprehensions[s];if(34===r.nodeType){const e=n[s];for(const t of e){const e=this._currentScope.parent.lookUpSymbol(t[0]);e&&this._createAssignmentAliasFlowNode(t[1].id,e.id)}this.walk(r.iterableExpression),this._createAssignmentTargetFlowNodes(r.targetExpression,!0,!1)}else{const e=this._createBranchLabel();this._bindConditional(r.testExpression,e,t),this._currentFlowNode=this._finishFlowLabel(e)}}this.walk(e.expression),this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(t)}),!1}_getWildcardImportNames(e){const t=[],n=e.symbolTable.get("__all__");if(n){const s=n.getDeclarations();if(1===s.length&&1===s[0].type){const n=s[0];if(n.node.parent&&3===n.node.parent.nodeType){const s=n.node.parent.rightExpression;if(32===s.nodeType)return s.entries.forEach(n=>{if(49===n.nodeType&&1===n.strings.length&&50===n.strings[0].nodeType){const s=n.strings[0].value;e.symbolTable.get(s)&&t.push(s)}}),t}}}return e.symbolTable.forEach((e,n)=>{n.startsWith("_")||t.push(n)}),t}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e){if(l.setFlowNode(n,this._currentFlowNode),this._isCodeUnreachable()&&!t){const s=n.start,r=e[e.length-1],i=a.TextRange.getEnd(r);this._addUnusedCode({start:s,length:i-s}),t=!0}if(t){if(this._targetFunctionDeclaration&&!this._targetFunctionDeclaration.isGenerator){(new _).checkContainsYield(n)&&(this._targetFunctionDeclaration.isGenerator=!0)}}else this.walk(n)}return!1}_createStartFlowNode(){return{flags:p.FlowFlags.Start,id:p.getUniqueFlowNodeId()}}_createBranchLabel(){return{flags:p.FlowFlags.BranchLabel,id:p.getUniqueFlowNodeId(),antecedents:[]}}_createLoopLabel(){return{flags:p.FlowFlags.LoopLabel,id:p.getUniqueFlowNodeId(),antecedents:[]}}_finishFlowLabel(e){return 0===e.antecedents.length?m._unreachableFlowNode:1===e.antecedents.length?e.antecedents[0]:e}_bindConditional(e,t,n){const s=this._currentTrueTarget,r=this._currentFalseTarget;this._currentTrueTarget=t,this._currentFalseTarget=n,this.walk(e),this._currentTrueTarget=s,this._currentFalseTarget=r,this._isLogicalExpression(e)||(this._addAntecedent(t,this._createFlowConditional(p.FlowFlags.TrueCondition,this._currentFlowNode,e)),this._addAntecedent(n,this._createFlowConditional(p.FlowFlags.FalseCondition,this._currentFlowNode,e)))}_createFlowConditional(e,t,n){if(t.flags&p.FlowFlags.Unreachable)return t;const s=f.evaluateStaticBoolLikeExpression(n,this._fileInfo.executionEnvironment);if(!0===s&&e&p.FlowFlags.FalseCondition||!1===s&&e&p.FlowFlags.TrueCondition)return m._unreachableFlowNode;const r=[];if(!this._isNarrowingExpression(n,r))return t;r.forEach(e=>{const t=p.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(t,t)});const i={flags:e,id:p.getUniqueFlowNodeId(),expression:n,antecedent:t};return this._addExceptTargets(i),i}_isLogicalExpression(e){switch(e.nodeType){case 56:return 37===e.operator;case 7:return 35===e.operator||36===e.operator}return!1}_isNarrowingExpression(e,t){switch(e.nodeType){case 39:case 36:return!!p.isCodeFlowSupportedForReference(e)&&(t.push(e),!0);case 4:return!!this._isNarrowingExpression(e.rightExpression,t)&&(t.push(e.name),!0);case 7:{const n=38===e.operator||39===e.operator,s=12===e.operator||27===e.operator;if(n||s){if(11===e.rightExpression.nodeType&&24===e.rightExpression.constType)return this._isNarrowingExpression(e.leftExpression,t);if(n&&9===e.leftExpression.nodeType&&39===e.leftExpression.leftExpression.nodeType&&"type"===e.leftExpression.leftExpression.value&&1===e.leftExpression.arguments.length&&0===e.leftExpression.arguments[0].argumentCategory)return this._isNarrowingExpression(e.leftExpression.arguments[0].valueExpression,t);if(s){if(49===e.leftExpression.nodeType||41===e.leftExpression.nodeType||11===e.leftExpression.nodeType)return this._isNarrowingExpression(e.rightExpression,t);if(49===e.rightExpression.nodeType||41===e.rightExpression.nodeType||11===e.rightExpression.nodeType)return this._isNarrowingExpression(e.leftExpression,t)}}return!1}case 56:return 37===e.operator&&this._isNarrowingExpression(e.expression,t);case 5:return this._isNarrowingExpression(e.rightExpression,t);case 9:if(39===e.leftExpression.nodeType&&("isinstance"===e.leftExpression.value||"issubclass"===e.leftExpression.value)&&2===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t);if(39===e.leftExpression.nodeType&&"callable"===e.leftExpression.value&&1===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t)}return!1}_createAssignmentTargetFlowNodes(e,t,n){switch(e.nodeType){case 39:case 36:this._createFlowAssignment(e,n),t&&this.walk(e);break;case 53:e.expressions.forEach(e=>{this._createAssignmentTargetFlowNodes(e,t,n)});break;case 55:this._createAssignmentTargetFlowNodes(e.valueExpression,!1,n),t&&this.walk(e);break;case 57:this._createAssignmentTargetFlowNodes(e.expression,!1,n),t&&this.walk(e);break;case 32:e.entries.forEach(e=>{this._createAssignmentTargetFlowNodes(e,t,n)});break;default:t&&this.walk(e)}}_createCallFlowNode(e){if(!this._isCodeUnreachable()){const t={flags:p.FlowFlags.Call,id:p.getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}}_createAssignmentAliasFlowNode(e,t){if(!this._isCodeUnreachable()){const n={flags:p.FlowFlags.AssignmentAlias,id:p.getUniqueFlowNodeId(),antecedent:this._currentFlowNode,targetSymbolId:e,aliasSymbolId:t};this._currentFlowNode=n}}_createFlowAssignment(e,t=!1){let n=g.indeterminateSymbolId;if(39===e.nodeType){const t=this._currentScope.lookUpSymbolRecursive(e.value);s.assert(void 0!==t),n=t.symbol.id}const r=this._currentFlowNode;if(!this._isCodeUnreachable()&&p.isCodeFlowSupportedForReference(e)){const s={flags:p.FlowFlags.Assignment,id:p.getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode,targetSymbolId:n},r=p.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(r,r),t&&(s.flags|=p.FlowFlags.Unbind),this._addExceptTargets(s),this._currentFlowNode=s}l.setFlowNode(e,t?r:this._currentFlowNode)}_createFlowWildcardImport(e,t){if(!this._isCodeUnreachable()){const n={flags:p.FlowFlags.WildcardImport,id:p.getUniqueFlowNodeId(),node:e,names:t,antecedent:this._currentFlowNode};this._addExceptTargets(n),this._currentFlowNode=n}l.setFlowNode(e,this._currentFlowNode)}_isCodeUnreachable(){return!!(this._currentFlowNode.flags&p.FlowFlags.Unreachable)}_addExceptTargets(e){this._currentExceptTargets&&this._currentExceptTargets.forEach(t=>{this._addAntecedent(t,e)})}_bindLoopStatement(e,t,n){const s=this._currentContinueTarget,r=this._currentBreakTarget;this._currentContinueTarget=e,this._currentBreakTarget=t,n(),this._currentContinueTarget=s,this._currentBreakTarget=r}_addAntecedent(e,t){this._currentFlowNode.flags&p.FlowFlags.Unreachable||e.antecedents.some(e=>e.id===t.id)||e.antecedents.push(t)}_bindNameToScope(e,t,n){if(void 0===this._notLocalBindings.get(t)){let s=e.lookUpSymbol(t);if(!s){if(s=e.addSymbol(t,5),2===e.type){const n=e.parent.lookUpSymbol(t);n&&this._createAssignmentAliasFlowNode(s.id,n.id)}this._fileInfo.isStubFile&&y.isPrivateOrProtectedName(t)&&s.setIsExternallyHidden(),n&&n.set(t,s)}return s}}_bindPossibleTupleNamedTarget(e,t){switch(e.nodeType){case 39:this._bindNameToScope(this._currentScope,e.value,t);break;case 53:e.expressions.forEach(e=>{this._bindPossibleTupleNamedTarget(e,t)});break;case 32:e.entries.forEach(e=>{this._bindPossibleTupleNamedTarget(e,t)});break;case 55:this._bindPossibleTupleNamedTarget(e.valueExpression,t);break;case 57:this._bindPossibleTupleNamedTarget(e.expression,t)}}_addBuiltInSymbolToCurrentScope(e,t,n){const s=this._addSymbolToCurrentScope(e,!1);s&&(s.addDeclaration({type:0,node:t,intrinsicType:n,path:this._fileInfo.filePath,range:o.getEmptyRange()}),s.setIsIgnoredForProtocolMatch())}_addSymbolToCurrentScope(e,t){let n=this._currentScope.lookUpSymbol(e);if(!n){let s=0;t&&(s|=1),2===this._currentScope.type&&(s|=4),this._fileInfo.isStubFile&&y.isPrivateOrProtectedName(e)&&(s|=2),n=this._currentScope.addSymbol(e,s)}return n}_createNewScope(e,t,n){const s=this._currentScope;this._currentScope=new h.Scope(e,t);const r=4===e||3===e||1===e,i=this._currentExecutionScopeReferenceMap;r&&(this._currentExecutionScopeReferenceMap=new Map);const o=this._notLocalBindings;this._notLocalBindings=new Map,n(),this._currentExecutionScopeReferenceMap=i,this._currentScope=s,this._notLocalBindings=o}_addInferredTypeAssignmentForVariable(e,t){switch(e.nodeType){case 39:{const n=e,s=this._currentScope.lookUpSymbolRecursive(n.value);if(s&&s.symbol){const i={type:1,node:e,isConstant:y.isConstantName(e.value),inferredTypeSource:t,path:this._fileInfo.filePath,range:r.convertOffsetsToRange(n.start,a.TextRange.getEnd(n),this._fileInfo.lines)};s.symbol.addDeclaration(i)}break}case 36:{const n=this._getMemberAccessInfo(e);if(n){const s=e.memberName;let i=n.classScope.lookUpSymbol(s.value);if(!i){i=n.classScope.addSymbol(s.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;y.isPrivateOrProtectedName(s.value)&&e&&i.setIsPrivateMember()}n.isInstanceMember?i.setIsInstanceMember():i.setIsClassMember();const o={type:1,node:e.memberName,isConstant:y.isConstantName(s.value),inferredTypeSource:t,path:this._fileInfo.filePath,range:r.convertOffsetsToRange(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines)};i.addDeclaration(o)}break}case 53:e.expressions.forEach(e=>{this._addInferredTypeAssignmentForVariable(e,t)});break;case 55:this._addInferredTypeAssignmentForVariable(e.valueExpression,t);break;case 57:this._addInferredTypeAssignmentForVariable(e.expression,t);break;case 32:e.entries.forEach(e=>{this._addInferredTypeAssignmentForVariable(e,t)})}}_addTypeDeclarationForVariable(e,t){let n=!1;switch(e.nodeType){case 39:{const s=e,i=this._currentScope.lookUpSymbolRecursive(s.value);if(i&&i.symbol){const n=this._isAnnotationFinal(t),o={type:1,node:e,isConstant:y.isConstantName(s.value),isFinal:n.isFinal,path:this._fileInfo.filePath,typeAnnotationNode:n.isFinal?n.finalTypeNode:t,range:r.convertOffsetsToRange(s.start,a.TextRange.getEnd(s),this._fileInfo.lines)};i.symbol.addDeclaration(o)}n=!0;break}case 36:{const s=this._getMemberAccessInfo(e);if(s){const i=e.memberName;let o=s.classScope.lookUpSymbol(i.value);if(!o){o=s.classScope.addSymbol(i.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;y.isPrivateOrProtectedName(i.value)&&e&&o.setIsPrivateMember()}s.isInstanceMember?o.setIsInstanceMember():o.setIsClassMember();const a=this._isAnnotationFinal(t),c={type:1,node:e.memberName,isConstant:y.isConstantName(i.value),isFinal:a.isFinal,path:this._fileInfo.filePath,typeAnnotationNode:a.isFinal?a.finalTypeNode:t,range:r.convertOffsetsToRange(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines)};o.addDeclaration(c),n=!0}break}}n||this._addError("Type annotation not supported for this type of expression",t)}_isAnnotationFinal(e){let t,n=!1;if(e)if(39===e.nodeType)"Final"===e.value&&(n=!0);else if(36===e.nodeType)39===e.leftExpression.nodeType&&"typing"===e.leftExpression.value&&"Final"===e.memberName.value&&(n=!0);else if(24===e.nodeType&&1===e.items.items.length){this._isAnnotationFinal(e.baseExpression).isFinal&&(n=!0,t=e.items.items[0])}return{isFinal:n,finalTypeNode:t}}_getMemberAccessInfo(e){if(39!==e.leftExpression.nodeType)return;const t=e.leftExpression.value,n=u.getEnclosingFunction(e);if(!n)return;const r=u.getEnclosingClass(n);if(!r)return;let i=!1;if(n.parameters.length<1||!n.parameters[0].name)return;const o=r.name.value,a=n.parameters[0].name.value;if(t===o)i=!1;else{if(t!==a)return;if("__new__"===n.name.value)i=!1;else{i=!0;for(const e of n.decorators)if(39===e.leftExpression.nodeType){const t=e.leftExpression.value;if("staticmethod"===t)return;if("classmethod"===t){i=!1;break}}}}const c=l.getScope(r);return s.assert(void 0!==c),{classNode:r,methodNode:n,classScope:c,isInstanceMember:i}}_addImplicitImportsToLoaderActions(e,t){e.implicitImports.forEach(e=>{const n=t.implicitImports?t.implicitImports.get(e.name):void 0;n?n.path=e.path:(t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(e.name,{path:e.path,implicitImports:new Map}))})}_handleTypingStubAssignmentOrAnnotation(e){if(!this._fileInfo.isTypingStubFile)return!1;let t;if(55===e.nodeType)t=e;else{if(55!==e.leftExpression.nodeType)return!1;t=e.leftExpression}if(39!==t.valueExpression.nodeType)return!1;const n=t.valueExpression.value;if(!{Tuple:!0,Generic:!0,Protocol:!0,Callable:!0,Type:!0,ClassVar:!0,Final:!0,Literal:!0,TypedDict:!0}[n])return!1;const s=this._bindNameToScope(this._currentScope,n);return s&&s.addDeclaration({type:5,node:t,path:this._fileInfo.filePath,range:r.convertOffsetsToRange(t.start,a.TextRange.getEnd(t),this._fileInfo.lines)}),!0}_deferBinding(e){this._deferredBindingTasks.push({scope:this._currentScope,nonLocalBindingsMap:this._notLocalBindings,codeFlowExpressionMap:this._currentExecutionScopeReferenceMap,callback:e})}_bindDeferred(){for(;this._deferredBindingTasks.length>0;){const e=this._deferredBindingTasks.shift();this._currentScope=e.scope,this._notLocalBindings=e.nonLocalBindingsMap,this._nestedExceptDepth=0,this._currentExecutionScopeReferenceMap=e.codeFlowExpressionMap,e.callback()}}_bindYield(e){const t=u.getEnclosingFunction(e);t?t.isAsync&&62===e.nodeType&&this._addError('"yield from" not allowed in an async function',e):this._addError('"yield" not allowed outside of a function',e),this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.yieldExpressions||(this._targetFunctionDeclaration.yieldExpressions=[]),this._targetFunctionDeclaration.yieldExpressions.push(e),this._targetFunctionDeclaration.isGenerator=!0),e.expression&&this.walk(e.expression),l.setFlowNode(e,this._currentFlowNode)}_addDiagnostic(e,t,n,s){if("error"===e){const e=this._addError(n,s);return e.setRule(t),e}if("warning"===e){const e=this._addWarning(n,s);return e.setRule(t),e}}_addUnusedCode(e){return this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange("Code is unreachable",e)}_addError(e,t){return this._fileInfo.diagnosticSink.addErrorWithTextRange(e,t)}_addWarning(e,t){return this._fileInfo.diagnosticSink.addWarningWithTextRange(e,t)}}t.Binder=m,m._unreachableFlowNode={flags:p.FlowFlags.Unreachable,id:p.getUniqueFlowNodeId()};class _ extends d.ParseTreeWalker{constructor(){super(...arguments),this._containsYield=!1}checkContainsYield(e){return this.walk(e),this._containsYield}visitYield(e){return this._containsYield=!0,!1}visitYieldFrom(e){return this._containsYield=!0,!1}}t.YieldFinder=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1),r=n(30);t.Scope=class{constructor(e,t){this.symbolTable=new Map,this.type=e,this.parent=t}getGlobalScope(){let e=this;for(;e;){if(3===e.type||4===e.type)return e;e=e.parent}return s.fail("failed to find scope"),this}isIndependentlyExecutable(){return 3===this.type||1===this.type}lookUpSymbol(e){return this.symbolTable.get(e)}lookUpSymbolRecursive(e){return this._lookUpSymbolRecursiveInternal(e,!1,!1)}addSymbol(e,t){const n=new r.Symbol(t);return this.symbolTable.set(e,n),n}_lookUpSymbolRecursiveInternal(e,t,n){const s=this.symbolTable.get(e);if(s){if(t&&s.isExternallyHidden())return;return{symbol:s,isOutsideCallerModule:t,isBeyondExecutionScope:n,scope:this}}if(this.parent)return this.parent._lookUpSymbolRecursiveInternal(e,t||3===this.type,n||this.isIndependentlyExecutable())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1),r=n(21),i=n(0),o=n(7),a=n(29),c=n(28),l=n(8),p=n(12),u=n(14),d=n(23),h=n(16),f=n(17);class g extends p.ParseTreeWalker{constructor(e,t){super(),this._scopedNodes=[],this._moduleNode=e,this._fileInfo=o.getFileInfo(e),this._evaluator=t}check(){this._scopedNodes.push(this._moduleNode),this.walkMultiple(this._moduleNode.statements),this._validateSymbolTables(),this._reportDuplicateImports()}walk(e){o.isCodeUnreachable(e)||super.walk(e)}visitClass(e){const t=this._evaluator.getTypeOfClass(e);return this.walk(e.suite),this.walkMultiple(e.decorators),this.walkMultiple(e.arguments),t&&(this._validateClassMethods(t.classType),this._validateFinalMemberOverrides(t.classType),h.ClassType.isTypedDictClass(t.classType)&&this._validateTypedDictClassSuite(e.suite)),this._scopedNodes.push(e),!1}visitFunction(e){const t=this._evaluator.getTypeOfFunction(e),n=l.getEnclosingClass(e,!0);return t&&(e.parameters.forEach((e,n)=>{if(e.name){const s=t.functionType.details.parameters[n].type;if(1===s.category)this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,"reportUnknownParameterType",`Type of parameter "${e.name.value}" is unknown`,e.name);else if(f.containsUnknown(s)){const t=new r.DiagnosticAddendum;t.addMessage(`Parameter type is "${this._evaluator.printType(s)}"`),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,"reportUnknownParameterType",`Type of parameter "${e.name.value}" is partially unknown`+t.getString(),e.name)}}}),n&&this._validateMethod(e,t.functionType,n)),e.parameters.forEach(e=>{e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation)}),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),this.walkMultiple(e.decorators),e.parameters.forEach(e=>{e.name&&this.walk(e.name)}),this.walk(e.suite),t&&this._validateFunctionReturn(e,t.functionType),this._scopedNodes.push(e),!1}visitLambda(e){this._evaluator.getType(e),this.walkMultiple([...e.parameters,e.expression]),e.parameters.forEach(e=>{if(e.name){const t=this._evaluator.getType(e.name);t&&(1===t.category?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,"reportUnknownLambdaType",`Type of "${e.name.value}" is unknown`,e.name):f.containsUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,"reportUnknownLambdaType",`Type of "${e.name.value}", `+`"${this._evaluator.printType(t)}", is partially unknown`,e.name))}});const t=this._evaluator.getType(e.expression);return t&&(1===t.category?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,"reportUnknownLambdaType","Return type of lambda is unknown",e.expression):f.containsUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,"reportUnknownLambdaType",`Return type of lambda, "${this._evaluator.printType(t)}", is partially unknown`,e.expression)),this._scopedNodes.push(e),!1}visitCall(e){return this._evaluator.getType(e),this._validateIsInstanceCallNecessary(e),l.isWithinDefaultParamInitializer(e)&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer,"reportCallInDefaultInitializer","Function calls within default value initializer are not permitted",e),!0}visitFor(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitListComprehension(e){return this._scopedNodes.push(e),!0}visitIf(e){return this._evaluator.getType(e.testExpression),!0}visitWhile(e){return this._evaluator.getType(e.testExpression),!0}visitWith(e){return e.withItems.forEach(e=>{this._evaluator.evaluateTypesForStatement(e)}),!0}visitReturn(e){let t;const n=l.getEnclosingFunction(e),s=n?this._evaluator.getFunctionDeclaredReturnType(n):void 0;if(t=e.returnExpression?this._evaluator.getType(e.returnExpression)||h.UnknownType.create():h.NoneType.create(),this._evaluator.isNodeReachable(e)&&n){if(s)if(f.isNoReturnType(s))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",'Function with declared return type "NoReturn" cannot include a return statement',e);else{const n=new r.DiagnosticAddendum,i=f.specializeType(s,void 0);this._evaluator.canAssignType(i,t,n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Expression of type "${this._evaluator.printType(t)}" cannot be assigned `+`to return type "${this._evaluator.printType(i)}"`+n.getString(),e.returnExpression?e.returnExpression:e)}1===t.category?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,"reportUnknownVariableType","Return type is unknown",e.returnExpression):f.containsUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,"reportUnknownVariableType",`Return type, "${this._evaluator.printType(t)}", is partially unknown`,e.returnExpression)}return!0}visitYield(e){const t=e.expression?this._evaluator.getType(e.expression):h.NoneType.create();let n=t;const s=this._evaluator.getBuiltInType(e,"Iterator");return n=t&&7===s.category?h.ObjectType.create(h.ClassType.cloneForSpecialization(s,[t])):h.UnknownType.create(),this._validateYieldType(e,n),!0}visitYieldFrom(e){const t=this._evaluator.getType(e.expression);return t&&this._validateYieldType(e,t),!0}visitRaise(e){const t=this._evaluator.getBuiltInType(e,"BaseException");if(e.typeExpression){const n=this._evaluator.getType(e.typeExpression);if(n&&t&&7===t.category){const s=new r.DiagnosticAddendum;f.doForSubtypes(n,e=>(h.isAnyOrUnknown(e)||(7===e.category?f.derivesFromClassRecursive(e,t)||s.addMessage(`"${this._evaluator.printType(e)}" does not derive from BaseException`):8===e.category&&f.derivesFromClassRecursive(e.classType,t)||s.addMessage(`"${this._evaluator.printType(e)}" does not derive from BaseException`)),e)),s.getMessageCount()>0&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues","Expected exception class or object"+s.getString(),e.typeExpression)}}if(e.valueExpression){const n=this._evaluator.getType(e.valueExpression);if(n&&t&&7===t.category){const s=new r.DiagnosticAddendum;f.doForSubtypes(n,e=>(h.isAnyOrUnknown(e)||h.isNoneOrNever(e)||8===e.category&&f.derivesFromClassRecursive(e.classType,t)||s.addMessage(`"${this._evaluator.printType(e)}" does not derive from BaseException`),e)),s.getMessageCount()>0&&this._evaluator.addError("Expected exception object or None"+s.getString(),e.valueExpression)}}return!0}visitExcept(e){if(e.typeExpression){this._evaluator.evaluateTypesForStatement(e);const t=this._evaluator.getType(e.typeExpression);t&&this._validateExceptionType(t,e.typeExpression)}return!0}visitAssert(e){e.exceptionExpression&&this._evaluator.getType(e.exceptionExpression);const t=this._evaluator.getType(e.testExpression);return t&&8===t.category&&h.ClassType.isBuiltIn(t.classType,"Tuple")&&t.classType.typeArguments&&t.classType.typeArguments.length>0&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportAssertAlwaysTrue,"reportAssertAlwaysTrue","Assert expression always evaluates to true",e.testExpression),!0}visitAssignment(e){return this._evaluator.evaluateTypesForStatement(e),e.typeAnnotationComment&&this._evaluator.getType(e.typeAnnotationComment),!0}visitAssignmentExpression(e){return this._evaluator.getType(e),!0}visitAugmentedAssignment(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitIndex(e){return this._evaluator.getType(e),!0}visitBinaryOperation(e){return this._evaluator.getType(e),!0}visitSlice(e){return this._evaluator.getType(e),!0}visitUnpack(e){return this._evaluator.getType(e),!0}visitTuple(e){return this._evaluator.getType(e),!0}visitUnaryOperation(e){return this._evaluator.getType(e),!0}visitTernary(e){return this._evaluator.getType(e),!0}visitStringList(e){return e.typeAnnotation&&this._evaluator.getType(e),e.strings.length>1&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportImplicitStringConcatenation,"reportImplicitStringConcatenation","Implicit string concatenation not allowed",e),!0}visitFormatString(e){return e.expressions.forEach(e=>{this._evaluator.getType(e)}),!0}visitName(e){return this._conditionallyReportPrivateUsage(e),!0}visitDel(e){return e.expressions.forEach(e=>{this._evaluator.verifyDeleteExpression(e)}),!0}visitMemberAccess(e){return this._evaluator.getType(e),this._conditionallyReportPrivateUsage(e.memberName),this.walk(e.leftExpression),!1}visitImportAs(e){return this._evaluator.evaluateTypesForStatement(e),!1}visitImportFrom(e){return e.isWildcardImport||e.imports.forEach(e=>{this._evaluator.evaluateTypesForStatement(e)}),!1}visitTypeAnnotation(e){return this._evaluator.getType(e.typeAnnotation),!0}visitError(e){return e.child&&this._evaluator.getType(e.child),!1}_validateExceptionType(e,t){const n=this._evaluator.getBuiltInType(t,"BaseException"),s=e=>!n||7!==n.category||f.derivesFromClassRecursive(e,n),i=new r.DiagnosticAddendum;let o;if(h.isAnyOrUnknown(e))o=e;else if(7===e.category)s(e)||i.addMessage(`"${this._evaluator.printType(e)}" does not derive from BaseException`),o=h.ObjectType.create(e);else if(8===e.category){const n=this._evaluator.getTypeFromIterable(e,!1,t,!1);o=f.doForSubtypes(n,t=>{if(h.isAnyOrUnknown(t))return t;const n=f.transformTypeObjectToClass(t);return 7===n.category?(s(n)||i.addMessage(`"${this._evaluator.printType(e)}" does not derive from BaseException`),h.ObjectType.create(n)):(i.addMessage(`"${this._evaluator.printType(e)}" does not derive from BaseException`),h.UnknownType.create())})}return i.getMessageCount()>0&&this._evaluator.addError(`"${this._evaluator.printType(e)}" is not valid exception class`+i.getString(),t),o||h.UnknownType.create()}_validateSymbolTables(){if(!this._fileInfo.isStubFile)for(const e of this._scopedNodes){const t=o.getScope(e);t.symbolTable.forEach((e,n)=>{this._conditionallyReportUnusedSymbol(n,e,t.type),this._reportIncompatibleDeclarations(n,e),this._reportMultipleFinalDeclarations(n,e)})}}_reportMultipleFinalDeclarations(e,t){if(!d.isFinalVariable(t))return;const n=t.getDeclarations();let s=!1,r=!1;if(n.forEach(t=>{a.isFinalVariableDeclaration(t)&&(s&&this._evaluator.addError(`"${e}" was previously declared as Final`,t.node),s=!0),1===t.type&&t.inferredTypeSource&&(r&&this._evaluator.addError(`"${e}" is declared Final and can be assigned only once`,t.node),r=!0)}),!r&&!this._fileInfo.isStubFile){const t=n.find(e=>1===e.type&&e.isFinal);t&&this._evaluator.addError(`"${e}" is declared Final, but value is not assigned`,t.node)}}_reportIncompatibleDeclarations(e,t){const n=d.getLastTypedDeclaredForSymbol(t);if(!n)return;let s=t.getDeclarations().filter(e=>e!==n);if(3===n.type&&(s=s.filter(e=>3!==e.type)),0===s.length)return;let r="";3===n.type?r=n.isMethod?"method ":"function ":4===n.type?r="class ":2===n.type?r="parameter ":1===n.type&&(r="variable ");const i=e=>{if(e){let t;3===n.type||4===n.type?t=n.node.name:1===n.type?39===n.node.nodeType&&(t=n.node):2===n.type&&n.node.name&&(t=n.node.name),t&&e.addRelatedInfo(`See ${r}declaration`,n.path,n.range)}};for(const t of s)if(4===t.type){i(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Class declaration "${e}" is obscured by a ${r}declaration of the same name`,t.node.name))}else if(3===t.type){i(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Function declaration "${e}" is obscured by a ${r}declaration of the same name`,t.node.name))}else if(2===t.type){if(t.node.name){i(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Parameter "${e}" is obscured by a ${r}declaration of the same name`,t.node.name))}}else if(1===t.type){const s=this._evaluator.getTypeForDeclaration(n);if(t.typeAnnotationNode){if(39===t.node.nodeType){let o=!1;if(1===n.type){const e=this._evaluator.getTypeForDeclaration(t);s&&e&&h.isTypeSame(s,e)&&(o=!0)}if(!o){i(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Declared type for "${e}" is obscured by an incompatible ${r}declaration`,t.node))}}}else if(s&&!f.isProperty(s)&&(3===n.type||4===n.type)){i(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Declared ${r}already exists for "${e}"`,t.node))}}}_conditionallyReportUnusedSymbol(e,t,n){const s=this._fileInfo.accessedSymbolMap;t.isIgnoredForProtocolMatch()||s.has(t.id)||"_"!==e&&(u.isDunderName(e)||t.getDeclarations().forEach(t=>{this._conditionallyReportUnusedDeclaration(t,this._isSymbolPrivate(e,n))}))}_conditionallyReportUnusedDeclaration(e,t){let n,s,r,o;switch(e.type){case 6:if(n=this._fileInfo.diagnosticRuleSet.reportUnusedImport,o="reportUnusedImport",21===e.node.nodeType)if(e.node.alias)s=e.node.alias;else{const t=e.node.module.nameParts;if(t.length>0){const e=t.map(e=>e.value).join("."),n={start:t[0].start,length:t[0].length};return i.TextRange.extend(n,t[t.length-1]),this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(`"${e}" is not accessed`,n),void this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportUnusedImport,"reportUnusedImport",`Import "${e}" is not accessed`,n)}}else if(23===e.node.nodeType){const t=e.node.parent;(0===t.module.nameParts.length||"__future__"!==t.module.nameParts[0].value&&!this._fileInfo.filePath.endsWith("_pb2.py"))&&(s=e.node.alias||e.node.name)}s&&(r=`Import "${s.value}" is not accessed`);break;case 1:case 2:if(!t)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedVariable,39===e.node.nodeType&&(s=e.node,o="reportUnusedVariable",r=`Variable "${s.value}" is not accessed`);break;case 4:if(!t)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedClass,s=e.node.name,o="reportUnusedClass",r=`Class "${s.value}" is not accessed`;break;case 3:if(!t)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedFunction,s=e.node.name,o="reportUnusedFunction",r=`Function "${s.value}" is not accessed`;break;default:return}s&&void 0!==o&&r&&(this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(`"${s.value}" is not accessed`,s),this._evaluator.addDiagnostic(n,o,r,s))}_validateIsInstanceCallNecessary(e){if(39!==e.leftExpression.nodeType||"isinstance"!==e.leftExpression.value&&"issubclass"!==e.leftExpression.value||2!==e.arguments.length)return;let t=e;for(;t;){if(2===t.nodeType)return;t=t.parent}const n=e.leftExpression.value,s="isinstance"===n;let r=this._evaluator.getType(e.arguments[0].valueExpression);if(!r)return;if(r=f.doForSubtypes(r,e=>f.transformTypeObjectToClass(e)),h.isAnyOrUnknown(r))return;const i=this._evaluator.getType(e.arguments[1].valueExpression);if(!i)return;const o=[];if(7===i.category)o.push(i);else{if(8!==i.category)return;{const e=i.classType;h.ClassType.isBuiltIn(e,"Tuple")&&e.typeArguments&&e.typeArguments.forEach(e=>{7===e.category&&o.push(e)})}}o.some(e=>h.ClassType.isProtocolClass(e))&&this._evaluator.addError(`Protocol class cannot be used in ${n} call`,e.arguments[1].valueExpression);const a=e=>h.combineTypes(e),c=e=>{const t=[];for(const n of o){const s=h.ClassType.isDerivedFrom(e,n),r=h.ClassType.isDerivedFrom(n,e);r&&r&&!h.ClassType.isSameGenericClass(e,n)?t.push(h.UnknownType.create()):s?t.push(e):r&&t.push(n)}return s?t.map(e=>7===e.category?h.ObjectType.create(e):e):t};let l;if(s&&8===r.category){l=a(c(r.classType))}else if(s||7!==r.category){if(10!==r.category)return;{let e=[],t=!1;if(r.subtypes.forEach(n=>{h.isAnyOrUnknown(n)&&(t=!0),s&&8===n.category?e=e.concat(c(n.classType)):s||7!==n.category||(e=e.concat(c(n)))}),l=a(e),t)return}}else{l=a(c(r))}const p=()=>{const e=o.map(e=>h.ObjectType.create(e));return h.combineTypes(e)},u=s?"instance":"subclass";4===l.category?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,"reportUnnecessaryIsInstance",`Unnecessary ${n} call; "${this._evaluator.printType(r)}" `+`is never ${u} of "${this._evaluator.printType(p())}"`,e):h.isTypeSame(l,r)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,"reportUnnecessaryIsInstance",`Unnecessary ${n} call; "${this._evaluator.printType(r)}" `+`is always ${u} of "${this._evaluator.printType(p())}"`,e)}_isSymbolPrivate(e,t){if(1===t||0===t)return!0;if(u.isPrivateName(e))return!0;if(u.isProtectedName(e)){return!(2===t)}return!1}_conditionallyReportPrivateUsage(e){if("none"===this._fileInfo.diagnosticRuleSet.reportPrivateUsage)return;if(this._fileInfo.isStubFile)return;const t=e.value,n=u.isPrivateName(t),s=u.isProtectedName(t);if(!n&&!s)return;const r=this._evaluator.getDeclarationsForNameNode(e);let i,o=r&&r.length>0?r[r.length-1]:void 0;if(!o||o.node===e)return;if(o=this._evaluator.resolveAliasDeclaration(o),!o||o.node===e)return;o.node&&(i=l.getEnclosingClassOrModule(o.node)),o.node&&o.node.parent&&o.node.parent===i&&10===i.nodeType&&(i=l.getEnclosingClassOrModule(i));let a=!1;if(i&&10===i.nodeType&&s){const t=this._evaluator.getTypeOfClass(i);if(t&&7===t.decoratedType.category){a=!0;const n=l.getEnclosingClass(e);if(n){a=!0;const e=this._evaluator.getTypeOfClass(n);if(e&&7===e.decoratedType.category&&f.derivesFromClassRecursive(e.decoratedType,t.decoratedType))return}}}if(i&&!l.isNodeContainedWithin(e,i))if(a)this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,"reportPrivateUsage",`"${t}" is protected and used outside of a derived class`,e);else{const n=10===i.nodeType?"class":"module";this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,"reportPrivateUsage",`"${t}" is private and used outside of the ${n} in which it is declared`,e)}}_validateTypedDictClassSuite(e){const t=e=>{this._evaluator.addError("TypedDict classes can contain only type annotations",e)};e.statements.forEach(e=>{if(!o.isCodeUnreachable(e))if(48===e.nodeType)for(const n of e.statements)55!==n.nodeType&&18!==n.nodeType&&49!==n.nodeType&&43!==n.nodeType&&t(n);else t(e)})}_validateFunctionReturn(e,t){if(!this._fileInfo.isStubFile)if(e.returnTypeAnnotation){const n=!this._evaluator.isAfterNodeReachable(e),s=this._evaluator.isAfterNodeReachable(e.suite);let i=t.details.declaredReturnType;if(i&&(1===i.category?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,"reportUnknownVariableType","Declared return type is unknown",e.returnTypeAnnotation):f.containsUnknown(i)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,"reportUnknownVariableType",`Declared return type, "${this._evaluator.printType(i)}", is partially unknown`,e.returnTypeAnnotation)),h.FunctionType.isGenerator(t)&&(i=f.getDeclaredGeneratorReturnType(t)),i&&!n&&s)if(f.isNoReturnType(i))l.isSuiteEmpty(e.suite)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",'Function with declared type of "NoReturn" cannot return "None"',e.returnTypeAnnotation);else if(!h.FunctionType.isAbstractMethod(t)){const t=new r.DiagnosticAddendum;this._evaluator.canAssignType(i,h.NoneType.create(),t)||l.isSuiteEmpty(e.suite)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Function with declared type of "${this._evaluator.printType(i)}" must return value`+t.getString(),e.returnTypeAnnotation)}}else{const n=this._evaluator.getFunctionInferredReturnType(t);1===n.category?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,"reportUnknownParameterType","Inferred return type is unknown",e.name):f.containsUnknown(n)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,"reportUnknownParameterType",`Return type "${this._evaluator.printType(n)}" is partially unknown`,e.name)}}_validateFinalMemberOverrides(e){e.details.fields.forEach((t,n)=>{const s=f.lookUpClassMember(e,n,1);if(s&&7===s.classType.category&&d.isFinalVariable(s.symbol)){const e=t.getDeclarations()[0];this._evaluator.addError(`"${n}" cannot be redeclared because parent class "${s.classType.details.name}" declares it as Final`,e.node)}})}_validateClassMethods(e){this._fileInfo.isStubFile||this._validateOveriddenMethods(e)}_validateOveriddenMethods(e){e.details.fields.forEach((t,n)=>{if(t.isClassMember()&&!u.isDunderName(n)){const s=this._evaluator.getEffectiveTypeOfSymbol(t);if(5===s.category){const i=f.lookUpClassMember(e,n,1);if(i&&7===i.classType.category){const e=this._evaluator.getEffectiveTypeOfSymbol(i.symbol),o=new r.DiagnosticAddendum;if(!this._evaluator.canOverrideMethod(e,s,o)){const e=d.getLastTypedDeclaredForSymbol(t);if(e&&3===e.type){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,"reportIncompatibleMethodOverride",`Method "${n}" overrides class "${i.classType.details.name}" `+"in an incompatible manner"+o.getString(),e.node.name),s=d.getLastTypedDeclaredForSymbol(i.symbol);t&&s&&t.addRelatedInfo("Overridden method",s.path,s.range)}}if(5===e.category&&h.FunctionType.isFinal(e)){const e=d.getLastTypedDeclaredForSymbol(t);if(e&&3===e.type){const t=this._evaluator.addError(`Method "${n}" cannot override final method defined `+`in class "${i.classType.details.name}"`,e.node.name),s=d.getLastTypedDeclaredForSymbol(i.symbol);t&&s&&t.addRelatedInfo("Final method",s.path,s.range)}}}}}})}_validateMethod(e,t,n){if(e.name&&"__new__"===e.name.value)(0===e.parameters.length||!e.parameters[0].name||"cls"!==e.parameters[0].name.value&&"mcs"!==e.parameters[0].name.value)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,"reportSelfClsParameterName",'The __new__ override should take a "cls" parameter',e.parameters.length>0?e.parameters[0]:e.name);else if(e.name&&"__init_subclass__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,"reportSelfClsParameterName",'The __init_subclass__ override should take a "cls" parameter',e.parameters.length>0?e.parameters[0]:e.name);else if(h.FunctionType.isStaticMethod(t)){if(e.parameters.length>0&&e.parameters[0].name){const t=e.parameters[0].name.value;"self"!==t&&"cls"!==t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,"reportSelfClsParameterName",'Static methods should not take a "self" or "cls" parameter',e.parameters[0].name)}}else if(h.FunctionType.isClassMethod(t)){let t="";e.parameters.length>0&&e.parameters[0].name&&(t=e.parameters[0].name.value),"cls"!==t&&(this._fileInfo.isStubFile&&(t.startsWith("_")||"metacls"===t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,"reportSelfClsParameterName",'Class methods should take a "cls" parameter',e.parameters.length>0?e.parameters[0]:e.name))}else if(0===e.decorators.length){let t="",s=!0;if(e.parameters.length>0&&(e.parameters[0].name&&(t=e.parameters[0].name.value),0!==e.parameters[0].category&&(s=!1)),s&&"self"!==t){let s=!1;if("cls"===t){const e=this._evaluator.getTypeOfClass(n),t=this._evaluator.getBuiltInType(n,"type");t&&7===t.category&&e&&7===e.classType.category&&f.derivesFromClassRecursive(e.classType,t)&&(s=!0)}s||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,"reportSelfClsParameterName",'Instance methods should take a "self" parameter',e.parameters.length>0?e.parameters[0]:e.name)}}}_validateYieldType(e,t){let n;const i=l.getEnclosingFunction(e);if(i){const t=this._evaluator.getTypeOfFunction(i);if(t){s.assert(5===t.functionType.category);const r=this._evaluator.getBuiltInType(e,"Iterator");n=f.getDeclaredGeneratorYieldType(t.functionType,r)}}if(this._evaluator.isNodeReachable(e)&&n)if(f.isNoReturnType(n))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",'Function with declared return type "NoReturn" cannot include a yield statement',e);else{const s=new r.DiagnosticAddendum;this._evaluator.canAssignType(n,t,s)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Expression of type "${this._evaluator.printType(t)}" cannot be assigned `+`to yield type "${this._evaluator.printType(n)}"`+s.getString(),e.expression||e)}}_reportDuplicateImports(){const e=c.getTopLevelImports(this._moduleNode),t=new Map;e.orderedImports.forEach(e=>{if(22===e.node.nodeType){const t=new Map;e.node.imports.forEach(e=>{if(!e.alias){t.get(e.name.value)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,"reportDuplicateImport",`"${e.name.value}" is imported more than once`,e.name):t.set(e.name.value,e)}})}else if(e.subnode&&!e.subnode.alias){t.get(e.moduleName)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,"reportDuplicateImport",`"${e.moduleName}" is imported more than once`,e.subnode):t.set(e.moduleName,e.subnode)}})}}t.Checker=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(35);function r(e){const t=s.getStrictDiagnosticRuleSet(),n=s.getBooleanDiagnosticRules(),r=s.getDiagLevelDiagnosticRules();for(const s of n)t[s]&&(e[s]=!0);for(const n of r){const s=t[n],r=e[n];("error"===s||"warning"===s&&"error"!==r)&&(e[n]=s)}}function i(e,t){const n=["pyright:","mspython:"].find(t=>e.startsWith(t));if(n){const s=e.substr(n.length).trim().split(",").map(e=>e.trim());s.some(e=>"strict"===e)&&r(t);for(const e of s)t=o(e,t)}return t}function o(e,t){const n=e.split("=").map(e=>e.trim());if(2!==n.length)return t;const r=n[0],i=s.getBooleanDiagnosticRules();if(s.getDiagLevelDiagnosticRules().find(e=>e===r)){const e=function(e){if("false"===e||"none"===e)return"none";if("warning"===e)return"warning";if("true"===e||"error"===e)return"error";return}(n[1]);void 0!==e&&(t[r]=e)}else if(i.find(e=>e===r)){const e=function(e){if("false"===e)return!1;if("true"===e)return!0;return}(n[1]);void 0!==e&&(t[r]=e)}return t}t.getFileLevelDirectives=function(e,t,n){let o=s.cloneDiagnosticRuleSet(t);n&&r(o);for(let t=0;t<e.count;t++){const n=e.getItemAt(t);if(n.comments)for(const e of n.comments){o=i(e.value.trim(),o)}}return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(7),r=n(12);class i extends r.ParseTreeWalker{constructor(e){super(),this._parseTree=e}clean(){this.walk(this._parseTree)}visitNode(e){return s.cleanNodeAnalysisInfo(e),super.visitNode(e)}}t.ParseTreeCleanerWalker=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(12),r=n(1),i=n(0);class o extends s.ParseTreeWalker{constructor(){super()}visitNode(e){const t=super.visitNode(e);return this._verifyParentChildLinks(e,t),this._verifyChildRanges(e,t),t}_verifyParentChildLinks(e,t){t.forEach(t=>{t&&t.parent!==e&&r.fail(`Child node ${t.nodeType} does not `+`contain a reference to its parent ${e.nodeType}`)})}_verifyChildRanges(e,t){let n;t.forEach(t=>{if(t){let s=!1;3===e.nodeType&&t===e.typeAnnotationComment&&(s=!0),49===e.nodeType&&t===e.typeAnnotation&&(s=!0),s||((t.start<e.start||i.TextRange.getEnd(t)>i.TextRange.getEnd(e))&&r.fail(`Child node ${t.nodeType} is not `+`contained within its parent ${e.nodeType}`),n&&t.start<i.TextRange.getEnd(n)&&r.fail("Child node is not after previous child node"),n=t)}})}}t.TestWalker=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(3),r=n(1),i=n(21),o=n(4),a=n(20),c=n(0),l=n(0),p=n(22),u=n(57),d=n(7),h=n(37),f=n(8),g=n(62),y=n(61),m=n(30),_=n(14),T=n(23),v=n(119),b=n(16),E=n(17),C=n(55),k={0:["__add__","__radd__"],32:["__sub__","__rsub__"],25:["__mul__","__rmul__"],13:["__floordiv__","__rfloordiv__"],10:["__truediv__","__rtruediv__"],23:["__mod__","__rmod__"],28:["__pow__","__rpow__"],21:["__matmul__",""]},S={3:["__and__","__rand__"],6:["__or__","__ror__"],8:["__xor__","__rxor__"],17:["__lshift__","__rlshift__"],30:["__rshift__","__rrshift__"]},x={12:["__eq__","__ne__"],27:["__ne__","__eq__"],19:["__lt__","__gt__"],20:["__le__","__ge__"],15:["__gt__","__lt__"],16:["__ge__","__le__"]},w={35:!0,36:!0,38:!0,39:!0,40:!0,41:!0};t.createTypeEvaluator=function(e){const t=[],n=new Map,I=new Map,R=new Map,F=new Map,P=new Map,A=new v.SpeculativeTypeTracker;let N,D=!1;const O=[];let M;function L(e){let t;if(t=M&&$(e)?M.get(e.id):P.get(e.id),void 0!==t)return r.assert(!v.isIncompleteType(t)),t}function U(e,t){const n=M&&$(e)?M:P;n.set(e.id,t);const s=A.getSpeculativeRootNode();s&&f.isNodeContainedWithin(e,s)&&A.trackEntry(n,e.id)}function $(e){const t=O.length;if(0===t)return!1;const n=O[t-1];let s=e;for(;s;){if(s===n.functionNode)return!0;s=s.parent}return!1}function q(e,n){return t.findIndex(t=>t.symbolId===e.id&&t.declaration===n)}function W(e,n){const s=q(e,n);if(s>=0){for(let e=s+1;e<t.length;e++)t[e].isResultValid=!1;return!1}return t.push({symbolId:e.id,declaration:n,isResultValid:!0}),!0}function V(e){const n=t.pop();return r.assert(n.symbolId===e.id),n.isResultValid}function B(e,n,s){const r=q(e,n);r>=0&&(t[r].partialType=s)}function j(e,n){const s=q(e,n);if(s>=0)return t[s].partialType}function z(e){if(!d.isCodeUnreachable(e))return tt(e),L(e)}function H(e,t,n=0){const o=L(e);if(o)return{type:o,node:e};let a;switch(N&&s.throwIfCancellationRequested(N),e.nodeType){case 39:a=function(e,t){const n=Tt(e),s=e.value;let r;const i=gt(e,s);if(i){const o=i.symbol,a=kt(o);let c=!(!!a&&7===a.category&&b.ClassType.isSpecialBuiltIn(a));if(4&t&&(c=!1),4===i.scope.type&&(c=!1),n.isStubFile){const e=T.getLastTypedDeclaredForSymbol(i.symbol);e&&4===e.type&&(c=!1)}if(r=a,c){const t=i.isBeyondExecutionScope||!o.isInitiallyUnbound()?a:b.UnboundType.create(),n=ot(e,o.id,t);n&&(r=n)}if(!(2&t))if(7===r.category)r.typeArguments||(r=ut(r,void 0,t,e));else if(8===r.category){const e=ye(r);e&&(r=e)}b.isUnbound(r)?ce(n.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${s}" is unbound`,e):b.isPossiblyUnbound(r)&&ce(n.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${s}" is possibly unbound`,e),de(n,o,e)}else"reveal_type"!==s&&ce(n.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${s}" is not defined`,e),r=b.UnknownType.create();return{type:r,node:e}}(e,n);break;case 36:a=function(e,t){const n=H(e.leftExpression,void 0,2),s=ge(e,n,{method:"get"},t);if(h.isCodeFlowSupportedForReference(e)){U(e,s.type),U(e.memberName,s.type);const t=ot(e,m.indeterminateSymbolId,s.type);t&&(s.type=t)}return U(e.memberName,s.type),s}(e,n);break;case 24:a=function(e,t,n=0){const s=H(e.baseExpression,void 0,2|n);return _e(e,s.type,{method:"get",expectedType:t},n)}(e,t,n);break;case 9:a=function(e,t,n){const s=H(e.leftExpression,void 0,2);if(39===e.leftExpression.nodeType&&"super"===e.leftExpression.value)return{type:ve(e),node:e};if(b.isAnyOrUnknown(s.type)&&39===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value&&1===e.arguments.length&&0===e.arguments[0].argumentCategory&&void 0===e.arguments[0].name){const t=H(e.arguments[0].valueExpression).type;return oe(`Type of "${f.printExpression(e.arguments[0].valueExpression)}" is "${Bt(t)}"`,e.arguments[0]),{type:b.AnyType.create(),node:e}}const r=e.arguments.map(e=>({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name}));return be(e,r,s,t,-3&n)}(e,t,n);break;case 53:a=function(e,t){const n=[];if(t&&8===t.category){const s=t.classType;if(b.ClassType.isBuiltIn(s,"Tuple")&&s.typeArguments)if(2===s.typeArguments.length&&E.isEllipsisType(s.typeArguments[1]))for(let t=0;t<e.expressions.length;t++)n.push(s.typeArguments[0]);else s.typeArguments.forEach(e=>{n.push(e)})}const s=e.expressions.map((e,t)=>H(e,t<n.length?n[t]:void 0));let r=b.UnknownType.create();const i=ht(e,"Tuple");if(7===i.category){let e=[];for(const t of s)if(t.unpackedType){if(8!==t.unpackedType.category||!b.ClassType.isBuiltIn(t.unpackedType.classType,"Tuple")){e=[b.AnyType.create(!1),b.AnyType.create(!0)];break}{const n=t.unpackedType.classType.typeArguments;if(!n||n.some(e=>2===e.category&&e.isEllipsis)){e=[b.AnyType.create(!1),b.AnyType.create(!0)];break}for(const t of n)e.push(t)}}else e.push(t.type);r=E.convertClassToObject(b.ClassType.cloneForSpecialization(i,e))}return{type:r,node:e}}(e,t);break;case 11:a=function(e){let t;24===e.constType?t=b.NoneType.create():31!==e.constType&&14!==e.constType&&8!==e.constType||(t=ft(e,"bool"),t&&8===t.category&&(31===e.constType?t=b.ObjectType.cloneWithLiteral(t,!0):14===e.constType&&(t=b.ObjectType.cloneWithLiteral(t,!1))));if(!t)return;return{type:t,node:e}}(e);break;case 49:{const t=0!=(16&n)&&!function(e){if(e.parent&&25===e.parent.nodeType){const t=e.parent;if(t.parent&&24===t.parent.nodeType){const e=H(t.parent.baseExpression).type;if(e&&7===e.category&&b.ClassType.isSpecialBuiltIn(e,"Literal"))return!0}}return!1}(e);if(t)if(e.typeAnnotation)a=H(e.typeAnnotation,void 0,4|n);else if(!e.typeAnnotation&&1===e.strings.length){const t=function(e){const t=Tt(e),n=new u.Parser,s=e.strings[0].value,r=e.strings[0].start+e.strings[0].token.prefixLength+e.strings[0].token.quoteMarkLength,i=new u.ParseOptions;i.isStubFile=t.isStubFile,i.pythonVersion=t.executionEnvironment.pythonVersion;const o=n.parseTextExpression(t.fileContents,r,s.length,i,!0);if(o.parseTree)return o.diagnostics.forEach(t=>{ae(t.message,e)}),o.parseTree.parent=e,o.parseTree;return}(e);t&&(a=H(t,void 0,4|n))}if(t){if(!a){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues","Expected type but received a string literal",e),a={node:e,type:b.UnknownType.create()}}}else{e.strings.forEach(e=>{28===e.nodeType&&e.expressions.forEach(e=>{H(e)})});const t=0!=(32&e.strings[0].token.flags);a=e.strings.some(e=>28===e.nodeType)?{node:e,type:ft(e,t?"bytes":"str")}:{node:e,type:Oe(e,t?"bytes":"str",e.strings.map(e=>e.value).join(""))}}break}case 41:{let t="float";e.isImaginary?t="complex":e.isInteger&&(t="int"),a={node:e,type:Oe(e,t,e.value)};break}case 18:if(0!=(1&n))a={type:b.AnyType.create(!0),node:e};else{a={type:ht(e,"ellipsis")||b.AnyType.create(),node:e}}break;case 56:a=function(e){let t=H(e.expression).type;11===t.category&&(t=E.specializeType(t,void 0));const n={0:"__pos__",32:"__neg__",5:"__invert__"};let s;37!==e.operator&&E.isOptionalType(t)&&(ce(Tt(e).diagnosticRuleSet.reportOptionalOperand,"reportOptionalOperand",`Operator "${f.printOperator(e.operator)}" not supported for "None" type`,e.expression),t=b.removeNoneFromUnion(t));if(37===e.operator)s=ft(e,"bool"),s||(s=b.UnknownType.create());else{if(b.isAnyOrUnknown(t))s=t;else{const r=n[e.operator];s=Ae(t,[],r,e)}if(!s){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Operator "${f.printOperator(e.operator)}" not supported for type "${Bt(t)}"`,e),s=b.UnknownType.create()}}return{type:s,node:e}}(e);break;case 7:a=function(e){let t=e.leftExpression;x[e.operator]&&7===e.leftExpression.nodeType&&x[e.leftExpression.operator]&&(t=e.leftExpression.rightExpression);let n=H(t).type;11===n.category&&(n=E.specializeType(n,void 0));let s=H(e.rightExpression).type;11===s.category&&(s=E.specializeType(s,void 0));void 0===w[e.operator]&&(E.isOptionalType(n)&&(12!==e.operator&&27!==e.operator&&ce(Tt(e).diagnosticRuleSet.reportOptionalOperand,"reportOptionalOperand",`Operator "${f.printOperator(e.operator)}" not supported for "None" type`,e.leftExpression),n=b.removeNoneFromUnion(n)),12!==e.operator&&27!==e.operator||(s=b.removeNoneFromUnion(s)));return{type:Pe(e.operator,n,s,e),node:e}}(e);break;case 5:{const t=Fe(e);ue(e.destExpression,t,e.rightExpression),a={type:t,node:e};break}case 32:a=function(e,t){const n=e=>{if(8!==e.category)return;const t=e.classType.details.aliasClass||e.classType;return b.ClassType.isBuiltIn(t,"list")&&e.classType.typeArguments?e.classType.typeArguments[0]:void 0},s=t?n(t):void 0;let r=e.entries.map(e=>33===e.nodeType?De(e):H(e,s).type);if(t&&r.length>0){const s=E.doForSubtypes(t,e=>{const t=n(e);if(t){const n=new C.TypeVarMap;for(const e of r)if(!Dt(t,e,new i.DiagnosticAddendum,n))return;return E.specializeType(e,n)}});if(4!==s.category)return{type:s,node:e}}r=r.map(e=>E.stripLiteralValue(e));let o=b.AnyType.create();r.length>0&&(o=t||Tt(e).diagnosticRuleSet.strictListInference?b.combineTypes(r):E.areTypesSame(r)?r[0]:b.UnknownType.create());return{type:ft(e,"list",[o]),node:e}}(e,t);break;case 47:a=function(e){e.startValue&&H(e.startValue);e.endValue&&H(e.endValue);e.stepValue&&H(e.stepValue);return{type:ft(e,"slice"),node:e}}(e);break;case 6:a=H(e.expression,void 0,n),a={type:Z(a.type,e.expression),node:e};break;case 52:a=function(e,t){H(e.testExpression);const n=H(e.ifExpression,void 0,t),s=H(e.elseExpression,void 0,t);return{type:b.combineTypes([n.type,s.type]),node:e}}(e,n);break;case 33:a=function(e){const t=De(e);let n=b.UnknownType.create();const s=se(e,"Generator");s&&7===s.category&&(n=b.ObjectType.create(b.ClassType.cloneForSpecialization(s,[t])));return{type:n,node:e}}(e);break;case 15:a=function(e,t){let n,s,o,a=b.AnyType.create(),c=b.AnyType.create(),l=[],p=[];if(t&&8===t.category){const e=t.classType;b.ClassType.isBuiltIn(e,"Dict")||b.ClassType.isBuiltIn(e,"dict")?e.typeArguments&&2===e.typeArguments.length&&(n=E.specializeType(e.typeArguments[0],void 0),s=E.specializeType(e.typeArguments[1],void 0)):b.ClassType.isTypedDictClass(e)&&(o=Ut(e))}if(e.entries.forEach(e=>{let t=!0;if(17===e.nodeType){const r=H(e.keyExpression,n).type;let i;i=o&&8===r.category&&b.ClassType.isBuiltIn(r.classType,"str")&&r.literalValue&&o.has(r.literalValue)?H(e.valueExpression,o.get(r.literalValue).valueType).type:H(e.valueExpression,s).type,l.push(r),p.push(i),t=!1}else if(16===e.nodeType){const n=H(e.expandExpression).type;if(b.isAnyOrUnknown(n))t=!1;else if(8===n.category){const e=n.classType,s=e.details.aliasClass||e;if(b.ClassType.isBuiltIn(s,"dict")){const n=e.typeArguments;n&&n.length>=2&&(l.push(n[0]),p.push(n[1]),t=!1)}}}else if(33===e.nodeType){const n=De(e);if(8===n.category){const e=n.classType;if(b.ClassType.isBuiltIn(e,"Tuple")){const n=e.typeArguments;n&&2===n.length&&(l.push(n[0]),p.push(n[1]),t=!1)}}}t&&(l.push(b.UnknownType.create()),p.push(b.UnknownType.create()))}),t){const n=E.doForSubtypes(t,e=>{if(8!==e.category)return;if(b.ClassType.isTypedDictClass(e.classType)&&function(e,t,n){r.assert(b.ClassType.isTypedDictClass(e)),r.assert(t.length===n.length);let s=!0;const o=Ut(e),a=new i.DiagnosticAddendum;if(t.forEach((e,t)=>{if(8===e.category&&b.ClassType.isBuiltIn(e.classType,"str")&&e.literalValue){const r=e.literalValue,i=o.get(r);i?(Dt(i.valueType,n[t],a)||(s=!1),i.isProvided=!0):s=!1}else s=!1}),!s)return!1;return o.forEach(e=>{e.isRequired&&!e.isProvided&&(s=!1)}),s}(e.classType,l,p))return e;const t=e.classType.details.aliasClass||e.classType;if(b.ClassType.isBuiltIn(t,"dict")&&e.classType.typeArguments){const t=e.classType.typeArguments[0],n=e.classType.typeArguments[1],s=new C.TypeVarMap;for(const e of l)if(!Dt(t,e,new i.DiagnosticAddendum,s))return;for(const e of p)if(!Dt(n,e,new i.DiagnosticAddendum,s))return;return E.specializeType(e,s)}});if(4!==n.category)return{type:n,node:e}}l=l.map(e=>E.stripLiteralValue(e)),p=p.map(e=>E.stripLiteralValue(e)),a=l.length>0?b.combineTypes(l):b.AnyType.create(),c=p.length>0?Tt(e).diagnosticRuleSet.strictDictionaryInference?b.combineTypes(p):E.areTypesSame(p)?p[0]:b.UnknownType.create():b.AnyType.create();return{type:ft(e,"dict",[a,c]),node:e}}(e,t);break;case 31:a=function(e,t){const n=b.FunctionType.create(0);let s;U(e,n),t&&(5===t.category?s=t:10===t.category&&(s=t.subtypes.find(e=>5===e.category)));return e.parameters.forEach((e,t)=>{let r=b.UnknownType.create();s&&t<s.details.parameters.length&&(r=b.FunctionType.getEffectiveParameterType(s,t),r=E.specializeType(r,void 0,!0)),e.name&&U(e.name,r);const i={category:e.category,name:e.name?e.name.value:void 0,hasDefault:!!e.defaultValue,type:r};b.FunctionType.addParameter(n,i)}),n.inferredReturnType=H(e.expression).type,{type:n,node:e}}(e,t);break;case 46:a=function(e,t){const n=e.entries.map(e=>33===e.nodeType?De(e):H(e).type);if(t&&n.length>0){const s=E.doForSubtypes(t,e=>{if(8===e.category){const t=e.classType.details.aliasClass||e.classType;if(b.ClassType.isBuiltIn(t,"set")&&e.classType.typeArguments){const t=e.classType.typeArguments[0],s=new C.TypeVarMap;for(const e of n)if(!Dt(t,e,new i.DiagnosticAddendum,s))return;return E.specializeType(e,s)}}});if(4!==s.category)return{type:s,node:e}}const s=n.length>0?b.combineTypes(n.map(e=>E.stripLiteralValue(e))):b.AnyType.create();return{type:ft(e,"set",[s]),node:e}}(e,t);break;case 3:a=H(e.rightExpression),ue(e.leftExpression,a.type,e.rightExpression);break;case 4:a=H(e.rightExpression),ue(e.name,a.type,e.rightExpression);break;case 61:a=function(e){let t;const n=f.getEnclosingFunction(e);if(n){const e=Be(n);e&&(t=E.getDeclaredGeneratorSendType(e.functionType))}t||(t=b.UnknownType.create());e.expression&&H(e.expression,t);return{type:t,node:e}}(e);break;case 62:a=function(e){let t;const n=f.getEnclosingFunction(e);if(n){const e=Be(n);e&&(t=E.getDeclaredGeneratorSendType(e.functionType))}t||(t=b.UnknownType.create());e.expression&&H(e.expression,t);return{type:t,node:e}}(e);break;case 57:{const n=H(e.expression,t).type;a={type:ee(n,!1,e,!1),unpackedType:n,node:e};break}case 55:a=H(e.typeAnnotation,void 0,16);break;case 0:yt(()=>{e.child&&H(e.child)}),a={type:b.UnknownType.create(),node:e}}return a||(r.fail(`Unhandled expression type '${f.printExpression(e)}'`),a={type:b.UnknownType.create(),node:e}),U(e,a.type),a}function G(e,t=!0){const n=Tt(e);if(n.isTypingStubFile){const t=function(e){if(!e.parent||55!==e.parent.nodeType)return;if(39!==e.parent.valueExpression.nodeType)return;const t=e.parent.valueExpression.value,n={Tuple:{alias:"tuple",module:"builtins"},Generic:{alias:"",module:"builtins"},Protocol:{alias:"",module:"builtins"},Callable:{alias:"",module:"builtins"},Type:{alias:"type",module:"builtins"},ClassVar:{alias:"",module:"builtins"},Final:{alias:"",module:"builtins"},Literal:{alias:"",module:"builtins"},TypedDict:{alias:"_TypedDict",module:"self"}}[t];if(n)return Ue(e,t,n);return}(e);if(t)return U(e,t),t}let s=17;return(void 0!==n.futureImports.get("annotations")||n.isStubFile)&&(s|=4),t||(s|=32),E.convertClassToObject(H(e,void 0,s).type)}function K(e,t){let n=H(e.leftExpression,void 0,2);if(e.arguments){const t=e.arguments.map(e=>({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name}));n=be(e.leftExpression,t,n,void 0,8)}const s=[{argumentCategory:0,type:t}];return be(e.leftExpression,s,n,void 0,8).type}function Y(e,t,n,s,r,i=0,o){const a=me(e,t.classType,n,s,r,i);let c=a?a.type:void 0;return c&&(5!==c.category&&6!==c.category||a.isClassMember&&(c=$t(o||t,c,!!o))),c}function Q(e,t,n,s,r,i=0){const o=me(e,t,n,s,r,1|i);let a=o?o.type:void 0;return a&&(5!==a.category&&6!==a.category||o.isClassMember&&(a=$t(t,a))),a}function X(e,t,n){const s=e.details.aliasClass;s&&(e=s);const r=E.lookUpClassMember(e,t,12);if(r){const t=Rt(r);if(5===t.category||6===t.category){const s=$t(b.ObjectType.create(e),t,n);if(5===s.category||6===s.category)return s}}}function J(e){let t,n;switch(e.nodeType){case 39:{const n=gt(e,e.value);n&&(t=n.symbol);break}case 55:return J(e.valueExpression);case 36:{const s=H(e.leftExpression).type;let r;8===s.category?(r=E.lookUpObjectMember(s,e.memberName.value,16),n=s):7===s.category&&(r=E.lookUpClassMember(s,e.memberName.value,24),n=s),r&&(t=r.symbol);break}case 24:{const t=J(e.baseExpression);if(t&&8===t.category){const e=E.lookUpClassMember(t.classType,"__setitem__");if(e){const n=Rt(e);if(5===n.category){const e=$t(t,n);if(5===e.category&&2===e.details.parameters.length)return b.FunctionType.getEffectiveParameterType(e,1)}}}break}}if(t){let e=St(t);if(e){if(E.isProperty(e)){const t=E.lookUpClassMember(e.classType,"fset"),n=t?Rt(t):void 0;if(!n||5!==n.category||n.details.parameters.length<2)return;e=n.details.parameters[1].type}return n&&(e=$t(n,e)),e}}}function Z(e,t){return E.doForSubtypes(e,e=>{if(b.isAnyOrUnknown(e))return e;const n=he(e);if(n)return n;if(8===e.category){const t=fe(e,"__await__");if(t){if(b.isAnyOrUnknown(t))return t;if(8===t.category){if(fe(t,"__iter__")){const e=he(t);if(e)return e}}}}if(t){ce(Tt(t).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${Bt(e)}" is not awaitable`,t)}return b.UnknownType.create()})}function ee(e,t,n,s){const r=t?"__aiter__":"__iter__",o=t?"__anext__":"__next__",a=s?"__getitem__":"";11===e.category&&(e=E.specializeType(e,void 0)),10===e.category&&e.subtypes.some(e=>b.isNoneOrNever(e))&&(n&&ce(Tt(n).diagnosticRuleSet.reportOptionalIterable,"reportOptionalIterable",'Object of type "None" cannot be used as iterable value',n),e=b.removeNoneFromUnion(e));const c=(e,s,i)=>{const c=s?function(e,t,n){const s=E.lookUpObjectMember(b.ObjectType.create(e),n,8);if(!s)return;const r=Rt(s);if(b.isAnyOrUnknown(r))return r;if(5===r.category){return xt($t(t,r,!0))}return}(s,e.classType,r):fe(e,r);if(c){if(b.isAnyOrUnknown(c))return c;if(8===c.category){const e=fe(c,o);if(e)return t?Z(e,n):e;i.addMessage(`"${o}" method not defined on type "${Bt(c)}"`)}else i.addMessage(`"${r}" method does not return an object`)}else{if(a){const t=fe(e,a);if(t)return t}i.addMessage(`"${r}" method not defined`)}};return E.doForSubtypes(e,e=>{if(b.isAnyOrUnknown(e))return e;const t=new i.DiagnosticAddendum;if(b.isAnyOrUnknown(e))return e;if(8===e.category){const n=c(e,void 0,t);if(n)return n}else if(7===e.category){const n=E.getMetaclass(e);if(n&&7===n.category){const s=c(b.ObjectType.create(e),n,t);if(s)return s}}return n&&ae(`"${Bt(e)}" is not iterable`+t.getString(),n),b.UnknownType.create()})}function te(e,t,n){r.assert(b.ClassType.isDataClass(t));const s=b.FunctionType.create(65),i=b.FunctionType.create(64);b.FunctionType.addParameter(s,{category:0,name:"cls",type:t}),E.addDefaultFunctionParameters(s),s.details.declaredReturnType=b.ObjectType.create(t),b.FunctionType.addParameter(i,{category:0,name:"self",type:b.ObjectType.create(t)}),i.details.declaredReturnType=b.NoneType.create();const o=[],a=[];!function(e,t){for(let n=e.details.mro.length-1;n>=0;n--){const s=e.details.mro[n];if(7===s.category){b.ClassType.getDataClassEntries(s).forEach(e=>{const n=t.findIndex(t=>t.name===e.name);n>=0?t[n]=e:t.push(e)})}}}(t,a);const c=[];if(e.suite.statements.forEach(e=>{48===e.nodeType&&e.statements.forEach(e=>{let t,n,s=!1;if(3===e.nodeType?(39===e.leftExpression.nodeType?(t=e.leftExpression,n=()=>E.stripLiteralValue(H(e.rightExpression).type)):55===e.leftExpression.nodeType&&39===e.leftExpression.valueExpression.nodeType&&(t=e.leftExpression.valueExpression,n=()=>G(e.leftExpression.typeAnnotation)),s=!0):55===e.nodeType&&39===e.valueExpression.nodeType&&(t=e.valueExpression,n=()=>G(e.typeAnnotation)),t&&n){const e=t.value,r={name:e,hasDefault:s,type:b.UnknownType.create()};c.push({entry:r,evaluator:n});let i=o.findIndex(t=>t.name===e);i>=0?o[i]=r:o.push(r),i=a.findIndex(t=>t.name===e),i>=0?a[i]=r:(a.push(r),i=a.length-1);const l=a.findIndex(e=>e.hasDefault);!s&&l>=0&&l<i&&ae("Data fields without default value cannot appear after data fields with default values",t)}})}),t.details.dataClassEntries=o,c.forEach(e=>{e.entry.type=e.evaluator()}),!n){a.forEach(e=>{const t={category:0,name:e.name,hasDefault:e.hasDefault,hasDeclaredType:!0,type:e.type};b.FunctionType.addParameter(i,t)});const e=t.details.fields;e.set("__init__",m.Symbol.createWithType(4,i)),e.set("__new__",m.Symbol.createWithType(4,s))}}function ne(e,t){r.assert(b.ClassType.isTypedDictClass(t));const n=b.FunctionType.create(65);b.FunctionType.addParameter(n,{category:0,name:"cls",type:t}),E.addDefaultFunctionParameters(n),n.details.declaredReturnType=b.ObjectType.create(t);const s=b.FunctionType.create(64);b.FunctionType.addParameter(s,{category:0,name:"self",type:b.ObjectType.create(t)}),s.details.declaredReturnType=b.NoneType.create(),b.FunctionType.addParameter(s,{category:1,type:b.AnyType.create()});const o=Ut(t);o.forEach((e,t)=>{b.FunctionType.addParameter(s,{category:0,name:t,hasDefault:!e.isRequired,type:e.valueType})});const a=t.details.fields;a.set("__init__",m.Symbol.createWithType(4,s)),a.set("__new__",m.Symbol.createWithType(4,n));const c=ht(e,"str");if(7===c.category){const n=[];if(o.forEach((e,s)=>{const r=b.FunctionType.create(320);b.FunctionType.addParameter(r,{category:0,name:"self",type:b.ObjectType.create(t)}),b.FunctionType.addParameter(r,{category:0,name:"k",hasDeclaredType:!0,type:b.ObjectType.cloneWithLiteral(b.ObjectType.create(c),s)}),b.FunctionType.addParameter(r,{category:0,name:"default",hasDeclaredType:!0,type:e.valueType,hasDefault:!0}),r.details.declaredReturnType=e.valueType,n.push(r)}),n.length>0){const t=ht(e,"Mapping");if(7===t.category){const s=me(e,t,"get",{method:"get"},new i.DiagnosticAddendum,2);s&&6===s.type.category&&n.push(s.type.overloads[s.type.overloads.length-1])}const s=b.OverloadedFunctionType.create();s.overloads=n,a.set("get",m.Symbol.createWithType(4,s))}}}function se(t,n){const s=Tt(t).typingModulePath;if(!s)return;const r=e(s);if(!r)return;const i=r.symbolTable.get(n);return i?kt(i):void 0}function re(e){const t=d.getFlowNode(e);return!t||ct(t)}function ie(e){const t=d.getAfterFlowNode(e);return!!t&&ct(t)}function oe(e,t){if(!D&&!_t(t)){return Tt(t).diagnosticSink.addWarningWithTextRange(e,t)}}function ae(e,t){if(!D&&!_t(t)){return Tt(t).diagnosticSink.addErrorWithTextRange(e,t)}}function ce(e,t,n,s){let r;return"error"===e?r=ae(n,s):"warning"===e&&(r=oe(n,s)),r&&r.setRule(t),r}function le(e,t,n){const s=e.value,o=gt(e,s);if(!o)return void r.fail(`Missing symbol '${s}'`);const a=o.symbol.getDeclarations(),c=St(o.symbol),l=Tt(e);let p=t;if(c&&n){const s=new i.DiagnosticAddendum;Dt(c,t,s)?p=Mt(c,t):(ce(l.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Expression of type "${Bt(t)}" cannot be assigned to declared type "${Bt(c)}"`+s.getString(),n||e),p=c)}else{if(p=E.stripLiteralTypeArgsValue(p),2===g.getScopeForNode(e).type){const t=_.isConstantName(s),n=_.isPrivateOrProtectedName(s);t||n&&"none"!==Tt(e).diagnosticRuleSet.reportPrivateUsage||(p=E.stripLiteralValue(p))}}const u=a.find(e=>1===e.type);u&&1===u.type&&n&&u.isConstant&&e!==a[0].node&&ce(l.diagnosticRuleSet.reportConstantRedefinition,"reportConstantRedefinition",`"${s}" is constant and cannot be redefined`,e),U(e,p)}function pe(e,t,n,s){const o=e.memberName.value,a=Tt(e),c=f.getEnclosingClass(e);if(!c)return;let l=t;const p=We(c);if(p&&7===p.classType.category){let c=E.lookUpClassMember(p.classType,o,n?0:8);const u=p.classType.details.fields;if(c){if(7===c.classType.category&&b.ClassType.isSameGenericClass(p.classType,c.classType)&&c.isInstanceMember===n){const t=u.get(o);r.assert(void 0!==t);const n=t.getDeclarations();let i=T.isFinalVariable(t);if(n.length>0&&1===n[0].type&&s&&e.memberName!==n[0].node){n[0].isConstant&&ce(a.diagnosticRuleSet.reportConstantRedefinition,"reportConstantRedefinition",`"${e.memberName.value}" is constant and cannot be redefined`,e.memberName);const t=f.getEnclosingFunction(e);t&&"__init__"===t.name.value&&(i=!1),i&&ae(`"${e.memberName.value}" is declared as Final and cannot be reassigned`,e.memberName)}}else{const s=St(c.symbol);if(s&&!E.isProperty(s)&&!c.isInstanceMember&&n){de(a,c.symbol,e.memberName);const n=Rt(c);t=b.combineTypes([t,n])}}}if(c=E.lookUpClassMember(p.classType,o,16),c){const e=St(c.symbol);if(e&&!b.isAnyOrUnknown(e))if(5===e.category);else if(E.isProperty(e));else{Dt(e,t,new i.DiagnosticAddendum)&&(l=Mt(l,t))}}else s&&Ne(a.diagnosticRuleSet.reportUnknownMemberType,"reportUnknownMemberType",e.memberName,t,e)}}function ue(e,t,n){switch(e.nodeType){case 39:if("__all__"===e.value&&n){const t=g.getScopeForNode(e);if(3===t.type&&32===n.nodeType){const s=Tt(e);n.entries.forEach(n=>{if(49===n.nodeType||50===n.nodeType){const r=50===n.nodeType?n.value:n.strings.map(e=>e.value).join(""),i=t.lookUpSymbolRecursive(r);i&&de(s,i.symbol,e)}})}}Ne(Tt(e).diagnosticRuleSet.reportUnknownVariableType,"reportUnknownVariableType",e,t,e),le(e,t,n);break;case 36:!function(e,t,n){const s=H(e.leftExpression);if(39===e.leftExpression.nodeType){const r=f.getEnclosingClass(e);if(r){const i=We(r);i&&7===i.classType.category&&(8===s.type.category?b.ClassType.isSameGenericClass(s.type.classType,i.classType)&&pe(e,t,!0,n):7===s.type.category&&b.ClassType.isSameGenericClass(s.type,i.classType)&&pe(e,t,!1,n),b.ClassType.isProtocolClass(i.classType)&&ae("Assignment to instance or class variables not allowed within a Protocol class",e.memberName))}}ge(e,s,{method:"set",setType:t,setErrorNode:n},0),U(e.memberName,t),U(e,t)}(e,t,n);break;case 24:{const s=H(e.baseExpression,void 0,2),r=_e(e,s.type,{method:"set",setType:t,setErrorNode:n},0);U(e,r.type);break}case 53:!function(e,t,n){const s=new Array(e.expressions.length);for(let t=0;t<e.expressions.length;t++)s[t]=[];E.doForSubtypes(t,t=>{const r=E.getSpecializedTupleType(t);if(r&&r.typeArguments){const t=r.typeArguments;let n=t.length;const i=n>1&&E.isEllipsisType(t[n-1]);if(i&&n--,e.expressions.length>0&&57===e.expressions[e.expressions.length-1].nodeType)if(n>=e.expressions.length){for(let r=0;r<e.expressions.length-1;r++){const e=r<n?t[r]:b.UnknownType.create();s[r].push(e)}const r=[];for(let s=e.expressions.length-1;s<n;s++){const e=t[s];r.push(e)}s[e.expressions.length-1].push(b.combineTypes(r))}else{ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Tuple size mismatch: expected at least ${e.expressions.length} entries but got ${n}`,e)}else if(e.expressions.length===n||i)for(let r=0;r<e.expressions.length;r++){const e=r<n?t[r]:t[n-1];s[r].push(e)}else{ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Tuple size mismatch: expected ${e.expressions.length} but got ${n}`,e)}}else{const r=ee(t,!1,n,!1);for(let t=0;t<e.expressions.length;t++)s[t].push(r)}}),e.expressions.forEach((e,t)=>{const r=s[t];ue(e,0===r.length?b.UnknownType.create():b.combineTypes(r),n)}),U(e,t)}(e,t,n);break;case 55:{const s=G(e.typeAnnotation);Dt(s,t,new i.DiagnosticAddendum)&&(t=Mt(s,t)),ue(e.valueExpression,t,n);break}case 57:if(39===e.expression.nodeType){if(!b.isAnyOrUnknown(t)){const n=ht(e,"List");t=7===n.category?b.ObjectType.create(b.ClassType.cloneForSpecialization(n,[t])):b.UnknownType.create()}le(e.expression,t)}break;case 32:{const s=ee(t,!1,n,!1);e.entries.forEach(e=>{ue(e,s,n)});break}case 0:yt(()=>{e.child&&H(e.child)});break;default:ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues","Expression cannot be assignment target",e);break}}function de(e,t,n){_t(n)||e.accessedSymbolMap.set(t.id,!0)}function he(e){if(b.isAnyOrUnknown(e))return e;if(8===e.category){const t=e.classType;if(b.ClassType.isBuiltIn(t,"Generator")){const e=t.typeArguments;if(e&&e.length>=3)return e[2]}}}function fe(e,t){const n=E.lookUpObjectMember(e,t,8);if(!n)return;const s=Rt(n);if(b.isAnyOrUnknown(s))return s;if(5===s.category){return xt($t(e,s))}}function ge(e,t,n,s){const r=t.type,o=e.memberName.value,a=new i.DiagnosticAddendum;let c;switch(r.category){case 2:case 1:c=r;break;case 7:c=Q(e.memberName,r,e.memberName.value,n,a);break;case 11:return ge(e,{type:E.specializeType(r,void 0),node:e},n,0);case 8:{const i=ye(r);if(i)return ge(e,{type:i,node:t.node},n,s);c=Y(e.memberName,r,e.memberName.value,n,a,0);break}case 9:{const t=b.ModuleType.getField(r,o);if(t)"get"===n.method&&de(Tt(e),t,e.memberName),c=kt(t),0===c.category&&(c=b.UnknownType.create());else{ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${o}" is not a known member of module`,e.memberName),c=b.UnknownType.create()}break}case 10:c=E.doForSubtypes(r,t=>{if(b.isNoneOrNever(t))ce(Tt(e).diagnosticRuleSet.reportOptionalMemberAccess,"reportOptionalMemberAccess",`"${o}" is not a known member of "None"`,e.memberName);else if(0!==t.category){return ge(e,{type:t,node:e},n,0).type}});break;case 5:case 6:c=b.UnknownType.create();break;default:a.addMessage(`Unsupported type "${Bt(r)}"`)}if(!c){let t="access";"set"===n.method?t="assign":"del"===n.method&&(t="delete"),ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Cannot ${t} member "${o}" for type "${Bt(r)}"`+a.getString(),e.memberName),c=b.UnknownType.create()}return 0==(2&s)&&(7!==c.category||c.typeArguments||(c=ut(c,void 0,s,e))),{type:c,node:e}}function ye(e){const t=e.classType;if(b.ClassType.isBuiltIn(t,"Type")){const e=t.typeArguments;if(e&&e.length>0){let t=e[0];if(11===t.category&&(t=E.getConcreteTypeFromTypeVar(t)),8===t.category)return t.classType}return b.AnyType.create()}}function me(e,t,n,s,o,a){t.details.aliasClass&&(t=t.details.aliasClass);let c=0;1&a&&(c|=8),2&a&&(c|=2),4&a&&(c|=4);let l=E.lookUpClassMember(t,n,16|c);if(l||(l=E.lookUpClassMember(t,n,c)),l){let r;if(r="get"===s.method?Rt(l):St(l.symbol)||b.UnknownType.create(),b.ClassType.isTypedDictClass(t)){const e=l.symbol.getTypedDeclarations();if(e.length>0&&1===e[0].type)return void o.addMessage(`Member "${n}" is unknown`)}if("get"===s.method&&l.classType===t&&de(Tt(e),l.symbol,e),!(16&a)&&8===r.category){let i;i="get"===s.method?"__get__":"set"===s.method?"__set__":"__delete__";const c=r.classType,p=E.lookUpClassMember(c,i,8);if(b.ClassType.isPropertyClass(r.classType))if("set"===s.method){if(!p)return void o.addMessage(`Property "${n}" has no defined setter`)}else if("del"===s.method&&!p)return void o.addMessage(`Property "${n}" has no defined deleter`);if(p){let n=Rt(p);if(6===n.category){const s=[{argumentCategory:0,type:b.ObjectType.create(c)},{argumentCategory:0,type:1&a?b.NoneType.create():b.ObjectType.create(t)},{argumentCategory:0,type:b.AnyType.create()}],r=Ee(e,s,n);r&&(n=r)}if(5===n.category)if(n=$t(b.ObjectType.create(t),n),"get"===s.method)r=xt(n),r=E.partiallySpecializeType(r,t);else{if("set"===s.method&&n.details.parameters.length>=2){if(!Dt(n.details.parameters[1].type,s.setType,o))return}r=b.AnyType.create()}return{type:r,isClassMember:!l.isInstanceMember}}}if("set"===s.method){let i=!1;if(l.symbol.hasTypedDeclarations()?i=!0:l.symbol.getDeclarations().some(t=>t.node===e)||(i=!0),i){let e=r;if(0==(1&a)&&(l.isInstanceMember||5!==r.category||(b.FunctionType.isClassMethod(r)||b.FunctionType.isInstanceMethod(r))&&(e=E.stripFirstParameter(r))),!Dt(e,s.setType,o.createAddendum()))return void o.addMessage(`Expression of type "${Bt(s.setType)}" cannot be assigned to member "${n}" of class "${Wt(t)}"`)}}return{type:r,isClassMember:!l.isInstanceMember}}if(!(8&a))if("get"===s.method){const n=Q(e,t,"__getattribute__",{method:"get"},new i.DiagnosticAddendum,29);if(n&&5===n.category)return{type:xt(n),isClassMember:!1};const s=Q(e,t,"__getattr__",{method:"get"},new i.DiagnosticAddendum,25);if(s&&5===s.category)return{type:xt(s),isClassMember:!1}}else if("set"===s.method){if(Q(e,t,"__setattr__",{method:"get"},new i.DiagnosticAddendum,29))return{type:b.AnyType.create(),isClassMember:!1}}else{if(r.assert("del"===s.method),Q(e,t,"__detattr__",{method:"get"},new i.DiagnosticAddendum,29))return{type:b.AnyType.create(),isClassMember:!1}}o.addMessage(`Member "${n}" is unknown`)}function _e(e,t,n,s){if(10===t.category||5===t.category){const n=[];let r=!0;if(E.doForSubtypes(t,e=>{7===e.category||11===e.category||5===e.category||3===e.category?E.addTypeVarsToListIfUnique(n,E.getTypeVarArgumentsRecursive(e)):r=!1}),r&&n.length>0){const r=Te(e.items,s).map(e=>E.convertClassToObject(e.type));r.length>n.length&&ae(`Too many type arguments provided; expected ${n.length} but got ${r.length}`,e.items);const o=new C.TypeVarMap,a=new i.DiagnosticAddendum;return n.forEach((e,t)=>{t<r.length&&Nt(e,r[t],!1,a,o)}),a.getMessageCount()>0&&ae(`Could not specialize type "${Bt(t)}"`+a.getString(),e.items),{type:E.specializeType(t,o),node:e}}}const o=E.doForSubtypes(t,t=>{if(11===t.category&&(t=E.specializeType(t,void 0)),b.isAnyOrUnknown(t))return t;if(7===t.category){if("set"===n.method?ae("Generic class type cannot be assigned",e.baseExpression):"del"===n.method&&ae("Generic class type cannot be deleted",e.baseExpression),b.ClassType.isSpecialBuiltIn(t,"Literal"))return function(e){if(0===e.items.items.length)return ae('Expected one or more type arguments after "Literal"',e.baseExpression),b.UnknownType.create();const t=[];for(const n of e.items.items){let s;if(49===n.nodeType){const t=0!=(32&n.strings[0].token.flags),r=n.strings.map(e=>e.value).join("");s=Oe(e,t?"bytes":"str",r)}else 41===n.nodeType?!n.isImaginary&&n.isInteger&&(s=Oe(e,"int",n.value)):11===n.nodeType&&(31===n.constType?s=Oe(e,"bool",!0):14===n.constType?s=Oe(e,"bool",!1):24===n.constType&&(s=b.NoneType.create()));s||(ae('Type arguments for "Literal" must be None, int, bool, str, or bytes value',n),s=b.UnknownType.create()),t.push(s)}return E.convertClassToObject(b.combineTypes(t))}(e);if(b.ClassType.isBuiltIn(t,"InitVar")){const t=Te(e.items,s);return 1===t.length?t[0].type:(ae(`Expected one type argument for "InitVar" but got ${t.length}`,e.baseExpression),b.UnknownType.create())}if(b.ClassType.isEnumClass(t))return b.ObjectType.create(t);return ut(t,Te(e.items,s),s,e)}if(8===t.category)return function(e,t,n){if(b.ClassType.isTypedDictClass(t.classType)){if(1!==e.items.items.length)return ae("Expected one type argument",e),b.UnknownType.create();const s=Ut(t.classType),r=H(e.items.items[0]).type,o=new i.DiagnosticAddendum,a=E.doForSubtypes(r,r=>{if(b.isAnyOrUnknown(r))return r;if(8===r.category&&b.ClassType.isBuiltIn(r.classType,"str")){if(!r.literalValue)return b.UnknownType.create();const i=r.literalValue,a=s.get(i);if(!a)return o.addMessage(`"${i}" is not a defined key in "${Bt(t)}"`),b.UnknownType.create();if("set"===n.method)Dt(a.valueType,n.setType,o);else if("del"===n.method&&a.isRequired){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${i}" is a required key and cannot be deleted`,e)}return a.valueType}return o.addMessage(`"${Bt(r)}" is not a string literal`),b.UnknownType.create()});if(o.getMessageCount()>0){let t="access";"set"===n.method?t="assign":"del"===n.method&&(t="delete"),ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Could not ${t} item in TypedDict`+o.getString(),e)}return a}let s;"get"===n.method?s="__getitem__":"set"===n.method?s="__setitem__":(r.assert("del"===n.method),s="__delitem__");const o=Y(e,t,s,{method:"get"},new i.DiagnosticAddendum,25);if(!o){return ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Object of type "${Bt(t)}" does not define "${s}"`,e.baseExpression),b.UnknownType.create()}const a=e.items.items.map(e=>H(e).type);let c;if(1===a.length){c=a[0];const n=t.classType;if(7===n.category&&b.ClassType.isBuiltIn(n,"Tuple")&&n.typeArguments&&41===e.items.items[0].nodeType&&e.items.items[0].isInteger&&!e.items.items[0].isImaginary){const t=e.items.items[0];if(t.isInteger&&t.value>=0&&t.value<n.typeArguments.length)return n.typeArguments[t.value]}}else{const t=ht(e,"Tuple");c=7===t.category?E.convertClassToObject(b.ClassType.cloneForSpecialization(t,a)):b.UnknownType.create()}const l=[{argumentCategory:0,type:c}];"set"===n.method&&l.push({argumentCategory:0,type:n.setType||b.AnyType.create()});return Se(e,l,o,new C.TypeVarMap,!1).returnType||b.UnknownType.create()}(e,t,n);if(b.isNoneOrNever(t))return ce(Tt(e).diagnosticRuleSet.reportOptionalSubscript,"reportOptionalSubscript",'Object of type "None" cannot be subscripted',e.baseExpression),b.UnknownType.create();if(!b.isUnbound(t)){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Object of type "${Bt(t)}" cannot be subscripted`,e.baseExpression)}return b.UnknownType.create()});return e.items.items.forEach(e=>{H(e)}),{type:o,node:e}}function Te(e,t){const n=[];return e.items.forEach(e=>{n.push(function(e,t){let n;n=32===e.nodeType?{type:b.UnknownType.create(),typeList:e.entries.map(e=>H(e,void 0,t)),node:e}:H(e,void 0,49|t);return n}(e,t))}),n}function ve(e){let t,n;if(e.arguments.length>2&&ae('Expecting no more than two arguments to "super" call',e.arguments[2]),e.arguments.length>0)t=H(e.arguments[0].valueExpression).type,b.isAnyOrUnknown(t)||7===t.category||ae(`Expected class type as first argument to "super" call but received "${Bt(t)}"`,e.arguments[0].valueExpression);else{const n=f.getEnclosingClass(e);if(n){const e=We(n);t=e?e.classType:b.UnknownType.create()}else ae('Zero-argument form of "super" call is valid only within a class',e.leftExpression),t=b.UnknownType.create()}if(e.arguments.length>1){n=H(e.arguments[1].valueExpression).type;let s=!1;if(b.isAnyOrUnknown(n));else if(8===n.category){const e=n.classType;7===t.category&&(E.derivesFromClassRecursive(e,t)||(s=!0))}else 7===n.category?7===t.category&&(E.derivesFromClassRecursive(n,t)||(s=!0)):s=!0;if(s){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Second argument to "super" call must be object or class that derives from "${Bt(t)}"`,e.arguments[1].valueExpression)}}const s=e.parent;if(36===s.nodeType){const e=s.memberName.value,n=E.lookUpClassMember(t,e,1);if(n&&7===n.classType.category)return b.ObjectType.create(n.classType)}if(7===t.category){const e=t.details.baseClasses;if(e.length>0){const t=e[0];if(7===t.category)return b.ObjectType.create(t)}}return b.UnknownType.create()}function be(e,t,n,s,a){let c,p=n.type;const u=0!=(8&a);switch(11===p.category&&(p=E.specializeType(p,void 0)),p.category){case 7:if(b.ClassType.isBuiltIn(p)){const n=p.details.name;if("type"===n){if(1===t.length){const e=dt(t[0]);8===e.category&&(c=e.classType)}else t.length>=2&&(c=function(e,t){const n=dt(t[0]);if(8!==n.category||!b.ClassType.isBuiltIn(n.classType,"str"))return void ae("Expected name of type as first argument",t[0].valueExpression||e);const s=n.literalValue||"_",r=dt(t[1]);if(8!==r.category||!b.ClassType.isBuiltIn(r.classType,"Tuple")||void 0===r.classType.typeArguments)return void ae("Expected tuple of base class types as second argument",t[1].valueExpression||e);const i=b.ClassType.create(s,0,e.id);r.classType.typeArguments.forEach(n=>{7===n.category||b.isAnyOrUnknown(n)?i.details.baseClasses.push(n):ae(`Expected class type but received "${Bt(n)}"`,t[1].valueExpression||e)}),E.computeMroLinearization(i)||ae("Cannot create consistent method ordering",e);return i}(e,t));c||(c=b.AnyType.create())}else if("TypeVar"===n)c=function(e,t){let n="";if(0===t.length)return void ae("Expected name of TypeVar as first parameter",e);const s=t[0];s.valueExpression&&49===s.valueExpression.nodeType?n=s.valueExpression.strings.map(e=>e.value).join(""):ae("Expected name of TypeVar as first parameter",s.valueExpression||e);const r=b.TypeVarType.create(n);for(let n=1;n<t.length;n++){const s=t[n].name,i=s?s.value:void 0,o=new Map;if(i){if(o.get(i)&&ae(`Duplicate parameter name "${i}" not allowed`,t[n].valueExpression||e),"bound"===i)if(r.constraints.length>0)ae("A TypeVar cannot be both bound and constrained",t[n].valueExpression||e);else{const s=dt(t[n],!0);E.requiresSpecialization(s)&&ae("A TypeVar bound type cannot be generic",t[n].valueExpression||e),r.boundType=E.convertClassToObject(s)}else"covariant"===i?t[n].valueExpression&&Ie(t[n].valueExpression)&&(r.isContravariant?ae("A TypeVar cannot be both covariant and contravariant",t[n].valueExpression):r.isCovariant=!0):"contravariant"===i?t[n].valueExpression&&Ie(t[n].valueExpression)&&(r.isContravariant?ae("A TypeVar cannot be both covariant and contravariant",t[n].valueExpression):r.isContravariant=!0):ae(`"${i}" is unknown parameter to TypeVar`,t[n].valueExpression||e);o.set(i,i)}else if(r.boundType)ae("A TypeVar cannot be both bound and constrained",t[n].valueExpression||e);else{const s=dt(t[n],!0);E.requiresSpecialization(s)&&ae("A TypeVar constraint type cannot be generic",t[n].valueExpression||e),b.TypeVarType.addConstraint(r,E.convertClassToObject(s))}}return r}(e,t);else if("NamedTuple"===n)c=Re(e,t,!0);else if("Protocol"===n||"Generic"===n||"Callable"===n||"Type"===n){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${n}" cannot be instantiated directly`,e)}else"Enum"===n||"IntEnum"===n||"Flag"===n||"IntFlag"===n?c=function(e,t,n){let s="enum";if(0===n.length)ae("Expected enum class name as first parameter",e);else{const t=n[0];0!==t.argumentCategory?ae("Expected enum class name as first parameter",n[0].valueExpression||e):t.valueExpression&&49===t.valueExpression.nodeType&&(s=t.valueExpression.strings.map(e=>e.value).join(""))}const i=b.ClassType.create(s,64,e.id);i.details.baseClasses.push(t),E.computeMroLinearization(i);const a=i.details.fields;if(a.set("__class__",m.Symbol.createWithType(36,i)),n.length<2)ae("Expected enum item string as second parameter",e);else{const t=n[1];if(0===t.argumentCategory&&t.valueExpression&&49===t.valueExpression.nodeType){t.valueExpression.strings.map(e=>e.value).join("").split(" ").forEach(n=>{if(n=n.trim()){const s=b.UnknownType.create(),i=m.Symbol.createWithType(4,s),c=t.valueExpression;r.assert(49===c.nodeType);const p={type:1,node:c,path:Tt(e).filePath,range:o.convertOffsetsToRange(c.start,l.TextRange.getEnd(c),Tt(e).lines)};i.addDeclaration(p),a.set(n,i)}})}else ae("Expected enum item string as second parameter",e)}return i}(e,p,t):"TypedDict"===n?c=function(e,t,n){let s="TypedDict";if(0===n.length)ae("Expected TypedDict class name as first parameter",e);else{const t=n[0];0===t.argumentCategory&&t.valueExpression&&49===t.valueExpression.nodeType?s=t.valueExpression.strings.map(e=>e.value).join(""):ae("Expected TypedDict class name as first parameter",n[0].valueExpression||e)}const r=b.ClassType.create(s,16,e.id);r.details.baseClasses.push(t),E.computeMroLinearization(r),n.length>=3&&(!n[2].name||"total"!==n[2].name.value||!n[2].valueExpression||11!==n[2].valueExpression.nodeType||14!==n[2].valueExpression.constType&&31!==n[2].valueExpression.constType?ae('Expected "total" parameter to have a value of "True" or "False"',n[2].valueExpression||e):14===n[2].valueExpression.constType&&(r.details.flags|=32));n.length>3&&ae("Extra TypedDict arguments not supported",n[3].valueExpression||e);const i=r.details.fields;if(i.set("__class__",m.Symbol.createWithType(36,r)),n.length<2)ae("Expected dict as second parameter",e);else{const t=n[1];if(0===t.argumentCategory&&t.valueExpression&&15===t.valueExpression.nodeType){const n=t.valueExpression,s=new Map;n.entries.forEach(t=>{if(17!==t.nodeType)return void ae("Expected simple dictionary entry",t);if(49!==t.keyExpression.nodeType)return void ae("Expected string literal for entry name",t.keyExpression);const n=t.keyExpression.strings.map(e=>e.value).join("");if(!n)return void ae("Names within a TypedDict cannot be empty",t.keyExpression);if(s.get(n))return void ae("Names within a named tuple must be unique",t.keyExpression);s.set(n,!0),G(t.valueExpression);const r=new m.Symbol(8),a={type:1,node:t.keyExpression,path:Tt(e).filePath,typeAnnotationNode:t.valueExpression,range:o.convertOffsetsToRange(t.keyExpression.start,l.TextRange.getEnd(t.keyExpression),Tt(e).lines)};r.addDeclaration(a),i.set(n,r)})}else ae("Expected dict as second parameter",e)}return ne(e,r),r}(e,p,t):"auto"===n&&0===t.length&&(c=ft(e,"int"))}else if(b.ClassType.hasAbstractMethods(p)){const t=Lt(p),n=new i.DiagnosticAddendum,s=2;t.forEach((e,r)=>{if(r===s)n.addMessage(`and ${t.length-s} more...`);else if(r<s&&7===e.classType.category){const t=e.classType.details.name;n.addMessage(`"${t}.${e.symbolName}" is abstract`)}}),ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Cannot instantiate abstract class "${p.details.name}"`+n.getString(),e)}c||(c=Ce(e,t,p,u,s).returnType);break;case 5:if("namedtuple"===p.details.builtInName)ce(Tt(e).diagnosticRuleSet.reportUntypedNamedTuple,"reportUntypedNamedTuple",'"namedtuple" provides no types for tuple entries; use "NamedTuple" instead',e),c=Re(e,t,!1);else if("NewType"===p.details.builtInName){const n=Se(e,t,p,new C.TypeVarMap,u);c=n.argumentErrors?n.returnType:function(e,t){let n="_";if(t.length>=1){const e=t[0];0===e.argumentCategory&&e.valueExpression&&49===e.valueExpression.nodeType&&(n=e.valueExpression.strings.map(e=>e.value).join(""))}if(t.length>=2){const s=dt(t[1],!0);if(7===s.category){const t=-4&s.details.flags,r=b.ClassType.create(n,t,e.id);return r.details.baseClasses.push(s),E.computeMroLinearization(r),r}}return}(e,t)}else c=Se(e,t,p,new C.TypeVarMap,u).returnType,"__import__"===p.details.builtInName&&(c=b.AnyType.create());c||(c=b.UnknownType.create());break;case 6:{const n=Ee(e,t,p);if(n)if("cast"===n.details.builtInName&&2===t.length){const n=dt(t[0],!0),s=dt(t[1]);7===n.category&&8===s.category&&b.isTypeSame(n,s.classType)&&ce(Tt(e).diagnosticRuleSet.reportUnnecessaryCast,"reportUnnecessaryCast",`Unnecessary "cast" call; type is already ${Bt(s)}`,e),c=E.convertClassToObject(n)}else c=Se(e,t,n,new C.TypeVarMap,u).returnType,c||(c=b.UnknownType.create());else{const n=f.printExpression(e),s=new i.DiagnosticAddendum,r=t.map(e=>Bt(dt(e)));s.addMessage(`Argument types: (${r.join(", ")})`),ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`No overloads for "${n}" match parameters`+s.getString(),e),c=b.UnknownType.create()}break}case 8:{const n=ye(p);if(n)b.isAnyOrUnknown(n)?c=n:7===n.category&&(c=Ce(e,t,n,u,s).returnType);else{const n=Y(e,p,"__call__",{method:"get"},new i.DiagnosticAddendum,25);n&&(c=Se(e,t,n,new C.TypeVarMap,u).returnType,c||(c=b.UnknownType.create()))}break}case 10:{const r=[];p.subtypes.forEach(i=>{if(b.isNoneOrNever(i))ce(Tt(e).diagnosticRuleSet.reportOptionalCall,"reportOptionalCall",'Object of type "None" cannot be called',e);else{const o=be(e,t,{type:i,node:n.node},s,a);o&&r.push(o.type)}}),r.length>0&&(c=b.combineTypes(r));break}case 2:case 1:t.forEach(e=>dt(e)),c=p}if(!c){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${f.printExpression(e)}" has type "${Bt(p)}" and is not callable`,e),c=b.UnknownType.create()}return 0==(2&a)&&7===c.category&&(c=ut(c,void 0,a,e)),{type:c,node:n.node}}function Ee(e,t,n){let s;for(const r of n.overloads)if(mt(e,()=>{Se(e,t,r,new C.TypeVarMap,!0,!1).argumentErrors||(s=r)}),s)break;return s}function Ce(e,t,n,s,r){let o,a=!1,c=!1;const l=e=>5===e.category&&b.FunctionType.isSkipConstructorCheck(e),p=Y(e,b.ObjectType.create(n),"__init__",{method:"get"},new i.DiagnosticAddendum,29);if(p&&!l(p)){const i=new C.TypeVarMap;if(Se(e,t,p,i,s).argumentErrors)c=!0;else{const e=ke(E.specializeType(n,i),r);o=b.ObjectType.create(e)}a=!0,s=!0}if(!c){const p=me(e,n,"__new__",{method:"get"},new i.DiagnosticAddendum,29);if(p&&!l(p.type)){const i=$t(n,p.type,!0),l=new C.TypeVarMap;if(Se(e,t,i,l,s).argumentErrors||(c=!0),!o){const e=ke(E.specializeType(n,l),r);o=b.ObjectType.create(e)}a=!0}}if(a||t.forEach(e=>{e.valueExpression&&H(e.valueExpression)}),!a&&t.length>0){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Expected no arguments to "${n.details.name}" constructor`,e)}else if(!o){const e=ke(n,r);o=b.ObjectType.create(e)}return{argumentErrors:c,returnType:o}}function ke(e,t){if(!t)return e;const n=b.removeNoneFromUnion(t);if(8!==n.category)return e;if(8!==n.category)return e;const s=n.classType,r=new C.TypeVarMap;if(Dt(s,e,new i.DiagnosticAddendum,r))return E.specializeType(s,r);if(b.ClassType.isSameGenericClass(e,s)&&s.typeArguments&&e.typeArguments&&s.typeArguments.length===e.typeArguments.length){let t=!0;if(s.typeArguments.forEach((n,s)=>{Dt(n,e.typeArguments[s],new i.DiagnosticAddendum,r)||(t=!1)}),t)return E.specializeType(s,r)}return e}function Se(e,t,n,s,r,o=!0){let a={argumentErrors:!1};switch(n.category){case 1:case 2:t.forEach(e=>dt(e)),a.returnType=n;break;case 5:a=xe(e,t,n,s,r,o);break;case 6:{const c=Ee(e,t,n);if(c)a=xe(e,t,c,s,r,o);else{const n=f.printExpression(e),s=new i.DiagnosticAddendum,r=t.map(e=>Bt(dt(e)));s.addMessage(`Argument types: (${r.join(", ")})`),ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`No overloads for "${n}" match parameters`+s.getString(),e)}break}case 7:if(b.ClassType.isSpecialBuiltIn(n)){ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${n.details.name}" cannot be instantiated`,e)}else a=Ce(e,t,n,r);break;case 8:{const c=Y(e,n,"__call__",{method:"get"},new i.DiagnosticAddendum,25);if(c&&5===c.category){a=Se(e,t,E.stripFirstParameter(c),s,r,o)}break}case 10:{const i=[];for(const a of n.subtypes)if(b.isNoneOrNever(a))ce(Tt(e).diagnosticRuleSet.reportOptionalCall,"reportOptionalCall",'Object of type "None" cannot be called',e);else{const n=Se(e,t,a,s,r,o);n.returnType&&i.push(n.returnType)}i.length>0&&(a.returnType=b.combineTypes(i));break}}return a}function xe(e,t,n,s,i,o=!0){let a=0;const c=n.details.parameters,l=c.find(e=>2===e.category);let p=!1;const u=new Map;c.forEach(e=>{e.name&&u.set(e.name,{argsNeeded:0!==e.category||e.hasDefault?0:1,argsReceived:0})});let d=c.findIndex(e=>1===e.category&&!e.name);const h=c.findIndex(e=>0===e.category&&!e.name);d<0&&(d=c.findIndex(e=>1===e.category),d>=0&&d++),d<0&&(d=c.findIndex(e=>2===e.category)),d<0&&(d=c.length);let f=t.findIndex(e=>2===e.argumentCategory||void 0!==e.name);f<0&&(f=t.length),h>=0&&f<h&&(f=Math.min(h,t.length));const g=[];let y;function m(e,t){e.active&&(y=t)}let _=0;for(;a<f;){if(_===h){_++;continue}if(a<h&&t[a].name){ce(Tt(t[a].name).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues","Expected positional argument",t[a].name)}if(_>=d){if(1!==t[a].argumentCategory){const n=d;ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Expected ${n} positional ${1===n?"argument":"arguments"}`,t[a].valueExpression||e),p=!0}break}const s=b.FunctionType.getEffectiveParameterType(n,_);if(1===t[a].argumentCategory){if(t[a].valueExpression){const n={argumentCategory:0,type:ee(dt(t[a]),!1,t[a].valueExpression,!1)};g.push({paramType:s,requiresTypeVarMatching:E.requiresSpecialization(s),argument:n,errorNode:t[a].valueExpression||e}),m(t[a],c[_])}break}if(1===c[_].category)g.push({paramType:s,requiresTypeVarMatching:E.requiresSpecialization(s),argument:t[a],errorNode:t[a].valueExpression||e,paramName:c[_].name}),m(t[a],c[_]),a++;else{g.push({paramType:s,requiresTypeVarMatching:E.requiresSpecialization(s),argument:t[a],errorNode:t[a].valueExpression||e,paramName:c[_].name}),m(t[a],c[_]);const n=c[_].name;n&&u.get(n).argsReceived++,a++,_++}}if(!p){let s=!1;const i=void 0!==t.find(e=>1===e.argumentCategory);for(;a<t.length;){if(2===t[a].argumentCategory)dt(t[a]),s=!0;else{const s=t[a].name;if(s){const i=s.value,o=u.get(i);if(o)if(o.argsReceived>0)ae(`Parameter "${i}" is already assigned`,s),p=!0;else{u.get(s.value).argsReceived++;const o=c.findIndex(e=>e.name===i);r.assert(o>=0);const l=b.FunctionType.getEffectiveParameterType(n,o);g.push({paramType:l,requiresTypeVarMatching:E.requiresSpecialization(l),argument:t[a],errorNode:t[a].valueExpression||e,paramName:i}),m(t[a],c[o])}else l?(g.push({paramType:l.type,requiresTypeVarMatching:E.requiresSpecialization(l.type),argument:t[a],errorNode:t[a].valueExpression||e,paramName:i}),m(t[a],l)):(ae(`No parameter named "${s.value}"`,s),p=!0)}}a++}if(!s&&!i&&!b.FunctionType.isDefaultParameterCheckDisabled(n)){const t=[...u.keys()].filter(e=>{const t=u.get(e);return t.argsReceived<t.argsNeeded});t.length>0&&(ae(`Argument missing for parameter${1===t.length?"":"s"} `+t.map(e=>`"${e}"`).join(", "),e),p=!0),c.forEach(t=>{if(0===t.category&&t.name){const n=u.get(t.name);0===n.argsNeeded&&0===n.argsReceived&&t.defaultType&&E.requiresSpecialization(t.type)&&g.push({paramType:t.type,requiresTypeVarMatching:!0,argument:{argumentCategory:0,type:t.defaultType},errorNode:e,paramName:t.name})}})}}["cast","isinstance","issubclass"].some(e=>e===n.details.builtInName)&&(i=!0);const T=g.filter(e=>e.requiresTypeVarMatching).length;if(T>0){const t=Math.min(T,2);for(let n=0;n<t;n++)mt(e,()=>{g.forEach(e=>{e.requiresTypeVarMatching&&we(e,s,i)})});s.lock()}g.forEach(e=>{we(e,s,i)||(p=!0)}),_t(void 0)||t.forEach(e=>{e.valueExpression&&(g.some(t=>t.argument===e)||H(e.valueExpression))});const v=xt(n,g,o&&!p),C=E.specializeType(v,s);return{argumentErrors:p,returnType:C,activeParam:y}}function we(e,t,n){let s;if(e.argument.valueExpression){let n=E.specializeType(e.paramType,t);1===n.category&&(n=void 0),s=H(e.argument.valueExpression,n).type,e.argument&&e.argument.name&&!_t(e.errorNode)&&U(e.argument.name,s)}else s=dt(e.argument);const r=new i.DiagnosticAddendum;if(!Dt(e.paramType,s,r.createAddendum(),t)){const t=e.paramName?`"${e.paramName}" `:"";return ce(Tt(e.errorNode).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Argument of type "${Bt(s)}" cannot be assigned to parameter ${t}of type "${Bt(e.paramType)}"`+r.getString(),e.errorNode),!1}if(!n){const t=b.removeUnboundFromUnion(s),n=Tt(e.errorNode);if(1===t.category)ce(n.diagnosticRuleSet.reportUnknownArgumentType,"reportUnknownArgumentType","Type of argument is unknown",e.errorNode);else if(E.containsUnknown(t,!0)&&!E.containsUnknown(e.paramType)&&7!==t.category){const s=new i.DiagnosticAddendum;s.addMessage(`Argument type is "${Bt(t)}"`),ce(n.diagnosticRuleSet.reportUnknownArgumentType,"reportUnknownArgumentType","Type of argument is partially unknown"+s.getString(),e.errorNode)}}return!0}function Ie(e){if(11===e.nodeType){if(14===e.constType)return!1;if(31===e.constType)return!0}return ae("Expected True or False",e),!1}function Re(e,t,n){let s="namedtuple";if(0===t.length)ae("Expected named tuple class name as first parameter",e);else{const n=t[0];0!==n.argumentCategory?ae("Expected named tuple class name as first parameter",t[0].valueExpression||e):n.valueExpression&&49===n.valueExpression.nodeType&&(s=n.valueExpression.strings.map(e=>e.value).join(""))}const r=b.ClassType.create(s,0,e.id),i=se(e,"NamedTuple")||b.UnknownType.create();r.details.baseClasses.push(i),E.computeMroLinearization(r);const a=r.details.fields;if(a.set("__class__",m.Symbol.createWithType(36,r)),7===ht(e,"Tuple").category){const s=b.FunctionType.create(65);s.details.declaredReturnType=b.ObjectType.create(r),f.isAssignmentToDefaultsFollowingNamedTuple(e)&&(s.details.flags|=32),b.FunctionType.addParameter(s,{category:0,name:"cls",type:r});const i={category:0,name:"self",type:b.ObjectType.create(r)};let c=!1;if(t.length<2)ae("Expected named tuple entry list as second parameter",e),c=!0;else{const r=t[1];if(0!==r.argumentCategory)c=!0;else if(!n&&r.valueExpression&&49===r.valueExpression.nodeType){r.valueExpression.strings.map(e=>e.value).join("").split(/[,\s]+/).forEach(t=>{if(t=t.trim()){const i=b.UnknownType.create(),c={category:0,name:t,hasDeclaredType:n,type:i};b.FunctionType.addParameter(s,c);const p=m.Symbol.createWithType(8,i),u=r.valueExpression,d={type:1,node:u,path:Tt(e).filePath,range:o.convertOffsetsToRange(u.start,l.TextRange.getEnd(u),Tt(e).lines)};p.addDeclaration(d),a.set(t,p)}})}else if(r.valueExpression&&32===r.valueExpression.nodeType){const t=r.valueExpression,i=new Map;t.entries.forEach((t,r)=>{let c,p,u,d="";if(n)if(53===t.nodeType&&2===t.expressions.length){u=t.expressions[0],c=t.expressions[1];const e=H(c,void 0,16);e&&(p=E.convertClassToObject(e.type))}else ae("Expected two-entry tuple specifying entry name and type",t);else u=t,p=b.UnknownType.create();u&&49===u.nodeType?(d=u.strings.map(e=>e.value).join(""),d||ae("Names within a named tuple cannot be empty",u)):ae("Expected string literal for entry name",u||t),d||(d=`_${r.toString()}`),i.has(d)&&ae("Names within a named tuple must be unique",u||t),i.set(d,d),p||(p=b.UnknownType.create());const h={category:0,name:d,hasDeclaredType:n,type:p};b.FunctionType.addParameter(s,h);const f=m.Symbol.createWithType(8,p);if(u&&49===u.nodeType){const t={type:1,node:u,path:Tt(e).filePath,typeAnnotationNode:c,range:o.convertOffsetsToRange(u.start,l.TextRange.getEnd(u),Tt(e).lines)};f.addDeclaration(t)}a.set(d,f)})}else c=!0}c&&E.addDefaultFunctionParameters(s);const p=b.FunctionType.create(192);b.FunctionType.addParameter(p,i),E.addDefaultFunctionParameters(p),p.details.declaredReturnType=b.NoneType.create(),a.set("__new__",m.Symbol.createWithType(4,s)),a.set("__init__",m.Symbol.createWithType(4,p));const u=b.FunctionType.create(64);u.details.declaredReturnType=ft(e,"list",[ft(e,"str")]),a.set("keys",m.Symbol.createWithType(8,u)),a.set("items",m.Symbol.createWithType(8,u));const d=b.FunctionType.create(64);if(d.details.declaredReturnType=ft(e,"int"),b.FunctionType.addParameter(d,i),a.set("__len__",m.Symbol.createWithType(4,d)),c){const t=b.FunctionType.create(64);t.details.declaredReturnType=b.AnyType.create(),b.FunctionType.addParameter(t,i),b.FunctionType.addParameter(t,{category:0,name:"name",type:ft(e,"str")}),a.set("__getattribute__",m.Symbol.createWithType(4,t))}}return r}function Fe(e){const t={1:["__iadd__",0],33:["__isub__",32],26:["__imul__",25],14:["__ifloordiv__",13],11:["__itruediv__",10],24:["__imod__",23],29:["__ipow__",28],22:["__imatmul__",21],4:["__iand__",3],7:["__ior__",6],9:["__ixor__",8],18:["__ilshift__",17],31:["__irshift__",30]};let n,s=H(e.leftExpression).type;11===s.category&&(s=E.specializeType(s,void 0));let r=H(e.rightExpression).type;if(11===r.category&&(r=E.specializeType(r,void 0)),n=E.doForSubtypes(s,n=>E.doForSubtypes(r,s=>{if(b.isAnyOrUnknown(n)||b.isAnyOrUnknown(s))return 1===n.category||1===s.category?b.UnknownType.create():b.AnyType.create();const r=t[e.operator][0];return Ae(n,[s],r,e)})),!n||4===n.category){n=Pe(t[e.operator][1],s,r,e)}return n}function Pe(e,t,n,s){let r;if(k[e]?r=E.doForSubtypes(t,t=>E.doForSubtypes(n,n=>{if(b.isAnyOrUnknown(t)||b.isAnyOrUnknown(n))return 1===t.category||1===n.category?b.UnknownType.create():b.AnyType.create();const r=k[e][0],i=Ae(t,[n],r,s);if(i)return i;const o=k[e][1];return Ae(n,[t],o,s)})):S[e]?r=E.doForSubtypes(t,t=>E.doForSubtypes(n,n=>{if(b.isAnyOrUnknown(t)||b.isAnyOrUnknown(n))return 1===t.category||1===n.category?b.UnknownType.create():b.AnyType.create();const r=S[e][0];return Ae(t,[n],r,s)})):x[e]?r=E.doForSubtypes(t,t=>E.doForSubtypes(n,n=>{if(b.isAnyOrUnknown(t)||b.isAnyOrUnknown(n))return 1===t.category||1===n.category?b.UnknownType.create():b.AnyType.create();const r=x[e][0],i=Ae(t,[n],r,s);if(i)return i;const o=x[e][1];return Ae(n,[t],o,s)})):w[e]&&(35===e?t=E.removeTruthinessFromType(t):36===e&&(t=E.removeFalsinessFromType(t)),r=E.doForSubtypes(t,t=>E.doForSubtypes(n,n=>35===e||36===e?b.combineTypes([t,n]):ft(s,"bool")))),!r||4===r.category){ce(Tt(s).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Operator "${f.printOperator(e)}" not supported for types "${Bt(t)}" and "${Bt(n)}"`,s),r=b.UnknownType.create()}return r}function Ae(e,t,n,s){let r=!0;const o=(e,o)=>{const a=Y(s,e,n,{method:"get"},new i.DiagnosticAddendum,25,o);if(a){const e=t.map(e=>({argumentCategory:0,type:e}));let n;return yt(()=>{n=Se(s,e,a,new C.TypeVarMap,!0)}),n.argumentErrors&&(r=!1),n.returnType}r=!1},a=E.doForSubtypes(e,e=>{if(b.isAnyOrUnknown(e))return e;if(8===e.category)return o(e);if(7===e.category){const t=E.getMetaclass(e);if(t&&7===t.category)return o(b.ObjectType.create(t),e)}else if(b.isNoneOrNever(e)){const e=ft(s,"object");if(8===e.category)return o(e)}r=!1});if(r)return a}function Ne(e,t,n,s,r){if("none"===e)return;const o=n.value,a=b.removeUnboundFromUnion(s);if(1===a.category)ce(e,t,`Type of "${o}" is unknown`,r);else if(E.containsUnknown(a)){const n=new i.DiagnosticAddendum;n.addMessage(`Type of "${o}" is "${Bt(a)}"`),ce(e,t,`Type of "${o}" is partially unknown`+n.getString(),r)}}function De(e){for(const t of e.comprehensions)if(34===t.nodeType){const e=ee(E.stripLiteralValue(H(t.iterableExpression).type),!!t.isAsync,t.iterableExpression,!1);ue(t.targetExpression,e,t.iterableExpression)}else r.assert(35===t.nodeType),_t(t.testExpression)||H(t.testExpression);let t=b.UnknownType.create();if(17===e.expression.nodeType){t=ft(e,"Tuple",[E.stripLiteralValue(H(e.expression.keyExpression).type),E.stripLiteralValue(H(e.expression.valueExpression).type)])}else 16===e.expression.nodeType?H(e.expression.expandExpression):p.isExpressionNode(e)&&(t=E.stripLiteralValue(H(e.expression).type));return t}function Oe(e,t,n){let s=ft(e,t);return 8===s.category&&(s=b.ObjectType.cloneWithLiteral(s,n)),s}function Me(e,t,n,s=!1){if(t&&(t.forEach((e,n)=>{E.isEllipsisType(e.type)&&(s?2===t.length&&1===n||ae('"..." allowed only as the second of two arguments',e.node):ae('"..." not allowed in this context',e.node),9===e.type.category&&ae("Module not allowed in this context",e.node))}),b.ClassType.isBuiltIn(e,"Tuple")&&1===t.length)){const e=t[0].type;8===e.category&&b.ClassType.isBuiltIn(e.classType,"Tuple")&&e.classType.typeArguments&&0===e.classType.typeArguments.length&&(t=[])}let r=t?t.map(e=>E.convertClassToObject(e.type)):[];if(void 0!==n)if(t&&r.length>n)ae(`Expected at most ${n} type ${1===n?"argument":"arguments"}`,t[n].node),r=r.slice(0,n);else if(r.length<n)for(;r.length<n;)r.push(b.UnknownType.create());return!t&&s&&(r.push(b.AnyType.create(!1)),r.push(b.AnyType.create(!0))),b.ClassType.cloneForSpecialization(e,r)}function Le(e,t){const n=f.getEnclosingClass(e,!0);if(n){const e=We(n);if(e&&b.ClassType.isEnumClass(e.classType)){if(b.ClassType.isBuiltIn(e.classType)){const n=e.classType.details.name;if(["Enum","IntEnum","Flag","IntFlag"].find(e=>e===n))return t}return b.ObjectType.create(e.classType)}}return t}function Ue(t,n,s){const r=b.ClassType.create(n,3,t.id),i=s.alias?s.alias:"object";let o;if("builtins"===s.module)o=ht(t,i);else if("collections"===s.module){const n=Tt(t);if(n.collectionsModulePath){const t=e(n.collectionsModulePath);if(t){const e=t.symbolTable.get(i);e&&(o=kt(e))}}}else if("self"===s.module){const e=gt(t,i);e&&(o=kt(e.symbol))}return o&&7===o.category&&7===r.category?(r.details.baseClasses.push(o),s.alias&&(r.details.aliasClass=o)):r.details.baseClasses.push(b.UnknownType.create()),E.computeMroLinearization(r),r}function $e(e){const t=Tt(e);if(L(e))return;let n=L(e.rightExpression);if(!n&&(t.isTypingStubFile&&(n=function(e){if(39!==e.leftExpression.nodeType)return;const t=e.leftExpression.value;if("Any"===t)return b.AnyType.create();const n={overload:{alias:"",module:"builtins"},TypeVar:{alias:"",module:"builtins"},_promote:{alias:"",module:"builtins"},no_type_check:{alias:"",module:"builtins"},NoReturn:{alias:"",module:"builtins"},Union:{alias:"",module:"builtins"},Optional:{alias:"",module:"builtins"},List:{alias:"list",module:"builtins"},Dict:{alias:"dict",module:"builtins"},DefaultDict:{alias:"defaultdict",module:"collections"},Set:{alias:"set",module:"builtins"},FrozenSet:{alias:"frozenset",module:"builtins"},Deque:{alias:"deque",module:"collections"},ChainMap:{alias:"ChainMap",module:"collections"}}[t];return n?Ue(e,t,n):void 0}(e),n&&U(e.rightExpression,n)),!n)){const s=J(e.leftExpression);let r=2;t.isStubFile&&(r|=1);let o=H(e.rightExpression,s,r).type;const a=y.evaluateStaticBoolExpression(e.rightExpression,t.executionEnvironment);if(void 0!==a){const t=ft(e,"bool");8===t.category&&(o=b.ObjectType.cloneWithLiteral(t,a))}if(s){Dt(s,o,new i.DiagnosticAddendum)&&(o=Mt(s,o))}n=o,39!==e.leftExpression.nodeType||e.typeAnnotationComment||(n=Le(e.leftExpression,n))}ue(e.leftExpression,n,e.rightExpression),U(e,n)}function qe(e){if(L(e))return;const t=Fe(e);ue(e.destExpression,t,e.rightExpression),U(e,t)}function We(e){let t=L(e.name),n=L(e);if(t)return{classType:t,decoratedType:n||b.UnknownType.create()};const s=g.getScopeForNode(e),r=Tt(e);let i=0;(4===s.type||r.isTypingStubFile||r.isBuiltInStubFile)&&(i|=1,"property"===e.name.value&&(i|=512)),t=b.ClassType.create(e.name.value,i,e.id,f.getDocString(e.suite.statements)),B(s.lookUpSymbol(e.name.value),d.getDeclaration(e),t),U(e,t),U(e.name,t);const o=[];let c,l=!1,p=0;e.arguments.forEach(e=>{if(e.name&&"metaclass"!==e.name.value){if("total"===e.name.value&&b.ClassType.isTypedDictClass(t)){const n=y.evaluateStaticBoolExpression(e.valueExpression,r.executionEnvironment);void 0===n?ae('Value for total parameter must be "True" or "False"',e.valueExpression):n||(t.details.flags|=32)}}else{let n=H(e.valueExpression).type;const s=!!e.name;if(s&&(l&&ae("Only one metaclass can be provided",e),l=!0),10===n.category&&(n=b.removeUnboundFromUnion(n)),b.isAnyOrUnknown(n)||0===n.category||(n=E.transformTypeObjectToClass(n),7!==n.category?(ce(r.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues","Argument to class must be a base class",e),n=b.UnknownType.create()):(b.ClassType.isBuiltIn(n,"Protocol")&&(!r.isStubFile&&r.executionEnvironment.pythonVersion<a.PythonVersion.V37&&ae('Use of "Protocol" requires Python 3.7 or newer',e.valueExpression),t.details.flags|=2048),b.ClassType.isBuiltIn(n,"property")&&(t.details.flags|=512),r.executionEnvironment.pythonVersion>=a.PythonVersion.V36&&b.ClassType.isBuiltIn(n,"NamedTuple")&&(t.details.flags|=4),b.ClassType.isBuiltIn(n,"TypedDict")||b.ClassType.isTypedDictClass(n)?t.details.flags|=16:b.ClassType.isTypedDictClass(t)&&!b.ClassType.isTypedDictClass(n)&&ae('All base classes for "TypedDict" classes must also be "TypedDict" classes',e),E.derivesFromClassRecursive(n,t)&&(ae("Class cannot derive from itself",e),n=b.UnknownType.create()))),(1===n.category||10===n.category&&n.subtypes.some(e=>1===e.category))&&ce(r.diagnosticRuleSet.reportUntypedBaseClass,"reportUntypedBaseClass","Base class type is unknown, obscuring type of derived class",e),s)7!==n.category&&1!==n.category||(t.details.metaClass=n,7===n.category&&(b.ClassType.isBuiltIn(n,"EnumMeta")?t.details.flags|=64:b.ClassType.isBuiltIn(n,"ABCMeta")&&(t.details.flags|=128)));else if(t.details.baseClasses.push(n),7===n.category&&(b.ClassType.isEnumClass(n)&&(t.details.flags|=64),b.ClassType.supportsAbstractMethods(n)&&(t.details.flags|=128),b.ClassType.isPropertyClass(n)&&(t.details.flags|=512),b.ClassType.isFinal(n))){ae(`Base class "${Wt(n)}" is marked final and cannot be subclassed`,e.valueExpression)}E.addTypeVarsToListIfUnique(o,E.getTypeVarArgumentsRecursive(n)),7===n.category&&b.ClassType.isBuiltIn(n,"Generic")&&(c?ae('Class cannot derive from "Generic" more than once',e.valueExpression):(c=[],E.addTypeVarsToListIfUnique(c,E.getTypeVarArgumentsRecursive(n)))),s||p++}}),0===p&&(b.ClassType.isBuiltIn(t,"object")||t.details.baseClasses.push(ht(e,"object"))),t.details.typeParameters=c||o,E.computeMroLinearization(t)||ae("Cannot create consistent method ordering",e.name);const u=g.getScopeForNode(e.suite);if(t.details.fields=u.symbolTable,b.ClassType.isTypedDictClass(t)&&ne(e,t),b.ClassType.supportsAbstractMethods(t)&&Lt(t).length>0&&(t.details.flags|=256),!r.isStubFile&&0===t.details.typeParameters.length){const e=t.details.fields.get("__init__");if(e){const n=e.getTypedDeclarations();if(1===n.length&&3===n[0].type){const e=n[0].node.parameters;if(e.length>1&&!e.some(e=>e.typeAnnotation)){const n=e.filter((e,t)=>t>0&&e.name&&0===e.category);n.length>0&&(t.details.flags|=4096,t.details.typeParameters=n.map(e=>b.TypeVarType.create(`__type_of_${e.name.value}`,!0)))}}}}n=t;let h=!1;for(let s=e.decorators.length-1;s>=0;s--){const i=e.decorators[s],o=Ve(n,t,i);1===o.category?h||(ce(r.diagnosticRuleSet.reportUntypedClassDecorator,"reportUntypedClassDecorator","Untyped class decorator obscures type of class; ignoring decorator",e.decorators[s].leftExpression),h=!0):n=o}if(b.ClassType.isDataClass(t)){let n=b.ClassType.isSkipSynthesizedInit(t);if(!n){const e=E.lookUpClassMember(t,"__init__",2);if(e){const t=Rt(e);5===t.category&&b.FunctionType.isSynthesizedMethod(t)||(n=!0)}}te(e,t,n)}return U(e.name,t),U(e,n),{classType:t,decoratedType:n}}function Ve(e,t,n){const s=H(n.leftExpression).type;if(6===s.category){const r=s.overloads;if(r.length>0&&"dataclass"===r[0].details.builtInName){let s=!1;return n.arguments&&n.arguments.forEach(e=>{if(e.name&&"init"===e.name.value&&e.valueExpression){const t=Tt(n);y.evaluateStaticBoolExpression(e.valueExpression,t.executionEnvironment)||(s=!0)}}),t.details.flags|=4,s&&(t.details.flags|=8),e}}else 5===s.category&&"final"===s.details.builtInName&&(t.details.flags|=1024);return K(n,e)}function Be(e){const t=Tt(e);let n=L(e.name),s=L(e);if(n)return{functionType:n,decoratedType:s||b.UnknownType.create()};const r=d.getDeclaration(e),o=f.getEnclosingClass(e,!0);let a;if(o){const e=We(o);if(!e)return;a=e.classType}let c=ze(e,!!o);r.isGenerator&&(c|=16),t.isStubFile&&(c|=2048),e.isAsync&&(c|=512),n=b.FunctionType.create(c,f.getDocString(e.suite.statements)),(t.isBuiltInStubFile||t.isTypingStubFile)&&(n.details.builtInName=e.name.value),n.details.declaration=r,B(g.getScopeForNode(e).lookUpSymbol(e.name.value),r,n),U(e,n),U(e.name,n);const l=a&&b.ClassType.isPseudoGenericClass(a)&&"__init__"===e.name.value;if(e.returnTypeAnnotation){const t=G(e.returnTypeAnnotation);n.details.declaredReturnType=t}const p=[];let u=0;if(e.parameters.forEach((s,r)=>{let o,c,d,h,f=!1;if(s.typeAnnotation?c=G(s.typeAnnotation,!1):l&&r>0&&0===s.category&&s.name&&(c=a.details.typeParameters[u],u++),c&&(s.defaultValue&&11===s.defaultValue.nodeType&&24===s.defaultValue.constType&&(f=!0,t.diagnosticRuleSet.strictParameterNoneValue||(c=b.combineTypes([c,b.NoneType.create()]))),d=E.specializeType(c,void 0)),s.defaultValue&&(h=H(s.defaultValue,c,1).type),c){if(s.defaultValue&&h&&d){const e=new i.DiagnosticAddendum;if(!Dt(d,h,e)){const n=ce(t.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Value of type "${Bt(h)}" cannot be assigned to parameter of type "${Bt(c)}"`+e.getString(),s.defaultValue);if(f&&s.typeAnnotation){const e={action:"pyright.addoptionalforparam",offsetOfTypeNode:s.typeAnnotation.start+1};n&&n.addAction(e)}}}o=c}const g={category:s.category,name:s.name?s.name.value:void 0,hasDefault:!!s.defaultValue,defaultType:h,hasDeclaredType:!!s.typeAnnotation,type:o||b.UnknownType.create()};if(b.FunctionType.addParameter(n,g),s.name){const t=function(e,t,n){switch(t){case 0:return n;case 1:{const t=se(e,"Tuple");return t&&7===t.category?b.ObjectType.create(b.ClassType.cloneForSpecialization(t,[n,b.AnyType.create(!0)])):b.UnknownType.create()}case 2:{const t=ht(e,"Dict"),s=ft(e,"str");return 7===t.category&&8===s.category?b.ObjectType.create(b.ClassType.cloneForSpecialization(t,[s,n])):b.UnknownType.create()}}}(e,s.category,g.type);p.push(t)}else p.push(g.type)}),a&&n.details.parameters.length>0&&!e.parameters[0].typeAnnotation){const e=je(n.details.flags,a);e&&(n.details.parameters[0].type=e,2!==e.category&&(n.details.parameters[0].isTypeInferred=!0),p[0]=e)}p.forEach((t,s)=>{const r=e.parameters[s].name;r&&(1===t.category&&(n.details.flags|=8192),U(r,t))}),s=e.isAsync?function(e,t){const n=b.FunctionType.clone(t);t.details.declaredReturnType&&(n.details.declaredReturnType=Ge(e,t.details.declaredReturnType));return n.details.flags|=1024,n}(e,n):n;let h=!1;for(let r=e.decorators.length-1;r>=0;r--){const i=e.decorators[r],o=He(s,n,i);1===o.category?h||(ce(t.diagnosticRuleSet.reportUntypedFunctionDecorator,"reportUntypedFunctionDecorator","Untyped function decorator obscures type of function; ignoring decorator",e.decorators[r].leftExpression),h=!0):s=o}return 5===s.category&&(s=function(e,t){const n=d.getDeclaration(e),s=gt(e,e.name.value);if(s){const e=s.symbol.getDeclarations();let r=e.findIndex(e=>e===n);if(r>0){const n=[t];for(;r>0;){const t=e[r-1];if(3!==t.type)break;const s=Be(t.node);if(!s)break;if(5===s.decoratedType.category){if(!b.FunctionType.isOverloaded(s.decoratedType))break;n.unshift(s.decoratedType)}else{if(6!==s.decoratedType.category)break;{const e=s.decoratedType.overloads[s.decoratedType.overloads.length-1];if(!b.FunctionType.isOverloaded(e))break;n.unshift(e)}}r--}if(n.length>1){const e=b.OverloadedFunctionType.create();return e.overloads=n,e}}}return t}(e,s)),U(e.name,n),U(e,s),{functionType:n,decoratedType:s}}function je(e,t){if(0==(4&e)&&t){if(b.ClassType.isProtocolClass(t))return b.AnyType.create();if(3&e)return E.selfSpecializeClassType(t,!0);if(0==(4&e)){const e=E.selfSpecializeClassType(t);return b.ObjectType.create(e)}}}function ze(e,t){let n=0;"__new__"===e.name.value&&t&&(n|=1);for(const s of e.decorators){const e=H(s.leftExpression,void 0,2).type;5===e.category?"abstractmethod"===e.details.builtInName?t&&(n|=8):"final"===e.details.builtInName&&(n|=4096):7===e.category&&(b.ClassType.isBuiltIn(e,"staticmethod")?t&&(n|=4):b.ClassType.isBuiltIn(e,"classmethod")&&t&&(n|=2))}return n}function He(e,t,n){const s=H(n.leftExpression,void 0,2).type;if(7===s.category&&b.ClassType.isSpecialBuiltIn(s,"overload")&&5===e.category)return e.details.flags|=256,e;const r=K(n,e);if(5===s.category){if("abstractmethod"===s.details.builtInName)return e;if(36===n.leftExpression.nodeType){const e=H(n.leftExpression.leftExpression).type;if(E.isProperty(e)){const s=n.leftExpression.memberName.value;if("setter"===s)return function(e,t){if(!E.isProperty(e))return e;const n=e.classType,s=b.ClassType.create(n.details.name,n.details.flags,n.details.typeSourceId);E.computeMroLinearization(s);const r=b.ObjectType.create(s),i=s.details.fields;n.details.fields.forEach((e,t)=>{e.isIgnoredForProtocolMatch()||i.set(t,e)});const o=m.Symbol.createWithType(4,t);i.set("fset",o);const a=b.FunctionType.create(64);a.details.parameters.push({category:0,name:"self",type:t.details.parameters.length>0?t.details.parameters[0].type:b.AnyType.create()}),a.details.parameters.push({category:0,name:"obj",type:r}),a.details.declaredReturnType=b.NoneType.create();let c=b.UnknownType.create();t.details.parameters.length>=2&&0===t.details.parameters[1].category&&t.details.parameters[1].name&&(c=t.details.parameters[1].type);a.details.parameters.push({category:0,name:"value",type:c});const l=m.Symbol.createWithType(4,a);return i.set("__set__",l),r}(e,t);if("deleter"===s)return function(e,t){if(!E.isProperty(e))return e;const n=e.classType,s=b.ClassType.create(n.details.name,n.details.flags,n.details.typeSourceId);E.computeMroLinearization(s);const r=b.ObjectType.create(s),i=s.details.fields;n.details.fields.forEach((e,t)=>{e.isIgnoredForProtocolMatch()||i.set(t,e)});const o=m.Symbol.createWithType(4,t);i.set("fdel",o);const a=b.FunctionType.create(64);a.details.parameters.push({category:0,name:"self",type:t.details.parameters.length>0?t.details.parameters[0].type:b.AnyType.create()}),a.details.parameters.push({category:0,name:"obj",type:r}),a.details.declaredReturnType=b.NoneType.create();const c=m.Symbol.createWithType(4,a);return i.set("__delete__",c),r}(e,t)}}}else if(7===s.category){if(b.ClassType.isBuiltIn(s))switch(s.details.name){case"classmethod":case"staticmethod":return e}if(b.ClassType.isPropertyClass(s)&&5===e.category)return function(e,t,n){const s=b.ClassType.create(e,512,n);E.computeMroLinearization(s);const r=b.ObjectType.create(s),i=s.details.fields,o=m.Symbol.createWithType(4,t);i.set("fget",o);const a=b.FunctionType.create(64);a.details.parameters.push({category:0,name:"self",type:t.details.parameters.length>0?t.details.parameters[0].type:b.AnyType.create()}),a.details.parameters.push({category:0,name:"obj",type:r}),a.details.declaredReturnType=t.details.declaredReturnType,a.details.declaration=t.details.declaration;const c=m.Symbol.createWithType(4,a);i.set("__get__",c);const l=b.FunctionType.create(64);l.details.parameters.push({category:0,name:"self",type:r}),l.details.parameters.push({category:0,name:"accessor",type:b.AnyType.create()}),l.details.declaredReturnType=r;const p=m.Symbol.createWithType(4,l);return i.set("getter",p),i.set("setter",p),i.set("deleter",p),r}(s.details.name,e,n.id)}return 5===e.category&&5===r.category&&b.FunctionType.isOverloaded(e)&&(r.details.flags|=256),r}function Ge(e,t){let n;if(8===t.category){const s=t.classType;if(b.ClassType.isBuiltIn(s))if("Generator"===s.details.name){const t=se(e,"AsyncGenerator");if(t&&7===t.category){const e=[],r=s.typeArguments;r&&r.length>0&&e.push(r[0]),r&&r.length>1&&e.push(r[1]),n=b.ObjectType.create(b.ClassType.cloneForSpecialization(t,e))}}else["AsyncGenerator","AsyncIterator","AsyncIterable"].some(e=>e===s.details.name)&&(n=t)}if(!n){const s=se(e,"Awaitable");n=s&&7===s.category?b.ObjectType.create(b.ClassType.cloneForSpecialization(s,[t])):b.UnknownType.create()}return n}function Ke(e,t){r.assert(!e.returnTypeAnnotation);let n=L(e.suite);if(n)return n;if(!I.has(e.id)){I.set(e.id,!0);const s=d.getDeclaration(e);if(s.yieldExpressions){const t=[];s.yieldExpressions.forEach(e=>{if(re(e))if(62==e.nodeType){const n=ee(H(e.expression).type,!1,e,!1);t.push(n||b.UnknownType.create())}else if(e.expression){const n=H(e.expression).type;t.push(n||b.UnknownType.create())}else t.push(b.NoneType.create())}),0===t.length&&t.push(b.NoneType.create()),n=b.combineTypes(t);const r=se(e,"Generator");n=r&&7===r.category?b.ObjectType.create(b.ClassType.cloneForSpecialization(r,[n])):b.UnknownType.create()}else{const r=!ie(e),i=ie(e.suite);if(Tt(e).isStubFile)n=b.UnknownType.create();else if(r)if(t)n=b.UnknownType.create();else{const t=se(e,"NoReturn");n=t&&7===t.category?b.ObjectType.create(t):b.UnknownType.create()}else{const e=[];s.returnExpressions&&s.returnExpressions.forEach(t=>{if(re(t))if(t.returnExpression){const n=H(t.returnExpression).type;e.push(n||b.UnknownType.create())}else e.push(b.NoneType.create())}),!r&&i&&e.push(b.NoneType.create()),n=b.combineTypes(e)}}n=b.removeUnboundFromUnion(n),U(e.suite,n),I.delete(e.id)}return n}function Ye(e){if(L(e))return;const t=ee(H(e.iterableExpression).type,!!e.isAsync,e.iterableExpression,!e.isAsync);ue(e.targetExpression,t,e.targetExpression),U(e,t)}function Qe(e){if(r.assert(void 0!==e.typeExpression),L(e))return;const t=H(e.typeExpression).type;function n(e,t){if(b.isAnyOrUnknown(e))return e;if(7===e.category)return b.ObjectType.create(e);if(8===e.category){const n=ee(e,!1,t,!1);return E.doForSubtypes(n,e=>{if(b.isAnyOrUnknown(e))return e;const t=E.transformTypeObjectToClass(e);return 7===t.category?b.ObjectType.create(t):b.UnknownType.create()})}return b.UnknownType.create()}const s=E.doForSubtypes(t,t=>{const s=E.getSpecializedTupleType(t);if(s&&s.typeArguments){const t=s.typeArguments.map(t=>n(t,e.typeExpression));return b.combineTypes(t)}return n(t,e.typeExpression)});e.name&&ue(e.name,s),U(e,s)}function Xe(e){if(L(e))return;let t=H(e.expression).type;const n=e.parent&&59===e.parent.nodeType&&!!e.parent.isAsync;if(E.isOptionalType(t)){ce(Tt(e).diagnosticRuleSet.reportOptionalContextManager,"reportOptionalContextManager",'Object of type "None" cannot be used with "with"',e.expression),t=b.removeNoneFromUnion(t)}const s=n?"__aenter__":"__enter__",r=E.doForSubtypes(t,t=>{if(11===t.category&&(t=E.specializeType(t,void 0)),b.isAnyOrUnknown(t))return t;const r=new i.DiagnosticAddendum;let o="";if(8===t.category){const i=Y(e.expression,t,s,{method:"get"},r,0);if(i){let t;return t=5===i.category?xt(i):b.UnknownType.create(),n&&(t=Z(t,e)),t}if(!n){Y(e.expression,t,"__aenter__",{method:"get"},r,0)&&(o='; did you mean "async with"?')}}return ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Object of type "${Bt(t)}" cannot be used with "with" because it does not implement ${s}`+o+r.getString(),e.expression),b.UnknownType.create()});e.target&&ue(e.target,r,e.target),U(e,r)}function Je(e){if(L(e))return;let t;if(t=e.alias?e.alias:e.module.nameParts[0],!t)return;let n=et(e,t.value)||b.UnknownType.create();const s=L(e);s&&9===s.category&&n&&b.isTypeSame(n,s)&&(n=s),le(t,n),U(e,n)}function Ze(t){if(L(t))return;const n=t.alias||t.name;let s=et(t,n.value);if(!s){const n=t.parent;r.assert(n&&22===n.nodeType),r.assert(!n.isWildcardImport);const i=d.getImportInfo(n.module);if(i&&i.isImportFound){const n=i.resolvedPaths[i.resolvedPaths.length-1],s=e(n);if(s){const e=Tt(t);(e.executionEnvironment.pythonVersion<a.PythonVersion.V37||!s.symbolTable.get("__getattr__"))&&ce(e.diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`"${t.name.value}" is unknown import symbol`,t.name)}}s=b.UnknownType.create()}le(n,s),U(t,s)}function et(e,t){const n=gt(e,t);if(!n)return;const s=n.symbol.getDeclarations().find(e=>6===e.type);if(!s)return;const r=Ct(s);return r?Et(s):r}function tt(e){let t=e,n=e;function s(e){return!(42!==e.nodeType||!e.parent||31!==e.parent.nodeType)||(!(1!==e.nodeType||!e.parent||9!==e.parent.nodeType)||(9===e.nodeType||15===e.nodeType||28===e.nodeType||32===e.nodeType||31===e.nodeType||36===e.nodeType||46===e.nodeType||50===e.nodeType||53===e.nodeType||57===e.nodeType||17===e.nodeType||16===e.nodeType||33===e.nodeType))}for(;n;){const e=s(n);if(!e&&!p.isExpressionNode(n))break;e&&(t=n),n=n.parent}const r=t.parent;if(3!==r.nodeType)if(5!==r.nodeType)if(55!==r.nodeType){if(38!==r.nodeType)if(45===r.nodeType&&r.returnExpression){const t=f.getEnclosingFunction(e),n=t?It(t):void 0;H(r.returnExpression,n,0)}else H(p.isExpressionNode(r)&&0!==r.nodeType?r:t)}else{const e=r.parent;e&&3===e.nodeType&&e.leftExpression===r?$e(e):G(r.typeAnnotation)}else qe(r);else t===r.typeAnnotationComment?G(t):$e(r)}function nt(e){r.assert(void 0!==e.name);const t=e.parent;if(31===t.nodeType)return void tt(t);r.assert(29===t.nodeType);const n=t;if(e.typeAnnotation)U(e.name,G(e.typeAnnotation));else{if(0===n.parameters.findIndex(t=>t===e)){const t=f.getEnclosingClass(n,!0);if(t){const s=We(t);if(s){const t=je(ze(n,!0),s.classType);return void U(e.name,t||b.UnknownType.create())}}}U(e.name,b.UnknownType.create())}}function st(e){let t=e;for(;t;){switch(t.nodeType){case 3:return void $e(t);case 4:return void H(t);case 5:return void qe(t);case 10:return void We(t);case 42:return void nt(t);case 31:return void tt(t);case 29:return void Be(t);case 27:return void Ye(t);case 26:return void Qe(t);case 60:return void Xe(t);case 34:{const e=t.parent;return r.assert(33===e.nodeType),void tt(e)}case 21:return void Je(t);case 23:return void Ze(t)}t=t.parent}r.fail("Unexpected assignment target")}function rt(e,t){const n=d.getImportInfo(e.node.module);r.assert(void 0!==n&&n.isImportFound),r.assert(e.node.isWildcardImport);const s=gt(e.node,t);r.assert(void 0!==s);const i=s.symbol.getDeclarations().find(t=>t.node===e.node);return i&&Et(i)||b.UnknownType.create()}function it(e){if(R.has(e.id))return R.get(e.id);R.set(e.id,!1);let t=!1;const n=function e(t){if(39===t.nodeType){const e=gt(t,t.value);if(!e)return;const n=e.symbol,s=St(n);if(s)return s;const r=n.getDeclarations();if(0===r.length)return;const i=r[r.length-1];return 2===i.type?(nt(i.node),L(i.node.name)):6===i.type?Et(i):void 0}if(36===t.nodeType){const n=t.memberName.value,s=e(t.leftExpression);if(!s)return;let r;if(9===s.category)r=b.ModuleType.getField(s,n);else if(7===s.category){const e=E.lookUpClassMember(s,n);r=e?e.symbol:void 0}else if(8===s.category){const e=E.lookUpClassMember(s.classType,n);r=e?e.symbol:void 0}if(!r)return;return St(r)}}(e.leftExpression);if(n){let e;if(5===n.category)e=n;else if(6===n.category){const t=n;e=t.overloads[t.overloads.length-1]}e&&(e.details.declaredReturnType?t=E.isNoReturnType(e.details.declaredReturnType):e.inferredReturnType?t=E.isNoReturnType(e.inferredReturnType):e.details.declaration&&(e.details.declaration.yieldExpressions||b.FunctionType.isAbstractMethod(e)||b.FunctionType.isStubDefinition(e)||(t=!ie(e.details.declaration.node))))}return R.set(e.id,t),t}function ot(e,t,n){const s=h.createKeyForReference(e),i=f.getExecutionScopeNode(e),o=d.getCodeFlowExpressions(i);if(r.assert(void 0!==o),!o.has(s))return;const a=f.getExecutionScopeNode(e);let c;return $(a)?c=function(){const e=O.length;return r.assert(e>0),O[e-1].codeFlowAnalyzer}():(c=F.get(a.id),c||(c=at(),F.set(a.id,c))),c.getTypeFromCodeFlow(e,t,n).type}function at(){const e=new Map;return{getTypeFromCodeFlow:function(t,n,s){const i=d.getFlowNode(t),o=h.createKeyForReference(t)+`.${n.toString()}`;let a=e.get(o);function c(e,t,n){const s=n?{isIncompleteType:!0,type:t}:t;return a.set(e.id,s),A.trackEntry(a,e.id),{type:t,isIncomplete:n}}function l(e){a.delete(e.id)}function p(e){const t=a.get(e.id);if(t)return v.isIncompleteType(t)?{type:t.type,isIncomplete:!0}:{type:t,isIncomplete:!1}}function u(e){let t=e.node;const n=e.node.parent;n&&(29!==n.nodeType&&10!==n.nodeType||(t=n));let s=L(t);return s||(st(e.node),s=L(t),s||(r.fail("evaluateAssignmentFlowNode failed to evaluate target"),s=b.UnknownType.create())),s}return a||(a=new Map,e.set(o,a)),i?function e(t,n,s,i){let o=t;for(;;){const t=p(o);if(t)return t;if(o.flags&h.FlowFlags.Unreachable)return c(o,void 0,!1);if(o.flags&h.FlowFlags.Call){const e=o;if(it(e.node))return c(o,void 0,!1);o=e.antecedent}else if(o.flags&h.FlowFlags.Assignment){const e=o;if(s===e.targetSymbolId&&f.isMatchingExpression(n,e.node)){if(o.flags&h.FlowFlags.Unbind)return c(o,b.UnboundType.create(),!1);c(o,void 0,!1);const t=u(e);return c(o,t,!1)}o=e.antecedent}else if(o.flags&h.FlowFlags.AssignmentAlias){const e=o;s===e.targetSymbolId&&(s=e.aliasSymbolId),o=e.antecedent}else{if(o.flags&(h.FlowFlags.BranchLabel|h.FlowFlags.LoopLabel)){const t=o,r=[];let a,p=!1,u=!1;const d=0!=(o.flags&h.FlowFlags.LoopLabel);return d&&c(o,void 0,!0),t.antecedents.map((t,l)=>{const h=e(t,n,s,i);h.isIncomplete&&(p=!0,0===l&&(u=!0)),h.type&&(r.push(h.type),a=b.combineTypes(r),d&&c(o,a,!0))}),d?u?(l(o),{type:a,isIncomplete:!0}):c(o,a,u):p?{type:a,isIncomplete:!0}:c(o,a,!1)}if(o.flags&(h.FlowFlags.TrueCondition|h.FlowFlags.FalseCondition)){const t=o,r=lt(n,t);if(r){const a=e(t.antecedent,n,s,i);let l=a.type;return l&&(l=r(l)),a.isIncomplete?{type:l,isIncomplete:!0}:c(o,l,!1)}o=t.antecedent}else if(o.flags&h.FlowFlags.PreFinallyGate){const e=o;if(e.isGateClosed)return{type:void 0,isIncomplete:!1};o=e.antecedent}else{if(o.flags&h.FlowFlags.PostFinally){const t=o,r=t.preFinallyGate.isGateClosed;t.preFinallyGate.isGateClosed=!0;const a=e(t.antecedent,n,s,i);return t.preFinallyGate.isGateClosed=r,a.isIncomplete?a:c(o,a.type,!1)}if(o.flags&h.FlowFlags.Start)return c(o,i,!1);if(!(o.flags&h.FlowFlags.WildcardImport))return r.fail("Unexpected flow node flags"),c(o,void 0,!1);{const e=o;if(39===n.nodeType){const t=n.value;if(e.names.some(e=>e===t)){const n=rt(e,t);return c(o,n,!1)}}o=e.antecedent}}}}}(i,t,n,s):{type:s,isIncomplete:!1}}}}function ct(e){const t=new Map;if(n.has(e.id))return!0;n.set(e.id,!0);const s=function e(n){let s=n;for(;;){if(t.has(s.id))return!1;if(t.set(s.id,!0),s.flags&h.FlowFlags.Unreachable)return!1;if(s.flags&h.FlowFlags.Call){const e=s;if(it(e.node))return!1;s=e.antecedent}else if(s.flags&h.FlowFlags.Assignment){s=s.antecedent}else if(s.flags&h.FlowFlags.AssignmentAlias){s=s.antecedent}else{if(s.flags&(h.FlowFlags.BranchLabel|h.FlowFlags.LoopLabel)){const t=s;for(const n of t.antecedents)if(e(n))return!0;return!1}if(s.flags&(h.FlowFlags.TrueCondition|h.FlowFlags.FalseCondition)){s=s.antecedent}else if(s.flags&h.FlowFlags.PreFinallyGate){const e=s;if(e.isGateClosed)return!1;s=e.antecedent}else{if(s.flags&h.FlowFlags.PostFinally){const t=s,n=t.preFinallyGate.isGateClosed;t.preFinallyGate.isGateClosed=!0;const r=e(t.antecedent);return t.preFinallyGate.isGateClosed=n,r}if(s.flags&h.FlowFlags.Start)return!0;if(!(s.flags&h.FlowFlags.WildcardImport))return r.fail("Unexpected flow node flags"),!1;s=s.antecedent}}}}(e);return n.delete(e.id),s}function lt(e,t){let n=t.expression;const s=!!(t.flags&h.FlowFlags.TrueCondition);if(4===n.nodeType&&(f.isMatchingExpression(e,n.rightExpression)?n=n.rightExpression:f.isMatchingExpression(e,n.name)&&(n=n.name)),7===n.nodeType){const t=38===n.operator||39===n.operator,r=12===n.operator||27===n.operator;if(t||r){const i=38===n.operator||12===n.operator?s:!s;if(11===n.rightExpression.nodeType&&24===n.rightExpression.constType&&f.isMatchingExpression(e,n.leftExpression))return e=>{if(10===e.category){const t=e.subtypes.filter(e=>!!b.isAnyOrUnknown(e)||b.isNoneOrNever(e)===i);return b.combineTypes(t)}return b.isNoneOrNever(e)&&!i?b.NeverType.create():e};if(t&&9===n.leftExpression.nodeType){const t=H(n.leftExpression.leftExpression).type;if(7===t.category&&b.ClassType.isBuiltIn(t,"type")&&1===n.leftExpression.arguments.length&&0===n.leftExpression.arguments[0].argumentCategory){const t=n.leftExpression.arguments[0].valueExpression;if(f.isMatchingExpression(e,t)){const e=H(n.rightExpression).type;if(7===e.category)return t=>E.doForSubtypes(t,t=>{if(8===t.category){const n=b.ClassType.isSameGenericClass(t.classType,e);return i?n?t:void 0:n?void 0:t}return b.isNoneOrNever(t)&&i?void 0:t})}}}if(r){const t=12===n.operator?s:!s;if(f.isMatchingExpression(e,n.leftExpression)){const e=H(n.rightExpression).type;if(8===e.category&&e.literalValue)return n=>pt(n,e,t)}if(f.isMatchingExpression(e,n.rightExpression)){const e=H(n.leftExpression).type;if(8===e.category&&e.literalValue)return n=>pt(n,e,t)}}}}if(9===n.nodeType&&39===n.leftExpression.nodeType)if("isinstance"!==n.leftExpression.value&&"issubclass"!==n.leftExpression.value||2!==n.arguments.length){if("callable"===n.leftExpression.value&&1===n.arguments.length){const t=n.arguments[0].valueExpression;if(f.isMatchingExpression(e,t))return e=>function(e,t,n){return E.doForSubtypes(e,e=>{switch(e.category){case 5:case 6:case 7:return t?e:void 0;case 9:return t?void 0:e;case 8:{const s=ye(e);return s&&7===s.category||Y(n,e,"__call__",{method:"get"},new i.DiagnosticAddendum,25)?t?e:void 0:t?void 0:e}default:return e}})}(e,s,n)}}else{const t="isinstance"===n.leftExpression.value,r=n.arguments[0].valueExpression,i=n.arguments[1].valueExpression;if(f.isMatchingExpression(e,r)){const e=function(e){if(7===e.category)return[e];if(8===e.category){const t=e.classType;if(b.ClassType.isBuiltIn(t,"Tuple")&&t.typeArguments){let e=!1;const n=[];if(t.typeArguments.forEach(t=>{7===t.category?n.push(t):e=!0}),!e)return n}}return}(H(i).type);if(e)return n=>function(e,t,n,s){const r=E.doForSubtypes(e,e=>E.transformTypeObjectToClass(e)),i=e=>{const r=[];let i=!1,o=!1;for(const n of t){const t=b.ClassType.isDerivedFrom(e,n),a=b.ClassType.isDerivedFrom(n,e);t&&(i=!0),a&&t&&!b.ClassType.isSameGenericClass(e,n)&&(o=!0),s&&(t?r.push(e):a&&r.push(n))}return s||i&&!o||r.push(e),n?r.map(e=>b.ObjectType.create(e)):r};if(n&&8===r.category){const e=i(r.classType);return b.combineTypes(e)}if(!n&&7===r.category){const e=i(r);return b.combineTypes(e)}if(10===r.category){let e=[];return r.subtypes.forEach(t=>{b.isAnyOrUnknown(t)?e.push(t):n&&8===t.category?e=e.concat(i(t.classType)):n||7!==t.category?s||e.push(t):e=e.concat(i(t))}),b.combineTypes(e)}return e}(n,e,t,s)}}if(f.isMatchingExpression(e,n))return e=>E.doForSubtypes(e,e=>{if(s){if(E.canBeTruthy(e))return e}else if(E.canBeFalsy(e))return e})}function pt(e,t,n){let s=!0;const r=E.doForSubtypes(e,e=>{if(8===e.category&&b.ClassType.isSameGenericClass(t.classType,e.classType)&&e.literalValue){const s=e.literalValue===t.literalValue;if(s&&!n||!s&&n)return;return e}return s=!1,e});return s?r:e}function ut(e,t,n,s){if(b.ClassType.isSpecialBuiltIn(e))switch(e.details.name){case"Callable":return function(e){const t=b.FunctionType.create(0);return t.details.declaredReturnType=b.AnyType.create(),e&&e.length>0?e[0].typeList?e[0].typeList.forEach((e,n)=>{E.isEllipsisType(e.type)?ae('"..." not allowed in this context',e.node):9===e.type.category&&ae("Module not allowed in this context",e.node),b.FunctionType.addParameter(t,{category:0,name:`p${n.toString()}`,isNameSynthesized:!0,type:E.convertClassToObject(e.type)})}):E.isEllipsisType(e[0].type)?E.addDefaultFunctionParameters(t):ae('Expected parameter type list or "..."',e[0].node):E.addDefaultFunctionParameters(t),e&&e.length>1?(E.isEllipsisType(e[1].type)?ae('"..." not allowed in this context',e[1].node):9===e[1].type.category&&ae("Module not allowed in this context",e[1].node),t.details.declaredReturnType=E.convertClassToObject(e[1].type)):t.details.declaredReturnType=b.AnyType.create(),e&&e.length>2&&ae('Expected only two type arguments to "Callable"',e[2].node),t}(t);case"Optional":return function(e,t){return t&&1===t.length?(E.isEllipsisType(t[0].type)?ae('"..." not allowed in this context',t[0].node):9===t[0].type.category&&ae("Module not allowed in this context",t[0].node),b.combineTypes([t[0].type,b.NoneType.create()])):(ae('Expected one type argument after "Optional"',e),b.UnknownType.create())}(s,t);case"Type":return Me(e,t,1);case"ClassVar":return function(e,t){if(!t||0===t.length)return ae('Expected a type argument after "ClassVar"',e),b.UnknownType.create();if(t.length>1)return ae('Expected only one type argument after "ClassVar"',t[1].node),b.UnknownType.create();let n=t[0].type;return E.requiresSpecialization(n)&&(n=E.specializeType(n,void 0)),E.convertClassToObject(n)}(s,t);case"Deque":case"List":case"FrozenSet":case"Set":return Me(e,t,1);case"ChainMap":case"Dict":case"DefaultDict":return Me(e,t,2);case"Protocol":return Me(e,t,void 0);case"Tuple":return Me(e,t,void 0,!0);case"Union":return function(e){const t=[];if(e)for(const n of e)t.push(n.type),E.isEllipsisType(n.type)?ae('"..." not allowed in this context',n.node):9===n.type.category&&ae("Module not allowed in this context",n.node);return t.length>0?b.combineTypes(t):b.NeverType.create()}(t);case"Generic":return function(e,t,n){n&&0!==n.length||ae('"Generic" requires at least one type argument',e);const s=[];return n&&n.forEach(e=>{if(11!==e.type.category)ae('Type argument for "Generic" must be a type variable',e.node);else{for(const t of s)if(t===e.type){ae('Type arguments for "Generic" must be unique',e.node);break}s.push(e.type)}}),Me(t,n)}(s,e,t);case"Final":return function(e,t,n){return 32&n?(ae('"Final" is not allowed in this context',e),b.AnyType.create()):t&&0!==t.length?(t.length>1&&ae('Expected a single type argument after "Final"',e),t[0].type):b.AnyType.create()}(s,t,n)}let r=t?t.length:0;const o=b.ClassType.getTypeParameters(e);if(0===o.length&&0===r)return e;t&&r>o.length&&(0===o.length?ae("Expected no type arguments",t[o.length].node):ae(`Expected at most ${o.length} type ${1===o.length?"argument":"arguments"} `,t[o.length].node),r=o.length),t&&t.forEach(e=>{E.isEllipsisType(e.type)?ae('"..." not allowed in this context',e.node):9===e.type.category&&ae("Module not allowed in this context",e.node)});const a=t?t.map(e=>E.convertClassToObject(e.type)):[],c=b.ClassType.getTypeParameters(e);for(let e=a.length;e<c.length;e++)a.push(E.getConcreteTypeFromTypeVar(c[e]));return a.forEach((e,n)=>{if(n<r){const s=new i.DiagnosticAddendum;if(!function(e,t,n,s=0,r=0){if(r>b.maxTypeRecursionCount)return!0;if(b.isAnyOrUnknown(t))return!0;let i=t;if(11===t.category){if(b.isTypeSame(t,e))return!0;i=E.getConcreteTypeFromTypeVar(t,r+1)}const o=e.boundType;if(o&&!Dt(o,i,n.createAddendum(),void 0,s,r+1))return n.addMessage(`Type "${Bt(i)}" is not compatible with bound type "${Bt(o)}" for TypeVar "${e.name}"`),!1;const a=e.constraints;if(0===a.length)return!0;for(const e of a){if(b.isAnyOrUnknown(e))return!0;if(10===i.category){if(i.subtypes.find(t=>b.isSameWithoutLiteralValue(e,t)))return!0}else if(b.isSameWithoutLiteralValue(e,i))return!0}return n.addMessage(`Type "${Bt(i)}" is not compatible with constraints imposed by TypeVar "${e.name}"`),!1}(o[n],e,s)){ce(Tt(t[n].node).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues",`Type "${Bt(e)}" cannot be assigned to TypeVar "${o[n].name}"`+s.getString(),t[n].node)}}}),b.ClassType.cloneForSpecialization(e,a)}function dt(e,t=!1){return e.type?e.type:H(e.valueExpression,void 0,t?16:0).type}function ht(e,t){const n=g.getScopeForNode(e),s=g.getBuiltInScope(n).lookUpSymbol(t);return s?kt(s):b.UnknownType.create()}function ft(e,t,n){const s=ht(e,t);if(7===s.category){let e=s;return n&&(e=b.ClassType.cloneForSpecialization(e,n)),b.ObjectType.create(e)}return s}function gt(e,t){return g.getScopeForNode(e).lookUpSymbolRecursive(t)}function yt(e){const t=D;D=!0,e(),D=t}function mt(e,t){A.enterSpeculativeContext(e),t(),A.leaveSpeculativeContext()}function _t(e){const t=A.getSpeculativeRootNode();return!!t&&(void 0===e||f.isNodeContainedWithin(e,t))}function Tt(e){for(;37!==e.nodeType;)e=e.parent;return d.getFileInfo(e)}function vt(e,t){if(5===e.category&&e.details.declaration){const n=e.details.declaration;if(3===n.type){const e=n.node,s=d.getScope(e).lookUpSymbol(t);if(s)return s.getDeclarations().find(e=>2===e.type)}}}function bt(e){switch(e.type){case 0:{if("Any"===e.intrinsicType)return b.AnyType.create();if("class"===e.intrinsicType){const t=We(f.getEnclosingClass(e.node));return t?t.classType:void 0}const t=ft(e.node,"str");if(8===t.category){if("str"===e.intrinsicType)return t;if("Iterable[str]"===e.intrinsicType){const n=ht(e.node,"Iterable");if(7===n.category)return b.ObjectType.create(b.ClassType.cloneForSpecialization(n,[t]))}if("Dict[str, Any]"===e.intrinsicType){const n=ht(e.node,"Dict");if(7===n.category)return b.ObjectType.create(b.ClassType.cloneForSpecialization(n,[t,b.AnyType.create()]))}}return b.UnknownType.create()}case 4:{const t=We(e.node);return t?t.decoratedType:void 0}case 5:return G(e.node.typeAnnotation);case 3:{const t=Be(e.node);return t?t.decoratedType:void 0}case 2:{let t=e.node.typeAnnotation;if(t&&49===t.nodeType&&(t=t.typeAnnotation),t){const e=G(t,!1);if(e)return E.convertClassToObject(e)}return}case 1:{let t=e.typeAnnotationNode;if(t&&49===t.nodeType&&(t=t.typeAnnotation),t){let n=G(t);if(n)return 39===e.node.nodeType&&(n=Le(e.node,n)),E.convertClassToObject(n)}return}case 6:return}}function Et(t){const n=Ct(t);if(!n)return b.UnknownType.create();function s(e,t,n){if(t.path){const s=n(t.path);if(!s)return b.UnknownType.create();e.fields=s.symbolTable,e.docString=s.docString}return t.implicitImports&&t.implicitImports.forEach((t,r)=>{const i=s(b.ModuleType.create(),t,n),o=m.Symbol.createWithType(0,i);e.loaderFields.set(r,o)}),e}if(6===n.type){const t=b.ModuleType.create();if(!n.symbolName)return s(t,n,e);if(n.submoduleFallback)return s(t,n.symbolName&&n.submoduleFallback?n.submoduleFallback:n,e)}const r=bt(n);if(r)return r;if(2===n.type){const e=L(n.node.name);return e||(nt(n.node),L(n.node.name))}if(1===n.type&&n.inferredTypeSource){let e=L(n.node);return e||(st(n.inferredTypeSource),e=L(n.node)),e&&39===n.node.nodeType&&(e=Le(n.node,e)),e}}function Ct(t){let n=t;const s=[];for(;;){if(6!==n.type)return n;if(!n.symbolName)return n;let r;if(n.path&&(r=e(n.path),!r))return;const i=r?r.symbolTable.get(n.symbolName):void 0;if(!i)return n.submoduleFallback?Ct(n.submoduleFallback):void 0;let o=i.getTypedDeclarations();if(0===o.length&&(o=i.getDeclarations(),0===o.length))return;if(n=o[o.length-1],s.find(e=>e===n))return t;s.push(n)}}function kt(e){if(e.hasTypedDeclarations())return St(e)||b.UnknownType.create();const t=[],n=e.isPrivateMember(),s=e.getDeclarations(),r=T.isFinalVariable(e);return s.forEach(s=>{if(W(e,s)){let i=Et(s);if(V(e),i){const e=1===s.type&&!!s.isConstant;i=E.stripLiteralTypeArgsValue(i),1===s.type&&(n||e||r||(i=E.stripLiteralValue(i))),t.push(i)}}}),t.length>0?b.combineTypes(t):b.UnboundType.create()}function St(e){const t=e.getSynthesizedType();if(t)return t;const n=e.getTypedDeclarations();if(0===n.length)return;let s=n.length-1;for(;s>=0;){const t=n[s],r=j(e,t);if(r)return r;if(q(e,t)<0){if(W(e,t)){const n=bt(t);if(!V(e))return;return n}break}s--}}function xt(e,t,n=!0){const s=b.FunctionType.getSpecializedReturnType(e);return s||(n?wt(e,t):b.UnknownType.create())}function wt(e,t){let n;if(b.FunctionType.isStubDefinition(e))return b.UnknownType.create();if(e.inferredReturnType)n=e.inferredReturnType;else{if(e.details.declaration){const t=e.details.declaration.node;!function(e){const t=A.disableSpeculativeMode();e(),A.enableSpeculativeMode(t)}(()=>{n=Ke(t,b.FunctionType.isAbstractMethod(e))}),n&&b.FunctionType.isWrapReturnTypeInAwait(e)&&!E.isNoReturnType(n)&&(n=Ge(t,n))}n||(n=b.UnknownType.create()),e.inferredReturnType=n}if(E.containsUnknown(n)&&b.FunctionType.hasUnannotatedParams(e)&&!b.FunctionType.isStubDefinition(e)&&t){const s=function(e,t){let n;if(!e.details.declaration)return;const s=e.details.declaration.node;if(t.some(e=>!e.paramName))return;if(O.some(e=>e.functionNode===s))return;const r=Be(s);if(!r)return;if(O.length>=3)return;if(yt(()=>{const i=M;O.push({functionNode:s,codeFlowAnalyzer:at()}),M=new Map;let o=!0;s.parameters.forEach((e,n)=>{if(e.name){let i;const a=t.find(t=>e.name.value===t.paramName);a&&a.argument.valueExpression?(i=H(a.argument.valueExpression).type,o=!1):e.defaultValue?(i=H(e.defaultValue).type,o=!1):0===n&&(b.FunctionType.isInstanceMethod(r.functionType)||b.FunctionType.isClassMethod(r.functionType))&&r.functionType.details.parameters.length>0&&s.parameters[0].name&&(i=r.functionType.details.parameters[0].type),i||(i=b.UnknownType.create()),U(e.name,i)}}),o||(n=Ke(s,b.FunctionType.isAbstractMethod(e))),O.pop(),M=i}),n)return b.FunctionType.isWrapReturnTypeInAwait(e)&&!E.isNoReturnType(n)&&(n=Ge(s,n)),n;return}(e,t);s&&(n=s)}return n}function It(e){const t=Be(e);return t?b.FunctionType.isAbstractMethod(t.functionType)?b.AnyType.create():b.FunctionType.isGenerator(t.functionType)?E.getDeclaredGeneratorReturnType(t.functionType):t.functionType.details.declaredReturnType:b.AnyType.create()}function Rt(e){return 7===e.classType.category?E.partiallySpecializeType(kt(e.symbol),e.classType):b.UnknownType.create()}function Ft(e,t,n,s,i,o,a){if(b.ClassType.isProtocolClass(e))return function e(t,n,s,r,i){const o=t.details.fields;if(b.isTypeSame(n,t))return!0;const a=b.ClassType.cloneForSpecialization(t,void 0),c=new C.TypeVarMap;let l=!0;const p=E.buildTypeVarMapFromSpecializedClass(n);if(o.forEach((e,t)=>{if(e.isClassMember()&&!e.isIgnoredForProtocolMatch()){const r=E.lookUpClassMember(n,t);if(r){const n=St(e);if(n){Dt(n,E.specializeType(Rt(r),p,!1,i+1),s.createAddendum(),c,0,i+1)||(s.addMessage(`"${t}" is an incompatible type`),l=!1)}}else s.addMessage(`"${t}" is not present`),l=!1}}),t.details.baseClasses.forEach(o=>{if(7===o.category&&!b.ClassType.isBuiltIn(o,"object")&&!b.ClassType.isBuiltIn(o,"Protocol")){e(Pt(t,o,i+1),n,s,r,i+1)||(l=!1)}}),l&&t.details.typeParameters.length>0){const e=E.specializeType(a,c,!1,i+1);At(t,e,s,r,i)||(l=!1)}return l}(e,t,n,s,o);if(b.ClassType.isTypedDictClass(e)&&b.ClassType.isTypedDictClass(t))return function(e,t,n,s){let r=!0;const i=Ut(e),o=Ut(t);return i.forEach((i,a)=>{const c=o.get(a);c?(i.isRequired&&!c.isRequired?(n.addMessage(`"${a}" is required in ${Bt(e)}`),r=!1):!i.isRequired&&c.isRequired&&(n.addMessage(`"${a}" is not required in ${Bt(e)}`),r=!1),b.isTypeSame(i.valueType,c.valueType,s+1)||(n.addMessage(`"${a}" is an incompatible type`),r=!1)):(n.addMessage(`"${a}" is missing from ${Bt(t)}`),r=!1)}),r}(e,t,n,o);if(b.ClassType.isPropertyClass(e)&&b.ClassType.isPropertyClass(t)){let s=!0;const r=e.details.fields.get("fget"),i=t.details.fields.get("fget");if(r&&i){const e=St(r),t=St(i);if(e&&t&&5===e.category&&5===t.category){Dt(xt(e),xt(t),n)||(s=!1)}}return s}if(b.ClassType.isBuiltIn(e,"float")&&b.ClassType.isBuiltIn(t,"int")&&0==(1&i))return!0;if(b.ClassType.isBuiltIn(e,"complex")&&(b.ClassType.isBuiltIn(t,"int")||b.ClassType.isBuiltIn(t,"float"))&&0==(1&i))return!0;if(0==(1&i)||b.ClassType.isSameGenericClass(t,e)){const i=[];if(b.ClassType.isDerivedFrom(t,e,i))return r.assert(i.length>0),function(e,t,n,s,r,i){let o=t;for(let t=n.length-1;t>=0;t--){const a=n[t];if(1===a.category)return!0;if(b.ClassType.isBuiltIn(a,"object"))return!0;if(t<n.length-1&&(o=Pt(o,a,i+1)),0===t&&b.ClassType.isSpecialBuiltIn(e)&&"Tuple"===e.details.name){if(e.typeArguments&&o.typeArguments){const t=e.typeArguments;let n=t.length;const a=2===n&&E.isEllipsisType(t[1]);a&&(n=1);const c=o.typeArguments;let l=c.length;const p=2===l&&E.isEllipsisType(c[1]);if(p&&(l=1),c.length!==n&&!a&&!p)return s.addMessage(`Tuple size mismatch; expected ${n} but got ${c.length}`),!1;for(let e=0;e<Math.max(n,l);e++){const n=(a?t[0]:t[e])||b.AnyType.create(),o=(p?c[0]:c[e])||b.AnyType.create();if(!Dt(n,o,s.createAddendum(),r,0,i+1))return s.addMessage(`Tuple entry ${e+1} is incorrect type`),!1}}return!0}if(0!==b.ClassType.getTypeParameters(a).length){if(!a.typeArguments)return!0;if(!At(a,o,s,r,i))return!1}}if(e.typeArguments&&!At(e,o,s,r,i))return!1;return!0}(e,t,i,n,s,o+1)}const c=a?b.ObjectType.create(e):e,l=a?b.ObjectType.create(t):t;return n.addMessage(`"${Bt(l)}" is incompatible with "${Bt(c)}"`),!1}function Pt(e,t,n){if(0===b.ClassType.getTypeParameters(t).length)return t;const s=E.buildTypeVarMapFromSpecializedClass(e),i=E.specializeType(t,s,!1,n+1);return r.assert(7===i.category),i}function At(e,t,n,s,i){r.assert(b.ClassType.isSameGenericClass(e,t));const o=b.ClassType.getTypeParameters(e),a=e.typeArguments;r.assert(void 0!==a);const c=t.typeArguments;if(c&&(b.ClassType.isSpecialBuiltIn(t)||c.length===o.length))for(let e=0;e<c.length;e++){const t=c[e],r=e>=a.length?a.length-1:e,l=a[r],p=r<o.length?o[r]:void 0;if(!p||p.isCovariant){if(!Dt(l,t,n.createAddendum(),s,0,i+1))return p&&n.addMessage(`TypeVar "${p.name}" is covariant`),!1}else if(p.isContravariant){if(!Dt(t,l,n.createAddendum(),s,2,i+1))return n.addMessage(`TypeVar "${p.name}" is contravariant`),!1}else if(!Dt(l,t,n.createAddendum(),s,1,i+1))return n.addMessage(`TypeVar "${p.name}" is invariant`),!1}return!0}function Nt(e,t,n,s,r,o=0,a=0){const c=r.get(e.name);if(e.constraints.length>0){const n=e.constraints.find(e=>Dt(e,t,new i.DiagnosticAddendum));if(!n)return s.addMessage(`Type "${Bt(t)}" is not compatible with constraints imposed by TypeVar "${e.name}"`),!1;if(c){if(!b.isTypeSame(c,n))return s.addMessage(`Type "${Bt(t)}" is not compatible with constrained type "${Bt(c)}"`),!1}else r.isLocked()||r.set(e.name,n,!1);return!0}let l=t;const p=r.isNarrowable(e.name)&&!r.isLocked(),u=n&&p;if(c){const e=new i.DiagnosticAddendum;if(n){if(p&&Dt(t,c,e,r,o,a+1))b.isAnyOrUnknown(c)||1===t.category||(l=c);else if(!Dt(c,t,new i.DiagnosticAddendum,r,o,a+1))return s.addMessage(`Type "${Bt(t)}" cannot be assigned to type "${Bt(c)}"`),!1}else if(Dt(c,t,e,r,o,a+1))p||1!==c.category&&(l=c);else{if(r.isLocked())return s.addMessage(`Type "${Bt(c)}" cannot be assigned to type "${Bt(t)}"`),!1;Dt(t,c,new i.DiagnosticAddendum,r,o,a+1)||(l=b.combineTypes([c,t]))}}return e.boundType&&!Dt(e.boundType,l,s.createAddendum(),void 0,o,a+1)?(s.addMessage(`Type "${Bt(l)}" is not compatible with bound type "${Bt(e.boundType)}" for TypeVar "${e.name}"`),!1):(r.isLocked()||r.set(e.name,l,u),!0)}function Dt(e,t,n,s,r=0,o=0){if(o>b.maxTypeRecursionCount)return!0;if(e===t)return!0;if(0===e.category||0===t.category)return!0;const a=0!=(2&r);if(r&=-3,11===e.category)return!(s&&!Nt(e,t,!1,n,s,r,o+1));if(b.isAnyOrUnknown(e))return!0;if(b.isAnyOrUnknown(t)){if(s){const n=E.isEllipsisType(t)?b.AnyType.create():t;E.setTypeArgumentsRecursive(e,n,s)}return!0}if(11===t.category){if(a&&s)return!!Nt(t,e,!0,n,s,r,o+1);const i=E.getConcreteTypeFromTypeVar(t);return Dt(e,i,n,void 0,r,o+1)}if(o>b.maxTypeRecursionCount)return!0;if(1&r&&(10===t.category||10===e.category))return!!b.isTypeSame(t,e)||(n.addMessage(`Type "${Bt(t)}" cannot be assigned to type "${Bt(e)}"`),!1);if(10===t.category){let i=!1;return t.subtypes.forEach(t=>{Dt(e,t,n.createAddendum(),s,r,o+1)||(n.addMessage(`Type "${Bt(t)}" cannot be assigned to type "${Bt(e)}"`),i=!0)}),!i}if(10===e.category){const a=new i.DiagnosticAddendum;let c=!1;return 3===t.category&&e.subtypes.some(e=>3===e.category)?c=!0:e.subtypes.forEach(e=>{Dt(e,t,a,s,r,o+1)&&(c=!0)}),!!c||(n.addAddendum(a),!1)}if(3===e.category&&3===t.category)return!0;if(8===t.category&&b.ClassType.isBuiltIn(t.classType,"Type")){const i=t.classType.typeArguments;if(i&&i.length>=1){if(b.isAnyOrUnknown(i[0]))return!0;if(8===i[0].category)return Dt(e,i[0].classType,n.createAddendum(),s,r,o+1)}}if(7===e.category&&7===t.category)return Ft(e,t,n,s,r,o+1,!1);if(8===e.category){const i=e.classType;if(b.ClassType.isBuiltIn(i,"type")&&(7===t.category||5===t.category||6===t.category))return!0;if(b.ClassType.isBuiltIn(i,"Type")){const e=i.typeArguments;if(e&&e.length>=1){if(b.isAnyOrUnknown(e[0]))return!0;if(8===e[0].category)return Dt(e[0].classType,t,n.createAddendum(),s,r,o+1);if(11===e[0].category){if(7===t.category)return Dt(e[0],b.ObjectType.create(t),n.createAddendum(),s,r,o+1);if(5===t.category||6===t.category)return Dt(e[0],t,n.createAddendum(),s,r,o+1)}}}if(8===t.category){const a=e.literalValue;if(void 0!==a){const s=t.literalValue;if(s!==a)return n.addMessage(`"${s?E.printLiteralType(t):Bt(t)}" cannot be assigned to "${E.printLiteralType(e)}"`),!1}return!!Ft(i,t.classType,n,s,r,o+1,!0)}if(5===t.category){const r=function(e){if(!b.ClassType.isProtocolClass(e.classType))return;const t=E.lookUpObjectMember(e,"__call__");if(!t)return;const n=Rt(t);if(5===n.category)return $t(e,n);return}(e);if(r)return!!Ot(r,t,n.createAddendum(),s,o+1,!0);if(b.ClassType.isBuiltIn(e.classType)&&"object"===e.classType.details.name)return!0}else if(9===t.category){if(b.ClassType.isBuiltIn(i,"ModuleType"))return!0}else if(7===t.category){if(b.ClassType.isBuiltIn(e.classType,"object"))return!0;const a=E.getMetaclass(t);if(a){if(b.isAnyOrUnknown(a))return!0;if(7===a.category)return s&&b.ClassType.isBuiltIn(a,"EnumMeta")&&(s.isLocked()||s.set("_T",b.ObjectType.create(t),!1)),Ft(i,a,n,s,r,o+1,!1)}}}if(5===e.category){let i;if(6===t.category){const a=t.overloads,c=a.findIndex(t=>{const i=s?s.clone():void 0;return Dt(e,t,n.createAddendum(),i,r,o+1)});if(c<0)return n.addMessage(`No overloaded function matches type "${Bt(e)}".`),!1;i=a[c]}else if(5===t.category)i=t;else if(8===t.category){const e=E.lookUpObjectMember(t,"__call__");if(e){const t=Rt(e);5===t.category&&(i=E.stripFirstParameter(t))}}else if(7===t.category){const e=b.FunctionType.create(69);e.details.declaredReturnType=b.ObjectType.create(t);const n=E.lookUpClassMember(t,"__new__",12),s=n?Rt(n):void 0;s&&5===s.category?s.details.parameters.forEach((t,n)=>{n>0&&b.FunctionType.addParameter(e,t)}):E.addDefaultFunctionParameters(e),i=e}if(i)return Ot(e,i,n.createAddendum(),s,o+1,!1)}if((b.isNoneOrNever(t)||9===t.category)&&8===e.category){const t=e.classType;if(b.ClassType.isBuiltIn(t,"object"))return!0}return b.isNoneOrNever(e)?(n.addMessage('Cannot assign to "None"'),!1):(n.addMessage(`Type "${Bt(t)}" cannot be assigned to type "${Bt(e)}"`),!1)}function Ot(e,t,n,s,r,i){let o=!0;const a=t.details.parameters.filter(e=>e.name).length,c=e.details.parameters.filter(e=>e.name).length,l=Math.min(a,c);for(let i=0;i<l;i++){const a=t.details.parameters[i],c=e.details.parameters[i],l=n.createAddendum();if(0!==a.category||0!==c.category)break;const p=b.FunctionType.getEffectiveParameterType(t,i),u=b.FunctionType.getEffectiveParameterType(e,i);Dt(p,u,l.createAddendum(),s,2,r+1);const d=E.specializeType(u,s,!1,r+1);Dt(p,d,l.createAddendum(),void 0,0,r+1)||(l.addMessage(`Parameter ${i+1} of type "${Bt(d)}" cannot be assigned to type "${Bt(p)}"`),o=!1)}const p=t.details.parameters,u=e.details.parameters,d=void 0!==p.find(e=>e.name&&0!==e.category),h=void 0!==u.find(e=>e.name&&0!==e.category);if(i){const e=new Map;let t=!1;u.forEach(n=>{t?n.name&&0===n.category&&e.set(n.name,n):1===n.category&&(t=!0)});let i=!1;p.forEach(t=>{if(i){if(t.name&&0===t.category){const i=e.get(t.name),a=n.createAddendum();if(i){const n=E.specializeType(i.type,s,!1,r+1);Dt(t.type,n,a.createAddendum(),void 0,0,r+1)||(a.addMessage(`Named parameter "${t.name}" of type "${Bt(n)}" cannot be assigned to type "${Bt(t.type)}"`),o=!1),e.delete(t.name)}else a.addMessage(`Named parameter "${t.name}" is missing in destination`),o=!1}}else 1===t.category&&(i=!0)}),e.forEach((e,t)=>{n.createAddendum().addMessage(`Named parameter "${t}" is missing in source`),o=!1})}if(!d&&!h){const e=p.filter(e=>!!e.name&&!e.hasDefault).length;c<e&&(n.addMessage(`Function accepts too few parameters; expected ${e} but got ${c}`),o=!1),c>a&&(n.addMessage(`Function accepts too many parameters; expected ${a} but got ${c}`),o=!1)}const f=xt(e);if(!b.isAnyOrUnknown(f)){const e=xt(t);Dt(f,e,n.createAddendum(),s,0,r+1)||(n.addMessage(`Function return type "${Bt(e)}" is not compatible with type "${Bt(f)}"`),o=!1)}return o}function Mt(e,t){const n=new i.DiagnosticAddendum;return 10===e.category?E.doForSubtypes(e,e=>10===t.category?t.subtypes.some(t=>Dt(e,t,n))?e:void 0:Dt(e,t,n)?e:void 0):Dt(e,t,n)?e:b.NeverType.create()}function Lt(e){const t=new Map;e.details.mro.forEach(e=>{7===e.category&&e.details.fields.forEach((n,s)=>{const r=T.getLastTypedDeclaredForSymbol(n);if(n.isClassMember()&&r&&3===r.type){const i=ze(r.node,!0);if(!t.has(s)){const r=!!(8&i);t.set(s,{symbol:n,symbolName:s,isAbstract:r,classType:e})}}})});const n=[];return t.forEach(e=>{e.isAbstract&&n.push(e)}),n}function Ut(e){const t=new Map;return function e(t,n,s=0){if(r.assert(b.ClassType.isTypedDictClass(t)),s>b.maxTypeRecursionCount)return;t.details.baseClasses.forEach(t=>{7===t.category&&b.ClassType.isTypedDictClass(t)&&e(t,n,s+1)}),t.details.fields.forEach((e,s)=>{if(!e.isIgnoredForProtocolMatch()){const r=T.getLastTypedDeclaredForSymbol(e);r&&1===r.type&&n.set(s,{valueType:St(e)||b.UnknownType.create(),isRequired:!b.ClassType.isCanOmitDictValues(t),isProvided:!1})}})}(e,t),t}function $t(e,t,n=!1){if(5===t.category){if(!e)return E.stripFirstParameter(t);if(b.FunctionType.isInstanceMethod(t)&&!n){if(8===e.category)return qt(e,t)}else if(b.FunctionType.isClassMethod(t)||n)return qt(7===e.category?e:e.classType,t)}else if(6===t.category){const s=b.OverloadedFunctionType.create();return t.overloads.forEach(t=>{b.OverloadedFunctionType.addOverload(s,$t(e,t,n))}),s}return t}function qt(e,t){const n=7===e.category?e:e.classType,s=n.typeArguments?E.buildTypeVarMapFromSpecializedClass(n):new C.TypeVarMap;if(t.details.parameters.length>0){Dt(t.details.parameters[0].type,e,new i.DiagnosticAddendum,s)}const r=E.specializeType(t,s,!1);return E.stripFirstParameter(r)}function Wt(e,t=0){let n=e.details.name;if(!b.ClassType.isPseudoGenericClass(e))if(e.typeArguments)e.typeArguments.length>0?n+="["+e.typeArguments.map(e=>Bt(e,t+1)).join(", ")+"]":b.ClassType.isBuiltIn(e,"Tuple")&&(n+="[()]");else{const s=b.ClassType.getTypeParameters(e);s.length>0&&(n+="["+s.map(e=>Bt(e,t+1)).join(", ")+"]")}return n}function Vt(e,t=0){const n=e.details.parameters.map((n,s)=>{let r="";if(1===n.category?r+="*":2===n.category&&(r+="**"),n.name&&(r+=n.name),0===n.category)if(n.name){if(n.hasDeclaredType||n.isTypeInferred){const n=b.FunctionType.getEffectiveParameterType(e,s);r+=": "+(t<b.maxTypeRecursionCount?Bt(n,t+1):"")}}else r+="/";if(e.details.declaration){const t=e.ignoreFirstParamOfDeclaration?s+1:s,n=e.details.declaration.node.parameters[t];n.defaultValue&&(r+=" = "+f.printExpression(n.defaultValue))}return r}),s=xt(e);return[n,t<b.maxTypeRecursionCount?Bt(s,t+1):""]}function Bt(e,t=0){if(t>=b.maxTypeRecursionCount)return"";switch(e.category){case 0:return"Unbound";case 1:return"Unknown";case 9:return"Module";case 7:return"Type["+Wt(e,t+1)+"]";case 8:{const n=e;if(void 0!==n.literalValue)return E.printLiteralType(n);if(E.isProperty(e)){const n=E.lookUpObjectMember(e,"fget");if(n){const e=Rt(n);if(5===e.category){return Bt(xt(e),t+1)}}}return Wt(n.classType,t+1)}case 5:{const n=Vt(e,t);return`(${n[0].join(", ")}) -> ${n[1]}`}case 6:return`Overload[${e.overloads.map(e=>Bt(e,t+1)).join(", ")}]`;case 10:{const n=e;let s=n.subtypes;if(void 0!==s.find(e=>3===e.category)){return"Optional["+Bt(b.removeNoneFromUnion(n),t+1)+"]"}s=[],s=s.concat(...n.subtypes);const r=e=>8===e.category&&void 0!==e.literalValue,i=[];for(;s.length>0;){const e=s.shift();if(r(e)){const t=s.filter(e=>r(e));t.unshift(e);const n=t.map(e=>E.printLiteralValue(e));i.push(`Literal[${n.join(", ")}]`),t.length>1&&(s=s.filter(e=>!r(e)))}else i.push(Bt(e,t+1))}return 1===i.length?i[0]:`Union[${i.join(", ")}]`}case 11:{if(e.isSynthesized)return"Unknown";const n=e.name;if(t>0)return n;const s=[`"${n}"`];for(const n of e.constraints)s.push(Bt(n,t+1));return"TypeVar["+s.join(", ")+"]"}case 3:return"None";case 4:return"Never";case 2:return e.isEllipsis?"...":"Any"}return""}return{runWithCancellationToken:function(e,t){try{return N=e,t()}finally{N=void 0}},getType:z,getTypeOfClass:We,getTypeOfFunction:Be,evaluateTypesForStatement:st,getDeclaredTypeForExpression:J,verifyDeleteExpression:function(e){switch(e.nodeType){case 39:H(e);break;case 36:{const t=H(e.leftExpression),n=ge(e,t,{method:"del"},0);U(e.memberName,n.type);break}case 24:{const t=H(e.baseExpression,void 0,2);_e(e,t.type,{method:"del"},0),U(e,b.UnboundType.create());break}case 0:yt(()=>{e.child&&H(e.child)});break;default:ce(Tt(e).diagnosticRuleSet.reportGeneralTypeIssues,"reportGeneralTypeIssues","Expression cannot be deleted",e);break}},isAfterNodeReachable:ie,isNodeReachable:re,getDeclarationsForNameNode:function(e){if(d.isCodeUnreachable(e))return;const t=[],n=e.value;if(!e.parent||23!==e.parent.nodeType||!e.parent.alias||e!==e.parent.name){if(e.parent&&36===e.parent.nodeType&&e===e.parent.memberName){const n=z(e.parent.leftExpression);if(n){const s=e.parent.memberName.value;E.doForSubtypes(n,e=>{let n;if(7===e.category){let t=E.lookUpClassMember(e,s,16);t||(t=E.lookUpClassMember(e,s)),t&&(n=t.symbol)}else if(8===e.category){let t=E.lookUpObjectMember(e,s,16);t||(t=E.lookUpObjectMember(e,s)),t&&(n=t.symbol)}else 9===e.category&&(n=b.ModuleType.getField(e,s));if(n){const e=n.getTypedDeclarations();e.length>0?t.push(...e):t.push(...n.getDeclarations())}return e})}}else if(e.parent&&38===e.parent.nodeType){const n=e.parent.nameParts.findIndex(t=>t===e),s=d.getImportInfo(e.parent);if(n>=0&&s&&n<s.resolvedPaths.length&&s.resolvedPaths[n]){const e={type:6,node:void 0,path:s.resolvedPaths[n],range:c.getEmptyRange(),implicitImports:new Map};t.push(e)}}else if(e.parent&&1===e.parent.nodeType&&e===e.parent.name){const n=e.parent,s=e.value;if(n.parent&&9===n.parent.nodeType){const e=z(n.parent.leftExpression);if(e)if(5===e.category&&e.details.declaration){const n=vt(e,s);n&&t.push(n)}else if(7===e.category){const r=Y(n.parent.leftExpression,b.ObjectType.create(e),"__init__",{method:"get"},new i.DiagnosticAddendum,29);if(r&&5===r.category){const e=vt(r,s);e&&t.push(e)}}}}else{const s=g.getScopeForNode(e);if(s){const e=s.lookUpSymbolRecursive(n);if(!e)return;t.push(...e.symbol.getDeclarations())}}return t}},getTypeForDeclaration:bt,resolveAliasDeclaration:Ct,getTypeFromIterable:ee,getTypedDictMembersForClass:Ut,getEffectiveTypeOfSymbol:kt,getFunctionDeclaredReturnType:It,getFunctionInferredReturnType:wt,getBuiltInType:ht,getTypeOfMember:Rt,bindFunctionToClassOrObject:$t,getBoundMethod:X,getCallSignatureInfo:function(e,t,n){let s,r=e;for(;void 0!==r;){if(9===r.nodeType||13===r.nodeType){s=r;break}r=r.parent}if(!s||!s.arguments)return;if(t>=l.TextRange.getEnd(s))return;const i=s.leftExpression,o=z(i);if(void 0===o)return;const a=[];let c=!1,p=0;function u(){a.push({argumentCategory:p,type:b.UnknownType.create(),active:!0})}s.arguments.forEach(e=>{let s=!1;if(!c){let r=e.start;const i=n.getItemAtPosition(r);i>=0&&(r=l.TextRange.getEnd(n.getItemAt(i-1)));let o=l.TextRange.getEnd(e);const a=n.getItemAtPosition(o);if(a>=0)for(let e=a;e<n.count;e++){const t=n.getItemAt(e);switch(t.type){case 12:case 14:break;default:continue}o=l.TextRange.getEnd(t);break}t<o&&(t>=r?s=!0:u(),c=!0)}p=e.argumentCategory,a.push({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name,active:s})}),c||u();const d=[];function h(e){let t;mt(s,()=>{t=xe(i,a,e,new C.TypeVarMap,!0)}),d.push({type:e,activeParam:null==t?void 0:t.activeParam})}function f(e){5===e.category?h(e):e.overloads.forEach(h)}return E.doForSubtypes(o,e=>{switch(e.category){case 5:case 6:f(e);break;case 7:{let t;b.ClassType.isDataClass(e)||(t=X(e,"__new__",!0)),t||(t=X(e,"__init__",!1)),t&&f(t);break}case 8:{const t=X(e.classType,"__call__",!1);t&&f(t);break}}}),0!==d.length?{callNode:s,signatures:d}:void 0},canAssignType:Dt,canOverrideMethod:function(e,t,n){if(6===e.category&&(e=e.overloads[e.overloads.length-1]),5!==e.category)return n.addMessage(`Base class defines type as "${Bt(e)}"`),!1;let s=!0;const r=e.details.parameters,i=t.details.parameters;if(r.length!==i.length)return n.addMessage(`Parameter count mismatch; base method has ${r.length}, but override has ${i.length}`),!1;const o=Math.min(r.length,i.length);for(let a=0;a<o;a++){const o=r[a],c=i[a];if(o.name!==c.name)n.addMessage(`Parameter ${a+1} name mismatch: base parameter is named "${o.name||"*"}", override parameter is named "${c.name||"*"}"`),s=!1;else{const r=b.FunctionType.getEffectiveParameterType(e,a),i=b.FunctionType.getEffectiveParameterType(t,a);Dt(r,i,n.createAddendum())||(n.addMessage(`Parameter ${a+1} type mismatch: base method parameter is type "${Bt(r)}", override is type "${Bt(i)}"`),s=!1)}}const a=xt(e),c=xt(t);return Dt(a,c,n.createAddendum())||(n.addMessage(`Return type mismatch: base method returns type "${Bt(a)}", override returns type "${Bt(c)}"`),s=!1),s},addError:ae,addWarning:oe,addDiagnostic:ce,addDiagnosticForTextRange:function(e,t,n,s,r){let i;return"error"===t?i=e.diagnosticSink.addErrorWithTextRange(s,r):"warning"===t&&(i=e.diagnosticSink.addWarningWithTextRange(s,r)),i&&i.setRule(n),i},printType:Bt,printFunctionParts:Vt,hasGrownTooLarge:function(){return P.size>75e4}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1);t.isIncompleteType=function(e){return!!e.isIncompleteType};t.SpeculativeTypeTracker=class{constructor(){this._speculativeContextStack=[]}enterSpeculativeContext(e){this._speculativeContextStack.push({speculativeRootNode:e,entriesToUndo:[]})}leaveSpeculativeContext(){s.assert(this._speculativeContextStack.length>0),this._speculativeContextStack.pop().entriesToUndo.forEach(e=>{e.cache.delete(e.id)})}isSpeculative(){return this._speculativeContextStack.length>0}getSpeculativeRootNode(){const e=this._speculativeContextStack.length;if(e>0)return this._speculativeContextStack[e-1].speculativeRootNode}trackEntry(e,t){const n=this._speculativeContextStack.length;n>0&&this._speculativeContextStack[n-1].entriesToUndo.push({cache:e,id:t})}disableSpeculativeMode(){const e=this._speculativeContextStack;return this._speculativeContextStack=[],e}enableSpeculativeMode(e){s.assert(0===this._speculativeContextStack.length),this._speculativeContextStack=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(7),r=n(8),i=n(12),o=n(62),a=n(14),c=n(16),l=n(17);class p{constructor(e){this.importName=e,this.isAccessed=!1}}class u extends p{constructor(e,t,n){super(e),this.alias=t,this.symbol=n}}class d extends p{constructor(e,t,n){super(e),this.isWildcardImport=t,this.node=n,this.symbols=[]}addSymbol(e,t,n,s=!1){this.symbols.find(e=>e.name===t)||this.symbols.push({symbol:e,name:t,alias:n,isAccessed:s})}}class h extends i.ParseTreeWalker{constructor(e,t){super(),this._accessedImportedSymbols=e,this._treatStringsAsSymbols=t}analyze(e){this.walk(e)}walk(e){s.isCodeUnreachable(e)||super.walk(e)}visitName(e){return this._accessedImportedSymbols.set(e.value,!0),!0}visitString(e){return this._treatStringsAsSymbols&&this._accessedImportedSymbols.set(e.value,!0),!0}}class f extends i.ParseTreeWalker{constructor(e,t,n){super(),this._typingsPath=e,this._sourceFile=t,this._evaluator=n,this._indentAmount=0,this._includeAllImports=!1,this._typeStubText="",this._lineEnd="\n",this._tab="    ",this._classNestCount=0,this._functionNestCount=0,this._ifNestCount=0,this._emittedSuite=!1,this._emitDocString=!0,this._trackedImportAs=new Map,this._trackedImportFrom=new Map,this._accessedImportedSymbols=new Map,this._typingsPath.endsWith("__init__.pyi")&&(this._includeAllImports=!0)}write(){const e=this._sourceFile.getParseResults();this._lineEnd=e.tokenizerOutput.predominantEndOfLineSequence,this._tab=e.tokenizerOutput.predominantTabSequence,this.walk(e.parseTree),this._writeFile()}walk(e){s.isCodeUnreachable(e)||super.walk(e)}visitClass(e){const t=e.name.value;this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n=`class ${t}`;return e.arguments.length>0&&(n+=`(${e.arguments.map(e=>{let t="";return e.name&&(t=e.name.value+"="),t+=this._printExpression(e.valueExpression),t}).join(", ")})`),n+=":",this._emitLine(n),this._emitSuite(()=>{this._classNestCount++,this.walk(e.suite),this._classNestCount--}),this._emitLine(""),this._emitLine(""),!1}visitFunction(e){const t=e.name.value;if(0===this._functionNestCount){this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n=e.isAsync?"async ":"";n+=`def ${t}`,n+=`(${e.parameters.map(e=>this._printParameter(e)).join(", ")})`,e.returnTypeAnnotation&&(n+=" -> "+this._printExpression(e.returnTypeAnnotation,!0)),n+=":",this._emitLine(n),this._emitSuite(()=>{this._functionNestCount++,this.walk(e.suite),this._functionNestCount--}),this._emitLine("")}return!1}visitWhile(e){return this._emitDocString=!1,!1}visitFor(e){return this._emitDocString=!1,!1}visitTry(e){return this._emitDocString=!1,!1}visitWith(e){return this._emitDocString=!1,!1}visitIf(e){if(this._emitDocString=!1,0===this._functionNestCount&&0===this._ifNestCount){this._ifNestCount++,this._emittedSuite=!0,this._emitLine("if "+this._printExpression(e.testExpression)+":"),this._emitSuite(()=>{this.walkMultiple(e.ifSuite.statements)});const t=e.elseSuite;t&&(this._emitLine("else:"),this._emitSuite(()=>{19===t.nodeType?this.walkMultiple([t.testExpression,t.ifSuite,t.elseSuite]):this.walkMultiple(t.statements)})),this._ifNestCount--}return!1}visitAssignment(e){let t="";if(39===e.leftExpression.nodeType){if("__all__"===e.leftExpression.value)return this._emitLine(this._printExpression(e,!1,!0)),!1;0===this._functionNestCount&&(t=this._printExpression(e.leftExpression))}else if(36===e.leftExpression.nodeType){const n=e.leftExpression.leftExpression;if(39===n.nodeType&&"self"===n.value){const n=e.leftExpression.memberName.value;a.isPrivateOrProtectedName(n)||(t=this._printExpression(e.leftExpression))}}if(t){const n=0===this._functionNestCount&&0===this._classNestCount;this._emittedSuite=!0,t+=" = ",t+=n?this._printExpression(e.rightExpression):"...",this._emitLine(t)}return!1}visitAugmentedAssignment(e){return 0===this._classNestCount&&0===this._functionNestCount&&39===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value&&this._emitLine(this._printExpression(e,!1,!0)),!1}visitTypeAnnotation(e){if(0===this._functionNestCount){let t="";if(39===e.valueExpression.nodeType)t=this._printExpression(e.valueExpression);else if(36===e.valueExpression.nodeType){const n=e.valueExpression.leftExpression;if(39===n.nodeType&&"self"===n.value){const n=e.valueExpression.memberName.value;a.isPrivateOrProtectedName(n)||(t=this._printExpression(e.valueExpression))}}t&&(t+=": "+this._printExpression(e.typeAnnotation,!0),this._emitLine(t))}return!1}visitImport(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=o.getScopeForNode(e);return t&&e.list.forEach(e=>{const n=this._printModuleName(e.module);if(!this._trackedImportAs.has(n)){const s=e.alias?e.alias.value:e.module.nameParts.length>0?e.module.nameParts[0].value:"",r=t.lookUpSymbolRecursive(s);if(r){const t=new u(n,e.alias?e.alias.value:void 0,r.symbol);this._trackedImportAs.set(n,t)}}}),!1}visitImportFrom(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=o.getScopeForNode(e);if(t){const n=this._printModuleName(e.module);let s=this._trackedImportFrom.get(n);s||(s=new d(n,e.isWildcardImport,e),this._trackedImportFrom.set(n,s)),e.imports.forEach(e=>{const n=e.alias?e.alias.value:e.name.value,r=t.lookUpSymbolRecursive(n);r&&s.addSymbol(r.symbol,e.name.value,e.alias?e.alias.value:void 0,!1)})}return!1}visitStatementList(e){return e.statements.length>0&&49===e.statements[0].nodeType&&!this._emittedSuite&&this._emitDocString&&this._emitLine(this._printExpression(e.statements[0])),this._emitDocString=!1,this.walkMultiple(e.statements),!1}_emitSuite(e){this._increaseIndent(()=>{const t=this._emittedSuite;this._emittedSuite=!1,e(),this._emittedSuite||this._emitLine("..."),this._emittedSuite=t})}_increaseIndent(e){this._indentAmount++,e(),this._indentAmount--}_emitDecorators(e){e.forEach(e=>{let t="@"+this._printExpression(e.leftExpression);e.arguments&&(t+=`(${e.arguments.map(e=>this._printArgument(e)).join(", ")})`),this._emitLine(t)})}_printHeaderDocString(){return'"""'+this._lineEnd+"This type stub file was generated by pyright."+this._lineEnd+'"""'+this._lineEnd+this._lineEnd}_emitLine(e){for(let e=0;e<this._indentAmount;e++)this._typeStubText+=this._tab;this._typeStubText+=e+this._lineEnd}_printModuleName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map(e=>e.value).join("."),t}_addImplicitImportFrom(e,t){let n=this._trackedImportFrom.get(e);n||(n=new d(e,!1),this._trackedImportFrom.set(e,n)),t.forEach(e=>{n.addSymbol(void 0,e,void 0,!0)})}_printParameter(e){let t="";1===e.category?t+="*":2===e.category&&(t+="**"),e.name&&(t+=e.name.value);let n="";if(e.typeAnnotation)n=this._printExpression(e.typeAnnotation,!0);else if(e.defaultValue){const t=this._evaluator.getType(e.defaultValue);if(t&&!l.containsUnknown(t))if(c.isNoneOrNever(t))n="Optional[Any]",this._addImplicitImportFrom("typing",["Any","Optional"]);else if(8===t.category){const e=t.classType;c.ClassType.isBuiltIn(e,"bool")&&(n="bool")}}return n&&(t+=": "+n),e.defaultValue&&(t+=n?" = ...":"=..."),t}_printArgument(e){let t="";return 1===e.argumentCategory?t+="*":2===e.argumentCategory&&(t+="**"),e.name&&(t+=e.name.value+"="),t+this._printExpression(e.valueExpression)}_printExpression(e,t=!1,n=!1){return new h(this._accessedImportedSymbols,n).analyze(e),r.printExpression(e,t?1:0)}_printTrackedImports(){let e="",t=!1;return this._trackedImportAs.forEach(n=>{this._accessedImportedSymbols.get(n.alias||n.importName)&&(n.isAccessed=!0),(n.isAccessed||this._includeAllImports)&&(e+=`import ${n.importName}`,n.alias&&(e+=` as ${n.alias}`),e+=this._lineEnd,t=!0)}),this._trackedImportFrom.forEach(n=>{n.symbols.forEach(e=>{this._accessedImportedSymbols.get(e.alias||e.name)&&(e.isAccessed=!0)}),n.isWildcardImport&&(e+=`from ${n.importName} import *`+this._lineEnd,t=!0);const s=n.symbols.filter(e=>e.isAccessed||this._includeAllImports).sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0);s.length>0&&(e+=`from ${n.importName} import `,e+=s.map(e=>{let t=e.name;return e.alias&&(t+=" as "+e.alias),t}).join(", "),e+=this._lineEnd,t=!0)}),t&&(e+=this._lineEnd),e}_writeFile(){let e=this._printHeaderDocString();e+=this._printTrackedImports(),e+=this._typeStubText,this._sourceFile.fileSystem.writeFileSync(this._typingsPath,e,"utf8")}}t.TypeStubWriter=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CommandLineOptions=class{constructor(e,t){this.fileSpecs=[],this.executionRoot=e,this.fromVsCodeExtension=t}}},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);t.QuickActionCommand=class{constructor(e){this._ls=e}execute(e,t){return s(this,void 0,void 0,(function*(){if(e.arguments&&e.arguments.length>=1){const n=e.arguments[0],s=e.arguments.slice(1),i=r.convertUriToPath(n),o=this._ls.getWorkspaceForFile(i);if("pyright.organizeimports"===e.command&&o.disableOrganizeImports)return[];const a=o.serviceInstance.performQuickAction(i,e.command,s,t);if(!a)return[];const c=[];return a.forEach(e=>{c.push({range:e.range,newText:e.replacementText})}),c}}))}}},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.RestartServerCommand=class{constructor(e){this._ls=e}execute(e){return s(this,void 0,void 0,(function*(){this._ls.restart()}))}}},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),n(125);const r=n(11),i=n(10),o=n(49),a=n(46),c=n(3),l=n(36),p=n(126),u=n(6),d=n(63),h=n(56),f=n(152);t.LanguageServerBase=class{constructor(e,t,n){this._productName=e,this._extension=n,this._connection=i.createConnection(this._GetConnectionOptions()),this._hasConfigurationCapability=!1,this._hasWatchFileCapability=!1,this._isDisplayingProgress=!1,this._fileWatchers=[],this.rootPath="",this._connection.console.log(`${e} language server starting`),this.fs=p.createFromRealFileSystem(this._connection.console,this),global.__rootDirectory=t,this._connection.console.log(`Server root directory: ${t}`),this._workspaceMap=new f.WorkspaceMap(this),this._setupConnection(),this._connection.listen()}getConfiguration(e,t){if(this._hasConfigurationCapability){const n={scopeUri:e.rootUri?e.rootUri:void 0,section:t};return this._connection.workspace.getConfiguration(n)}if(this._defaultClientConfig)return l.getNestedProperty(this._defaultClientConfig,t)}createImportResolver(e,t){return new o.ImportResolver(e,t)}setExtension(e){this._extension=e}get console(){return this._connection.console}get window(){return this._connection.window}createAnalyzerService(e){this._connection.console.log(`Starting service instance "${e}"`);const t=new a.AnalyzerService(e,this.fs,this._connection.console,this.createImportResolver.bind(this),void 0,this._extension);return t.setMaxAnalysisDuration({openFilesTimeInMs:50,noOpenFilesTimeInMs:200}),t.setCompletionCallback(e=>this.onAnalysisCompletedHandler(e)),t}getWorkspaceForFile(e){return this._workspaceMap.getWorkspaceForFile(e)}reanalyze(){this._workspaceMap.forEach(e=>{e.serviceInstance.invalidateAndForceReanalysis()})}restart(){this._workspaceMap.forEach(e=>{e.serviceInstance.restart()})}createFileWatcher(e,t){const n=this,s=[],i=[],o=this._workspaceMap.getNonDefaultWorkspaces();e.forEach(e=>{o.some(t=>u.containsPath(t.rootPath,e))?s.push(e):i.push(e)});const a=i.map(e=>r.watch(e,{recursive:!0},t)),c={close(){n._fileWatchers=n._fileWatchers.filter(e=>e!==c),a.forEach(e=>{e.close()})},workspacePaths:s,eventHandler:t};return this._fileWatchers.push(c),c}_setupConnection(){this._connection.onInitialize(e=>{var t,n,s;this.rootPath=e.rootPath||"";const r=e.capabilities;return this._hasConfigurationCapability=!!(null===(t=r.workspace)||void 0===t?void 0:t.configuration),this._hasWatchFileCapability=!!(null===(s=null===(n=r.workspace)||void 0===n?void 0:n.didChangeWatchedFiles)||void 0===s?void 0:s.dynamicRegistration),e.workspaceFolders?e.workspaceFolders.forEach(e=>{const t=u.convertUriToPath(e.uri);this._workspaceMap.set(t,{workspaceName:e.name,rootPath:t,rootUri:e.uri,serviceInstance:this.createAnalyzerService(e.name),disableLanguageServices:!1,disableOrganizeImports:!1})}):e.rootPath&&this._workspaceMap.set(e.rootPath,{workspaceName:"",rootPath:e.rootPath,rootUri:"",serviceInstance:this.createAnalyzerService(e.rootPath),disableLanguageServices:!1,disableOrganizeImports:!1}),{capabilities:{textDocumentSync:i.TextDocumentSyncKind.Full,definitionProvider:!0,referencesProvider:!0,documentSymbolProvider:!0,workspaceSymbolProvider:!0,hoverProvider:!0,renameProvider:!0,completionProvider:{triggerCharacters:[".","["],resolveProvider:!0},signatureHelpProvider:{triggerCharacters:["(",",",")"]},codeActionProvider:{codeActionKinds:[i.CodeActionKind.QuickFix,i.CodeActionKind.SourceOrganizeImports]}}}}),this._connection.onDidChangeConfiguration(e=>{this._connection.console.log("Received updated settings"),(null==e?void 0:e.settings)&&(this._defaultClientConfig=null==e?void 0:e.settings),this.updateSettingsForAllWorkspaces()}),this._connection.onCodeAction((e,t)=>this.executeCodeAction(e,t)),this._connection.onDefinition((e,t)=>{this.recordUserInteractionTime();const n=u.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},r=this._workspaceMap.getWorkspaceForFile(n);if(r.disableLanguageServices)return;const o=r.serviceInstance.getDefinitionForPosition(n,s,t);return o?o.map(e=>i.Location.create(u.convertPathToUri(e.path),e.range)):void 0}),this._connection.onReferences((e,t)=>{const n=u.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},r=this._workspaceMap.getWorkspaceForFile(n);if(r.disableLanguageServices)return;const o=r.serviceInstance.getReferencesForPosition(n,s,e.context.includeDeclaration,t);return o?o.map(e=>i.Location.create(u.convertPathToUri(e.path),e.range)):void 0}),this._connection.onDocumentSymbol((e,t)=>{this.recordUserInteractionTime();const n=u.convertUriToPath(e.textDocument.uri),s=this._workspaceMap.getWorkspaceForFile(n);if(s.disableLanguageServices)return;const r=[];return s.serviceInstance.addSymbolsForDocument(n,r,t),r}),this._connection.onWorkspaceSymbol((e,t)=>{const n=[];return this._workspaceMap.forEach(s=>{s.disableLanguageServices||s.serviceInstance.addSymbolsForWorkspace(n,e.query,t)}),n}),this._connection.onHover((e,t)=>{const n=u.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},r=this._workspaceMap.getWorkspaceForFile(n).serviceInstance.getHoverForPosition(n,s,t);return h.convertHoverResults(r)}),this._connection.onSignatureHelp((e,t)=>{const n=u.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},r=this._workspaceMap.getWorkspaceForFile(n);if(r.disableLanguageServices)return;const o=r.serviceInstance.getSignatureHelpForPosition(n,s,t);return o?{signatures:o.signatures.map(e=>{let t=[];return e.parameters&&(t=e.parameters.map(e=>i.ParameterInformation.create([e.startOffset,e.endOffset],e.documentation))),i.SignatureInformation.create(e.label,e.documentation,...t)}),activeSignature:void 0!==o.activeSignature?o.activeSignature:null,activeParameter:void 0!==o.activeParameter?o.activeParameter:-1}:void 0}),this._connection.onCompletion((e,t)=>{const n=u.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},r=this._workspaceMap.getWorkspaceForFile(n);if(r.disableLanguageServices)return;const i=r.serviceInstance.getCompletionsForPosition(n,s,r.rootPath,t);return i&&(i.isIncomplete=!0),i}),this._connection.onCompletionResolve((e,t)=>{const n=e.data;if(n){const s=this._workspaceMap.get(n.workspacePath);s&&n.filePath&&s.serviceInstance.resolveCompletionItem(n.filePath,e,t)}return e}),this._connection.onRenameRequest((e,t)=>{const n=u.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},r=this._workspaceMap.getWorkspaceForFile(n);if(r.disableLanguageServices)return;const i=r.serviceInstance.renameSymbolAtPosition(n,s,e.newName,t);if(!i)return;const o={changes:{}};return i.forEach(e=>{const t=u.convertPathToUri(e.filePath);void 0===o.changes[t]&&(o.changes[t]=[]);const n={range:e.range,newText:e.replacementText};o.changes[t].push(n)}),o}),this._connection.onDidOpenTextDocument(e=>{const t=u.convertUriToPath(e.textDocument.uri);this._workspaceMap.getWorkspaceForFile(t).serviceInstance.setFileOpened(t,e.textDocument.version,e.textDocument.text)}),this._connection.onDidChangeTextDocument(e=>{this.recordUserInteractionTime();const t=u.convertUriToPath(e.textDocument.uri);this._workspaceMap.getWorkspaceForFile(t).serviceInstance.updateOpenFileContents(t,e.textDocument.version,e.contentChanges[0].text)}),this._connection.onDidCloseTextDocument(e=>{const t=u.convertUriToPath(e.textDocument.uri);this._workspaceMap.getWorkspaceForFile(t).serviceInstance.setFileClosed(t)}),this._connection.onDidChangeWatchedFiles(e=>{e.changes.forEach(e=>{const t=u.convertUriToPath(e.uri),n=1===e.type?"add":"change";this._fileWatchers.forEach(e=>{e.workspacePaths.some(e=>u.containsPath(e,t))&&e.eventHandler(n,t)})})}),this._connection.onInitialized(()=>{this._connection.workspace.onDidChangeWorkspaceFolders(e=>{e.removed.forEach(e=>{const t=u.convertUriToPath(e.uri);this._workspaceMap.delete(t)}),e.added.forEach(e=>s(this,void 0,void 0,(function*(){const t=u.convertUriToPath(e.uri),n={workspaceName:e.name,rootPath:t,rootUri:e.uri,serviceInstance:this.createAnalyzerService(e.name),disableLanguageServices:!1,disableOrganizeImports:!1};this._workspaceMap.set(t,n),yield this.updateSettingsForWorkspace(n)})))}),this._hasWatchFileCapability&&this._connection.client.register(i.DidChangeWatchedFilesNotification.type,{watchers:[...a.configFileNames.map(e=>({globPattern:`**/${e}`,kind:i.WatchKind.Create|i.WatchKind.Change|i.WatchKind.Delete})),{globPattern:"**/*.{py,pyi,pyd}",kind:i.WatchKind.Create|i.WatchKind.Change|i.WatchKind.Delete}]})}),this._connection.onExecuteCommand((e,t)=>this.executeCommand(e,t))}updateSettingsForAllWorkspaces(){this._workspaceMap.forEach(e=>{this.updateSettingsForWorkspace(e).ignoreErrors()})}onAnalysisCompletedHandler(e){e.diagnostics.forEach(t=>{const n=this._convertDiagnostics(t.diagnostics);if(this._connection.sendDiagnostics({uri:u.convertPathToUri(t.filePath),diagnostics:n}),e.filesRequiringAnalysis>0){if(!e.checkingOnlyOpenFiles){this._isDisplayingProgress||(this._isDisplayingProgress=!0,this._connection.sendNotification("pyright/beginProgress"));const t=1!==e.filesRequiringAnalysis?"files":"file";this._connection.sendNotification("pyright/reportProgress",`${e.filesRequiringAnalysis} ${t} to analyze`)}}else this._isDisplayingProgress&&(this._isDisplayingProgress=!1,this._connection.sendNotification("pyright/endProgress"))})}updateSettingsForWorkspace(e){return s(this,void 0,void 0,(function*(){const t=yield this.getSettings(e);this.updateOptionsAndRestartService(e,t),e.disableLanguageServices=!!t.disableLanguageServices,e.disableOrganizeImports=!!t.disableOrganizeImports}))}updateOptionsAndRestartService(e,t,n){d.AnalyzerServiceExecutor.runWithOptions(this.rootPath,e,t,n)}_GetConnectionOptions(){return{cancellationStrategy:c.getCancellationStrategyFromArgv(process.argv)}}_convertDiagnostics(e){return e.map(e=>{const t=0===e.category?i.DiagnosticSeverity.Error:i.DiagnosticSeverity.Warning;let n=this._productName;const s=e.getRule();s&&(n=`${n} (${s})`);const r=i.Diagnostic.create(e.range,e.message,t,void 0,n);2===e.category&&(r.tags=[i.DiagnosticTag.Unnecessary],r.severity=i.DiagnosticSeverity.Hint);const o=e.getRelatedInfo();return o.length>0&&(r.relatedInformation=o.map(e=>i.DiagnosticRelatedInformation.create(i.Location.create(u.convertPathToUri(e.filePath),e.range),e.message))),r})}recordUserInteractionTime(){this._workspaceMap.forEach(e=>{e.serviceInstance.recordUserInteractionTime()})}}},function(e,t){Promise.prototype.ignoreErrors=function(){this.catch(()=>{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(127),r=n(11),i=n(26);t.createFromRealFileSystem=function(e,t){return new c(null!=t?t:new l(null!=e?e:new i.NullConsole))};const o="darwin"===process.platform,a="linux"===process.platform;class c{constructor(e){this._fileWatcherProvider=e}existsSync(e){return r.existsSync(e)}mkdirSync(e){r.mkdirSync(e)}chdir(e){process.chdir(e)}readdirSync(e){return r.readdirSync(e)}readFileSync(e,t=null){return r.readFileSync(e,{encoding:t})}writeFileSync(e,t,n){r.writeFileSync(e,t,{encoding:n})}statSync(e){return r.statSync(e)}unlinkSync(e){r.unlinkSync(e)}realpathSync(e){return r.realpathSync(e)}getModulePath(){return global.__rootDirectory}createFileSystemWatcher(e,t){return this._fileWatcherProvider.createFileWatcher(e,t)}}class l{constructor(e){this._console=e}createFileWatcher(e,t){return this._createFileSystemWatcher(e).on("all",t)}_createFileSystemWatcher(e){const t={ignoreInitial:!0,ignorePermissionErrors:!0,followSymlinks:!0,interval:1e3,binaryInterval:1e3,disableGlobbing:!0};o&&(t.usePolling=!1);const n=[];(o||a)&&e.some(e=>""===e||"/"===e)&&(n.push("/dev/**"),a&&n.push("/proc/**","/sys/**")),t.ignored=n;const r=s.watch(e,t);return r.on("error",e=>{this._console.log("Error returned from file system watcher.")}),o&&!r.options.useFsEvents&&this._console.log("Watcher could not use native fsevents library. File system watcher disabled."),r}}},function(e,t,n){"use strict";const{EventEmitter:s}=n(128),r=n(11),i=n(2),{promisify:o}=n(15),a=n(129),c=n(134).default,l=n(135),p=n(66),u=n(137),d=n(65),h=n(144),f=n(148),{EV_ALL:g,EV_READY:y,EV_ADD:m,EV_CHANGE:_,EV_UNLINK:T,EV_ADD_DIR:v,EV_UNLINK_DIR:b,EV_RAW:E,EV_ERROR:C,STR_CLOSE:k,STR_END:S,BACK_SLASH_RE:x,DOUBLE_SLASH_RE:w,SLASH_OR_BACK_SLASH_RE:I,DOT_RE:R,REPLACER_RE:F,SLASH:P,BRACE_START:A,BANG:N,ONE_DOT:D,TWO_DOTS:O,GLOBSTAR:M,SLASH_GLOBSTAR:L,ANYMATCH_OPTS:U,STRING_TYPE:$,FUNCTION_TYPE:q,EMPTY_STR:W,EMPTY_FN:V,isWindows:B,isMacos:j}=n(41),z=o(r.stat),H=o(r.readdir),G=(e=[])=>Array.isArray(e)?e:[e],K=(e,t=[])=>(e.forEach(e=>{Array.isArray(e)?K(e,t):t.push(e)}),t),Y=e=>{const t=K(G(e));if(!t.every(e=>typeof e===$))throw new TypeError(`Non-string provided as watch path: ${t}`);return t.map(X)},Q=e=>{let t=e.replace(x,P);for(;t.match(w);)t=t.replace(w,P);return t},X=e=>Q(i.normalize(Q(e))),J=(e=W)=>t=>typeof t!==$?t:X(i.isAbsolute(t)?t:i.join(e,t)),Z=(e,t)=>void 0===e[t];class ee{constructor(e,t){this.path=e,this._removeWatcher=t,this.items=new Set}add(e){const{items:t}=this;t&&e!==D&&e!==O&&t.add(e)}async remove(e){const{items:t}=this;if(t&&(t.delete(e),!t.size)){const e=this.path;try{await H(e)}catch(t){this._removeWatcher(i.dirname(e),i.basename(e))}}}has(e){const{items:t}=this;if(t)return t.has(e)}getChildren(){const{items:e}=this;if(e)return[...e.values()]}dispose(){this.items.clear(),delete this.path,delete this._removeWatcher,delete this.items,Object.freeze(this)}}class te{constructor(e,t,n,s){this.fsw=s,this.path=e=e.replace(F,W),this.watchPath=t,this.fullWatchPath=i.resolve(t),this.hasGlob=t!==e,e===W&&(this.hasGlob=!1),this.globSymlink=!(!this.hasGlob||!n)&&void 0,this.globFilter=!!this.hasGlob&&c(e,void 0,U),this.dirParts=this.getDirParts(e),this.dirParts.forEach(e=>{e.length>1&&e.pop()}),this.followSymlinks=n,this.statMethod=n?"stat":"lstat"}checkGlobSymlink(e){return void 0===this.globSymlink&&(this.globSymlink=e.fullParentDir!==this.fullWatchPath&&{realPath:e.fullParentDir,linkPath:this.fullWatchPath}),this.globSymlink?e.fullPath.replace(this.globSymlink.realPath,this.globSymlink.linkPath):e.fullPath}entryPath(e){return i.join(this.watchPath,i.relative(this.watchPath,this.checkGlobSymlink(e)))}filterPath(e){const{stats:t}=e;if(t&&t.isSymbolicLink())return this.filterDir(e);const n=this.entryPath(e);return(!this.hasGlob||typeof this.globFilter!==q||this.globFilter(n))&&this.fsw._isntIgnored(n,t)&&this.fsw._hasReadPermissions(t)}getDirParts(e){if(!this.hasGlob)return[];const t=[];return(e.includes(A)?u.expand(e):[e]).forEach(e=>{t.push(i.relative(this.watchPath,e).split(I))}),t}filterDir(e){if(this.hasGlob){const t=this.getDirParts(this.checkGlobSymlink(e));let n=!1;this.unmatchedGlob=!this.dirParts.some(e=>e.every((e,s)=>(e===M&&(n=!0),n||!t[0][s]||c(e,t[0][s],U))))}return!this.unmatchedGlob&&this.fsw._isntIgnored(this.entryPath(e),e.stats)}}class ne extends s{constructor(e){super();const t={};e&&Object.assign(t,e),this._watched=new Map,this._closers=new Map,this._ignoredPaths=new Set,this._throttled=new Map,this._symlinkPaths=new Map,this._streams=new Set,this.closed=!1,Z(t,"persistent")&&(t.persistent=!0),Z(t,"ignoreInitial")&&(t.ignoreInitial=!1),Z(t,"ignorePermissionErrors")&&(t.ignorePermissionErrors=!1),Z(t,"interval")&&(t.interval=100),Z(t,"binaryInterval")&&(t.binaryInterval=300),Z(t,"disableGlobbing")&&(t.disableGlobbing=!1),t.enableBinaryInterval=t.binaryInterval!==t.interval,Z(t,"useFsEvents")&&(t.useFsEvents=!t.usePolling),f.canUse()||(t.useFsEvents=!1),Z(t,"usePolling")&&!t.useFsEvents&&(t.usePolling=j);const n=process.env.CHOKIDAR_USEPOLLING;if(void 0!==n){const e=n.toLowerCase();t.usePolling="false"!==e&&"0"!==e&&("true"===e||"1"===e||!!e)}const s=process.env.CHOKIDAR_INTERVAL;s&&(t.interval=Number.parseInt(s,10)),Z(t,"atomic")&&(t.atomic=!t.usePolling&&!t.useFsEvents),t.atomic&&(this._pendingUnlinks=new Map),Z(t,"followSymlinks")&&(t.followSymlinks=!0),Z(t,"awaitWriteFinish")&&(t.awaitWriteFinish=!1),!0===t.awaitWriteFinish&&(t.awaitWriteFinish={});const r=t.awaitWriteFinish;r&&(r.stabilityThreshold||(r.stabilityThreshold=2e3),r.pollInterval||(r.pollInterval=100),this._pendingWrites=new Map),t.ignored&&(t.ignored=G(t.ignored));let i=0;this._emitReady=()=>{i++,i>=this._readyCount&&(this._emitReady=V,this._readyEmitted=!0,process.nextTick(()=>this.emit(y)))},this._emitRaw=(...e)=>this.emit(E,...e),this._readyEmitted=!1,this.options=t,t.useFsEvents?this._fsEventsHandler=new f(this):this._nodeFsHandler=new h(this),Object.freeze(t)}add(e,t,n){const{cwd:s,disableGlobbing:r}=this.options;this.closed=!1;let o=Y(e);return s&&(o=o.map(e=>{const t=((e,t)=>i.isAbsolute(e)?e:e.startsWith(N)?N+i.join(t,e.slice(1)):i.join(t,e))(e,s);return r||!p(e)?t:d(t)})),o=o.filter(e=>e.startsWith(N)?(this._ignoredPaths.add(e.slice(1)),!1):(this._ignoredPaths.delete(e),this._ignoredPaths.delete(e+L),this._userIgnored=void 0,!0)),this.options.useFsEvents&&this._fsEventsHandler?(this._readyCount||(this._readyCount=o.length),this.options.persistent&&(this._readyCount*=2),o.forEach(e=>this._fsEventsHandler._addToFsEvents(e))):(this._readyCount||(this._readyCount=0),this._readyCount+=o.length,Promise.all(o.map(async e=>{const s=await this._nodeFsHandler._addToNodeFs(e,!n,0,0,t);return s&&this._emitReady(),s})).then(e=>{this.closed||e.filter(e=>e).forEach(e=>{this.add(i.dirname(e),i.basename(t||e))})})),this}unwatch(e){if(this.closed)return this;const t=Y(e),{cwd:n}=this.options;return t.forEach(e=>{i.isAbsolute(e)||this._closers.has(e)||(n&&(e=i.join(n,e)),e=i.resolve(e)),this._closePath(e),this._ignoredPaths.add(e),this._watched.has(e)&&this._ignoredPaths.add(e+L),this._userIgnored=void 0}),this}close(){if(this.closed)return this;this.closed=!0,this.removeAllListeners();const e=[];return this._closers.forEach(t=>t.forEach(t=>{const n=t();n instanceof Promise&&e.push(n)})),this._streams.forEach(e=>e.destroy()),this._userIgnored=void 0,this._readyCount=0,this._readyEmitted=!1,this._watched.forEach(e=>e.dispose()),["closers","watched","streams","symlinkPaths","throttled"].forEach(e=>{this[`_${e}`].clear()}),e.length?Promise.all(e).then(()=>{}):Promise.resolve()}getWatched(){const e={};return this._watched.forEach((t,n)=>{const s=this.options.cwd?i.relative(this.options.cwd,n):n;e[s||D]=t.getChildren().sort()}),e}emitWithAll(e,t){this.emit(...t),e!==C&&this.emit(g,...t)}async _emit(e,t,n,s,r){if(this.closed)return;const o=this.options;B&&(t=i.normalize(t)),o.cwd&&(t=i.relative(o.cwd,t));const a=[e,t];void 0!==r?a.push(n,s,r):void 0!==s?a.push(n,s):void 0!==n&&a.push(n);const c=o.awaitWriteFinish;let l;if(c&&(l=this._pendingWrites.get(t)))return l.lastChange=new Date,this;if(o.atomic){if(e===T)return this._pendingUnlinks.set(t,a),setTimeout(()=>{this._pendingUnlinks.forEach((e,t)=>{this.emit(...e),this.emit(g,...e),this._pendingUnlinks.delete(t)})},"number"==typeof o.atomic?o.atomic:100),this;e===m&&this._pendingUnlinks.has(t)&&(e=a[0]=_,this._pendingUnlinks.delete(t))}if(c&&(e===m||e===_)&&this._readyEmitted){const n=(t,n)=>{t?(e=a[0]=C,a[1]=t,this.emitWithAll(e,a)):n&&(a.length>2?a[2]=n:a.push(n),this.emitWithAll(e,a))};return this._awaitWriteFinish(t,c.stabilityThreshold,e,n),this}if(e===_){if(!this._throttle(_,t,50))return this}if(!o.alwaysStat||void 0!==n||e!==m&&e!==v&&e!==_)this.emitWithAll(e,a);else{const n=o.cwd?i.join(o.cwd,t):t;try{const t=await z(n);if(!t)return;a.push(t),this.emitWithAll(e,a)}catch(e){}}return this}_handleError(e){const t=e&&e.code;return e&&"ENOENT"!==t&&"ENOTDIR"!==t&&(!this.options.ignorePermissionErrors||"EPERM"!==t&&"EACCES"!==t)&&this.emit(C,e),e||this.closed}_throttle(e,t,n){this._throttled.has(e)||this._throttled.set(e,new Map);const s=this._throttled.get(e),r=s.get(t);if(r)return r.count++,!1;let i;const o=()=>{const e=s.get(t),n=e?e.count:0;return s.delete(t),clearTimeout(i),e&&clearTimeout(e.timeoutObject),n};i=setTimeout(o,n);const a={timeoutObject:i,clear:o,count:0};return s.set(t,a),a}_incrReadyCount(){return this._readyCount++}_awaitWriteFinish(e,t,n,s){let o,a=e;this.options.cwd&&!i.isAbsolute(e)&&(a=i.join(this.options.cwd,e));const c=new Date,l=n=>{r.stat(a,(r,i)=>{if(r||!this._pendingWrites.has(e))return void(r&&"ENOENT"!==r.code&&s(r));const a=Number(new Date);n&&i.size!==n.size&&(this._pendingWrites.get(e).lastChange=a),a-this._pendingWrites.get(e).lastChange>=t?(this._pendingWrites.delete(e),s(void 0,i)):o=setTimeout(l,this.options.awaitWriteFinish.pollInterval,i)})};this._pendingWrites.has(e)||(this._pendingWrites.set(e,{lastChange:c,cancelWait:()=>(this._pendingWrites.delete(e),clearTimeout(o),n)}),o=setTimeout(l,this.options.awaitWriteFinish.pollInterval))}_getGlobIgnored(){return[...this._ignoredPaths.values()]}_isIgnored(e,t){if(this.options.atomic&&R.test(e))return!0;if(!this._userIgnored){const{cwd:e}=this.options,t=this.options.ignored,n=t&&t.map(J(e)),s=G(n).filter(e=>typeof e===$&&!p(e)).map(e=>e+L),r=this._getGlobIgnored().map(J(e)).concat(n,s);this._userIgnored=c(r,void 0,U)}return this._userIgnored([e,t])}_isntIgnored(e,t){return!this._isIgnored(e,t)}_getWatchHelpers(e,t){const n=t||this.options.disableGlobbing||!p(e)?e:l(e),s=this.options.followSymlinks;return new te(e,n,s,this)}_getWatchedDir(e){this._boundRemove||(this._boundRemove=this._remove.bind(this));const t=i.resolve(e);return this._watched.has(t)||this._watched.set(t,new ee(t,this._boundRemove)),this._watched.get(t)}_hasReadPermissions(e){if(this.options.ignorePermissionErrors)return!0;const t=511&(e&&Number.parseInt(e.mode,10)),n=Number.parseInt(t.toString(8)[0],10);return Boolean(4&n)}_remove(e,t){const n=i.join(e,t),s=i.resolve(n),r=this._watched.has(n)||this._watched.has(s);if(!this._throttle("remove",n,100))return;r||this.options.useFsEvents||1!==this._watched.size||this.add(e,t,!0),this._getWatchedDir(n).getChildren().forEach(e=>this._remove(n,e));const o=this._getWatchedDir(e),a=o.has(t);o.remove(t);let c=n;if(this.options.cwd&&(c=i.relative(this.options.cwd,n)),this.options.awaitWriteFinish&&this._pendingWrites.has(c)){if(this._pendingWrites.get(c).cancelWait()===m)return}this._watched.delete(n),this._watched.delete(s);const l=r?b:T;a&&!this._isIgnored(n)&&this._emit(l,n),this.options.useFsEvents||this._closePath(n)}_closePath(e){const t=this._closers.get(e);if(!t)return;t.forEach(e=>e()),this._closers.delete(e);const n=i.dirname(e);this._getWatchedDir(n).remove(i.basename(e))}_addPathCloser(e,t){if(!t)return;let n=this._closers.get(e);n||(n=[],this._closers.set(e,n)),n.push(t)}_readdirp(e,t){if(this.closed)return;const n={type:g,alwaysStat:!0,lstat:!0,...t};let s=a(e,n);return this._streams.add(s),s.once(k,()=>{s=void 0}),s.once(S,()=>{s&&(this._streams.delete(s),s=void 0)}),s}}t.FSWatcher=ne;t.watch=(e,t)=>{const n=new ne(t);return n.add(e),n}},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";const s=n(11),{Readable:r}=n(130),i=n(2),{promisify:o}=n(15),a=n(64),c=o(s.readdir),l=o(s.stat),p=o(s.lstat),u=new Set(["ENOENT","EPERM","EACCES","ELOOP"]),d="files",h="directories",f="files_directories",g="all",y=[d,h,f,g],m=e=>{if(void 0!==e){if("function"==typeof e)return e;if("string"==typeof e){const t=a(e.trim());return e=>t(e.basename)}if(Array.isArray(e)){const t=[],n=[];for(const s of e){const e=s.trim();"!"===e.charAt(0)?n.push(a(e.slice(1))):t.push(a(e))}return n.length>0?t.length>0?e=>t.some(t=>t(e.basename))&&!n.some(t=>t(e.basename)):e=>!n.some(t=>t(e.basename)):e=>t.some(t=>t(e.basename))}}};class _ extends r{static get defaultOptions(){return{root:".",fileFilter:e=>!0,directoryFilter:e=>!0,type:d,lstat:!1,depth:2147483648,alwaysStat:!1}}constructor(e={}){super({objectMode:!0,autoDestroy:!0,highWaterMark:e.highWaterMark||4096});const t={..._.defaultOptions,...e},{root:n,type:r}=t;this._fileFilter=m(t.fileFilter),this._directoryFilter=m(t.directoryFilter);const o=t.lstat?p:l;"win32"===process.platform&&3===l.length?this._stat=e=>o(e,{bigint:!0}):this._stat=o,this._maxDepth=t.depth,this._wantsDir=[h,f,g].includes(r),this._wantsFile=[d,f,g].includes(r),this._wantsEverything=r===g,this._root=i.resolve(n),this._isDirent="Dirent"in s&&!t.alwaysStat,this._statsProp=this._isDirent?"dirent":"stats",this._rdOptions={encoding:"utf8",withFileTypes:this._isDirent};try{this.parents=[this._exploreDir(n,1)]}catch(e){this.destroy(e)}this.reading=!1,this.parent=void 0}async _read(e){if(!this.reading){this.reading=!0;try{for(;!this.destroyed&&e>0;){const{path:t,depth:n,files:s=[]}=this.parent||{};if(s.length>0){const r=s.splice(0,e).map(e=>this._formatEntry(e,t));for(const t of await Promise.all(r))this._isDirAndMatchesFilter(t)?(n<=this._maxDepth&&this.parents.push(this._exploreDir(t.fullPath,n+1)),this._wantsDir&&(this.push(t),e--)):this._isFileAndMatchesFilter(t)&&this._wantsFile&&(this.push(t),e--)}else{const e=this.parents.pop();if(!e){this.push(null);break}this.parent=await e}}}catch(e){this.destroy(e)}finally{this.reading=!1}}}async _exploreDir(e,t){let n;try{n=await c(e,this._rdOptions)}catch(e){this._onError(e)}return{files:n,depth:t,path:e}}async _formatEntry(e,t){const n=this._isDirent?e.name:e,s=i.resolve(i.join(t,n)),r={path:i.relative(this._root,s),fullPath:s,basename:n};try{r[this._statsProp]=this._isDirent?e:await this._stat(s)}catch(e){this._onError(e)}return r}_onError(e){if(t=e,!u.has(t.code)||this.destroyed)throw e;var t;this.emit("warn",e)}_isDirAndMatchesFilter(e){const t=e&&e[this._statsProp];return t&&t.isDirectory()&&this._directoryFilter(e)}_isFileAndMatchesFilter(e){const t=e&&e[this._statsProp];return t&&(this._wantsEverything&&!t.isDirectory()||t.isFile()||t.isSymbolicLink())&&this._fileFilter(e)}}const T=(e,t={})=>{let n=t.entryType||t.type;if("both"===n&&(n=f),n&&(t.type=n),!e)throw new Error("readdirp: root argument is required. Usage: readdirp(root, options)");if("string"!=typeof e)throw new TypeError("readdirp: root argument must be a string. Usage: readdirp(root, options)");if(n&&!y.includes(n))throw new Error(`readdirp: Invalid type passed. Use one of ${y.join(", ")}`);return t.root=e,new _(t)};T.promise=(e,t={})=>new Promise((n,s)=>{const r=[];T(e,t).on("data",e=>r.push(e)).on("end",()=>n(r)).on("error",e=>s(e))}),T.ReaddirpStream=_,T.default=T,e.exports=T},function(e,t){e.exports=require("stream")},function(e,t,n){"use strict";const s=n(2),r=n(132),i=n(133),o=n(38),a=n(31),c=(e,t,n=!1)=>{if(Array.isArray(e)){const s=e.map(e=>c(e,t,n));return e=>{for(const t of s){const n=t(e);if(n)return n}return!1}}if("string"!=typeof e||""===e)throw new TypeError("Expected pattern to be a non-empty string");const s=t||{},r=o.isWindows(t),i=c.makeRe(e,t,!1,!0),a=i.state;delete i.state;let l=()=>!1;if(s.ignore){const e={...t,ignore:null,onMatch:null,onResult:null};l=c(s.ignore,e,n)}const p=(n,o=!1)=>{const{isMatch:p,match:u,output:d}=c.test(n,i,t,{glob:e,posix:r}),h={glob:e,state:a,regex:i,posix:r,input:n,output:d,match:u,isMatch:p};return"function"==typeof s.onResult&&s.onResult(h),!1===p?(h.isMatch=!1,!!o&&h):l(n)?("function"==typeof s.onIgnore&&s.onIgnore(h),h.isMatch=!1,!!o&&h):("function"==typeof s.onMatch&&s.onMatch(h),!o||h)};return n&&(p.state=a),p};c.test=(e,t,n,{glob:s,posix:r}={})=>{if("string"!=typeof e)throw new TypeError("Expected input to be a string");if(""===e)return{isMatch:!1,output:""};const i=n||{},a=i.format||(r?o.toPosixSlashes:null);let l=e===s,p=l&&a?a(e):e;return!1===l&&(p=a?a(e):e,l=p===s),!1!==l&&!0!==i.capture||(l=!0===i.matchBase||!0===i.basename?c.matchBase(e,t,n,r):t.exec(p)),{isMatch:!!l,match:l,output:p}},c.matchBase=(e,t,n,r=o.isWindows(n))=>(t instanceof RegExp?t:c.makeRe(t,n)).test(s.basename(e)),c.isMatch=(e,t,n)=>c(t,n)(e),c.parse=(e,t)=>i(e,t),c.scan=(e,t)=>r(e,t),c.makeRe=(e,t,n=!1,s=!1)=>{if(!e||"string"!=typeof e)throw new TypeError("Expected a non-empty string");const r=t||{},o=r.contains?"":"^",a=r.contains?"":"$";let l,p={negated:!1,fastpaths:!0},u="";if(e.startsWith("./")&&(e=e.slice(2),u=p.prefix="./"),!1===r.fastpaths||"."!==e[0]&&"*"!==e[0]||(l=i.fastpaths(e,t)),void 0===l&&(p=c.parse(e,t),p.prefix=u+(p.prefix||""),l=p.output),!0===n)return l;let d=`${o}(?:${l})${a}`;p&&!0===p.negated&&(d=`^(?!${d}).*$`);const h=c.toRegex(d,t);return!0===s&&(h.state=p),h},c.toRegex=(e,t)=>{try{const n=t||{};return new RegExp(e,n.flags||(n.nocase?"i":""))}catch(e){if(t&&!0===t.debug)throw e;return/$^/}},c.constants=a,e.exports=c},function(e,t,n){"use strict";const s=n(38),{CHAR_ASTERISK:r,CHAR_AT:i,CHAR_BACKWARD_SLASH:o,CHAR_COMMA:a,CHAR_DOT:c,CHAR_EXCLAMATION_MARK:l,CHAR_FORWARD_SLASH:p,CHAR_LEFT_CURLY_BRACE:u,CHAR_LEFT_PARENTHESES:d,CHAR_LEFT_SQUARE_BRACKET:h,CHAR_PLUS:f,CHAR_QUESTION_MARK:g,CHAR_RIGHT_CURLY_BRACE:y,CHAR_RIGHT_PARENTHESES:m,CHAR_RIGHT_SQUARE_BRACKET:_}=n(31);e.exports=(e,t)=>{const n=t||{},T=e.length-1;let v,b,E=-1,C=0,k=0,S=!1,x=!1,w=!1,I=0,R=!1;const F=()=>E>=T,P=()=>(v=b,e.charCodeAt(++E));for(;E<T;){let t;if(b=P(),b===o){x=!0,t=P(),t===u&&(R=!0);continue}if(!0===R||b===u)for(I++;!F()&&(t=P());)if(t!==o)if(t!==u){if(!R&&t===c&&(t=P())===c){S=!0;break}if(!R&&t===a){S=!0;break}if(t===y&&(I--,0===I)){R=!1;break}}else I++;else x=!0,t=P();if(b===p){if(v===c&&E===C+1){C+=2;continue}k=E+1;continue}if(b===r){S=!0;break}if(b===r||b===g){S=!0;break}if(b===h)for(;!F()&&(t=P());)if(t!==o){if(t===_){S=!0;break}}else x=!0,t=P();if((b===f||b===i||b===l)&&e.charCodeAt(E+1)===d){S=!0;break}if(n.nonegate||b!==l||E!==C){if(!0!==n.noparen&&b===d)for(;!F()&&(b=P());)if(b!==o){if(b===m){S=!0;break}}else x=!0,b=P();if(S)break}else w=!0,C++}!0===n.noext&&(S=!1);let A="";const N=e;let D=e,O="";return C>0&&(A=e.slice(0,C),e=e.slice(C),k-=C),D&&!0===S&&k>0?(D=e.slice(0,k),O=e.slice(k)):!0===S?(D="",O=e):D=e,D&&""!==D&&"/"!==D&&D!==e&&(e=>e===p||e===o)(D.charCodeAt(D.length-1))&&(D=D.slice(0,-1)),!0===n.unescape&&(O&&(O=s.removeBackslashes(O)),D&&!0===x&&(D=s.removeBackslashes(D))),{prefix:A,input:N,base:D,glob:O,negated:w,isGlob:S}}},function(e,t,n){"use strict";const s=n(31),r=n(38),{MAX_LENGTH:i,POSIX_REGEX_SOURCE:o,REGEX_NON_SPECIAL_CHARS:a,REGEX_SPECIAL_CHARS_BACKREF:c,REPLACEMENTS:l}=s,p=(e,t)=>{if("function"==typeof t.expandRange)return t.expandRange(...e,t);e.sort();const n=`[${e.join("-")}]`;try{new RegExp(n)}catch(t){return e.map(e=>r.escapeRegex(e)).join("..")}return n},u=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,d=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");e=l[e]||e;const n={...t},d="number"==typeof n.maxLength?Math.min(i,n.maxLength):i;let h=e.length;if(h>d)throw new SyntaxError(`Input length: ${h}, exceeds maximum allowed length: ${d}`);const f={type:"bos",value:"",output:n.prepend||""},g=[f],y=n.capture?"":"?:",m=r.isWindows(t),_=s.globChars(m),T=s.extglobChars(_),{DOT_LITERAL:v,PLUS_LITERAL:b,SLASH_LITERAL:E,ONE_CHAR:C,DOTS_SLASH:k,NO_DOT:S,NO_DOT_SLASH:x,NO_DOTS_SLASH:w,QMARK:I,QMARK_NO_DOT:R,STAR:F,START_ANCHOR:P}=_,A=e=>`(${y}(?:(?!${P}${e.dot?k:v}).)*?)`,N=n.dot?"":S,D=n.dot?I:R;let O=!0===n.bash?A(n):F;n.capture&&(O=`(${O})`),"boolean"==typeof n.noext&&(n.noextglob=n.noext);const M={input:e,index:-1,start:0,dot:!0===n.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,tokens:g};e=r.removePrefix(e,M),h=e.length;const L=[],U=[];let $,q=f;const W=()=>M.index===h-1,V=M.peek=(t=1)=>e[M.index+t],B=M.advance=()=>e[++M.index],j=()=>e.slice(M.index+1),z=(e="",t=0)=>{M.consumed+=e,M.index+=t},H=e=>{M.output+=null!=e.output?e.output:e.value,z(e.value)},G=()=>{let e=1;for(;"!"===V()&&("("!==V(2)||"?"===V(3));)B(),M.start++,e++;return e%2!=0&&(M.negated=!0,M.start++,!0)},K=e=>{M[e]++,U.push(e)},Y=e=>{M[e]--,U.pop()},Q=e=>{if("globstar"===q.type){const t=M.braces>0&&("comma"===e.type||"brace"===e.type),n=!0===e.extglob||L.length&&("pipe"===e.type||"paren"===e.type);"slash"===e.type||"paren"===e.type||t||n||(M.output=M.output.slice(0,-q.output.length),q.type="star",q.value="*",q.output=O,M.output+=q.output)}L.length&&"paren"!==e.type&&!T[e.value]&&(L[L.length-1].inner+=e.value),(e.value||e.output)&&H(e),q&&"text"===q.type&&"text"===e.type?q.value+=e.value:(e.prev=q,g.push(e),q=e)},X=(e,t)=>{const s={...T[t],conditions:1,inner:""};s.prev=q,s.parens=M.parens,s.output=M.output;const r=(n.capture?"(":"")+s.open;K("parens"),Q({type:e,value:t,output:M.output?"":C}),Q({type:"paren",extglob:!0,value:B(),output:r}),L.push(s)},J=e=>{let t=e.close+(n.capture?")":"");if("negate"===e.type){let s=O;e.inner&&e.inner.length>1&&e.inner.includes("/")&&(s=A(n)),(s!==O||W()||/^\)+$/.test(j()))&&(t=e.close=")$))"+s),"bos"===e.prev.type&&W()&&(M.negatedExtglob=!0)}Q({type:"paren",extglob:!0,value:$,output:t}),Y("parens")};if(!1!==n.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(e)){let s=!1,i=e.replace(c,(e,t,n,r,i,o)=>"\\"===r?(s=!0,e):"?"===r?t?t+r+(i?I.repeat(i.length):""):0===o?D+(i?I.repeat(i.length):""):I.repeat(n.length):"."===r?v.repeat(n.length):"*"===r?t?t+r+(i?O:""):O:t?e:"\\"+e);return!0===s&&(i=!0===n.unescape?i.replace(/\\/g,""):i.replace(/\\+/g,e=>e.length%2==0?"\\\\":e?"\\":"")),i===e&&!0===n.contains?(M.output=e,M):(M.output=r.wrapOutput(i,M,t),M)}for(;!W();){if($=B(),"\0"===$)continue;if("\\"===$){const e=V();if("/"===e&&!0!==n.bash)continue;if("."===e||";"===e)continue;if(!e){$+="\\",Q({type:"text",value:$});continue}const t=/^\\+/.exec(j());let s=0;if(t&&t[0].length>2&&(s=t[0].length,M.index+=s,s%2!=0&&($+="\\")),!0===n.unescape?$=B()||"":$+=B()||"",0===M.brackets){Q({type:"text",value:$});continue}}if(M.brackets>0&&("]"!==$||"["===q.value||"[^"===q.value)){if(!1!==n.posix&&":"===$){const e=q.value.slice(1);if(e.includes("[")&&(q.posix=!0,e.includes(":"))){const e=q.value.lastIndexOf("["),t=q.value.slice(0,e),n=q.value.slice(e+2),s=o[n];if(s){q.value=t+s,M.backtrack=!0,B(),f.output||1!==g.indexOf(q)||(f.output=C);continue}}}("["===$&&":"!==V()||"-"===$&&"]"===V())&&($="\\"+$),"]"!==$||"["!==q.value&&"[^"!==q.value||($="\\"+$),!0===n.posix&&"!"===$&&"["===q.value&&($="^"),q.value+=$,H({value:$});continue}if(1===M.quotes&&'"'!==$){$=r.escapeRegex($),q.value+=$,H({value:$});continue}if('"'===$){M.quotes=1===M.quotes?0:1,!0===n.keepQuotes&&Q({type:"text",value:$});continue}if("("===$){K("parens"),Q({type:"paren",value:$});continue}if(")"===$){if(0===M.parens&&!0===n.strictBrackets)throw new SyntaxError(u("opening","("));const e=L[L.length-1];if(e&&M.parens===e.parens+1){J(L.pop());continue}Q({type:"paren",value:$,output:M.parens?")":"\\)"}),Y("parens");continue}if("["===$){if(!0!==n.nobracket&&j().includes("]"))K("brackets");else{if(!0!==n.nobracket&&!0===n.strictBrackets)throw new SyntaxError(u("closing","]"));$="\\"+$}Q({type:"bracket",value:$});continue}if("]"===$){if(!0===n.nobracket||q&&"bracket"===q.type&&1===q.value.length){Q({type:"text",value:$,output:"\\"+$});continue}if(0===M.brackets){if(!0===n.strictBrackets)throw new SyntaxError(u("opening","["));Q({type:"text",value:$,output:"\\"+$});continue}Y("brackets");const e=q.value.slice(1);if(!0===q.posix||"^"!==e[0]||e.includes("/")||($="/"+$),q.value+=$,H({value:$}),!1===n.literalBrackets||r.hasRegexChars(e))continue;const t=r.escapeRegex(q.value);if(M.output=M.output.slice(0,-q.value.length),!0===n.literalBrackets){M.output+=t,q.value=t;continue}q.value=`(${y}${t}|${q.value})`,M.output+=q.value;continue}if("{"===$&&!0!==n.nobrace){K("braces"),Q({type:"brace",value:$,output:"("});continue}if("}"===$){if(!0===n.nobrace||0===M.braces){Q({type:"text",value:$,output:$});continue}let e=")";if(!0===M.dots){const t=g.slice(),s=[];for(let e=t.length-1;e>=0&&(g.pop(),"brace"!==t[e].type);e--)"dots"!==t[e].type&&s.unshift(t[e].value);e=p(s,n),M.backtrack=!0}Q({type:"brace",value:$,output:e}),Y("braces");continue}if("|"===$){L.length>0&&L[L.length-1].conditions++,Q({type:"text",value:$});continue}if(","===$){let e=$;M.braces>0&&"braces"===U[U.length-1]&&(e="|"),Q({type:"comma",value:$,output:e});continue}if("/"===$){if("dot"===q.type&&M.index===M.start+1){M.start=M.index+1,M.consumed="",M.output="",g.pop(),q=f;continue}Q({type:"slash",value:$,output:E});continue}if("."===$){if(M.braces>0&&"dot"===q.type){"."===q.value&&(q.output=v),q.type="dots",q.output+=$,q.value+=$,M.dots=!0;continue}if(M.braces+M.parens===0&&"bos"!==q.type&&"slash"!==q.type){Q({type:"text",value:$,output:v});continue}Q({type:"dot",value:$,output:v});continue}if("?"===$){if(!(q&&"("===q.value)&&!0!==n.noextglob&&"("===V()&&"?"!==V(2)){X("qmark",$);continue}if(q&&"paren"===q.type){const e=V();let t=$;if("<"===e&&!r.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===q.value&&!/[!=<:]/.test(e)||"<"===e&&!/<([!=]|\w+>)/.test(j()))&&(t="\\"+$),Q({type:"text",value:$,output:t});continue}if(!0!==n.dot&&("slash"===q.type||"bos"===q.type)){Q({type:"qmark",value:$,output:R});continue}Q({type:"qmark",value:$,output:I});continue}if("!"===$){if(!0!==n.noextglob&&"("===V()&&("?"!==V(2)||!/[!=<:]/.test(V(3)))){X("negate",$);continue}if(!0!==n.nonegate&&0===M.index){G();continue}}if("+"===$){if(!0!==n.noextglob&&"("===V()&&"?"!==V(2)){X("plus",$);continue}if(q&&"("===q.value||!1===n.regex){Q({type:"plus",value:$,output:b});continue}if(q&&("bracket"===q.type||"paren"===q.type||"brace"===q.type)||M.parens>0){Q({type:"plus",value:$});continue}Q({type:"plus",value:b});continue}if("@"===$){if(!0!==n.noextglob&&"("===V()&&"?"!==V(2)){Q({type:"at",extglob:!0,value:$,output:""});continue}Q({type:"text",value:$});continue}if("*"!==$){"$"!==$&&"^"!==$||($="\\"+$);const e=a.exec(j());e&&($+=e[0],M.index+=e[0].length),Q({type:"text",value:$});continue}if(q&&("globstar"===q.type||!0===q.star)){q.type="star",q.star=!0,q.value+=$,q.output=O,M.backtrack=!0,z($);continue}let t=j();if(!0!==n.noextglob&&/^\([^?]/.test(t)){X("star",$);continue}if("star"===q.type){if(!0===n.noglobstar){z($);continue}const s=q.prev,r=s.prev,i="slash"===s.type||"bos"===s.type,o=r&&("star"===r.type||"globstar"===r.type);if(!0===n.bash&&(!i||t[0]&&"/"!==t[0])){Q({type:"star",value:$,output:""});continue}const a=M.braces>0&&("comma"===s.type||"brace"===s.type),c=L.length&&("pipe"===s.type||"paren"===s.type);if(!i&&"paren"!==s.type&&!a&&!c){Q({type:"star",value:$,output:""});continue}for(;"/**"===t.slice(0,3);){const n=e[M.index+4];if(n&&"/"!==n)break;t=t.slice(3),z("/**",3)}if("bos"===s.type&&W()){q.type="globstar",q.value+=$,q.output=A(n),M.output=q.output,z($);continue}if("slash"===s.type&&"bos"!==s.prev.type&&!o&&W()){M.output=M.output.slice(0,-(s.output+q.output).length),s.output="(?:"+s.output,q.type="globstar",q.output=A(n)+(n.strictSlashes?")":"|$)"),q.value+=$,M.output+=s.output+q.output,z($);continue}if("slash"===s.type&&"bos"!==s.prev.type&&"/"===t[0]){const e=void 0!==t[1]?"|$":"";M.output=M.output.slice(0,-(s.output+q.output).length),s.output="(?:"+s.output,q.type="globstar",q.output=`${A(n)}${E}|${E}${e})`,q.value+=$,M.output+=s.output+q.output,z($+B()),Q({type:"slash",value:$,output:""});continue}if("bos"===s.type&&"/"===t[0]){q.type="globstar",q.value+=$,q.output=`(?:^|${E}|${A(n)}${E})`,M.output=q.output,z($+B()),Q({type:"slash",value:$,output:""});continue}M.output=M.output.slice(0,-q.output.length),q.type="globstar",q.output=A(n),q.value+=$,M.output+=q.output,z($);continue}const s={type:"star",value:$,output:O};!0!==n.bash?!q||"bracket"!==q.type&&"paren"!==q.type||!0!==n.regex?(M.index!==M.start&&"slash"!==q.type&&"dot"!==q.type||("dot"===q.type?(M.output+=x,q.output+=x):!0===n.dot?(M.output+=w,q.output+=w):(M.output+=N,q.output+=N),"*"!==V()&&(M.output+=C,q.output+=C)),Q(s)):(s.output=$,Q(s)):(s.output=".*?","bos"!==q.type&&"slash"!==q.type||(s.output=N+s.output),Q(s))}for(;M.brackets>0;){if(!0===n.strictBrackets)throw new SyntaxError(u("closing","]"));M.output=r.escapeLast(M.output,"["),Y("brackets")}for(;M.parens>0;){if(!0===n.strictBrackets)throw new SyntaxError(u("closing",")"));M.output=r.escapeLast(M.output,"("),Y("parens")}for(;M.braces>0;){if(!0===n.strictBrackets)throw new SyntaxError(u("closing","}"));M.output=r.escapeLast(M.output,"{"),Y("braces")}if(!0===n.strictSlashes||"star"!==q.type&&"bracket"!==q.type||Q({type:"maybe_slash",value:"",output:`${E}?`}),!0===M.backtrack){M.output="";for(const e of M.tokens)M.output+=null!=e.output?e.output:e.value,e.suffix&&(M.output+=e.suffix)}return M};d.fastpaths=(e,t)=>{const n={...t},o="number"==typeof n.maxLength?Math.min(i,n.maxLength):i,a=e.length;if(a>o)throw new SyntaxError(`Input length: ${a}, exceeds maximum allowed length: ${o}`);e=l[e]||e;const c=r.isWindows(t),{DOT_LITERAL:p,SLASH_LITERAL:u,ONE_CHAR:d,DOTS_SLASH:h,NO_DOT:f,NO_DOTS:g,NO_DOTS_SLASH:y,STAR:m,START_ANCHOR:_}=s.globChars(c),T=n.dot?g:f,v=n.dot?y:f,b=n.capture?"":"?:";let E=!0===n.bash?".*?":m;n.capture&&(E=`(${E})`);const C=e=>!0===e.noglobstar?E:`(${b}(?:(?!${_}${e.dot?h:p}).)*?)`,k=e=>{switch(e){case"*":return`${T}${d}${E}`;case".*":return`${p}${d}${E}`;case"*.*":return`${T}${E}${p}${d}${E}`;case"*/*":return`${T}${E}${u}${d}${v}${E}`;case"**":return T+C(n);case"**/*":return`(?:${T}${C(n)}${u})?${v}${d}${E}`;case"**/*.*":return`(?:${T}${C(n)}${u})?${v}${E}${p}${d}${E}`;case"**/.*":return`(?:${T}${C(n)}${u})?${p}${d}${E}`;default:{const n=/^(.*?)\.(\w+)$/.exec(e);if(!n)return;const s=k(n[1],t);if(!s)return;return s+p+n[2]}}},S=r.removePrefix(e,{negated:!1,prefix:""});let x=k(S);return x&&!0!==n.strictSlashes&&(x+=`${u}?`),x},e.exports=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(64),r=n(65),i={returnIndex:!1},o=(e,t,n,s)=>{const i=Array.isArray(n),o=i?n[0]:n;if(!i&&"string"!=typeof o)throw new TypeError("anymatch: second argument must be a string: got "+Object.prototype.toString.call(o));const a=r(o);for(let e=0;e<t.length;e++){if((0,t[e])(a))return!!s&&-1}const c=i&&[a].concat(n.slice(1));for(let t=0;t<e.length;t++){const n=e[t];if(i?n(...c):n(a))return!s||t}return!!s&&-1},a=(e,t,n=i)=>{if(null==e)throw new TypeError("anymatch: specify first argument");const r="boolean"==typeof n?{returnIndex:n}:n,a=r.returnIndex||!1,c=(l=e,Array.isArray(l)?l:[l]);var l;const p=c.filter(e=>"string"==typeof e&&"!"===e.charAt(0)).map(e=>e.slice(1)).map(e=>s(e,r)),u=c.map(e=>((e,t)=>{if("function"==typeof e)return e;if("string"==typeof e){const n=s(e,t);return t=>e===t||n(t)}return e instanceof RegExp?t=>e.test(t):e=>!1})(e,r));return null==t?(e,t=!1)=>o(u,p,e,"boolean"==typeof t&&t):o(u,p,t,a)};a.default=a,e.exports=a},function(e,t,n){"use strict";var s=n(66),r=n(2).posix.dirname,i="win32"===n(34).platform(),o=/\\/g,a=/[\{\[].*[\/]*.*[\}\]]$/,c=/(^|[^\\])([\{\[]|\([^\)]+$)/,l=/\\([\*\?\|\[\]\(\)\{\}])/g;e.exports=function(e,t){Object.assign({flipBackslashes:!0},t).flipBackslashes&&i&&e.indexOf("/")<0&&(e=e.replace(o,"/")),a.test(e)&&(e+="/"),e+="a";do{e=r(e)}while(s(e)||c.test(e));return e.replace(l,"$1")}},function(e,t){
/*!
 * is-extglob <https://github.com/jonschlinkert/is-extglob>
 *
 * Copyright (c) 2014-2016, Jon Schlinkert.
 * Licensed under the MIT License.
 */
e.exports=function(e){if("string"!=typeof e||""===e)return!1;for(var t;t=/(\\).|([@?!+*]\(.*\))/g.exec(e);){if(t[2])return!0;e=e.slice(t.index+t[0].length)}return!1}},function(e,t,n){"use strict";const s=n(39),r=n(138),i=n(141),o=n(142),a=(e,t={})=>{let n=[];if(Array.isArray(e))for(let s of e){let e=a.create(s,t);Array.isArray(e)?n.push(...e):n.push(e)}else n=[].concat(a.create(e,t));return t&&!0===t.expand&&!0===t.nodupes&&(n=[...new Set(n)]),n};a.parse=(e,t={})=>o(e,t),a.stringify=(e,t={})=>s("string"==typeof e?a.parse(e,t):e,t),a.compile=(e,t={})=>("string"==typeof e&&(e=a.parse(e,t)),r(e,t)),a.expand=(e,t={})=>{"string"==typeof e&&(e=a.parse(e,t));let n=i(e,t);return!0===t.noempty&&(n=n.filter(Boolean)),!0===t.nodupes&&(n=[...new Set(n)]),n},a.create=(e,t={})=>""===e||e.length<3?[e]:!0!==t.expand?a.compile(e,t):a.expand(e,t),e.exports=a},function(e,t,n){"use strict";const s=n(67),r=n(40);e.exports=(e,t={})=>{let n=(e,i={})=>{let o=r.isInvalidBrace(i),a=!0===e.invalid&&!0===t.escapeInvalid,c=!0===o||!0===a,l=!0===t.escapeInvalid?"\\":"",p="";if(!0===e.isOpen)return l+e.value;if(!0===e.isClose)return l+e.value;if("open"===e.type)return c?l+e.value:"(";if("close"===e.type)return c?l+e.value:")";if("comma"===e.type)return"comma"===e.prev.type?"":c?e.value:"|";if(e.value)return e.value;if(e.nodes&&e.ranges>0){let n=r.reduce(e.nodes),i=s(...n,{...t,wrap:!1,toRegex:!0});if(0!==i.length)return n.length>1&&i.length>1?`(${i})`:i}if(e.nodes)for(let t of e.nodes)p+=n(t,e);return p};return n(e)}},function(e,t,n){"use strict";
/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const s=n(140),r=(e,t,n)=>{if(!1===s(e))throw new TypeError("toRegexRange: expected the first argument to be a number");if(void 0===t||e===t)return String(e);if(!1===s(t))throw new TypeError("toRegexRange: expected the second argument to be a number.");let i={relaxZeros:!0,...n};"boolean"==typeof i.strictZeros&&(i.relaxZeros=!1===i.strictZeros);let c=e+":"+t+"="+String(i.relaxZeros)+String(i.shorthand)+String(i.capture)+String(i.wrap);if(r.cache.hasOwnProperty(c))return r.cache[c].result;let l=Math.min(e,t),p=Math.max(e,t);if(1===Math.abs(l-p)){let n=e+"|"+t;return i.capture?`(${n})`:!1===i.wrap?n:`(?:${n})`}let u=f(e)||f(t),d={min:e,max:t,a:l,b:p},h=[],g=[];if(u&&(d.isPadded=u,d.maxLen=String(d.max).length),l<0){g=o(p<0?Math.abs(p):1,Math.abs(l),d,i),l=d.a=0}return p>=0&&(h=o(l,p,d,i)),d.negatives=g,d.positives=h,d.result=function(e,t,n){let s=a(e,t,"-",!1,n)||[],r=a(t,e,"",!1,n)||[],i=a(e,t,"-?",!0,n)||[];return s.concat(i).concat(r).join("|")}(g,h,i),!0===i.capture?d.result=`(${d.result})`:!1!==i.wrap&&h.length+g.length>1&&(d.result=`(?:${d.result})`),r.cache[c]=d,d.result};function i(e,t,n){if(e===t)return{pattern:e,count:[],digits:0};let s=function(e,t){let n=[];for(let s=0;s<e.length;s++)n.push([e[s],t[s]]);return n}(e,t),r=s.length,i="",o=0;for(let e=0;e<r;e++){let[t,r]=s[e];t===r?i+=t:"0"!==t||"9"!==r?i+=h(t,r,n):o++}return o&&(i+=!0===n.shorthand?"\\d":"[0-9]"),{pattern:i,count:[o],digits:r}}function o(e,t,n,s){let r,o=function(e,t){let n=1,s=1,r=p(e,n),i=new Set([t]);for(;e<=r&&r<=t;)i.add(r),n+=1,r=p(e,n);for(r=u(t+1,s)-1;e<r&&r<=t;)i.add(r),s+=1,r=u(t+1,s)-1;return i=[...i],i.sort(c),i}(e,t),a=[],l=e;for(let e=0;e<o.length;e++){let t=o[e],c=i(String(l),String(t),s),p="";n.isPadded||!r||r.pattern!==c.pattern?(n.isPadded&&(p=g(t,n,s)),c.string=p+c.pattern+d(c.count),a.push(c),l=t+1,r=c):(r.count.length>1&&r.count.pop(),r.count.push(c.count[0]),r.string=r.pattern+d(r.count),l=t+1)}return a}function a(e,t,n,s,r){let i=[];for(let r of e){let{string:e}=r;s||l(t,"string",e)||i.push(n+e),s&&l(t,"string",e)&&i.push(n+e)}return i}function c(e,t){return e>t?1:t>e?-1:0}function l(e,t,n){return e.some(e=>e[t]===n)}function p(e,t){return Number(String(e).slice(0,-t)+"9".repeat(t))}function u(e,t){return e-e%Math.pow(10,t)}function d(e){let[t=0,n=""]=e;return n||t>1?`{${t+(n?","+n:"")}}`:""}function h(e,t,n){return`[${e}${t-e==1?"":"-"}${t}]`}function f(e){return/^-?(0+)\d/.test(e)}function g(e,t,n){if(!t.isPadded)return e;let s=Math.abs(t.maxLen-String(e).length),r=!1!==n.relaxZeros;switch(s){case 0:return"";case 1:return r?"0?":"0";case 2:return r?"0{0,2}":"00";default:return r?`0{0,${s}}`:`0{${s}}`}}r.cache={},r.clearCache=()=>r.cache={},e.exports=r},function(e,t,n){"use strict";
/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */e.exports=function(e){return"number"==typeof e?e-e==0:"string"==typeof e&&""!==e.trim()&&(Number.isFinite?Number.isFinite(+e):isFinite(+e))}},function(e,t,n){"use strict";const s=n(67),r=n(39),i=n(40),o=(e="",t="",n=!1)=>{let s=[];if(e=[].concat(e),!(t=[].concat(t)).length)return e;if(!e.length)return n?i.flatten(t).map(e=>`{${e}}`):t;for(let r of e)if(Array.isArray(r))for(let e of r)s.push(o(e,t,n));else for(let e of t)!0===n&&"string"==typeof e&&(e=`{${e}}`),s.push(Array.isArray(e)?o(r,e,n):r+e);return i.flatten(s)};e.exports=(e,t={})=>{let n=void 0===t.rangeLimit?1e3:t.rangeLimit,a=(e,c={})=>{e.queue=[];let l=c,p=c.queue;for(;"brace"!==l.type&&"root"!==l.type&&l.parent;)l=l.parent,p=l.queue;if(e.invalid||e.dollar)return void p.push(o(p.pop(),r(e,t)));if("brace"===e.type&&!0!==e.invalid&&2===e.nodes.length)return void p.push(o(p.pop(),["{}"]));if(e.nodes&&e.ranges>0){let a=i.reduce(e.nodes);if(i.exceedsLimit(...a,t.step,n))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let c=s(...a,t);return 0===c.length&&(c=r(e,t)),p.push(o(p.pop(),c)),void(e.nodes=[])}let u=i.encloseBrace(e),d=e.queue,h=e;for(;"brace"!==h.type&&"root"!==h.type&&h.parent;)h=h.parent,d=h.queue;for(let t=0;t<e.nodes.length;t++){let n=e.nodes[t];"comma"!==n.type||"brace"!==e.type?"close"!==n.type?n.value&&"open"!==n.type?d.push(o(d.pop(),n.value)):n.nodes&&a(n,e):p.push(o(p.pop(),d,u)):(1===t&&d.push(""),d.push(""))}return d};return i.flatten(a(e))}},function(e,t,n){"use strict";const s=n(39),{MAX_LENGTH:r,CHAR_BACKSLASH:i,CHAR_BACKTICK:o,CHAR_COMMA:a,CHAR_DOT:c,CHAR_LEFT_PARENTHESES:l,CHAR_RIGHT_PARENTHESES:p,CHAR_LEFT_CURLY_BRACE:u,CHAR_RIGHT_CURLY_BRACE:d,CHAR_LEFT_SQUARE_BRACKET:h,CHAR_RIGHT_SQUARE_BRACKET:f,CHAR_DOUBLE_QUOTE:g,CHAR_SINGLE_QUOTE:y,CHAR_NO_BREAK_SPACE:m,CHAR_ZERO_WIDTH_NOBREAK_SPACE:_}=n(143);e.exports=(e,t={})=>{if("string"!=typeof e)throw new TypeError("Expected a string");let n=t||{},T="number"==typeof n.maxLength?Math.min(r,n.maxLength):r;if(e.length>T)throw new SyntaxError(`Input length (${e.length}), exceeds max characters (${T})`);let v,b={type:"root",input:e,nodes:[]},E=[b],C=b,k=b,S=0,x=e.length,w=0,I=0;const R=()=>e[w++],F=e=>{if("text"===e.type&&"dot"===k.type&&(k.type="text"),!k||"text"!==k.type||"text"!==e.type)return C.nodes.push(e),e.parent=C,e.prev=k,k=e,e;k.value+=e.value};for(F({type:"bos"});w<x;)if(C=E[E.length-1],v=R(),v!==_&&v!==m)if(v!==i)if(v!==f)if(v!==h)if(v!==l)if(v!==p)if(v!==g&&v!==y&&v!==o)if(v!==u)if(v!==d)if(v===a&&I>0){if(C.ranges>0){C.ranges=0;let e=C.nodes.shift();C.nodes=[e,{type:"text",value:s(C)}]}F({type:"comma",value:v}),C.commas++}else if(v===c&&I>0&&0===C.commas){let e=C.nodes;if(0===I||0===e.length){F({type:"text",value:v});continue}if("dot"===k.type){if(C.range=[],k.value+=v,k.type="range",3!==C.nodes.length&&5!==C.nodes.length){C.invalid=!0,C.ranges=0,k.type="text";continue}C.ranges++,C.args=[];continue}if("range"===k.type){e.pop();let t=e[e.length-1];t.value+=k.value+v,k=t,C.ranges--;continue}F({type:"dot",value:v})}else F({type:"text",value:v});else{if("brace"!==C.type){F({type:"text",value:v});continue}let e="close";C=E.pop(),C.close=!0,F({type:e,value:v}),I--,C=E[E.length-1]}else{I++;let e=k.value&&"$"===k.value.slice(-1)||!0===C.dollar;C=F({type:"brace",open:!0,close:!1,dollar:e,depth:I,commas:0,ranges:0,nodes:[]}),E.push(C),F({type:"open",value:v})}else{let e,n=v;for(!0!==t.keepQuotes&&(v="");w<x&&(e=R());)if(e!==i){if(e===n){!0===t.keepQuotes&&(v+=e);break}v+=e}else v+=e+R();F({type:"text",value:v})}else{if("paren"!==C.type){F({type:"text",value:v});continue}C=E.pop(),F({type:"text",value:v}),C=E[E.length-1]}else C=F({type:"paren",nodes:[]}),E.push(C),F({type:"text",value:v});else{S++;let e;for(;w<x&&(e=R());)if(v+=e,e!==h)if(e!==i){if(e===f&&(S--,0===S))break}else v+=R();else S++;F({type:"text",value:v})}else F({type:"text",value:"\\"+v});else F({type:"text",value:(t.keepEscaping?v:"")+R()});do{if(C=E.pop(),"root"!==C.type){C.nodes.forEach(e=>{e.nodes||("open"===e.type&&(e.isOpen=!0),"close"===e.type&&(e.isClose=!0),e.nodes||(e.type="text"),e.invalid=!0)});let e=E[E.length-1],t=e.nodes.indexOf(C);e.nodes.splice(t,1,...C.nodes)}}while(E.length>0);return F({type:"eos"}),b}},function(e,t,n){"use strict";e.exports={MAX_LENGTH:65536,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:"\n",CHAR_NO_BREAK_SPACE:"",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"\t",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\ufeff"}},function(e,t,n){"use strict";const s=n(11),r=n(2),{promisify:i}=n(15),o=n(145),{isWindows:a,EMPTY_FN:c,EMPTY_STR:l,KEY_LISTENERS:p,KEY_ERR:u,KEY_RAW:d,HANDLER_KEYS:h,EV_CHANGE:f,EV_ADD:g,EV_ADD_DIR:y,EV_ERROR:m,STR_DATA:_,STR_END:T,BRACE_START:v,STAR:b}=n(41),E=i(s.open),C=i(s.stat),k=i(s.lstat),S=i(s.close),x=i(s.realpath),w={lstat:k,stat:C},I=(e,t)=>{e instanceof Set?e.forEach(t):t(e)},R=(e,t,n)=>{let s=e[t];s instanceof Set||(e[t]=s=new Set([s])),s.add(n)},F=(e,t,n)=>{const s=e[t];s instanceof Set?s.delete(n):s===n&&delete e[t]},P=e=>e instanceof Set?0===e.size:!e,A=new Map;function N(e,t,n,i,o){const a=(t,s)=>{n(e),o(t,s,{watchedPath:e}),s&&e!==s&&D(r.resolve(e,s),p,r.join(e,s))};try{return s.watch(e,t,a)}catch(e){i(e)}}const D=(e,t,n,s,r)=>{const i=A.get(e);i&&I(i[t],e=>{e(n,s,r)})},O=(e,t,n,s)=>{const{listener:r,errHandler:i,rawEmitter:o}=s;let c,l=A.get(t);if(!n.persistent)return c=N(e,n,r,i,o),c.close.bind(c);if(l)R(l,p,r),R(l,u,i),R(l,d,o);else{if(c=N(e,n,D.bind(null,t,p),i,D.bind(null,t,d)),!c)return;c.on(m,async n=>{const s=D.bind(null,t,u);if(l.watcherUnusable=!0,a&&"EPERM"===n.code)try{const t=await E(e,"r");await S(t),s(n)}catch(e){}else s(n)}),l={listeners:r,errHandlers:i,rawEmitters:o,watcher:c},A.set(t,l)}return()=>{F(l,p,r),F(l,u,i),F(l,d,o),P(l.listeners)&&(l.watcher.close(),A.delete(t),h.forEach((e=>t=>{const n=e[t];n instanceof Set?n.clear():delete e[t]})(l)),l.watcher=void 0,Object.freeze(l))}},M=new Map;e.exports=class{constructor(e){this.fsw=e,this._boundHandleError=t=>e._handleError(t)}_watchWithNodeFs(e,t){const n=this.fsw.options,i=r.dirname(e),a=r.basename(e);this.fsw._getWatchedDir(i).add(a);const l=r.resolve(e),u={persistent:n.persistent};let h;return t||(t=c),n.usePolling?(u.interval=n.enableBinaryInterval&&o(a)?n.binaryInterval:n.interval,h=((e,t,n,r)=>{const{listener:i,rawEmitter:o}=r;let a=M.get(t),c=new Set,l=new Set;const u=a&&a.options;return u&&(u.persistent<n.persistent||u.interval>n.interval)&&(c=a.listeners,l=a.rawEmitters,s.unwatchFile(t),a=void 0),a?(R(a,p,i),R(a,d,o)):(a={listeners:i,rawEmitters:o,options:n,watcher:s.watchFile(t,n,(n,s)=>{I(a.rawEmitters,e=>{e(f,t,{curr:n,prev:s})});const r=n.mtimeMs;(n.size!==s.size||r>s.mtimeMs||0===r)&&I(a.listeners,t=>t(e,n))})},M.set(t,a)),()=>{F(a,p,i),F(a,d,o),P(a.listeners)&&(M.delete(t),s.unwatchFile(t),a.options=a.watcher=void 0,Object.freeze(a))}})(e,l,u,{listener:t,rawEmitter:this.fsw._emitRaw})):h=O(e,l,u,{listener:t,errHandler:this._boundHandleError,rawEmitter:this.fsw._emitRaw}),h}_handleFile(e,t,n){if(this.fsw.closed)return;const s=r.dirname(e),i=r.basename(e),o=this.fsw._getWatchedDir(s);let a=t;if(o.has(i))return;const c=this._watchWithNodeFs(e,async(t,n)=>{if(this.fsw._throttle("watch",e,5))if(n&&0!==n.mtimeMs){if(o.has(i)){const t=n.atimeMs,s=n.mtimeMs;(!t||t<=s||s!==a.mtimeMs)&&this.fsw._emit(f,e,n),a=n}}else try{const t=await C(e);if(this.fsw.closed)return;const n=t.atimeMs,s=t.mtimeMs;(!n||n<=s||s!==a.mtimeMs)&&this.fsw._emit(f,e,t),a=t}catch(e){this.fsw._remove(s,i)}});if((!n||!this.fsw.options.ignoreInitial)&&this.fsw._isntIgnored(e)){if(!this.fsw._throttle(g,e,0))return;this.fsw._emit(g,e,t)}return c}async _handleSymlink(e,t,n,s){if(this.fsw.closed)return;const r=e.fullPath,i=this.fsw._getWatchedDir(t);if(!this.fsw.options.followSymlinks){this.fsw._incrReadyCount();const t=await x(n);if(this.fsw.closed)return;return i.has(s)?this.fsw._symlinkPaths.get(r)!==t&&(this.fsw._symlinkPaths.set(r,t),this.fsw._emit(f,n,e.stats)):(i.add(s),this.fsw._symlinkPaths.set(r,t),this.fsw._emit(g,n,e.stats)),this.fsw._emitReady(),!0}if(this.fsw._symlinkPaths.has(r))return!0;this.fsw._symlinkPaths.set(r,!0)}_handleRead(e,t,n,s,i,o,a){if(e=r.join(e,l),!n.hasGlob&&!(a=this.fsw._throttle("readdir",e,1e3)))return;const c=this.fsw._getWatchedDir(n.path),p=new Set;let u=this.fsw._readdirp(e,{fileFilter:e=>n.filterPath(e),directoryFilter:e=>n.filterDir(e),depth:0}).on(_,async a=>{if(this.fsw.closed)return void(u=void 0);const l=a.path;let d=r.join(e,l);p.add(l),a.stats.isSymbolicLink()&&await this._handleSymlink(a,e,d,l)||(this.fsw.closed?u=void 0:l!==s&&(s||c.has(l))||(this.fsw._incrReadyCount(),d=r.join(i,r.relative(i,d)),this._addToNodeFs(d,t,n,o+1)))}).on(m,this._boundHandleError);return new Promise(t=>u.once(T,()=>{if(this.fsw.closed)return void(u=void 0);const l=!!a&&a.clear();t(),c.getChildren().filter(t=>t!==e&&!p.has(t)&&(!n.hasGlob||n.filterPath({fullPath:r.resolve(e,t)}))).forEach(t=>{this.fsw._remove(e,t)}),u=void 0,l&&this._handleRead(e,!1,n,s,i,o,a)}))}async _handleDir(e,t,n,s,i,o,a){const c=this.fsw._getWatchedDir(r.dirname(e)),l=c.has(r.basename(e));let p;n&&this.fsw.options.ignoreInitial||i||l||o.hasGlob&&!o.globFilter(e)||this.fsw._emit(y,e,t),c.add(r.basename(e)),this.fsw._getWatchedDir(e);const u=this.fsw.options.depth;if((null==u||s<=u)&&!this.fsw._symlinkPaths.has(a)){if(!i&&(await this._handleRead(e,n,o,i,e,s,void 0),this.fsw.closed))return;p=this._watchWithNodeFs(e,(t,n)=>{n&&0===n.mtimeMs||this._handleRead(t,!1,o,i,e,s,void 0)})}return p}async _addToNodeFs(e,t,n,s,i){const o=this.fsw._emitReady;if(this.fsw._isIgnored(e)||this.fsw.closed)return o(),!1;const a=this.fsw._getWatchHelpers(e,s);!a.hasGlob&&n&&(a.hasGlob=n.hasGlob,a.globFilter=n.globFilter,a.filterPath=e=>n.filterPath(e),a.filterDir=e=>n.filterDir(e));try{const n=await w[a.statMethod](a.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(a.watchPath,n))return o(),!1;const c=this.fsw.options.followSymlinks&&!e.includes(b)&&!e.includes(v);let l;if(n.isDirectory()){const r=c?await x(e):e;if(this.fsw.closed)return;if(l=await this._handleDir(a.watchPath,n,t,s,i,a,r),this.fsw.closed)return;e!==r&&void 0!==r&&this.fsw._symlinkPaths.set(r,!0)}else if(n.isSymbolicLink()){const i=c?await x(e):e;if(this.fsw.closed)return;const o=r.dirname(a.watchPath);if(this.fsw._getWatchedDir(o).add(a.watchPath),this.fsw._emit(g,a.watchPath,n),l=await this._handleDir(o,n,t,s,e,a,i),this.fsw.closed)return;void 0!==i&&this.fsw._symlinkPaths.set(r.resolve(e),i)}else l=this._handleFile(a.watchPath,n,t);return o(),this.fsw._addPathCloser(e,l),!1}catch(t){if(this.fsw._handleError(t))return o(),e}}}},function(e,t,n){"use strict";const s=n(2),r=n(146),i=new Set(r);e.exports=e=>i.has(s.extname(e).slice(1).toLowerCase())},function(e,t,n){e.exports=n(147)},function(e){e.exports=JSON.parse('["3dm","3ds","3g2","3gp","7z","a","aac","adp","ai","aif","aiff","alz","ape","apk","ar","arj","asf","au","avi","bak","baml","bh","bin","bk","bmp","btif","bz2","bzip2","cab","caf","cgm","class","cmx","cpio","cr2","cur","dat","dcm","deb","dex","djvu","dll","dmg","dng","doc","docm","docx","dot","dotm","dra","DS_Store","dsk","dts","dtshd","dvb","dwg","dxf","ecelp4800","ecelp7470","ecelp9600","egg","eol","eot","epub","exe","f4v","fbs","fh","fla","flac","fli","flv","fpx","fst","fvt","g3","gh","gif","graffle","gz","gzip","h261","h263","h264","icns","ico","ief","img","ipa","iso","jar","jpeg","jpg","jpgv","jpm","jxr","key","ktx","lha","lib","lvp","lz","lzh","lzma","lzo","m3u","m4a","m4v","mar","mdi","mht","mid","midi","mj2","mka","mkv","mmr","mng","mobi","mov","movie","mp3","mp4","mp4a","mpeg","mpg","mpga","mxu","nef","npx","numbers","nupkg","o","oga","ogg","ogv","otf","pages","pbm","pcx","pdb","pdf","pea","pgm","pic","png","pnm","pot","potm","potx","ppa","ppam","ppm","pps","ppsm","ppsx","ppt","pptm","pptx","psd","pya","pyc","pyo","pyv","qt","rar","ras","raw","resources","rgb","rip","rlc","rmf","rmvb","rtf","rz","s3m","s7z","scpt","sgi","shar","sil","sketch","slk","smv","snk","so","stl","suo","sub","swf","tar","tbz","tbz2","tga","tgz","thmx","tif","tiff","tlz","ttc","ttf","txz","udf","uvh","uvi","uvm","uvp","uvs","uvu","viv","vob","war","wav","wax","wbmp","wdp","weba","webm","webp","whl","wim","wm","wma","wmv","wmx","woff","woff2","wrm","wvx","xbm","xif","xla","xlam","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx","xm","xmind","xpi","xpm","xwd","xz","z","zip","zipx"]')},function(e,t,n){"use strict";const s=n(11),r=n(2),{promisify:i}=n(15);let o;try{o=n(149)}catch(e){process.env.CHOKIDAR_PRINT_FSEVENTS_REQUIRE_ERROR&&console.error(e)}if(o){const e=process.version.match(/v(\d+)\.(\d+)/);if(e&&e[1]&&e[2]){const t=Number.parseInt(e[1],10),n=Number.parseInt(e[2],10);8===t&&n<16&&(o=void 0)}}const{EV_ADD:a,EV_CHANGE:c,EV_ADD_DIR:l,EV_UNLINK:p,EV_ERROR:u,STR_DATA:d,STR_END:h,FSEVENT_CREATED:f,FSEVENT_MODIFIED:g,FSEVENT_DELETED:y,FSEVENT_MOVED:m,FSEVENT_UNKNOWN:_,FSEVENT_TYPE_DIRECTORY:T,FSEVENT_TYPE_SYMLINK:v,ROOT_GLOBSTAR:b,DIR_SUFFIX:E,DOT_SLASH:C,FUNCTION_TYPE:k,EMPTY_FN:S,IDENTITY_FN:x}=n(41),w=i(s.stat),I=i(s.open),R=i(s.close),F=i(s.lstat),P=i(s.realpath),A={stat:w,lstat:F},N=new Map,D=new Set([69888,70400,71424,72704,73472,131328,131840,262912]),O=(e,t)=>({stop:o.watch(e,t)});const M=e=>{let t=0;for(const n of N.keys())if(0===n.indexOf(e)&&(t++,t>=10))return!0;return!1},L=(e,t)=>{let n=0;for(;!e.indexOf(t)&&(e=r.dirname(e))!==t;)n++;return n};e.exports=class{constructor(e){this.fsw=e}checkIgnored(e,t){const n=this.fsw._ignoredPaths;if(this.fsw._isIgnored(e,t))return n.add(e),t&&t.isDirectory()&&n.add(e+b),!0;n.delete(e),n.delete(e+b)}addOrChange(e,t,n,s,r,i,o,l){const p=r.has(i)?c:a;this.handleEvent(p,e,t,n,s,r,i,o,l)}async checkFd(e,t,n,s,r,i,o,a){try{const c=await I(e,"r");if(this.fsw.closed)return;if(await R(c),this.fsw.closed)return;this.addOrChange(e,t,n,s,r,i,o,a)}catch(c){"EACCES"===c.code?this.addOrChange(e,t,n,s,r,i,o,a):this.handleEvent(p,e,t,n,s,r,i,o,a)}}handleEvent(e,t,n,s,r,i,o,c,u){if(!this.fsw.closed&&!this.checkIgnored(t))if(e===p)(c.type===T||i.has(o))&&this.fsw._remove(r,o);else{if(e===a){if(c.type===T&&this.fsw._getWatchedDir(t),c.type===v&&u.followSymlinks){const e=void 0===u.depth?void 0:L(n,s)+1;return this._addToFsEvents(t,!1,!0,e)}this.fsw._getWatchedDir(r).add(o)}const i=c.type===T?e+E:e;this.fsw._emit(i,t),i===l&&this._addToFsEvents(t,!1,!0)}}_watchWithFsEvents(e,t,n,s){if(this.fsw.closed)return;if(this.fsw._isIgnored(e))return;const i=this.fsw.options,a=function(e,t,n,s,i){let a=r.extname(e)?r.dirname(e):e;const c=r.dirname(a);let l=N.get(a);M(c)&&(a=c);const p=r.resolve(e),u=p!==t,d=(e,s,i)=>{u&&(e=e.replace(t,p)),e!==p&&e.indexOf(p+r.sep)||n(e,s,i)};let h=!1;for(const e of N.keys())if(0===t.indexOf(r.resolve(e)+r.sep)){a=e,l=N.get(a),h=!0;break}return l||h?l.listeners.add(d):(l={listeners:new Set([d]),rawEmitter:s,watcher:O(a,(e,t)=>{if(i.closed)return;const n=o.getInfo(e,t);l.listeners.forEach(s=>{s(e,t,n)}),l.rawEmitter(n.event,e,n)})},N.set(a,l)),()=>{const e=l.listeners;if(e.delete(d),!e.size&&(N.delete(a),l.watcher))return l.watcher.stop().then(()=>{l.rawEmitter=l.watcher=void 0,Object.freeze(l)})}}(e,t,async(o,a,c)=>{if(this.fsw.closed)return;if(void 0!==i.depth&&L(o,t)>i.depth)return;const l=n(r.join(e,r.relative(e,o)));if(s&&!s(l))return;const u=r.dirname(l),d=r.basename(l),h=this.fsw._getWatchedDir(c.type===T?l:u);if(D.has(a)||c.event===_)if(typeof i.ignored===k){let e;try{e=await w(l)}catch(e){}if(this.fsw.closed)return;if(this.checkIgnored(l,e))return;e?this.addOrChange(l,o,t,u,h,d,c,i):this.handleEvent(p,l,o,t,u,h,d,c,i)}else this.checkFd(l,o,t,u,h,d,c,i);else switch(c.event){case f:case g:return this.addOrChange(l,o,t,u,h,d,c,i);case y:case m:return this.checkFd(l,o,t,u,h,d,c,i)}},this.fsw._emitRaw,this.fsw);return this.fsw._emitReady(),a}async _handleFsEventsSymlink(e,t,n,s){if(!this.fsw.closed&&!this.fsw._symlinkPaths.has(t)){this.fsw._symlinkPaths.set(t,!0),this.fsw._incrReadyCount();try{const t=await P(e);if(this.fsw.closed)return;if(this.fsw._isIgnored(t))return this.fsw._emitReady();this.fsw._incrReadyCount(),this._addToFsEvents(t||e,s=>{let i=e;return t&&t!==C?i=s.replace(t,e):s!==C&&(i=r.join(e,s)),n(i)},!1,s)}catch(e){if(this.fsw._handleError(e))return this.fsw._emitReady()}}}emitAdd(e,t,n,s,i){const o=n(e),c=t.isDirectory(),p=this.fsw._getWatchedDir(r.dirname(o)),u=r.basename(o);c&&this.fsw._getWatchedDir(o),p.has(u)||(p.add(u),s.ignoreInitial&&!0!==i||this.fsw._emit(c?l:a,o,t))}initWatch(e,t,n,s){if(this.fsw.closed)return;const i=this._watchWithFsEvents(n.watchPath,r.resolve(e||n.watchPath),s,n.globFilter);this.fsw._addPathCloser(t,i)}async _addToFsEvents(e,t,n,s){if(this.fsw.closed)return;const i=this.fsw.options,o=typeof t===k?t:x,a=this.fsw._getWatchHelpers(e);try{const t=await A[a.statMethod](a.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(a.watchPath,t))throw null;if(t.isDirectory()){if(a.globFilter||this.emitAdd(o(e),t,o,i,n),s&&s>i.depth)return;this.fsw._readdirp(a.watchPath,{fileFilter:e=>a.filterPath(e),directoryFilter:e=>a.filterDir(e),...(c=i.depth-(s||0),isNaN(c)?{}:{depth:c})}).on(d,e=>{if(this.fsw.closed)return;if(e.stats.isDirectory()&&!a.filterPath(e))return;const t=r.join(a.watchPath,e.path),{fullPath:s}=e;if(a.followSymlinks&&e.stats.isSymbolicLink()){const e=void 0===i.depth?void 0:L(t,r.resolve(a.watchPath))+1;this._handleFsEventsSymlink(t,s,o,e)}else this.emitAdd(t,e.stats,o,i,n)}).on(u,S).on(h,()=>{this.fsw._emitReady()})}else this.emitAdd(a.watchPath,t,o,i,n),this.fsw._emitReady()}catch(e){e&&!this.fsw._handleError(e)||(this.fsw._emitReady(),this.fsw._emitReady())}var c;if(i.persistent&&!0!==n)if(typeof t===k)this.initWatch(void 0,e,a,o);else{let t;try{t=await P(a.watchPath)}catch(e){}this.initWatch(t,e,a,o)}}},e.exports.canUse=()=>o&&N.size<128},function(e,t,n){"use strict";if("darwin"!==process.platform)throw new Error(`Module 'fsevents' is not compatible with platform '${process.platform}'`);const s=n(150),r=s.constants;function i(e){return r.ItemIsFile&e?"file":r.ItemIsDir&e?"directory":r.ItemIsSymlink&e?"symlink":void 0}function o(e){return r.ItemRemoved&e?"deleted":r.ItemRenamed&e?"moved":r.ItemCreated&e?"created":r.ItemModified&e?"modified":r.RootChanged&e?"root-changed":r.ItemCloned&e?"cloned":function(e){for(let t in e)if(e[t])return!0;return!1}(e)?"modified":"unknown"}function a(e){return{inode:!!(r.ItemInodeMetaMod&e),finder:!!(r.ItemFinderInfoMod&e),access:!!(r.ItemChangeOwner&e),xattrs:!!(r.ItemXattrMod&e)}}t.watch=function(e,t){if("string"!=typeof e)throw new TypeError(`fsevents argument 1 must be a string and not a ${typeof e}`);if("function"!=typeof t)throw new TypeError(`fsevents argument 2 must be a function and not a ${typeof t}`);let n=s.start(e,t);if(!n)throw new Error(`could not watch: ${e}`);return()=>{const e=n?Promise.resolve(n).then(s.stop):Promise.resolve(void 0);return n=void 0,e}},t.getInfo=function(e,t){return{path:e,flags:t,event:o(t),type:i(t),changes:a(t)}},t.constants=r},function(e,t,n){(function(e){try{global.process.dlopen(e,"/Users/xm0003/src/coc-pyright/pyright-1.1.32/server/node_modules/chokidar/node_modules/fsevents/fsevents.node")}catch(e){throw new Error("Cannot open /Users/xm0003/src/coc-pyright/pyright-1.1.32/server/node_modules/chokidar/node_modules/fsevents/fsevents.node: "+e)}}).call(this,n(151)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s extends Map{constructor(e){super(),this._ls=e,this._defaultWorkspacePath="<default>"}getNonDefaultWorkspaces(){const e=[];return this.forEach(t=>{t.rootPath&&e.push(t)}),e}getWorkspaceForFile(e){let t,n;if(this.forEach(s=>{s.rootPath&&e.startsWith(s.rootPath)&&(void 0===t||s.rootPath.startsWith(t))&&(t=s.rootPath,n=s)}),void 0===n){let e=this.get(this._defaultWorkspacePath);if(!e){const t=[...this.keys()];if(1===t.length)return this.get(t[0]);e={workspaceName:"",rootPath:"",rootUri:"",serviceInstance:this._ls.createAnalyzerService(this._defaultWorkspacePath),disableLanguageServices:!1,disableOrganizeImports:!1},this.set(this._defaultWorkspacePath,e),this._ls.updateSettingsForWorkspace(e).ignoreErrors()}return e}return n}}t.WorkspaceMap=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(10),r=n(3);t.CodeActionProvider=class{static getCodeActionsForPosition(e,t,n,i){r.throwIfCancellationRequested(i);const o=s.CodeAction.create("Organize Imports",s.Command.create("Organize Imports","pyright.organizeimports"),s.CodeActionKind.SourceOrganizeImports),a=[];if(e.disableOrganizeImports||a.push(o),!e.disableLanguageServices){const r=e.serviceInstance.getDiagnosticsForRange(t,n),i=r.find(e=>{const t=e.getActions();return t&&t.find(e=>"pyright.createtypestub"===e.action)});if(i){const n=i.getActions().find(e=>"pyright.createtypestub"===e.action);if(n){const r=s.CodeAction.create(`Create Type Stub For "${n.moduleName}"`,s.Command.create("Create Type Stub","pyright.createtypestub",e.rootPath,n.moduleName,t),s.CodeActionKind.QuickFix);a.push(r)}}const o=r.find(e=>{const t=e.getActions();return t&&t.find(e=>"pyright.addoptionalforparam"===e.action)});if(o){const e=o.getActions().find(e=>"pyright.addoptionalforparam"===e.action);if(e){const t=s.CodeAction.create('Add "Optional" to type annotation',s.Command.create('Add "Optional" to type annotation',"pyright.addoptionalforparam",e.offsetOfTypeNode),s.CodeActionKind.QuickFix);a.push(t)}}}return a}}}]);
//# sourceMappingURL=server.bundle.js.map